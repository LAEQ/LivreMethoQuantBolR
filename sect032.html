<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Analyse centrographique | Notes de cours GMQ405 : Modélisation et analyse spatiale</title>
  <meta name="description" content="Mettre le description du cours." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Analyse centrographique | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Mettre le description du cours." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Analyse centrographique | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  
  <meta name="twitter:description" content="Mettre le description du cours." />
  <meta name="twitter:image" content="/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio, département de géomatique appliquée, Université de Sherbrooke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect031.html"/>
<link rel="next" href="sect033.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GMQ405 : modélisation et analyse spatiale</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Comment lire ce manuel?</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en géomatique appliquée et utiliser R?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
</ul></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Manipulation des données spatiales dans R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Importation de données géographiques</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sect011.html"><a href="sect011.html#sect0111"><i class="fa fa-check"></i><b>1.1.1</b> Importation de données vectorielles</a></li>
<li class="chapter" data-level="1.1.2" data-path="sect011.html"><a href="sect011.html#sect0112"><i class="fa fa-check"></i><b>1.1.2</b> Importation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Manipulation de données vectorielles</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Fonctions relatives à la projection cartographique</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Fonctions d’opérations géométriques sur une couche</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect01213"><i class="fa fa-check"></i><b>1.2.3</b> Fonctions d’opérations géométriques entre deux couches</a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#sect0124"><i class="fa fa-check"></i><b>1.2.4</b> Fonctions de mesures géométriques et de récupération des coordonnées géographiques</a></li>
<li class="chapter" data-level="1.2.5" data-path="sect012.html"><a href="sect012.html#sect0125"><i class="fa fa-check"></i><b>1.2.5</b> Jointures spatiales</a></li>
<li class="chapter" data-level="1.2.6" data-path="sect012.html"><a href="sect012.html#sect0126"><i class="fa fa-check"></i><b>1.2.6</b> Requêtes spatiales</a></li>
<li class="chapter" data-level="1.2.7" data-path="sect012.html"><a href="sect012.html#sect0127"><i class="fa fa-check"></i><b>1.2.7</b> Manipulation des données attributaires</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Manipulation de données <em>raster</em></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> Mosaïquage et découpage d’images</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Requêtes attributaires sur des images</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Exportation de données spatiales de R vers des formats géographiques</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Exportation de données vectorielles <code>sf</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Exportation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect015.html"><a href="sect015.html"><i class="fa fa-check"></i><b>1.5</b> Cartographie avec R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sect015.html"><a href="sect015.html#sect0151"><i class="fa fa-check"></i><b>1.5.1</b> Manipulation des couches géométriques</a></li>
<li class="chapter" data-level="1.5.2" data-path="sect015.html"><a href="sect015.html#sect0152"><i class="fa fa-check"></i><b>1.5.2</b> Cartes interactives</a></li>
<li class="chapter" data-level="1.5.3" data-path="sect015.html"><a href="sect015.html#sect0153"><i class="fa fa-check"></i><b>1.5.3</b> Mise en page d’une carte</a></li>
<li class="chapter" data-level="1.5.4" data-path="sect015.html"><a href="sect015.html#sect0154"><i class="fa fa-check"></i><b>1.5.4</b> Exportation d’une carte</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.6</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="1.7" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.7</b> Exercices de révision</a></li>
</ul></li>
<li class="part"><span><b>II Autocorrélation spatiale</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Autocorrélation spatiale</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion d’autocorrélation spatiale</a></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Matrices de pondération spatiale</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Matrices de contiguïté</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Matrices de proximité spatiale</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Standardisation des matrices de pondération spatiale en ligne</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Construction de matrices de pondération spatiale dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Autocorrélation spatiale globale</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Statistique du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Autocorrélation spatiale locale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#sect0241"><i class="fa fa-check"></i><b>2.4.1</b> Statistiques locales de Getis et Ord : repérer les points chauds et froids</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#sect0242"><i class="fa fa-check"></i><b>2.4.2</b> Version locale du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#sect0243"><i class="fa fa-check"></i><b>2.4.3</b> Nuage de points du <em>I</em> de Moran d’Anselin</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Méthodes de répartition ponctuelle</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Fréquence et densité des points dans l’espace d’étude</a></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Analyse centrographique</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0311"><i class="fa fa-check"></i><b>3.2.1</b> Paramètres de tendance centrale d’un semis de points</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0312"><i class="fa fa-check"></i><b>3.2.2</b> Paramètres de dispersion d’un semis de points</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0313"><i class="fa fa-check"></i><b>3.2.3</b> Mise en œuvre de l’analyse centrographique dans R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Forme d’un semis de points</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Méthode du plus proche voisin</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Méthode des quadrats</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Identification des agrégats spatiaux</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sect034.html"><a href="sect034.html#sect0341"><i class="fa fa-check"></i><b>3.4.1</b> Cartographie de la densité dans une maille irrégulière</a></li>
<li class="chapter" data-level="3.4.2" data-path="sect034.html"><a href="sect034.html#sect0342"><i class="fa fa-check"></i><b>3.4.2</b> Cartographie de la densité dans une maille régulière</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Méthodes de détection d’agrégats spatiaux et spatio-temporels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Agrégats d’entités spatiales ponctuelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sect041.html"><a href="sect041.html#sect0411"><i class="fa fa-check"></i><b>4.1.1</b> DBSCAN : agrégats spatiaux</a></li>
<li class="chapter" data-level="4.1.2" data-path="sect041.html"><a href="sect041.html#sect0412"><i class="fa fa-check"></i><b>4.1.2</b> ST-DBSCAN : agrégats spatio-temporels</a></li>
<li class="chapter" data-level="4.1.3" data-path="sect041.html"><a href="sect041.html#sect0414"><i class="fa fa-check"></i><b>4.1.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Méthodes de balayage de Kulldorff</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Objectifs de la méthode, types d’analyses, de modèles et d’agrégats</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Principes de base de la méthode</a></li>
<li class="chapter" data-level="4.2.3" data-path="sect042.html"><a href="sect042.html#sect043"><i class="fa fa-check"></i><b>4.2.3</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="4.4" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Mesures d’accessibilité spatiale selon les différents de modes de transport</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Notions relatives à l’analyse de réseau</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sect051.html"><a href="sect051.html#sect0511"><i class="fa fa-check"></i><b>5.1.1</b> Définition d’un réseau</a></li>
<li class="chapter" data-level="5.1.2" data-path="sect051.html"><a href="sect051.html#sect0512"><i class="fa fa-check"></i><b>5.1.2</b> Principaux problèmes résolus en analyse de réseau</a></li>
<li class="chapter" data-level="5.1.3" data-path="sect051.html"><a href="sect051.html#sect0513"><i class="fa fa-check"></i><b>5.1.3</b> Analyse de réseau et entités polygonales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Construction d’un réseau avec R5R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sect052.html"><a href="sect052.html#sect0521"><i class="fa fa-check"></i><b>5.2.1</b> Extraction des données spatiales pour R5R</a></li>
<li class="chapter" data-level="5.2.2" data-path="sect052.html"><a href="sect052.html#sect0522"><i class="fa fa-check"></i><b>5.2.2</b> Construction du réseau avec R5R</a></li>
<li class="chapter" data-level="5.2.3" data-path="sect052.html"><a href="sect052.html#sect0523"><i class="fa fa-check"></i><b>5.2.3</b> Calcul d’itinéraires avec R5R selon le mode de transport</a></li>
<li class="chapter" data-level="5.2.4" data-path="sect052.html"><a href="sect052.html#sect0524"><i class="fa fa-check"></i><b>5.2.4</b> Calcul de matrices OD selon différents modes de transport</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mesures d’accessibilité</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sect053.html"><a href="sect053.html#sect0531"><i class="fa fa-check"></i><b>5.3.1</b> Notion d’accessibilité</a></li>
<li class="chapter" data-level="5.3.2" data-path="sect053.html"><a href="sect053.html#sect0532"><i class="fa fa-check"></i><b>5.3.2</b> Accessibilité spatiale potentielle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Mesures d’accessibilité spatiale potentielle dans R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="sect054.html"><a href="sect054.html#sect0541"><i class="fa fa-check"></i><b>5.4.1</b> Accessibilité spatiale potentielle aux supermarchés</a></li>
<li class="chapter" data-level="5.4.2" data-path="sect054.html"><a href="sect054.html#sect0542"><i class="fa fa-check"></i><b>5.4.2</b> Accessibilité spatiale potentielle aux patinoires extérieures</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Introduction aux modèles de régression spatiale</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Modèles spatiaux autorégressifs</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Les différents modèles</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Quel modèle choisir?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Autres approches de modélisation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Modèles généralisées additifs (GAM) avec une <em>spline</em> bivariée sur les coordonnées géographiques</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> GAM avec <em>random markov field</em></a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Modèle SEVM (<em>Spatial eigenvector mapping</em>)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Modèles géographiquement pondérées</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sect063.html"><a href="sect063.html#sect0631"><i class="fa fa-check"></i><b>6.3.1</b> Modèles GWR classique</a></li>
<li class="chapter" data-level="6.3.2" data-path="sect063.html"><a href="sect063.html#sect0632"><i class="fa fa-check"></i><b>6.3.2</b> Modèles GWR mixte</a></li>
<li class="chapter" data-level="6.3.3" data-path="sect063.html"><a href="sect063.html#sect0633"><i class="fa fa-check"></i><b>6.3.3</b> Modèle MGWR</a></li>
<li class="chapter" data-level="6.3.4" data-path="sect063.html"><a href="sect063.html#sect0634"><i class="fa fa-check"></i><b>6.3.4</b> Modèles MGWR avec autocorrélation spatiale (MGWRSAR)</a></li>
<li class="chapter" data-level="6.3.5" data-path="sect063.html"><a href="sect063.html#sect0635"><i class="fa fa-check"></i><b>6.3.5</b> Extension des modèles GWR pour des variables binaires et de comptages</a></li>
<li class="chapter" data-level="6.3.6" data-path="sect063.html"><a href="sect063.html#sect0636"><i class="fa fa-check"></i><b>6.3.6</b> Autres extensions de la GWR : un aperçu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Introduction aux méthodes de classification spatiale</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Bref retour sur les méthodes de classification non-supervisées</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sect071.html"><a href="sect071.html#sect0711"><i class="fa fa-check"></i><b>7.1.1</b> Classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="7.1.2" data-path="sect071.html"><a href="sect071.html#sect0712"><i class="fa fa-check"></i><b>7.1.2</b> <em>K-means</em></a></li>
<li class="chapter" data-level="7.1.3" data-path="sect071.html"><a href="sect071.html#sect0713"><i class="fa fa-check"></i><b>7.1.3</b> <em>Fuzzy c-means</em></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Méthodes de classification par agrégation intégrant une constrainte spatiale</a></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Classifications spatiales</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Classification ascendante hiérarchique spatiale (<em>ClustGeo</em>)</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> <em>Spatial fuzzy c-means</em> (SFCM)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Méthodes d’interpolation spatiale</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Méthodes déterministes</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Interpolation polynomiale locale</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Interpolation de l’inverse à la distance - <em>IDW</em></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Méthodes géostatistiques</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Krigeage simple</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Krigeage universel</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Co-krigeage</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Krigeage résiduel</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect083.html"><a href="sect083.html"><i class="fa fa-check"></i><b>8.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="8.4" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Analyse spatiale par l’analyse d’images</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Fonctions mathématiques, booléennes, relationnelles et conditionnelles sur les images</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Fonctions mathématiques</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Fonctions booléennes</a></li>
<li class="chapter" data-level="9.1.3" data-path="sect091.html"><a href="sect091.html#sect0913"><i class="fa fa-check"></i><b>9.1.3</b> Fonctions relationnelles</a></li>
<li class="chapter" data-level="9.1.4" data-path="sect091.html"><a href="sect091.html#sect0914"><i class="fa fa-check"></i><b>9.1.4</b> Fonctions conditionnelles</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Fonctions locales, focales, zonales et globales sur les images</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> Fonctions locales</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0922"><i class="fa fa-check"></i><b>9.2.2</b> Fonctions focales</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.3</b> Fonctions zonales</a></li>
<li class="chapter" data-level="9.2.4" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.4</b> Fonctions globales</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Fonctions de surface</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Élevation</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Pente</a></li>
<li class="chapter" data-level="9.3.3" data-path="sect093.html"><a href="sect093.html#sect0933"><i class="fa fa-check"></i><b>9.3.3</b> Ombrage</a></li>
<li class="chapter" data-level="9.3.4" data-path="sect093.html"><a href="sect093.html#sect0934"><i class="fa fa-check"></i><b>9.3.4</b> Visibilité</a></li>
<li class="chapter" data-level="9.3.5" data-path="sect093.html"><a href="sect093.html#sect0935"><i class="fa fa-check"></i><b>9.3.5</b> Sky-view factor Index</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Données spatiotemporelles en mode image</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#fichier-netcdf"><i class="fa fa-check"></i><b>9.4.1</b> Fichier <em>netCDF</em></a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#exemples-applicatifs"><i class="fa fa-check"></i><b>9.4.2</b> Exemples applicatifs</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Correction des exercices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect1001.html"><a href="sect1001.html"><i class="fa fa-check"></i><b>10.1</b> Exercices du chapitre 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect1001.html"><a href="sect1001.html#sect10011"><i class="fa fa-check"></i><b>10.1.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect1001.html"><a href="sect1001.html#sect10012"><i class="fa fa-check"></i><b>10.1.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="sect1001.html"><a href="sect1001.html#sect10013"><i class="fa fa-check"></i><b>10.1.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="sect1001.html"><a href="sect1001.html#sect10014"><i class="fa fa-check"></i><b>10.1.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect1002.html"><a href="sect1002.html"><i class="fa fa-check"></i><b>10.2</b> Exercices du chapitre 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect1002.html"><a href="sect1002.html#sect10021"><i class="fa fa-check"></i><b>10.2.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect1002.html"><a href="sect1002.html#sect10022"><i class="fa fa-check"></i><b>10.2.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.2.3" data-path="sect1002.html"><a href="sect1002.html#sect10023"><i class="fa fa-check"></i><b>10.2.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.2.4" data-path="sect1002.html"><a href="sect1002.html#sect10024"><i class="fa fa-check"></i><b>10.2.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect1003.html"><a href="sect1003.html"><i class="fa fa-check"></i><b>10.3</b> Exercices du chapitre 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sect1003.html"><a href="sect1003.html#sect10031"><i class="fa fa-check"></i><b>10.3.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="sect1003.html"><a href="sect1003.html#sect10032"><i class="fa fa-check"></i><b>10.3.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.3.3" data-path="sect1003.html"><a href="sect1003.html#sect10033"><i class="fa fa-check"></i><b>10.3.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sect1004.html"><a href="sect1004.html"><i class="fa fa-check"></i><b>10.4</b> Exercices du chapitre 4</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect1004.html"><a href="sect1004.html#sect10041"><i class="fa fa-check"></i><b>10.4.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect1004.html"><a href="sect1004.html#sect10042"><i class="fa fa-check"></i><b>10.4.2</b> Exercice 2</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect1005.html"><a href="sect1005.html"><i class="fa fa-check"></i><b>10.5</b> Exercices du chapitre 5</a></li>
<li class="chapter" data-level="10.6" data-path="sect1006.html"><a href="sect1006.html"><i class="fa fa-check"></i><b>10.6</b> Exercices du chapitre 6</a></li>
<li class="chapter" data-level="10.7" data-path="sect1007.html"><a href="sect1007.html"><i class="fa fa-check"></i><b>10.7</b> Exercices du chapitre 7</a></li>
<li class="chapter" data-level="10.8" data-path="sect1008.html"><a href="sect1008.html"><i class="fa fa-check"></i><b>10.8</b> Exercices du chapitre 8</a></li>
<li class="chapter" data-level="10.9" data-path="sect1009.html"><a href="sect1009.html"><i class="fa fa-check"></i><b>10.9</b> Exercices du chapitre 9</a></li>
<li class="chapter" data-level="10.10" data-path="sect1011.html"><a href="sect1011.html"><i class="fa fa-check"></i><b>10.10</b> Exercices du chapitre 11</a></li>
<li class="chapter" data-level="10.11" data-path="sect1012.html"><a href="sect1012.html"><i class="fa fa-check"></i><b>10.11</b> Excercice du chapitre 12</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours GMQ405 :
Modélisation et analyse spatiale</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect032" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Analyse centrographique<a href="sect032.html#sect032" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>L’analyse centrographique est une approche qui a été largement utilisée durant les décennies 1990 et 2000. Son utilisation est parfois critiquée pour deux raisons principales : 1) elle ne décrit que partiellement le semis de points; 2) aucun test d’inférence n’est calculé. Quoi qu’il en soit, elle permet d’explorer les données avant de se lancer dans des analyses plus avancées.</p>
<div class="bloc_notes">
<p><strong>Utilisation de l’analyse centrographique au Québec et dans le monde francophone</strong></p>
<p>Marius Thériault (géographe et professeur émérite à l’Université Laval) a largement contribué à la popularité de l’analyse centrographique au Québec et ailleurs. Il est le créateur de <em>MapStat</em>, un module MapBasic intégré dans le logiciel SIG MapInfo permettant de réaliser une analyse centrographique avant même qu’elle soit implémentée dans ArcGIS. En guise d’exemple, les études suivantes utilisent l’analyse centrographique calculée avec <em>MapStat</em> <span class="citation">(<a href="#ref-lopez2015evolution" role="doc-biblioref">López Castro, Thériault et Vandersmissen 2015</a>; <a href="#ref-barbonne2007dynamique" role="doc-biblioref">Barbonne, Villeneuve et Thériault 2007</a>)</span>. Consultez-les au besoin.</p>
</div>
<div id="sect0311" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Paramètres de tendance centrale d’un semis de points<a href="sect032.html#sect0311" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect03111" class="section level4 hasAnchor" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Centre moyen<a href="sect032.html#sect03111" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le centre moyen (<span class="math inline">\(cm\)</span>) est le centre de gravité du semis de points et correspond aux valeurs des moyennes arithmétiques des coordonnées géographiques (équation <a href="sect032.html#eq:CentreMoyen">(3.1)</a>).</p>
<p><span class="math display" id="eq:CentreMoyen">\[\begin{equation}  
(\bar{x}_{cm}, \bar{y}_{cm}) = \Biggl( \frac{\Sigma_{i=1}^n x_i}{n}, \frac{\Sigma_{i=1}^n y_i}{n}\Biggl)\text{ avec :}
\tag{3.1}
\end{equation}\]</span>
</p>
<ul>
<li><span class="math inline">\((\bar{x}_{cm}, \bar{y}_{cm})\)</span>, les coordonnées géographiques du point moyen.</li>
<li><span class="math inline">\(n\)</span>, le nombre de points dans la couche géographique.</li>
<li><span class="math inline">\(x_i\)</span> et <span class="math inline">\(y_j\)</span>, les coordonnées géographiques du point <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Il est possible de calculer le centre moyen en pondérant chacun des points du semis avec la valeur d’une variable donnée (équation <a href="sect032.html#eq:CentreMoyenPonderee">(3.2)</a>). Ainsi, l’importance accordée à chacun des points n’est pas la même. Par exemple, nous pourrions calculer le centre moyen pondéré (<span class="math inline">\(cmp\)</span>) des cliniques médicales d’une ville en pondérant chaque clinique par le nombre de médecins, ou encore le point moyen des hôpitaux pondéré par le nombre de lits. Autre exemple, avec un jeu de données sur les arbres dans une érablière, nous pourrions utiliser une pondération basée sur le DHP (diamètre à la hauteur de la poitrine) afin d’accorder un poids plus important aux arbres de plus « grand volume ».</p>
<div class="bloc_notes">
<p><strong>Pour un rappel sur le calcul d’une moyenne pondérée</strong>, consultez la section intitulée <a href="https://laeq.github.io/LivreMethoQuantBolR/sect027.html"><em>Statistiques descriptives pondérées</em></a> <span class="citation">(<a href="#ref-RBoldAir" role="doc-biblioref">Apparicio et Gelb 2022</a>)</span>.</p>
</div>
<p><span class="math display" id="eq:CentreMoyenPonderee">\[\begin{equation}  
(\bar{x}_{cmp}, \bar{y}_{cmp}) = \Biggl( \frac{\Sigma_{i=1}^n w_ix_i}{\Sigma_{i=1}^nw_i}, \frac{\Sigma_{i=1}^n w_iy_i}{\Sigma_{i=1}^nw_i}\Biggl) \text{ avec :}
\tag{3.2}
\end{equation}\]</span>
</p>
<ul>
<li><span class="math inline">\(n\)</span>, <span class="math inline">\(x_i\)</span> et <span class="math inline">\(y_j\)</span> étant définis plus haut.</li>
<li><span class="math inline">\((\bar{x}_w, \bar{y}_w)\)</span>, les coordonnées géographiques du point moyen pondéré.</li>
<li><span class="math inline">\(w_i\)</span>, la valeur de pondération associée au point <span class="math inline">\(i\)</span>.</li>
</ul>
<p>Le centre moyen et le centre moyen pondéré sont des mesures très utiles pour comparer la distribution de plusieurs semis de points (de différents services et équipements collectifs par exemple) ou encore pour décrire l’évolution dans le temps de la répartition d’un semis de points. L’analyse du déplacement du centre moyen (pondéré) à différentes dates nous informe ainsi de l’évolution du phénomène à l’étude, et plus spécifiquement, de son orientation, de sa direction.</p>
<div class="bloc_astuce">
<p><strong>Exemple d’utilisation temporelle du centre moyen pondéré : le centre moyen de la population américaine</strong></p>
<p>Un exemple classique d’utilisation du centre moyen pondéré sur plusieurs années est l’évolution du centre moyen pondéré de la population des États-Unis de 1790 à 2020. Il est calculé à partir des centroïdes des comtés américains et de la population comme variable de pondération issus des recensements de l’<em>US Census Bureau</em>. Sans surprise, le centre moyen pondéré se déplace vers l’ouest.</p>
<p>Vous pouvez consulter <a href="https://www.census.gov/library/visualizations/2020/geo/center-of-population-1790-2020.html">cette carte</a> ou visionner cette <a href="https://www.youtube.com/watch?v=D9XelnGyggI">courte vidéo YouTube ludique</a>.</p>
</div>
<p>Notez que les centres moyen et moyen pondéré peuvent aussi être calculés sur des données géographiques comprenant l’élévation (<span class="math inline">\(x,y,z\)</span>) :</p>
<p><span class="math display" id="eq:PointMoyenZ1">\[\begin{equation}  
(\bar{x}_{cm}, \bar{y}_{cm}, \bar{z}_{cm}) = \Biggl( \frac{\Sigma_{i=1}^n x_i}{n}, \frac{\Sigma_{i=1}^n y_i}{n}, \frac{w_i\Sigma_{i=1}^n z_i}{n}\Biggl)
\tag{3.3}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:PointMoyenZ2">\[\begin{equation}  
(\bar{x}_{cmp}, \bar{y}_{cmp}, \bar{z}_{cmp}) = \Biggl( \frac{w_i\Sigma_{i=1}^n x_i}{\Sigma_{i=1}^nw_i}, \frac{w_i\Sigma_{i=1}^n y_i}{\Sigma_{i=1}^nw_i}, \frac{w_i\Sigma_{i=1}^n z_i}{\Sigma_{i=1}^nw_i}\Biggl)
\tag{3.4}
\end{equation}\]</span>
</p>
</div>
<div id="sect03112" class="section level4 hasAnchor" number="3.2.1.2">
<h4><span class="header-section-number">3.2.1.2</span> Point central<a href="sect032.html#sect03112" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le point central d’un semis de points (<span class="math inline">\(pc\)</span>) est celui qui minimise la somme des distances le séparant de tous les autres points (équation <a href="sect032.html#eq:PointCentral">(3.5)</a>). Bien entendu, il est aussi possible de calculer le point central pondéré (<span class="math inline">\(pcp\)</span>) (équation <a href="sect032.html#eq:PointCentralW">(3.6)</a>).</p>
<p><span class="math display" id="eq:PointCentral">\[\begin{equation}  
\text{Min}\Biggl(\Sigma_{i=1}^n \sqrt{(x_i-x_j)^2+(y_i-y_j)^2}\Biggl)\text{; avec }i \ne j
\tag{3.5}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:PointCentralW">\[\begin{equation}  
\text{Min}\Biggl(\Sigma_{i=1}^n w_i \sqrt{(x_i-x_j)^2+(y_i-y_j)^2}\Biggl)\text{; avec }i \ne j
\tag{3.6}
\end{equation}\]</span>
</p>
<div class="bloc_attention">
<p><strong>Différence entre point central et centre moyen</strong></p>
<p>Contrairement au centre moyen, le point central fait partie du semis de points initial.</p>
<p><strong>Utilité du point central pondéré</strong></p>
<p>Imaginez que des personnes étudiantes en géographie et en géomatique de toutes les universités du Québec souhaitent organiser une rencontre en présence. Calculer le point central, pondéré par le nombre de personnes étudiantes par établissement participant à la rencontre, permet d’identifier l’université la plus centrale. Idéalement, il faudrait calculer ce point central pondéré avec la distance réticulaire.</p>
</div>
</div>
</div>
<div id="sect0312" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Paramètres de dispersion d’un semis de points<a href="sect032.html#sect0312" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect03121" class="section level4 hasAnchor" number="3.2.2.1">
<h4><span class="header-section-number">3.2.2.1</span> Distance standard et distance standard pondérée<a href="sect032.html#sect03121" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En statistique univariée, l’écart-type (équation <a href="sect032.html#eq:ecartype">(3.7)</a>) est une mesure de dispersion bien connue : plus la valeur de l’écart-type est élevée, plus la dispersion des valeurs de la variable autour de la moyenne (<span class="math inline">\(\mu\)</span>) est importante.</p>
<p><span class="math display" id="eq:ecartype">\[\begin{equation}  
\sigma=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\mu)^2}{n}}
\tag{3.7}
\end{equation}\]</span>
</p>
<div class="bloc_notes">
<p><strong>Pour un rappel sur l’écart-type</strong>, consultez la section intitulée <a href="https://laeq.github.io/LivreMethoQuantBolR/sect025.html#sect0253"><em>Paramètres de dispersion</em></a> <span class="citation">(<a href="#ref-RBoldAir" role="doc-biblioref">Apparicio et Gelb 2022</a>)</span>.</p>
</div>
<p><strong>Distance standard (pondérée ou non) des <em>X</em> et des <em>Y</em></strong></p>
<p>De manière analogue à l’écart-type, nous pouvons calculer la distance standard pour les coordonnées <em>X</em> et pour les coordonnées <em>Y</em> des points, soit l’écart moyen respectif au centre moyen (équation <a href="sect032.html#eq:distancestandardxy">(3.8)</a>) ou au centre moyen pondéré (équation <a href="sect032.html#eq:distancestandardxyw">(3.9)</a>).</p>
<p><span class="math display" id="eq:distancestandardxy">\[\begin{equation}  
\sigma_x=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x}_{cm})^2}{n}} \text{ et }
\sigma_y=\sqrt{\frac{\sum_{i=1}^n (y_{i}-\bar{y}_{cm})^2}{n}}
\tag{3.8}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:distancestandardxyw">\[\begin{equation}  
\sigma_{xw}=\sqrt{\frac{\sum_{i=1}^n w_i(x_{i}-\bar{x}_{cmp})^2}{\sum_{i=1}^n{w_i}}} \text{ et } \sigma_{yw}=\sqrt{\frac{\sum_{i=1}^n w_i(y_{i}-\bar{y}_{cmp})^2}{\sum_{i=1}^n{w_i}}}
\tag{3.9}
\end{equation}\]</span>
</p>
<p><strong>Distance standard (pondérée ou non)</strong></p>
<p>Nous pouvons aussi calculer la distance standard (<span class="math inline">\(ds\)</span>) sans ou avec pondération (équations <a href="sect032.html#eq:distancestandard">(3.10)</a> et <a href="sect032.html#eq:distancestandardw">(3.11)</a>). Plus elle est forte, plus les points sont dispersés autour du centre moyen ou du centre moyen pondéré. Inversement, une faible distance standard traduit une concentration de points autour du centre moyen.</p>
<p><span class="math display" id="eq:distancestandard">\[\begin{equation}  
ds=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x}_{cm})^2}{n} + \frac{\sum_{i=1}^n (y_{i}-\bar{y}_{cm})^2}{n}}
\tag{3.10}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:distancestandardw">\[\begin{equation}  
ds_w=\sqrt{\frac{\sum_{i=1}^n w_i(x_{i}-\bar{x}_{cmp})^2}{\sum_{i=1}^n w_i} + \frac{\sum_{i=1}^n w_i(y_{i}-\bar{y}_{cmp})^2}{\sum_{i=1}^n w_i}}
\tag{3.11}
\end{equation}\]</span>
</p>
<p>De nouveau, ces mesures peuvent être adaptées pour des points avec une élévation (<span class="math inline">\(x,y,z\)</span>) :</p>
<p><span class="math display" id="eq:distancestandardz">\[\begin{equation}  
ds=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x}_{cm})^2}{n} + \frac{\sum_{i=1}^n (y_{i}-\bar{y}_{cm})^2}{n} + \frac{\sum_{i=1}^n (z_{i}-\bar{z}_{cm})^2}{n}}
\tag{3.12}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:distancestandardwz">\[\begin{equation}  
ds_w=\sqrt{\frac{\sum_{i=1}^n w_i(x_{i}-\bar{x}_{cmp})^2}{\sum_{i=1}^n w_i} + \frac{\sum_{i=1}^n w_i(y_{i}-\bar{y}_{cmp})^2}{\sum_{i=1}^n w_i} + \frac{\sum_{i=1}^n w_i(z_{i}-\bar{z}_{cmp})^2}{\sum_{i=1}^n w_i}}
\tag{3.13}
\end{equation}\]</span>
</p>
</div>
<div id="sect03122" class="section level4 hasAnchor" number="3.2.2.2">
<h4><span class="header-section-number">3.2.2.2</span> Représenter la dispersion : cercle de distance standard et ellipse<a href="sect032.html#sect03122" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La dispersion d’un semis de points peut être représentée de quatre manières différentes :</p>
<ol style="list-style-type: decimal">
<li><p>Une enveloppe convexe des points décrite à la section <a href="sect012.html#sect01225">1.2.2.5</a>.</p></li>
<li><p>Un rectangle centré sur le centre moyen avec les déviations des coordonnées <em>X</em> et <em>Y</em> pondérées ou non (équations <a href="sect032.html#eq:distancestandardxy">(3.8)</a> et <a href="sect032.html#eq:distancestandardxyw">(3.9)</a> décrites précédemment). Dans le cas de données comprenant l’élévation, la forme géométrique est un parallélépipède rectangle.</p></li>
<li><p>Un cercle de rayon de distance standard pondérée ou non (équations <a href="sect032.html#eq:distancestandard">(3.10)</a> et <a href="sect032.html#eq:distancestandardw">(3.11)</a> décrites précédemment). Dans le cas de données comprenant l’élévation, la forme géométrique est une sphère de rayon de distance standard.</p></li>
<li><p>Une ellipse de distance standard pondérée ou non. Dans le cas de données comprenant l’élévation, la forme géométrique est un ellipsoïde.</p></li>
</ol>
<p><strong>Prenons un jeu de données fictives</strong> pour décrire ces quatre représentations graphiques. Imaginons que nous avons observé le parc de la Laurentie à Sherbrooke pour comprendre son utilisation. Pour collecter des données sur la localisation des personnes utilisatrices, nous aurions pu utiliser un questionnaire dans QFIELD ou ArcGIS Survey 123. La figure <a href="sect032.html#fig:PointsB">3.1</a> illustre la localisation de dix personnes (points rouges).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:PointsB"></span>
<img src="images/Chap03/CartePointsB.png" alt="Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke" width="100%" />
<p class="caption">
Figure 3.1: Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke
</p>
</div>
<p>À partir de ces dix points, nous obtenons :</p>
<ul>
<li><p>Les coordonnées du <strong>centre moyen</strong> qui sont égales à -8 007 869 et 5 685 921, soit simplement les moyennes des coordonnées <em>X</em> et <em>Y</em> des dix observations.</p></li>
<li><p>L’<strong>enveloppe convexe des points</strong> qui contient tous les points.</p></li>
<li><p><strong>Le rectangle construit avec les déviations standards des <em>X</em> et des <em>Y</em></strong> qui est centré sur le centre moyen. À partir de ce point, nous ajoutons à l’est et à l’ouest la valeur de la distance standard des <em>X</em> et au nord et au sud celle des <em>Y</em>. Les valeurs de ces distances standards sont égales à 32,60 et 52,20 mètres (voir les calculs au tableau <a href="sect032.html#tab:DonneesFictivesCasB">3.2</a>).</p></li>
<li><p>La <strong>distance standard</strong> est égale à 61,59 mètres (voir les calculs au tableau <a href="sect032.html#tab:DonneesFictivesCasB">3.2</a>). À partir de cette distance, nous traçons le cercle ayant comme rayon la distance standard.</p></li>
<li><p>L’<strong>ellipse de déviation de distance standard</strong> (figure <a href="sect032.html#fig:ExplicationEllipse">3.2</a>).</p></li>
</ul>
<table>
<caption>
<span id="tab:DonneesFictivesCasB">Tableau 3.2: </span>Calcul des distances standards des X et des Y et de la distance standard
</caption>
<thead>
<tr>
<th style="text-align:right;">
Pt
</th>
<th style="text-align:right;">
<span class="math inline">\(x_i\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(y_i\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((x_{i}-\bar{x}_{cm})^2\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((y_{i}-\bar{y}_{cm})^2\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((x_{i}-\bar{x}_{cm})^2+\)</span><span class="math inline">\((y_{i}-\bar{y}_{cm})^2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
-8 007 877
</td>
<td style="text-align:right;">
5 686 000
</td>
<td style="text-align:right;">
52,80
</td>
<td style="text-align:right;">
6 347,70
</td>
<td style="text-align:right;">
6 400,50
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-8 007 843
</td>
<td style="text-align:right;">
5 685 993
</td>
<td style="text-align:right;">
716,90
</td>
<td style="text-align:right;">
5 298,00
</td>
<td style="text-align:right;">
6 014,90
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
-8 007 836
</td>
<td style="text-align:right;">
5 685 976
</td>
<td style="text-align:right;">
1 082,00
</td>
<td style="text-align:right;">
3 046,30
</td>
<td style="text-align:right;">
4 128,30
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
-8 007 859
</td>
<td style="text-align:right;">
5 685 928
</td>
<td style="text-align:right;">
98,90
</td>
<td style="text-align:right;">
60,30
</td>
<td style="text-align:right;">
159,20
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
-8 007 911
</td>
<td style="text-align:right;">
5 685 935
</td>
<td style="text-align:right;">
1 770,20
</td>
<td style="text-align:right;">
214,60
</td>
<td style="text-align:right;">
1 984,80
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
-8 007 913
</td>
<td style="text-align:right;">
5 685 871
</td>
<td style="text-align:right;">
1 934,80
</td>
<td style="text-align:right;">
2 461,00
</td>
<td style="text-align:right;">
4 395,80
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
-8 007 888
</td>
<td style="text-align:right;">
5 685 855
</td>
<td style="text-align:right;">
365,70
</td>
<td style="text-align:right;">
4 363,40
</td>
<td style="text-align:right;">
4 729,10
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
-8 007 835
</td>
<td style="text-align:right;">
5 685 857
</td>
<td style="text-align:right;">
1 185,00
</td>
<td style="text-align:right;">
4 016,80
</td>
<td style="text-align:right;">
5 201,80
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
-8 007 824
</td>
<td style="text-align:right;">
5 685 886
</td>
<td style="text-align:right;">
2 071,70
</td>
<td style="text-align:right;">
1 203,50
</td>
<td style="text-align:right;">
3 275,20
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
-8 007 906
</td>
<td style="text-align:right;">
5 685 904
</td>
<td style="text-align:right;">
1 376,50
</td>
<td style="text-align:right;">
266,70
</td>
<td style="text-align:right;">
1 643,30
</td>
</tr>
<tr>
<td style="text-align:right;">
<span class="math inline">\(n =\)</span>
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:right;">
<span class="math inline">\(\text{Moyenne} =\)</span>
</td>
<td style="text-align:right;">
-8 007 869
</td>
<td style="text-align:right;">
5 685 921
</td>
<td style="text-align:right;">
1 065,45
</td>
<td style="text-align:right;">
2 727,83
</td>
<td style="text-align:right;">
3 793,28
</td>
</tr>
<tr>
<td style="text-align:right;">
<span class="math inline">\(\text{Racine carrée} =\)</span>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
32,60
</td>
<td style="text-align:right;">
52,20
</td>
<td style="text-align:right;">
61,59
</td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ExplicationEllipse"></span>
<img src="images/Chap03/ExplicationEllipse.png" alt="Trois éléments composant une ellipse" width="35%" />
<p class="caption">
Figure 3.2: Trois éléments composant une ellipse
</p>
</div>
<div class="bloc_attention">
<p><strong>Calcul des ellipses : des résultats qui varient d’un logiciel à l’autre…</strong></p>
<p>Étonnamment, il existe plusieurs solutions pour tracer une ellipse. Pour une discussion détaillée de ces différentes solutions, lisez le <a href="https://portailsig.org/content/qgis-des-ellipses-de-deviation-standard-sde-un-plugin-standard-deviational-ellipse-des-scrip.html">court texte très intéressant de Martin Leroux</a>.</p>
<ul>
<li>Ellipse de Yuill <span class="citation">(<a href="#ref-tveitesde" role="doc-biblioref">Tveite 2020</a>)</span>.</li>
<li>Ellipse basée sur la covariance implémentée dans <a href="https://pro.arcgis.com/en/pro-app/3.0/tool-reference/spatial-statistics/h-how-directional-distribution-standard-deviationa.htm">ArcGIS Pro</a>.</li>
<li>Ellipse de distance standard implémentée dans le logiciel <a href="https://www.icpsr.umich.edu/CrimeStat/">CrimeStat</a>.</li>
<li>Ellipse avec la correction proposée par Wang et ses collègues <span class="citation">(<a href="#ref-wang2015confidence" role="doc-biblioref">2015</a>)</span>.</li>
</ul>
<p>Il est à noter qu’un plugin QGIS intitulé <em>The QGIS Standard Deviational Ellipse Plugin</em> <span class="citation">(<a href="#ref-tveitesde" role="doc-biblioref">Tveite 2020</a>)</span> intègre plusieurs de ces méthodes. Les résultats varient ainsi d’un logiciel à l’autre dépendamment de la méthode implémentée. Autrement dit, pour un même jeu de données ponctuelles, l’ellipse n’est pas la même dans ArcGIS Pro, ArcMap 9.3, ArcMap 10.x et QGIS.</p>
<p><strong>Quoi faire alors?</strong></p>
<p>Quelle que soit la méthode utilisée, l’ellipse est toujours centrée sur le point moyen et a toujours le même angle de rotation. Par contre, la taille de l’ellipse (superficie) varie. Par conséquent, si vous souhaitez comparer des ellipses différentes, assurez-vous toujours qu’elles sont toutes obtenues dans le même logiciel et avec la même solution.</p>
</div>
<div class="bloc_aller_loin">
<p><strong>Calcul de l’ellipse selon la méthode implémentée dans CrimeStat</strong></p>
<p>Ned Levine <span class="citation">(<a href="#ref-levine2006crime" role="doc-biblioref">2006</a>; <a href="#ref-levine2021crimestat" role="doc-biblioref">2021</a>)</span> ayant développé le logiciel <a href="https://www.icpsr.umich.edu/CrimeStat/">CrimeStat</a> propose les formulations suivantes pour le calcul d’une ellipse :</p>
<p><span class="math display" id="eq:CrimeStatRotation">\[\begin{equation}  
\theta = \frac{\text{arctan} \Biggl\{ \Bigl(\sum_{i=1}^nx_d^2-\sum_{i=1}^ny_d^2 \Bigl)+  \Bigr[\Bigl(\sum_{i=1}^nx_d^2-\sum_{i=1}^ny_d^2 \Bigl)^2 + 4 \Bigl(\sum_{i=1}^nx_dy_d \Bigl)^2\Bigr]^{1/2} \Biggl\}} {2 \sum_{i=1}^nx_dy_d}
\tag{3.14}
\end{equation}\]</span>
</p>
<p>avec <span class="math inline">\(\theta\)</span> est la rotation de l’ellipse, <span class="math inline">\(x_d = x_i-\bar{x}\)</span> et <span class="math inline">\(y_d = y_i-\bar{y}\)</span>.</p>
<p><span class="math display" id="eq:CrimeStatSigmaX">\[\begin{equation}  
\sigma_x =\sqrt{2\times \frac{\sum_{i=1}^n\Bigl((x_i-\bar{x}) \text{cos}\theta-(y_i-\bar{y})\text{sin}\theta\Bigl)^2}{n-2}}
\tag{3.15}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:CrimeStatSigmaY">\[\begin{equation}  
\sigma_y =\sqrt{2\times \frac{\sum_{i=1}^n\Bigl((x_i-\bar{x}) \text{sin}\theta-(y_i-\bar{y})\text{cos}\theta\Bigl)^2}{n-2}}
\tag{3.16}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:CrimeStatSuperficieLyLx">\[\begin{equation}  
l_x=2\sigma_x \text{ et }l_y=2\sigma_y \text{ et }S_e=\pi\sigma_x\sigma_y
\tag{3.17}
\end{equation}\]</span>
</p>
<p>avec <span class="math inline">\(l_x\)</span>, <span class="math inline">\(l_y\)</span> et <span class="math inline">\(S_e\)</span> étant les longueurs de axes <em>X</em> et <em>Y</em> et la superficie de l’ellipse.</p>
</div>
<p>Prenons quatre situations fictives de répartition de dix personnes utilisatrices du parc de la Laurentie à Sherbrooke :</p>
<ul>
<li><strong>Situation A</strong>. Les observations sont concentrées autour de l’aire de jeu.</li>
<li><strong>Situation B</strong>. Les observations sont dispersées dans la partie est du parc.</li>
<li><strong>Situation C</strong>. Les observations sont concentrées dans la partie nord du parc.</li>
<li><strong>Situation D</strong>. Les observations sont concentrées dans la partie nord du parc, excepté deux observations au sud.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:PointsABCD"></span>
<img src="images/Chap03/CartePointsABCD.png" alt="Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke (quatre situations)" width="100%" />
<p class="caption">
Figure 3.3: Données fictives sur des personnes utilisatrices du parc de la Laurentie à Sherbrooke (quatre situations)
</p>
</div>
<p>Les cercles et les ellipses de distance standard (<span class="math inline">\(ds\)</span>) centrés au centre moyen (<span class="math inline">\(cm\)</span>) sont représentés à la (figure <a href="sect032.html#fig:EllipsesCercleABCD">3.4</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:EllipsesCercleABCD"></span>
<img src="images/Chap03/CartePointsABCD_DS.png" alt="Ellipse et cercle de distance standard pour les quatre situations" width="100%" />
<p class="caption">
Figure 3.4: Ellipse et cercle de distance standard pour les quatre situations
</p>
</div>
</div>
<div id="sect03123" class="section level4 hasAnchor" number="3.2.2.3">
<h4><span class="header-section-number">3.2.2.3</span> Comparaison de la dispersion de deux semis de points dans deux régions différentes<a href="sect032.html#sect03123" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour comparer la dispersion de deux semis de points situés dans des régions de taille différente, il convient de supprimer les effets de taille des deux régions. Pour ce faire, nous divisons la <strong>distance standard</strong> ou la <strong>distance standard pondérée</strong> par la superficie de la région. Cette approche est donc très similaire au <a href="https://laeq.github.io/LivreMethoQuantBolR/sect025.html#sect0253">coefficient de variation</a> en statistique univariée, soit le rapport entre l’écart-type et la moyenne.</p>
<p>Par exemple, si nous comparons les dispersions des personnes utilisatrices du parc de la Laurentie (0,078 ha) et parc du Mont-Bellevue (409 ha). Inévitablement, la valeur de la distance standard est plus forte pour le parc du Mont-Bellevue que celle du parc de la Laurentie. Il faut donc diviser chaque distance standard par la superficie associée.</p>
</div>
<div id="sect03124" class="section level4 hasAnchor" number="3.2.2.4">
<h4><span class="header-section-number">3.2.2.4</span> Comparaison de la dispersion de deux semis de points dans la même région<a href="sect032.html#sect03124" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour comparer la distribution spatiale de deux semis de points situés dans la même région, nous comparons leur cercle ou leur ellipse respective (par exemple, des points représentant des accidents l’été versus l’hiver ou encore deux espèces végétales sur le même territoire).</p>
<p>Une démarche similaire peut être appliquée à deux groupes de population rattachés à des entités polygonales : ils ont la même distribution spatiale si les deux ellipses de distance pondérée se juxtaposent significativement. David W.S. Wong <span class="citation">(<a href="#ref-wong1999geostatistics" role="doc-biblioref">1999</a>)</span> propose d’ailleurs un indice dénommé <em>S</em> basé sur la comparaison des deux ellipses (équation <a href="sect032.html#eq:WongIndice2Groupes">(3.18)</a>). Le numérateur représente la surface d’intersection entre les deux ellipses tandis que le dénominateur représente leur surface d’union. L’indice varie de 0 à 1, soit respectivement d’une similitude parfaite à une dissemblance la plus grande entre les deux distributions spatiales :</p>
<ul>
<li>Si deux groupes de population ont des distributions spatiales identiques, les ellipses sont les mêmes et donc <span class="math inline">\(E_i \cap E_j = E_i \cup E_j = 1\)</span> et <span class="math inline">\(S_{ij} = 1 - 1 = 0\)</span>.</li>
<li>Si les deux groupes de population ont des distributions spatiales totalement différentes, les ellipses ne se touchent pas, alors <span class="math inline">\(E_i \cap E_j = 0\)</span> et la valeur de <span class="math inline">\(S = 1 - 0 = 1\)</span>.</li>
</ul>
<p>Bien évidemment, cet indice peut être étendu pour comparer les distributions de plus de deux groupes de population simultanément (équation <a href="sect032.html#eq:WongIndiceNGroupes">(3.19)</a>).</p>
<p><span class="math display" id="eq:WongIndice2Groupes">\[\begin{equation}  
S_{ij}=1-\frac{E_i \cap E_j}{E_i \cup E_j}
\tag{3.18}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:WongIndiceNGroupes">\[\begin{equation}  
S=1-\frac{E_1 \cap E_2 \cap E_3 \cap \text{…} \cap E_n}{E_1 \cup E_2 \cup E_3 \cup \text{…} \cup E_n}
\tag{3.19}
\end{equation}\]</span>
</p>
<p><strong>Voyons un exemple concret</strong> : calculons l’indice de Wong <span class="citation">(<a href="#ref-wong1999geostatistics" role="doc-biblioref">1999</a>)</span> (équation <a href="sect032.html#eq:WongIndice2Groupes">(3.18)</a>) pour les ellipses de distances standards pondérées par les effectifs de propriétaires et de locataires par secteur de recensement pour la ville de Sherbrooke en 2021 (figure <a href="sect032.html#fig:CarteProprioLoctaires">3.5</a>). D’emblée, nous constatons que les propriétaires ont une distribution plus dispersée que celle des locataires beaucoup plus présents dans le centre de la ville.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CarteProprioLoctaires"></span>
<img src="GMQ405_files/figure-html/CarteProprioLoctaires-1.png" alt="Propriétaires et locataires dans la ville de Sherbrooke (avec ellipse de distance standard), 2021" width="85%" />
<p class="caption">
Figure 3.5: Propriétaires et locataires dans la ville de Sherbrooke (avec ellipse de distance standard), 2021
</p>
</div>
<p>Quelques lignes de code suffisent pour obtenir l’indice de Wong <span class="citation">(<a href="#ref-wong1999geostatistics" role="doc-biblioref">1999</a>)</span>.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="sect032.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Importation des deux ellipses </span></span>
<span id="cb264-2"><a href="sect032.html#cb264-2" aria-hidden="true" tabindex="-1"></a>E1 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/EllipseProprio.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>) </span>
<span id="cb264-3"><a href="sect032.html#cb264-3" aria-hidden="true" tabindex="-1"></a>E2 <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/EllipseLocataire.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>) </span>
<span id="cb264-4"><a href="sect032.html#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Intersection </span></span>
<span id="cb264-5"><a href="sect032.html#cb264-5" aria-hidden="true" tabindex="-1"></a>Inter <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(E1, E2)</span>
<span id="cb264-6"><a href="sect032.html#cb264-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Union</span></span>
<span id="cb264-7"><a href="sect032.html#cb264-7" aria-hidden="true" tabindex="-1"></a>Union <span class="ot">&lt;-</span> <span class="fu">st_union</span>(E1, E2)</span>
<span id="cb264-8"><a href="sect032.html#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul de l&#39;indice de Wong</span></span>
<span id="cb264-9"><a href="sect032.html#cb264-9" aria-hidden="true" tabindex="-1"></a>Wong <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> ( <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(Inter)) <span class="sc">/</span> <span class="fu">as.numeric</span>(<span class="fu">st_area</span>(Union)))</span>
<span id="cb264-10"><a href="sect032.html#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Valeur de l&#39;indice de Wong : &quot;</span>,<span class="fu">round</span>(Wong,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Valeur de l&#39;indice de Wong : 0.515&quot;</code></pre>
</div>
</div>
<div id="sect0313" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Mise en œuvre de l’analyse centrographique dans R<a href="sect032.html#sect0313" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect03131" class="section level4 hasAnchor" number="3.2.3.1">
<h4><span class="header-section-number">3.2.3.1</span> Calcul de mesures non pondérées<a href="sect032.html#sect03131" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour illustrer la mise en œuvre des différentes mesures de l’analyse centrographique dans R, nous utilisons un jeu de données ouvertes sur les <a href="https://donneesouvertes-sherbrooke.opendata.arcgis.com/datasets/64d19d62f0804f5896e4b24c32aea49d_0/explore?location=45.403468%2C-71.960143%2C12.00">incidents de sécurité publique de la ville de Sherbrooke</a>. Dans la syntaxe ci-dessous, nous importons les données et constituons une couche <code>sf</code> par année (2019 à 2022) et extrayons les coordonnées géographiques.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="sect032.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb266-2"><a href="sect032.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb266-3"><a href="sect032.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Importation des données </span></span>
<span id="cb266-4"><a href="sect032.html#cb266-4" aria-hidden="true" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span>  <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/Arrondissements.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb266-5"><a href="sect032.html#cb266-5" aria-hidden="true" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/IncidentsSecuritePublique.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb266-6"><a href="sect032.html#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Changement de projection</span></span>
<span id="cb266-7"><a href="sect032.html#cb266-7" aria-hidden="true" tabindex="-1"></a>Arrondissements <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Arrondissements, <span class="at">crs =</span> <span class="dv">3798</span>) </span>
<span id="cb266-8"><a href="sect032.html#cb266-8" aria-hidden="true" tabindex="-1"></a>Incidents <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(Incidents, <span class="at">crs =</span> <span class="dv">3798</span>)</span>
<span id="cb266-9"><a href="sect032.html#cb266-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Extaction des méfaits</span></span>
<span id="cb266-10"><a href="sect032.html#cb266-10" aria-hidden="true" tabindex="-1"></a>Mefaits <span class="ot">&lt;-</span> <span class="fu">subset</span>(Incidents, DESCRIPTIO <span class="sc">==</span> <span class="st">&quot;Méfait&quot;</span>)</span>
<span id="cb266-11"><a href="sect032.html#cb266-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Méfaits par année</span></span>
<span id="cb266-12"><a href="sect032.html#cb266-12" aria-hidden="true" tabindex="-1"></a>M2019 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Mefaits, ANNEE<span class="sc">==</span><span class="dv">2019</span>)</span>
<span id="cb266-13"><a href="sect032.html#cb266-13" aria-hidden="true" tabindex="-1"></a>M2020 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Mefaits, ANNEE<span class="sc">==</span><span class="dv">2020</span>)</span>
<span id="cb266-14"><a href="sect032.html#cb266-14" aria-hidden="true" tabindex="-1"></a>M2021 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Mefaits, ANNEE<span class="sc">==</span><span class="dv">2021</span>)</span>
<span id="cb266-15"><a href="sect032.html#cb266-15" aria-hidden="true" tabindex="-1"></a>M2022 <span class="ot">&lt;-</span> <span class="fu">subset</span>(Mefaits, ANNEE<span class="sc">==</span><span class="dv">2022</span>)</span>
<span id="cb266-16"><a href="sect032.html#cb266-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordonnées géographiques</span></span>
<span id="cb266-17"><a href="sect032.html#cb266-17" aria-hidden="true" tabindex="-1"></a>xy<span class="fl">.2019</span> <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(M2019)</span>
<span id="cb266-18"><a href="sect032.html#cb266-18" aria-hidden="true" tabindex="-1"></a>xy<span class="fl">.2020</span> <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(M2020)</span>
<span id="cb266-19"><a href="sect032.html#cb266-19" aria-hidden="true" tabindex="-1"></a>xy<span class="fl">.2021</span> <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(M2021)</span>
<span id="cb266-20"><a href="sect032.html#cb266-20" aria-hidden="true" tabindex="-1"></a>xy<span class="fl">.2022</span> <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(M2022)</span></code></pre></div>
<p>Les méfaits par année sont présentés à la figure <a href="sect032.html#fig:CarteMefaits">3.6</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CarteMefaits"></span>
<img src="GMQ405_files/figure-html/CarteMefaits-1.png" alt="Localisation des méfaits par année, ville de Sherbrooke, 2021" width="85%" />
<p class="caption">
Figure 3.6: Localisation des méfaits par année, ville de Sherbrooke, 2021
</p>
</div>
<p><strong>Centre moyen</strong></p>
<p>Avec la fonction <code>mean</code>, nous pouvons calculer les valeurs moyennes sur les coordonnées <em>X</em> et <em>Y</em>, puis créer un objet <code>sf</code> avec les centres moyens.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="sect032.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Récupération de la projection cartographique dans une variable</span></span>
<span id="cb267-2"><a href="sect032.html#cb267-2" aria-hidden="true" tabindex="-1"></a>ProjCarto <span class="ot">=</span> <span class="fu">st_crs</span>(Mefaits)</span>
<span id="cb267-3"><a href="sect032.html#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul du centre moyen pour une année (2019)</span></span>
<span id="cb267-4"><a href="sect032.html#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]), <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>])))</span></code></pre></div>
<pre><code>## [1] 649990.3 157059.3</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="sect032.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul pour toutes les années</span></span>
<span id="cb269-2"><a href="sect032.html#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vecteur pour les moyennes des X</span></span>
<span id="cb269-3"><a href="sect032.html#cb269-3" aria-hidden="true" tabindex="-1"></a>X.moy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]), <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">1</span>]), <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">1</span>]), <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">1</span>]))</span>
<span id="cb269-4"><a href="sect032.html#cb269-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Vecteur pour les moyennes des Y</span></span>
<span id="cb269-5"><a href="sect032.html#cb269-5" aria-hidden="true" tabindex="-1"></a>Y.moy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]), <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">2</span>]), <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">2</span>]), <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">2</span>]))</span>
<span id="cb269-6"><a href="sect032.html#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Enregistrement dans un objet sf</span></span>
<span id="cb269-7"><a href="sect032.html#cb269-7" aria-hidden="true" tabindex="-1"></a>CentreMoyen <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Annee =</span> <span class="fu">c</span>(<span class="st">&quot;2019&quot;</span>, <span class="st">&quot;2020&quot;</span>, <span class="st">&quot;2021&quot;</span>, <span class="st">&quot;2022&quot;</span>),</span>
<span id="cb269-8"><a href="sect032.html#cb269-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">X =</span> X.moy, </span>
<span id="cb269-9"><a href="sect032.html#cb269-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Y =</span> Y.moy,</span>
<span id="cb269-10"><a href="sect032.html#cb269-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">CMx =</span> X.moy,  </span>
<span id="cb269-11"><a href="sect032.html#cb269-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">CMy =</span> Y.moy)</span>
<span id="cb269-12"><a href="sect032.html#cb269-12" aria-hidden="true" tabindex="-1"></a>CentreMoyen <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(CentreMoyen, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>), <span class="at">crs =</span> ProjCarto)</span>
<span id="cb269-13"><a href="sect032.html#cb269-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb269-14"><a href="sect032.html#cb269-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CentreMoyen)</span></code></pre></div>
<pre><code>## Simple feature collection with 4 features and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 649696 ymin: 157059.3 xmax: 650663.7 ymax: 157544.8
## Projected CRS: NAD83 / MTQ Lambert
##   Annee      CMx      CMy                  geometry
## 1  2019 649990.3 157059.3 POINT (649990.3 157059.3)
## 2  2020 649696.0 157544.8   POINT (649696 157544.8)
## 3  2021 650663.7 157214.8 POINT (650663.7 157214.8)
## 4  2022 650442.5 157237.0   POINT (650442.5 157237)</code></pre>
<p><strong>Point central</strong></p>
<p>La syntaxe ci-dessous illustre comment identifier le point central, qui fait partie du jeu de données, pour l’année 2019.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="sect032.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul de la matrice de distances entre les points de l&#39;année 2019</span></span>
<span id="cb271-2"><a href="sect032.html#cb271-2" aria-hidden="true" tabindex="-1"></a>DistMatrice2019 <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(xy<span class="fl">.2019</span>, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>, <span class="at">diag =</span> <span class="cn">TRUE</span>, <span class="at">upper =</span> <span class="cn">TRUE</span>))</span>
<span id="cb271-3"><a href="sect032.html#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Somme de chaque ligne de la matrice, soit la somme des distances à tous les autres points</span></span>
<span id="cb271-4"><a href="sect032.html#cb271-4" aria-hidden="true" tabindex="-1"></a>M2019<span class="sc">$</span>DistATous <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(DistMatrice2019)</span>
<span id="cb271-5"><a href="sect032.html#cb271-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Sélection du point avec plus petite distance à tous les autres</span></span>
<span id="cb271-6"><a href="sect032.html#cb271-6" aria-hidden="true" tabindex="-1"></a>PointCentral2019 <span class="ot">&lt;-</span> <span class="fu">subset</span>(M2019, M2019<span class="sc">$</span>DistATous<span class="sc">==</span><span class="fu">min</span>(M2019<span class="sc">$</span>DistATous))</span></code></pre></div>
<p><strong>Distance standard sur les coordonnées <em>X</em> et <em>Y</em> et distance standard combinée</strong></p>
<p>La syntaxe permet de calculer les trois distances standards.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="sect032.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul de la distance standard pour une année (2019)</span></span>
<span id="cb272-2"><a href="sect032.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance standard sur les coordonnées X et Y</span></span>
<span id="cb272-3"><a href="sect032.html#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb272-4"><a href="sect032.html#cb272-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 3732.173 2593.207</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="sect032.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Distance standard</span></span>
<span id="cb274-2"><a href="sect032.html#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb274-3"><a href="sect032.html#cb274-3" aria-hidden="true" tabindex="-1"></a>            (xy<span class="fl">.2019</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 4544.649</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="sect032.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul pour toutes les années et enregistrement des centres moyens dans de nouveaux champs</span></span>
<span id="cb276-2"><a href="sect032.html#cb276-2" aria-hidden="true" tabindex="-1"></a>CentreMoyen<span class="sc">$</span>DS.X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb276-3"><a href="sect032.html#cb276-3" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2020</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb276-4"><a href="sect032.html#cb276-4" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2021</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb276-5"><a href="sect032.html#cb276-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2022</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">1</span>]))<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb276-6"><a href="sect032.html#cb276-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-7"><a href="sect032.html#cb276-7" aria-hidden="true" tabindex="-1"></a>CentreMoyen<span class="sc">$</span>DS.Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb276-8"><a href="sect032.html#cb276-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2020</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb276-9"><a href="sect032.html#cb276-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2021</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb276-10"><a href="sect032.html#cb276-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2022</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">2</span>]))<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb276-11"><a href="sect032.html#cb276-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-12"><a href="sect032.html#cb276-12" aria-hidden="true" tabindex="-1"></a>CentreMoyen<span class="sc">$</span>DS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2019</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb276-13"><a href="sect032.html#cb276-13" aria-hidden="true" tabindex="-1"></a>                              (xy<span class="fl">.2019</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2019</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>)),</span>
<span id="cb276-14"><a href="sect032.html#cb276-14" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2020</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb276-15"><a href="sect032.html#cb276-15" aria-hidden="true" tabindex="-1"></a>                              (xy<span class="fl">.2020</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2020</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>)),<span class="sc">+</span></span>
<span id="cb276-16"><a href="sect032.html#cb276-16" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2021</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb276-17"><a href="sect032.html#cb276-17" aria-hidden="true" tabindex="-1"></a>                              (xy<span class="fl">.2021</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2021</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>)),<span class="sc">+</span></span>
<span id="cb276-18"><a href="sect032.html#cb276-18" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">sqrt</span>(<span class="fu">mean</span>((xy<span class="fl">.2022</span>[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">1</span>]))<span class="sc">**</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb276-19"><a href="sect032.html#cb276-19" aria-hidden="true" tabindex="-1"></a>                              (xy<span class="fl">.2022</span>[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fu">mean</span>(xy<span class="fl">.2022</span>[,<span class="dv">2</span>]))<span class="sc">**</span><span class="dv">2</span>)))</span>
<span id="cb276-20"><a href="sect032.html#cb276-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Visualisation des résultats</span></span>
<span id="cb276-21"><a href="sect032.html#cb276-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(CentreMoyen)</span></code></pre></div>
<pre><code>## Simple feature collection with 4 features and 6 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: 649696 ymin: 157059.3 xmax: 650663.7 ymax: 157544.8
## Projected CRS: NAD83 / MTQ Lambert
##   Annee      CMx      CMy                  geometry     DS.X     DS.Y       DS
## 1  2019 649990.3 157059.3 POINT (649990.3 157059.3) 3732.173 2593.207 4544.649
## 2  2020 649696.0 157544.8   POINT (649696 157544.8) 4134.913 2393.048 4777.466
## 3  2021 650663.7 157214.8 POINT (650663.7 157214.8) 3374.821 2294.171 4080.764
## 4  2022 650442.5 157237.0   POINT (650442.5 157237) 3601.208 2170.215 4204.585</code></pre>
<p><strong>Représentations graphiques de la dispersion</strong></p>
<p>Une fois que la couche <code>sf</code> des centres moyens avec les trois champs pour la distance standard est créée, il suffit de tracer un rectangle et un cercle de distance standard.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="sect032.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Enveloppe convexe</span></span>
<span id="cb278-2"><a href="sect032.html#cb278-2" aria-hidden="true" tabindex="-1"></a>sf.Enveloppes <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="fu">data.frame</span>(<span class="at">Id=</span><span class="fu">c</span>(<span class="st">&quot;2019&quot;</span>, <span class="st">&quot;2020&quot;</span>, <span class="st">&quot;2021&quot;</span>, <span class="st">&quot;2022&quot;</span>)),</span>
<span id="cb278-3"><a href="sect032.html#cb278-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">geometry =</span> <span class="fu">c</span>(<span class="fu">st_convex_hull</span>(<span class="fu">st_union</span>(M2019)),</span>
<span id="cb278-4"><a href="sect032.html#cb278-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">st_convex_hull</span>(<span class="fu">st_union</span>(M2020)),</span>
<span id="cb278-5"><a href="sect032.html#cb278-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">st_convex_hull</span>(<span class="fu">st_union</span>(M2021)),</span>
<span id="cb278-6"><a href="sect032.html#cb278-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">st_convex_hull</span>(<span class="fu">st_union</span>(M2022))))</span>
<span id="cb278-7"><a href="sect032.html#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Rectangle avec les distances standards sur les coordonnées X et Y</span></span>
<span id="cb278-8"><a href="sect032.html#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Fonction pour tracer le rectangle</span></span>
<span id="cb278-9"><a href="sect032.html#cb278-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param MoyX coordonnées X du centre moyen.</span></span>
<span id="cb278-10"><a href="sect032.html#cb278-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param MoyY coordonnées Y du centre moyen.</span></span>
<span id="cb278-11"><a href="sect032.html#cb278-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param SDx distance standard sur les coordonnées X.</span></span>
<span id="cb278-12"><a href="sect032.html#cb278-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param SDy distance standard sur les coordonnées Y.</span></span>
<span id="cb278-13"><a href="sect032.html#cb278-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param crs projection cartographique.</span></span>
<span id="cb278-14"><a href="sect032.html#cb278-14" aria-hidden="true" tabindex="-1"></a>CreationRec <span class="ot">&lt;-</span> <span class="cf">function</span>(MoyX, MoyY, SDx, SDy, ProjCarto){</span>
<span id="cb278-15"><a href="sect032.html#cb278-15" aria-hidden="true" tabindex="-1"></a>  pt1 <span class="ot">=</span> <span class="fu">c</span>(MoyX <span class="sc">-</span> SDx, MoyY <span class="sc">-</span> SDy)</span>
<span id="cb278-16"><a href="sect032.html#cb278-16" aria-hidden="true" tabindex="-1"></a>  pt2 <span class="ot">=</span> <span class="fu">c</span>(MoyX <span class="sc">-</span> SDx, MoyY <span class="sc">+</span> SDy)</span>
<span id="cb278-17"><a href="sect032.html#cb278-17" aria-hidden="true" tabindex="-1"></a>  pt3 <span class="ot">=</span> <span class="fu">c</span>(MoyX <span class="sc">+</span> SDx, MoyY <span class="sc">+</span> SDy)</span>
<span id="cb278-18"><a href="sect032.html#cb278-18" aria-hidden="true" tabindex="-1"></a>  pt4 <span class="ot">=</span> <span class="fu">c</span>(MoyX <span class="sc">+</span> SDx, MoyY <span class="sc">-</span> SDy)</span>
<span id="cb278-19"><a href="sect032.html#cb278-19" aria-hidden="true" tabindex="-1"></a>  Rectangle <span class="ot">=</span> <span class="fu">st_polygon</span>(<span class="fu">list</span>(<span class="fu">rbind</span>(pt1, pt2, pt3, pt4, pt1)))</span>
<span id="cb278-20"><a href="sect032.html#cb278-20" aria-hidden="true" tabindex="-1"></a>  Rectangle <span class="ot">=</span> <span class="fu">st_sfc</span>(Rectangle)</span>
<span id="cb278-21"><a href="sect032.html#cb278-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_crs</span>(Rectangle) <span class="ot">=</span> ProjCarto</span>
<span id="cb278-22"><a href="sect032.html#cb278-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Rectangle)</span>
<span id="cb278-23"><a href="sect032.html#cb278-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb278-24"><a href="sect032.html#cb278-24" aria-hidden="true" tabindex="-1"></a>MoyX <span class="ot">&lt;-</span> CentreMoyen<span class="sc">$</span>CMx</span>
<span id="cb278-25"><a href="sect032.html#cb278-25" aria-hidden="true" tabindex="-1"></a>MoyY <span class="ot">&lt;-</span> CentreMoyen<span class="sc">$</span>CMy</span>
<span id="cb278-26"><a href="sect032.html#cb278-26" aria-hidden="true" tabindex="-1"></a>SDx <span class="ot">&lt;-</span> CentreMoyen<span class="sc">$</span>DS.X</span>
<span id="cb278-27"><a href="sect032.html#cb278-27" aria-hidden="true" tabindex="-1"></a>SDy <span class="ot">&lt;-</span> CentreMoyen<span class="sc">$</span>DS.Y</span>
<span id="cb278-28"><a href="sect032.html#cb278-28" aria-hidden="true" tabindex="-1"></a>sf.Rectangles <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="fu">data.frame</span>(<span class="at">Id=</span><span class="fu">c</span>(<span class="st">&quot;2019&quot;</span>, <span class="st">&quot;2020&quot;</span>, <span class="st">&quot;2021&quot;</span>, <span class="st">&quot;2022&quot;</span>)),</span>
<span id="cb278-29"><a href="sect032.html#cb278-29" aria-hidden="true" tabindex="-1"></a>                    <span class="at">geometry =</span> <span class="fu">c</span>(<span class="fu">CreationRec</span>(MoyX[<span class="dv">1</span>], MoyY[<span class="dv">1</span>], SDx[<span class="dv">1</span>], SDy[<span class="dv">1</span>], ProjCarto),</span>
<span id="cb278-30"><a href="sect032.html#cb278-30" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">CreationRec</span>(MoyX[<span class="dv">2</span>], MoyY[<span class="dv">2</span>], SDx[<span class="dv">2</span>], SDy[<span class="dv">2</span>], ProjCarto),</span>
<span id="cb278-31"><a href="sect032.html#cb278-31" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">CreationRec</span>(MoyX[<span class="dv">3</span>], MoyY[<span class="dv">3</span>], SDx[<span class="dv">3</span>], SDy[<span class="dv">3</span>], ProjCarto),</span>
<span id="cb278-32"><a href="sect032.html#cb278-32" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">CreationRec</span>(MoyX[<span class="dv">4</span>], MoyY[<span class="dv">4</span>], SDx[<span class="dv">4</span>], SDy[<span class="dv">4</span>], ProjCarto)))</span>
<span id="cb278-33"><a href="sect032.html#cb278-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Cercle de distance standard avec la fonction st_buffer</span></span>
<span id="cb278-34"><a href="sect032.html#cb278-34" aria-hidden="true" tabindex="-1"></a>sf.CercleDS <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(CentreMoyen, <span class="at">dist =</span> CentreMoyen<span class="sc">$</span>DS)</span></code></pre></div>
<p>Le calcul de l’ellipse est un peu plus complexe. Par conséquent, nous avons créer une fonction <code>CreateEllipse</code> qui renvoie un objets <code>sf</code>.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="sect032.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Calcul de l&#39;ellipse</span></span>
<span id="cb279-2"><a href="sect032.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param id identifiant de l&#39;ellipse.</span></span>
<span id="cb279-3"><a href="sect032.html#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param x coordonnées X.</span></span>
<span id="cb279-4"><a href="sect032.html#cb279-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y coordonnées Y.</span></span>
<span id="cb279-5"><a href="sect032.html#cb279-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param crs projection cartographique.</span></span>
<span id="cb279-6"><a href="sect032.html#cb279-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39;</span></span>
<span id="cb279-7"><a href="sect032.html#cb279-7" aria-hidden="true" tabindex="-1"></a>CreateEllipse <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">id=</span><span class="dv">1</span>, x, y, crs){</span>
<span id="cb279-8"><a href="sect032.html#cb279-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coordonnées du centre moyen </span></span>
<span id="cb279-9"><a href="sect032.html#cb279-9" aria-hidden="true" tabindex="-1"></a>  mean.x <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb279-10"><a href="sect032.html#cb279-10" aria-hidden="true" tabindex="-1"></a>  mean.y <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb279-11"><a href="sect032.html#cb279-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># coordonnées centrées</span></span>
<span id="cb279-12"><a href="sect032.html#cb279-12" aria-hidden="true" tabindex="-1"></a>  zx <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb279-13"><a href="sect032.html#cb279-13" aria-hidden="true" tabindex="-1"></a>  zy <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb279-14"><a href="sect032.html#cb279-14" aria-hidden="true" tabindex="-1"></a>  sumzx2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(zx<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb279-15"><a href="sect032.html#cb279-15" aria-hidden="true" tabindex="-1"></a>  sumzy2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(zy<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb279-16"><a href="sect032.html#cb279-16" aria-hidden="true" tabindex="-1"></a>  sumzxy <span class="ot">&lt;-</span> <span class="fu">sum</span>(zx <span class="sc">*</span> zy)</span>
<span id="cb279-17"><a href="sect032.html#cb279-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcul de l&#39;angle de rotation</span></span>
<span id="cb279-18"><a href="sect032.html#cb279-18" aria-hidden="true" tabindex="-1"></a>  numerateur   <span class="ot">&lt;-</span> (sumzx2<span class="sc">-</span>sumzy2)<span class="sc">+</span> <span class="fu">sqrt</span>((sumzx2<span class="sc">-</span>sumzy2)<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span>(sumzxy)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb279-19"><a href="sect032.html#cb279-19" aria-hidden="true" tabindex="-1"></a>  demoninateur <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>sumzxy</span>
<span id="cb279-20"><a href="sect032.html#cb279-20" aria-hidden="true" tabindex="-1"></a>  tantheta <span class="ot">&lt;-</span> numerateur <span class="sc">/</span> demoninateur</span>
<span id="cb279-21"><a href="sect032.html#cb279-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Theta</span></span>
<span id="cb279-22"><a href="sect032.html#cb279-22" aria-hidden="true" tabindex="-1"></a>  theta <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tantheta <span class="sc">&lt;</span> <span class="dv">0</span>,</span>
<span id="cb279-23"><a href="sect032.html#cb279-23" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">180</span> <span class="sc">+</span> <span class="fu">atan</span>(tantheta)<span class="sc">*</span> <span class="dv">180</span><span class="sc">/</span>pi,</span>
<span id="cb279-24"><a href="sect032.html#cb279-24" aria-hidden="true" tabindex="-1"></a>                  Theta <span class="ot">&lt;-</span> <span class="fu">atan</span>(tantheta)<span class="sc">*</span> <span class="dv">180</span><span class="sc">/</span>pi)</span>
<span id="cb279-25"><a href="sect032.html#cb279-25" aria-hidden="true" tabindex="-1"></a>  sintheta <span class="ot">&lt;-</span> <span class="fu">sin</span>(theta <span class="sc">*</span> pi<span class="sc">/</span><span class="dv">180</span>)</span>
<span id="cb279-26"><a href="sect032.html#cb279-26" aria-hidden="true" tabindex="-1"></a>  costheta <span class="ot">&lt;-</span> <span class="fu">cos</span>(theta <span class="sc">*</span> pi<span class="sc">/</span><span class="dv">180</span>)</span>
<span id="cb279-27"><a href="sect032.html#cb279-27" aria-hidden="true" tabindex="-1"></a>  sin2theta <span class="ot">&lt;-</span> sintheta<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb279-28"><a href="sect032.html#cb279-28" aria-hidden="true" tabindex="-1"></a>  cos2theta <span class="ot">&lt;-</span> costheta<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb279-29"><a href="sect032.html#cb279-29" aria-hidden="true" tabindex="-1"></a>  sinthetacostheta <span class="ot">&lt;-</span> sintheta <span class="sc">*</span> costheta</span>
<span id="cb279-30"><a href="sect032.html#cb279-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcul de Sigma.x et Sigma.y</span></span>
<span id="cb279-31"><a href="sect032.html#cb279-31" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(zx)</span>
<span id="cb279-32"><a href="sect032.html#cb279-32" aria-hidden="true" tabindex="-1"></a>  sigmax <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(((sumzx2) <span class="sc">*</span> (cos2theta) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> (sumzxy) <span class="sc">*</span> </span>
<span id="cb279-33"><a href="sect032.html#cb279-33" aria-hidden="true" tabindex="-1"></a>            (sinthetacostheta) <span class="sc">+</span> (sumzy2) <span class="sc">*</span> (sin2theta))<span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb279-34"><a href="sect032.html#cb279-34" aria-hidden="true" tabindex="-1"></a>  sigmay <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(((sumzx2) <span class="sc">*</span> (sin2theta) <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> (sumzxy) <span class="sc">*</span> </span>
<span id="cb279-35"><a href="sect032.html#cb279-35" aria-hidden="true" tabindex="-1"></a>            (sinthetacostheta) <span class="sc">+</span> (sumzy2) <span class="sc">*</span> (cos2theta))<span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb279-36"><a href="sect032.html#cb279-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Theta corrigé</span></span>
<span id="cb279-37"><a href="sect032.html#cb279-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (sigmax <span class="sc">&gt;</span> sigmay) {</span>
<span id="cb279-38"><a href="sect032.html#cb279-38" aria-hidden="true" tabindex="-1"></a>    Theta.Corr <span class="ot">&lt;-</span> theta <span class="sc">+</span> <span class="dv">90</span></span>
<span id="cb279-39"><a href="sect032.html#cb279-39" aria-hidden="true" tabindex="-1"></a>    Major <span class="ot">&lt;-</span> <span class="st">&quot;SigmaX&quot;</span></span>
<span id="cb279-40"><a href="sect032.html#cb279-40" aria-hidden="true" tabindex="-1"></a>    Minor <span class="ot">&lt;-</span> <span class="st">&quot;SigmaY&quot;</span></span>
<span id="cb279-41"><a href="sect032.html#cb279-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb279-42"><a href="sect032.html#cb279-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb279-43"><a href="sect032.html#cb279-43" aria-hidden="true" tabindex="-1"></a>    Theta.Corr <span class="ot">&lt;-</span> theta</span>
<span id="cb279-44"><a href="sect032.html#cb279-44" aria-hidden="true" tabindex="-1"></a>    Major <span class="ot">&lt;-</span> <span class="st">&quot;SigmaY&quot;</span></span>
<span id="cb279-45"><a href="sect032.html#cb279-45" aria-hidden="true" tabindex="-1"></a>    Minor <span class="ot">&lt;-</span> <span class="st">&quot;SigmaX&quot;</span></span>
<span id="cb279-46"><a href="sect032.html#cb279-46" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb279-47"><a href="sect032.html#cb279-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Coordonnées</span></span>
<span id="cb279-48"><a href="sect032.html#cb279-48" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">min</span>(sigmax, sigmay)</span>
<span id="cb279-49"><a href="sect032.html#cb279-49" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">max</span>(sigmax, sigmay)</span>
<span id="cb279-50"><a href="sect032.html#cb279-50" aria-hidden="true" tabindex="-1"></a>  d2 <span class="ot">&lt;-</span> (A <span class="sc">-</span> B) <span class="sc">*</span> (A <span class="sc">+</span> B)</span>
<span id="cb279-51"><a href="sect032.html#cb279-51" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">len =</span> <span class="dv">360</span>)</span>
<span id="cb279-52"><a href="sect032.html#cb279-52" aria-hidden="true" tabindex="-1"></a>  sp <span class="ot">&lt;-</span> <span class="fu">sin</span>(phi)</span>
<span id="cb279-53"><a href="sect032.html#cb279-53" aria-hidden="true" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> <span class="fu">cos</span>(phi)</span>
<span id="cb279-54"><a href="sect032.html#cb279-54" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> sigmax <span class="sc">*</span> sigmay<span class="sc">/</span><span class="fu">sqrt</span>(B<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> d2 <span class="sc">*</span> sp<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb279-55"><a href="sect032.html#cb279-55" aria-hidden="true" tabindex="-1"></a>  xy <span class="ot">&lt;-</span> r <span class="sc">*</span> <span class="fu">cbind</span>(cp, sp)</span>
<span id="cb279-56"><a href="sect032.html#cb279-56" aria-hidden="true" tabindex="-1"></a>  al <span class="ot">&lt;-</span> (<span class="dv">90</span> <span class="sc">-</span> theta) <span class="sc">*</span> pi<span class="sc">/</span><span class="dv">180</span></span>
<span id="cb279-57"><a href="sect032.html#cb279-57" aria-hidden="true" tabindex="-1"></a>  ca <span class="ot">&lt;-</span> <span class="fu">cos</span>(al)</span>
<span id="cb279-58"><a href="sect032.html#cb279-58" aria-hidden="true" tabindex="-1"></a>  sa <span class="ot">&lt;-</span> <span class="fu">sin</span>(al)</span>
<span id="cb279-59"><a href="sect032.html#cb279-59" aria-hidden="true" tabindex="-1"></a>  coordsSDE <span class="ot">&lt;-</span> xy <span class="sc">%*%</span> <span class="fu">rbind</span>(<span class="fu">c</span>(ca, sa), <span class="fu">c</span>(<span class="sc">-</span>sa, ca)) <span class="sc">+</span> </span>
<span id="cb279-60"><a href="sect032.html#cb279-60" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">cbind</span>(<span class="fu">rep</span>(mean.x, <span class="dv">360</span>), <span class="fu">rep</span>(mean.y, <span class="dv">360</span>))</span>
<span id="cb279-61"><a href="sect032.html#cb279-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Polygone</span></span>
<span id="cb279-62"><a href="sect032.html#cb279-62" aria-hidden="true" tabindex="-1"></a>  EllPoly <span class="ot">&lt;-</span> <span class="fu">st_polygon</span>(<span class="fu">list</span>(<span class="fu">as.matrix</span>(coordsSDE)))</span>
<span id="cb279-63"><a href="sect032.html#cb279-63" aria-hidden="true" tabindex="-1"></a>  ellipse <span class="ot">&lt;-</span> <span class="fu">st_sfc</span>(EllPoly, <span class="at">crs=</span>crs)</span>
<span id="cb279-64"><a href="sect032.html#cb279-64" aria-hidden="true" tabindex="-1"></a>  ellipse <span class="ot">&lt;-</span> <span class="fu">st_sf</span>(<span class="fu">data.frame</span>(<span class="at">Id=</span>id,</span>
<span id="cb279-65"><a href="sect032.html#cb279-65" aria-hidden="true" tabindex="-1"></a>                               <span class="at">CMx =</span> mean.x,</span>
<span id="cb279-66"><a href="sect032.html#cb279-66" aria-hidden="true" tabindex="-1"></a>                               <span class="at">CMy =</span> mean.y,</span>
<span id="cb279-67"><a href="sect032.html#cb279-67" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Sigmax =</span> sigmax,</span>
<span id="cb279-68"><a href="sect032.html#cb279-68" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Sigmay =</span> sigmay,</span>
<span id="cb279-69"><a href="sect032.html#cb279-69" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Lx =</span> <span class="dv">2</span><span class="sc">*</span>sigmax,</span>
<span id="cb279-70"><a href="sect032.html#cb279-70" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Ly =</span> <span class="dv">2</span><span class="sc">*</span>sigmay,</span>
<span id="cb279-71"><a href="sect032.html#cb279-71" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Aire =</span> pi<span class="sc">*</span>sigmax<span class="sc">*</span>sigmay,</span>
<span id="cb279-72"><a href="sect032.html#cb279-72" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Theta =</span> theta,</span>
<span id="cb279-73"><a href="sect032.html#cb279-73" aria-hidden="true" tabindex="-1"></a>                               <span class="at">ThetaCorr =</span>Theta.Corr,</span>
<span id="cb279-74"><a href="sect032.html#cb279-74" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Major =</span> Major,</span>
<span id="cb279-75"><a href="sect032.html#cb279-75" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Minor =</span> Minor),</span>
<span id="cb279-76"><a href="sect032.html#cb279-76" aria-hidden="true" tabindex="-1"></a>                     <span class="at">geometry =</span> ellipse)</span>
<span id="cb279-77"><a href="sect032.html#cb279-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ellipse)</span>
<span id="cb279-78"><a href="sect032.html#cb279-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb279-79"><a href="sect032.html#cb279-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-80"><a href="sect032.html#cb279-80" aria-hidden="true" tabindex="-1"></a>El2019 <span class="ot">&lt;-</span> <span class="fu">CreateEllipse</span>(<span class="at">id=</span><span class="st">&quot;2019&quot;</span>,  <span class="at">x =</span> xy<span class="fl">.2019</span>[,<span class="dv">1</span>], <span class="at">y =</span> xy<span class="fl">.2019</span>[,<span class="dv">2</span>], <span class="at">crs =</span> ProjCarto)</span>
<span id="cb279-81"><a href="sect032.html#cb279-81" aria-hidden="true" tabindex="-1"></a>El2020 <span class="ot">&lt;-</span> <span class="fu">CreateEllipse</span>(<span class="at">id=</span><span class="st">&quot;2020&quot;</span>,  <span class="at">x =</span> xy<span class="fl">.2020</span>[,<span class="dv">1</span>], <span class="at">y =</span> xy<span class="fl">.2020</span>[,<span class="dv">2</span>], <span class="at">crs =</span> ProjCarto)</span>
<span id="cb279-82"><a href="sect032.html#cb279-82" aria-hidden="true" tabindex="-1"></a>El2021 <span class="ot">&lt;-</span> <span class="fu">CreateEllipse</span>(<span class="at">id=</span><span class="st">&quot;2021&quot;</span>,  <span class="at">x =</span> xy<span class="fl">.2021</span>[,<span class="dv">1</span>], <span class="at">y =</span> xy<span class="fl">.2021</span>[,<span class="dv">2</span>], <span class="at">crs =</span> ProjCarto)</span>
<span id="cb279-83"><a href="sect032.html#cb279-83" aria-hidden="true" tabindex="-1"></a>El2022 <span class="ot">&lt;-</span> <span class="fu">CreateEllipse</span>(<span class="at">id=</span><span class="st">&quot;2022&quot;</span>,  <span class="at">x =</span> xy<span class="fl">.2022</span>[,<span class="dv">1</span>], <span class="at">y =</span> xy<span class="fl">.2022</span>[,<span class="dv">2</span>], <span class="at">crs =</span> ProjCarto)</span>
<span id="cb279-84"><a href="sect032.html#cb279-84" aria-hidden="true" tabindex="-1"></a>sf.Ellipse <span class="ot">&lt;-</span> <span class="fu">rbind</span>(El2019, El2020, El2021, El2022)</span>
<span id="cb279-85"><a href="sect032.html#cb279-85" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sf.Ellipse)</span></code></pre></div>
<pre><code>## Simple feature collection with 4 features and 12 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 643833.8 ymin: 153377.3 xmax: 655559 ymax: 160937.9
## Projected CRS: NAD83 / MTQ Lambert
##     Id      CMx      CMy   Sigmax   Sigmay       Lx        Ly     Aire    Theta
## 1 2019 649990.3 157059.3 3055.157 5683.790 6110.315 11367.580 54553357 64.60944
## 2 2020 649696.0 157544.8 3154.712 5994.647 6309.423 11989.294 59411858 75.81068
## 3 2021 650663.7 157214.8 3128.891 4869.299 6257.783  9738.598 47863757 76.14675
## 4 2022 650442.5 157237.0 2540.594 5406.184 5081.187 10812.368 43149511 68.52718
##   ThetaCorr  Major  Minor                       geometry
## 1  64.60944 SigmaY SigmaX POLYGON ((655125.1 159496.4...
## 2  75.81068 SigmaY SigmaX POLYGON ((655507.7 159014.3...
## 3  76.14675 SigmaY SigmaX POLYGON ((655391.4 158380.7...
## 4  68.52718 SigmaY SigmaX POLYGON ((655473.5 159216, ...</code></pre>
<p>Les quatre représentations de la dispersion sont présentées à la figure <a href="sect032.html#fig:RepresentationDispersion">3.7</a> : 1) enveloppe convexe (gris), 2) cercle de distance standard (bleu), 3) rectangle de distance standard sur les X et Y (noir) et 4) ellipse de distance standard (rouge).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:RepresentationDispersion"></span>
<img src="GMQ405_files/figure-html/RepresentationDispersion-1.png" alt="Représentations de la dispersion des méfaits pour les quatre années" width="85%" />
<p class="caption">
Figure 3.7: Représentations de la dispersion des méfaits pour les quatre années
</p>
</div>
</div>
<div id="sect03132" class="section level4 hasAnchor" number="3.2.3.2">
<h4><span class="header-section-number">3.2.3.2</span> Calcul de mesures pondérées<a href="sect032.html#sect03132" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour illustrer le calcul des mesures pondérées, nous utilisons des données sur les effectifs du premier et du dernier déciles de revenu après impôt des familles économiques pour les secteurs de recensement de la ville de Sherbrooke en 2021 (figure <a href="sect032.html#fig:CartesDecilesPremierDernier">3.8</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CartesDecilesPremierDernier"></span>
<img src="GMQ405_files/figure-html/CartesDecilesPremierDernier-1.png" alt="Déciles extrêmes de revenu après impôt des familles économiques" width="85%" />
<p class="caption">
Figure 3.8: Déciles extrêmes de revenu après impôt des familles économiques
</p>
</div>
<p>La syntaxe suivante permet d’importer et de structurer les données. puis de calculer les différentes mesures (centre moyen pondéré et distance standard pondérée).</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="sect032.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Importation et structuration des données</span></span>
<span id="cb281-2"><a href="sect032.html#cb281-2" aria-hidden="true" tabindex="-1"></a>dfdecile <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/chap03/DataDecilesSR.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb281-3"><a href="sect032.html#cb281-3" aria-hidden="true" tabindex="-1"></a>dfdecile<span class="sc">$</span>SRIDU <span class="ot">&lt;-</span> <span class="fu">substr</span>(dfdecile<span class="sc">$</span>SRIDU, <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb281-4"><a href="sect032.html#cb281-4" aria-hidden="true" tabindex="-1"></a>SR <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap03/Recen2021Sherbrooke.gpkg&quot;</span>,</span>
<span id="cb281-5"><a href="sect032.html#cb281-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">layer =</span> <span class="st">&quot;DR_SherbSRDonnees2021&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb281-6"><a href="sect032.html#cb281-6" aria-hidden="true" tabindex="-1"></a>SR <span class="ot">&lt;-</span> <span class="fu">merge</span>(SR[,<span class="fu">c</span>(<span class="st">&quot;SRIDU&quot;</span>)], dfdecile, <span class="at">by =</span> <span class="st">&quot;SRIDU&quot;</span>)</span>
<span id="cb281-7"><a href="sect032.html#cb281-7" aria-hidden="true" tabindex="-1"></a>ProjCarto <span class="ot">&lt;-</span> <span class="fu">st_crs</span>(SR)</span>
<span id="cb281-8"><a href="sect032.html#cb281-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Coordonnées géographiques des secteurs de recensement</span></span>
<span id="cb281-9"><a href="sect032.html#cb281-9" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_point_on_surface</span>(SR))</span>
<span id="cb281-10"><a href="sect032.html#cb281-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Pondérations pour les deux déciles</span></span>
<span id="cb281-11"><a href="sect032.html#cb281-11" aria-hidden="true" tabindex="-1"></a>wd1  <span class="ot">&lt;-</span> SR<span class="sc">$</span>D1</span>
<span id="cb281-12"><a href="sect032.html#cb281-12" aria-hidden="true" tabindex="-1"></a>wd10 <span class="ot">&lt;-</span> SR<span class="sc">$</span>D10</span>
<span id="cb281-13"><a href="sect032.html#cb281-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Sommes des pondérations</span></span>
<span id="cb281-14"><a href="sect032.html#cb281-14" aria-hidden="true" tabindex="-1"></a>swd1  <span class="ot">&lt;-</span> <span class="fu">sum</span>(wd1)</span>
<span id="cb281-15"><a href="sect032.html#cb281-15" aria-hidden="true" tabindex="-1"></a>swd10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(wd10)</span>
<span id="cb281-16"><a href="sect032.html#cb281-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul du centre pondéré</span></span>
<span id="cb281-17"><a href="sect032.html#cb281-17" aria-hidden="true" tabindex="-1"></a>XmoyD1  <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy[,<span class="dv">1</span>]<span class="sc">*</span>wd1) <span class="sc">/</span> swd1</span>
<span id="cb281-18"><a href="sect032.html#cb281-18" aria-hidden="true" tabindex="-1"></a>XmoyD10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy[,<span class="dv">1</span>]<span class="sc">*</span>wd10) <span class="sc">/</span> swd10</span>
<span id="cb281-19"><a href="sect032.html#cb281-19" aria-hidden="true" tabindex="-1"></a>YmoyD1  <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy[,<span class="dv">2</span>]<span class="sc">*</span>wd1) <span class="sc">/</span> swd1</span>
<span id="cb281-20"><a href="sect032.html#cb281-20" aria-hidden="true" tabindex="-1"></a>YmoyD10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(xy[,<span class="dv">2</span>]<span class="sc">*</span>wd10) <span class="sc">/</span> swd10</span>
<span id="cb281-21"><a href="sect032.html#cb281-21" aria-hidden="true" tabindex="-1"></a>CentreMoyenPond <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Decile =</span> <span class="fu">c</span>(<span class="st">&quot;Premier&quot;</span>, <span class="st">&quot;Dernier&quot;</span>),</span>
<span id="cb281-22"><a href="sect032.html#cb281-22" aria-hidden="true" tabindex="-1"></a>                          <span class="at">X =</span> <span class="fu">c</span>(XmoyD1, XmoyD10), </span>
<span id="cb281-23"><a href="sect032.html#cb281-23" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Y =</span> <span class="fu">c</span>(YmoyD1, YmoyD10),</span>
<span id="cb281-24"><a href="sect032.html#cb281-24" aria-hidden="true" tabindex="-1"></a>                          <span class="at">CMwx =</span> <span class="fu">c</span>(XmoyD1, XmoyD10),  </span>
<span id="cb281-25"><a href="sect032.html#cb281-25" aria-hidden="true" tabindex="-1"></a>                          <span class="at">CMwy =</span> <span class="fu">c</span>(YmoyD1, YmoyD10))</span>
<span id="cb281-26"><a href="sect032.html#cb281-26" aria-hidden="true" tabindex="-1"></a>CentreMoyenPond <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(CentreMoyenPond, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>), <span class="at">crs =</span> ProjCarto)</span>
<span id="cb281-27"><a href="sect032.html#cb281-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul de la distance standard pondérée</span></span>
<span id="cb281-28"><a href="sect032.html#cb281-28" aria-hidden="true" tabindex="-1"></a>sdD1  <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">sum</span>(wd1<span class="sc">*</span>(xy[,<span class="dv">1</span>]<span class="sc">-</span> XmoyD1)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> swd1) <span class="sc">+</span> (<span class="fu">sum</span>(wd1<span class="sc">*</span>(xy[,<span class="dv">2</span>]<span class="sc">-</span> YmoyD1)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> swd1))</span>
<span id="cb281-29"><a href="sect032.html#cb281-29" aria-hidden="true" tabindex="-1"></a>sdD10 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="fu">sum</span>(wd10<span class="sc">*</span>(xy[,<span class="dv">1</span>]<span class="sc">-</span> XmoyD10)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> swd1) <span class="sc">+</span> (<span class="fu">sum</span>(wd10<span class="sc">*</span>(xy[,<span class="dv">2</span>]<span class="sc">-</span> YmoyD10)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> swd10))</span>
<span id="cb281-30"><a href="sect032.html#cb281-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Zones tampons</span></span>
<span id="cb281-31"><a href="sect032.html#cb281-31" aria-hidden="true" tabindex="-1"></a>CentreMoyenPond<span class="sc">$</span>SDw <span class="ot">&lt;-</span> <span class="fu">c</span>(sdD1, sdD10)</span>
<span id="cb281-32"><a href="sect032.html#cb281-32" aria-hidden="true" tabindex="-1"></a>sf.CercleDSW <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(CentreMoyenPond, <span class="at">dist =</span> CentreMoyenPond<span class="sc">$</span>SDw)</span>
<span id="cb281-33"><a href="sect032.html#cb281-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Cartographie</span></span>
<span id="cb281-34"><a href="sect032.html#cb281-34" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb281-35"><a href="sect032.html#cb281-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Arrondissements)<span class="sc">+</span><span class="fu">tm_borders</span>(<span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span><span class="fu">tm_fill</span>(<span class="at">col=</span><span class="st">&quot;wheat&quot;</span>)<span class="sc">+</span></span>
<span id="cb281-36"><a href="sect032.html#cb281-36" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(CentreMoyenPond) <span class="sc">+</span> <span class="fu">tm_dots</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb281-37"><a href="sect032.html#cb281-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(sf.CercleDSW) <span class="sc">+</span></span>
<span id="cb281-38"><a href="sect032.html#cb281-38" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tm_polygons</span>(<span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;Decile&quot;</span>, <span class="at">border.col=</span><span class="st">&quot;black&quot;</span>, <span class="at">alpha=</span>.<span class="dv">3</span>, <span class="at">title=</span><span class="st">&quot;Décile&quot;</span>)<span class="sc">+</span>               </span>
<span id="cb281-39"><a href="sect032.html#cb281-39" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">frame=</span><span class="cn">FALSE</span>, <span class="at">title =</span> <span class="st">&quot;2019&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:MesuresPonderees"></span>
<img src="GMQ405_files/figure-html/MesuresPonderees-1.png" alt="Déciles extrêmes de revenu après impôt des familles économiques" width="85%" />
<p class="caption">
Figure 3.9: Déciles extrêmes de revenu après impôt des familles économiques
</p>
</div>
</div>
</div>
</div>
<h3>Références</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-RBoldAir" class="csl-entry">
Apparicio, Philippe et Jérémy Gelb. 2022. <em>Méthodes quantitatives en sciences sociales : un grand bol d’R</em>. FabriqueREL, Licence CC BY-SA. <a href="https://laeq.github.io/LivreMethoQuantBolR/">https://laeq.github.io/LivreMethoQuantBolR/</a>.
</div>
<div id="ref-barbonne2007dynamique" class="csl-entry">
Barbonne, Rémy, Paul Villeneuve et Marius Thériault. 2007. <span>« La dynamique spatiale des march<span>é</span>s locaux de l’emploi au sein du champ m<span>é</span>tropolitain de Qu<span>é</span>bec, 1981–2001. »</span> <em>The Canadian Geographer/Le G<span>é</span>ographe canadien</em> 51 (3). Wiley Online Library: 303‑322. <a href="https://doi.org/10.1111/j.1541-0064.2007.00180.x">https://doi.org/10.1111/j.1541-0064.2007.00180.x</a>.
</div>
<div id="ref-levine2006crime" class="csl-entry">
Levine, Ned. 2006. <span>« Crime mapping and the Crimestat program. »</span> <em>Geographical analysis</em> 38 (1): 41‑56. <a href="https://doi.org/10.1111/j.0016-7363.2005.00673.x">https://doi.org/10.1111/j.0016-7363.2005.00673.x</a>.
</div>
<div id="ref-levine2021crimestat" class="csl-entry">
———. 2021. <span>« CrimeStat IV. »</span> In <em>The Encyclopedia of Research Methods in Criminology and Criminal Justice</em>, sous la dir. de JC Barnes et David R Forde, 1:28‑32. John Wiley &amp; Sons. <a href="https://doi.org/10.1002/9781119111931.ch6">https://doi.org/10.1002/9781119111931.ch6</a>.
</div>
<div id="ref-lopez2015evolution" class="csl-entry">
López Castro, Marco Antonio, Marius Thériault et Marie-Hélène Vandersmissen. 2015. <span>« <span>É</span>volution de la mobilit<span>é</span> des membres de familles monoparentales dans la r<span>é</span>gion m<span>é</span>tropolitaine de Qu<span>é</span>bec de 1996 <span>à</span> 2006: comparaison entre les m<span>é</span>nages matricentriques et patricentriques. »</span> <em>Cahiers de g<span>é</span>ographie du Qu<span>é</span>bec</em> 59 (167): 209‑250. <a href="https://doi.org/10.7202/1036355ar">https://doi.org/10.7202/1036355ar</a>.
</div>
<div id="ref-tveitesde" class="csl-entry">
Tveite, Håvard. 2020. <span>« The <span>QGIS</span> <span>Standard</span> <span>Deviational</span> <span>Ellipse</span> Plugin. »</span> <a href="http://plugins.qgis.org/plugins/SDEllipse/" class="uri">http://plugins.qgis.org/plugins/SDEllipse/</a>.
</div>
<div id="ref-wang2015confidence" class="csl-entry">
Wang, Bin, Wenzhong Shi et Zelang Miao. 2015. <span>« Confidence analysis of standard deviational ellipse and its extension into higher dimensional Euclidean space. »</span> <em>PloS one</em> 10 (3): e0118537. <a href="https://doi.org/10.1371%2Fjournal.pone.0118537">https://doi.org/10.1371%2Fjournal.pone.0118537</a>.
</div>
<div id="ref-wong1999geostatistics" class="csl-entry">
Wong, David WS. 1999. <span>« Geostatistics as measures of spatial segregation. »</span> <em>Urban geography</em> 20 (7): 635‑647. <a href="https://doi.org/10.2747/0272-3638.20.7.635">https://doi.org/10.2747/0272-3638.20.7.635</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect031.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect033.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["GMQ405.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
