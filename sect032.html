<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.2 Principaux graphiques | Méthodes quantitatives en sciences sociales : un grand bol d’R</title>
  <meta name="description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3.2 Principaux graphiques | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://laeq.github.io/LivreStatistique_website/" />
  <meta property="og:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="github-repo" content="LAEQ/livre_statistique_Phil_Jere" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.2 Principaux graphiques | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  
  <meta name="twitter:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="twitter:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio et Jérémy Gelb" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect031.html"/>
<link rel="next" href="sect033.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d'R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Un manuel conçu comme un projet collaboratif</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment lire ce livre?</a></li>
<li class="chapter" data-level="" data-path="sect003B.html"><a href="sect003B.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en sciences sociales?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="sect007.html"><a href="sect007.html"><i class="fa fa-check"></i>Dédicace toute spéciale à Cargo et Ambrée</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auteurs.html"><a href="auteurs.html"><i class="fa fa-check"></i>À propos des auteurs</a></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Prise en main de R</a><ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Histoire et philosophie de R</a></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Environnement de travail</a><ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Installation de R</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Environnement RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect0123"><i class="fa fa-check"></i><b>1.2.3</b> Installation et chargement un <em>package</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#aide-disponible"><i class="fa fa-check"></i><b>1.2.4</b> Aide disponible</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Bases du langage R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> <em>Hello World</em>!</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Objets et expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="sect013.html"><a href="sect013.html#sect0_133"><i class="fa fa-check"></i><b>1.3.3</b> Fonctions et arguments</a></li>
<li class="chapter" data-level="1.3.4" data-path="sect013.html"><a href="sect013.html#sect0134"><i class="fa fa-check"></i><b>1.3.4</b> Principaux types de données</a></li>
<li class="chapter" data-level="1.3.5" data-path="sect013.html"><a href="sect013.html#sect0135"><i class="fa fa-check"></i><b>1.3.5</b> Opérateurs</a></li>
<li class="chapter" data-level="1.3.6" data-path="sect013.html"><a href="sect013.html#sect0136"><i class="fa fa-check"></i><b>1.3.6</b> Structures de données</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Manipulation de données</a><ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Manipulation d’un <em>DataFrame</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.5</b> Code R bien structuré</a></li>
<li class="chapter" data-level="1.6" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.6</b> Enregistrement des résultats</a></li>
<li class="chapter" data-level="1.7" data-path="sect018.html"><a href="sect018.html"><i class="fa fa-check"></i><b>1.7</b> Session de travail</a></li>
<li class="chapter" data-level="1.8" data-path="sect019.html"><a href="sect019.html"><i class="fa fa-check"></i><b>1.8</b> Conclusion et ressources pertinentes</a></li>
<li class="chapter" data-level="1.9" data-path="sect0110.html"><a href="sect0110.html"><i class="fa fa-check"></i><b>1.9</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>II Analyses univariées et graphiques dans R</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Statistiques descriptives univariées</a><ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion et types de variable</a><ul>
<li class="chapter" data-level="2.1.1" data-path="sect021.html"><a href="sect021.html#sect0211"><i class="fa fa-check"></i><b>2.1.1</b> Notion de variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="sect021.html"><a href="sect021.html#sect0212"><i class="fa fa-check"></i><b>2.1.2</b> Types de variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Types de données</a><ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Données secondaires <em>versus</em> données primaires</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Données transversales <em>versus</em> données longitudinales</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Données spatiales versus données aspatiales</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Données individuelles <em>versus</em> données agrégées</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Statistique descriptive et statistique inférentielle</a><ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Population, échantillon et inférence</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Deux grandes familles de méthodes statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Notion de distribution</a><ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#définition-générale"><i class="fa fa-check"></i><b>2.4.1</b> Définition générale</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#anatomie-dune-distribution"><i class="fa fa-check"></i><b>2.4.2</b> Anatomie d’une distribution</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#principales-distributions"><i class="fa fa-check"></i><b>2.4.3</b> Principales distributions</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#conclusion-sur-les-distributions"><i class="fa fa-check"></i><b>2.4.4</b> Conclusion sur les distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Statistiques descriptives sur des variables quantitatives</a><ul>
<li class="chapter" data-level="2.5.1" data-path="sect025.html"><a href="sect025.html#sect0251"><i class="fa fa-check"></i><b>2.5.1</b> Paramètres de tendance centrale</a></li>
<li class="chapter" data-level="2.5.2" data-path="sect025.html"><a href="sect025.html#sect0252"><i class="fa fa-check"></i><b>2.5.2</b> Paramètres de position</a></li>
<li class="chapter" data-level="2.5.3" data-path="sect025.html"><a href="sect025.html#sect0253"><i class="fa fa-check"></i><b>2.5.3</b> Paramètres de dispersion</a></li>
<li class="chapter" data-level="2.5.4" data-path="sect025.html"><a href="sect025.html#sect0254"><i class="fa fa-check"></i><b>2.5.4</b> Paramètres de forme</a></li>
<li class="chapter" data-level="2.5.5" data-path="sect025.html"><a href="sect025.html#sect0255"><i class="fa fa-check"></i><b>2.5.5</b> Transformation des variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="sect025.html"><a href="sect025.html#sect0256"><i class="fa fa-check"></i><b>2.5.6</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a><ul>
<li class="chapter" data-level="2.6.1" data-path="sect026.html"><a href="sect026.html#sect0261"><i class="fa fa-check"></i><b>2.6.1</b> Fréquences</a></li>
<li class="chapter" data-level="2.6.2" data-path="sect026.html"><a href="sect026.html#sect0262"><i class="fa fa-check"></i><b>2.6.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sect027.html"><a href="sect027.html"><i class="fa fa-check"></i><b>2.7</b> Statistiques descriptives pondérées : pour aller plus loin</a></li>
<li class="chapter" data-level="2.8" data-path="sect028.html"><a href="sect028.html"><i class="fa fa-check"></i><b>2.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Magie des graphiques</a><ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Philosophie du ggplot2</a><ul>
<li class="chapter" data-level="3.1.1" data-path="sect031.html"><a href="sect031.html#sect0311"><i class="fa fa-check"></i><b>3.1.1</b> Grammaire</a></li>
<li class="chapter" data-level="3.1.2" data-path="sect031.html"><a href="sect031.html#sect0312"><i class="fa fa-check"></i><b>3.1.2</b> Types de géométries</a></li>
<li class="chapter" data-level="3.1.3" data-path="sect031.html"><a href="sect031.html#sect0313"><i class="fa fa-check"></i><b>3.1.3</b> Habillage</a></li>
<li class="chapter" data-level="3.1.4" data-path="sect031.html"><a href="sect031.html#utilisation-des-thèmes"><i class="fa fa-check"></i><b>3.1.4</b> Utilisation des thèmes</a></li>
<li class="chapter" data-level="3.1.5" data-path="sect031.html"><a href="sect031.html#sect0314"><i class="fa fa-check"></i><b>3.1.5</b> Composition d’une figure avec plusieurs graphiques</a></li>
<li class="chapter" data-level="3.1.6" data-path="sect031.html"><a href="sect031.html#sect0315"><i class="fa fa-check"></i><b>3.1.6</b> Couleur</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Principaux graphiques</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0321"><i class="fa fa-check"></i><b>3.2.1</b> Histogramme</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0322"><i class="fa fa-check"></i><b>3.2.2</b> Graphique de densité</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0323"><i class="fa fa-check"></i><b>3.2.3</b> Nuage de points</a></li>
<li class="chapter" data-level="3.2.4" data-path="sect032.html"><a href="sect032.html#sect0324"><i class="fa fa-check"></i><b>3.2.4</b> Graphique en ligne</a></li>
<li class="chapter" data-level="3.2.5" data-path="sect032.html"><a href="sect032.html#sect0325"><i class="fa fa-check"></i><b>3.2.5</b> Boîte à moustaches</a></li>
<li class="chapter" data-level="3.2.6" data-path="sect032.html"><a href="sect032.html#sect0326"><i class="fa fa-check"></i><b>3.2.6</b> Graphique en violon</a></li>
<li class="chapter" data-level="3.2.7" data-path="sect032.html"><a href="sect032.html#sect0327"><i class="fa fa-check"></i><b>3.2.7</b> Graphique en barre</a></li>
<li class="chapter" data-level="3.2.8" data-path="sect032.html"><a href="sect032.html#sect0328"><i class="fa fa-check"></i><b>3.2.8</b> Graphique circulaire</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Graphiques spéciaux</a><ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Graphique en radar</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Diagramme d’accord</a></li>
<li class="chapter" data-level="3.3.3" data-path="sect033.html"><a href="sect033.html#sect0333"><i class="fa fa-check"></i><b>3.3.3</b> Nuage de mots</a></li>
<li class="chapter" data-level="3.3.4" data-path="sect033.html"><a href="sect033.html#sect0334"><i class="fa fa-check"></i><b>3.3.4</b> Carte proportionnelle</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Cartes</a></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Exportation des graphiques</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Conclusion sur les graphiques</a></li>
</ul></li>
<li class="part"><span><b>III Analyses bivariées</b></span></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Relation linéaire entre deux variables quantitatives</a><ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Bref retour sur le postulat de la relation linéaire</a></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Covariance</a><ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Formulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect043.html"><a href="sect043.html"><i class="fa fa-check"></i><b>4.3</b> Corrélation</a><ul>
<li class="chapter" data-level="4.3.1" data-path="sect043.html"><a href="sect043.html#sect0431"><i class="fa fa-check"></i><b>4.3.1</b> Formulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="sect043.html"><a href="sect043.html#sect0432"><i class="fa fa-check"></i><b>4.3.2</b> Interprétation</a></li>
<li class="chapter" data-level="4.3.3" data-path="sect043.html"><a href="sect043.html#sect0433"><i class="fa fa-check"></i><b>4.3.3</b> Corrélations pour des variables anormalement distribuées (coefficient de Spearman, tau de Kendall)</a></li>
<li class="chapter" data-level="4.3.4" data-path="sect043.html"><a href="sect043.html#sect0434"><i class="fa fa-check"></i><b>4.3.4</b> Corrélations robustes (<em>Biweight midcorrelation</em>, <em>Percentage bend correlation</em> et la corrélation <em>pi</em> de Shepherd)</a></li>
<li class="chapter" data-level="4.3.5" data-path="sect043.html"><a href="sect043.html#sect0435"><i class="fa fa-check"></i><b>4.3.5</b> Significativité des coefficients de corrélation</a></li>
<li class="chapter" data-level="4.3.6" data-path="sect043.html"><a href="sect043.html#sect0436"><i class="fa fa-check"></i><b>4.3.6</b> Corrélation partielle</a></li>
<li class="chapter" data-level="4.3.7" data-path="sect043.html"><a href="sect043.html#sect0437"><i class="fa fa-check"></i><b>4.3.7</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.3.8" data-path="sect043.html"><a href="sect043.html#sect0438"><i class="fa fa-check"></i><b>4.3.8</b> Comment rapporter des valeurs de corrélations?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.4</b> Régression linéaire simple</a><ul>
<li class="chapter" data-level="4.4.1" data-path="sect044.html"><a href="sect044.html#sect0441"><i class="fa fa-check"></i><b>4.4.1</b> Principe de base de la régression linéaire simple</a></li>
<li class="chapter" data-level="4.4.2" data-path="sect044.html"><a href="sect044.html#sect0442"><i class="fa fa-check"></i><b>4.4.2</b> Formulation de la droite de régression des moindres carrés ordinaires</a></li>
<li class="chapter" data-level="4.4.3" data-path="sect044.html"><a href="sect044.html#sect0443"><i class="fa fa-check"></i><b>4.4.3</b> Mesure de la qualité d’ajustement du modèle</a></li>
<li class="chapter" data-level="4.4.4" data-path="sect044.html"><a href="sect044.html#sect0444"><i class="fa fa-check"></i><b>4.4.4</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.4.5" data-path="sect044.html"><a href="sect044.html#sect0445"><i class="fa fa-check"></i><b>4.4.5</b> Comment rapporter une régression linéaire simple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Relation entre deux variables qualitatives</a><ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Construction de tableau de contingence</a></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Test du khi-deux</a></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Interprétation d’un tableau de contingence</a></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Relation entre une variable qualitative et une variable quantitative</a><ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Relation entre une variable quantitative et une variable qualitative à deux modalités</a><ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Test <em>t</em> et ses différentes variantes</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Test non paramétrique de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a><ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Analyse de variance</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Test non paramétrique de Kruskal-Wallis</a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="6.2.4" data-path="sect062.html"><a href="sect062.html#sect0624"><i class="fa fa-check"></i><b>6.2.4</b> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Conclusion sur la troisième partie</a></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>IV Modèles de régression</b></span></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Régression linéaire multiple</a><ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Principes de base de la régression linéaire multiple</a><ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Un peu d’équations…</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Hypothèses de la régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Évaluation de la qualité d’ajustement du modèle</a><ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Mesures de la qualité d’un modèle</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Comparaison des modèles incrémentiels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Différentes mesures pour les coefficients de régression</a><ul>
<li class="chapter" data-level="7.4.1" data-path="sect074.html"><a href="sect074.html#sect0741"><i class="fa fa-check"></i><b>7.4.1</b> Coefficients de régression : évaluer l’effet des variables indépendantes</a></li>
<li class="chapter" data-level="7.4.2" data-path="sect074.html"><a href="sect074.html#sect0742"><i class="fa fa-check"></i><b>7.4.2</b> Coefficients de régression standardisés : repérer les variables les plus importantes du modèle</a></li>
<li class="chapter" data-level="7.4.3" data-path="sect074.html"><a href="sect074.html#sect0743"><i class="fa fa-check"></i><b>7.4.3</b> Significativité des coefficients de régression : valeurs de <em>t</em> et de <em>p</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="sect074.html"><a href="sect074.html#sect0744"><i class="fa fa-check"></i><b>7.4.4</b> Intervalle de confiance des coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Introduction de variables explicatives particulières</a><ul>
<li class="chapter" data-level="7.5.1" data-path="sect075.html"><a href="sect075.html#sect0751"><i class="fa fa-check"></i><b>7.5.1</b> Exploration des relations non linéaires</a></li>
<li class="chapter" data-level="7.5.2" data-path="sect075.html"><a href="sect075.html#sect0752"><i class="fa fa-check"></i><b>7.5.2</b> Variable indépendante qualitative dichotomique</a></li>
<li class="chapter" data-level="7.5.3" data-path="sect075.html"><a href="sect075.html#sect0753"><i class="fa fa-check"></i><b>7.5.3</b> Variable indépendante qualitative polytomique</a></li>
<li class="chapter" data-level="7.5.4" data-path="sect075.html"><a href="sect075.html#sect0754"><i class="fa fa-check"></i><b>7.5.4</b> Variables d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sect076.html"><a href="sect076.html"><i class="fa fa-check"></i><b>7.6</b> Diagnostics de la régression</a><ul>
<li class="chapter" data-level="7.6.1" data-path="sect076.html"><a href="sect076.html#sect0761"><i class="fa fa-check"></i><b>7.6.1</b> Nombre d’observations</a></li>
<li class="chapter" data-level="7.6.2" data-path="sect076.html"><a href="sect076.html#sect0762"><i class="fa fa-check"></i><b>7.6.2</b> Normalité des résidus</a></li>
<li class="chapter" data-level="7.6.3" data-path="sect076.html"><a href="sect076.html#sect0763"><i class="fa fa-check"></i><b>7.6.3</b> Linéarité et homoscédasticité des résidus</a></li>
<li class="chapter" data-level="7.6.4" data-path="sect076.html"><a href="sect076.html#sect0764"><i class="fa fa-check"></i><b>7.6.4</b> Absence de multicolinéarité excessive</a></li>
<li class="chapter" data-level="7.6.5" data-path="sect076.html"><a href="sect076.html#sect0766"><i class="fa fa-check"></i><b>7.6.5</b> Absence d’observations aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sect077.html"><a href="sect077.html"><i class="fa fa-check"></i><b>7.7</b> Mise en œuvre dans R</a><ul>
<li class="chapter" data-level="7.7.1" data-path="sect077.html"><a href="sect077.html#sect0771"><i class="fa fa-check"></i><b>7.7.1</b> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
<li class="chapter" data-level="7.7.2" data-path="sect077.html"><a href="sect077.html#sect0772"><i class="fa fa-check"></i><b>7.7.2</b> Comparaison des modèles</a></li>
<li class="chapter" data-level="7.7.3" data-path="sect077.html"><a href="sect077.html#sect0773"><i class="fa fa-check"></i><b>7.7.3</b> Diagnostic sur un modèle</a></li>
<li class="chapter" data-level="7.7.4" data-path="sect077.html"><a href="sect077.html#sect0774"><i class="fa fa-check"></i><b>7.7.4</b> Graphiques pour les effets marginaux</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sect078.html"><a href="sect078.html"><i class="fa fa-check"></i><b>7.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Régressions linéaires généralisées (GLM)</a><ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Qu’est qu’un modèle GLM?</a><ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Formulation d’un GLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Autres distributions et rôle de la fonction de lien</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Conditions d’application</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Résidus et déviance</a></li>
<li class="chapter" data-level="8.1.5" data-path="sect081.html"><a href="sect081.html#sect0815"><i class="fa fa-check"></i><b>8.1.5</b> Vérification l’ajustement</a></li>
<li class="chapter" data-level="8.1.6" data-path="sect081.html"><a href="sect081.html#sect0816"><i class="fa fa-check"></i><b>8.1.6</b> Comparaison de deux modèles GLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Modèles GLM pour des variables qualitatives</a><ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Modèle logistique binomial</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Modèle probit binomial</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Modèle logistique des cotes proportionnelles</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Modèle logistique multinomial</a></li>
<li class="chapter" data-level="8.2.5" data-path="sect082.html"><a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives"><i class="fa fa-check"></i><b>8.2.5</b> Conclusion sur les modèles pour des variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.3</b> Modèles GLM pour des variables de comptage</a><ul>
<li class="chapter" data-level="8.3.1" data-path="sect084.html"><a href="sect084.html#sect0841"><i class="fa fa-check"></i><b>8.3.1</b> Modèle de Poisson</a></li>
<li class="chapter" data-level="8.3.2" data-path="sect084.html"><a href="sect084.html#sect0842"><i class="fa fa-check"></i><b>8.3.2</b> Modèle binomial négatif</a></li>
<li class="chapter" data-level="8.3.3" data-path="sect084.html"><a href="sect084.html#sect0843"><i class="fa fa-check"></i><b>8.3.3</b> Modèle de Poisson avec excès fixe de zéros</a></li>
<li class="chapter" data-level="8.3.4" data-path="sect084.html"><a href="sect084.html#sect0844"><i class="fa fa-check"></i><b>8.3.4</b> Modèle de Poisson avec excès ajusté de zéros</a></li>
<li class="chapter" data-level="8.3.5" data-path="sect084.html"><a href="sect084.html#sect0845"><i class="fa fa-check"></i><b>8.3.5</b> Conclusion sur les modèles destinés à des variables de comptage</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sect085.html"><a href="sect085.html"><i class="fa fa-check"></i><b>8.4</b> Modèles GLM pour des variables continues</a><ul>
<li class="chapter" data-level="8.4.1" data-path="sect085.html"><a href="sect085.html#sect0851"><i class="fa fa-check"></i><b>8.4.1</b> Modèle GLM gaussien</a></li>
<li class="chapter" data-level="8.4.2" data-path="sect085.html"><a href="sect085.html#sect0852"><i class="fa fa-check"></i><b>8.4.2</b> Modèle GLM avec une distribution de Student</a></li>
<li class="chapter" data-level="8.4.3" data-path="sect085.html"><a href="sect085.html#sect0853"><i class="fa fa-check"></i><b>8.4.3</b> Modèle GLM avec distribution Gamma</a></li>
<li class="chapter" data-level="8.4.4" data-path="sect085.html"><a href="sect085.html#sect0854"><i class="fa fa-check"></i><b>8.4.4</b> Modèle GLM avec une distribution bêta</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sect086.html"><a href="sect086.html"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="8.6" data-path="sect087.html"><a href="sect087.html"><i class="fa fa-check"></i><b>8.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Régressions à effets mixtes (GLMM)</a><ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Indépendance des observations et effets de groupes</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Terminologie: effets fixes et effets aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Principes de base des GLMM</a><ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> GLMM avec constantes aléatoires</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.2</b> GLMM avec pentes aléatoires</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.3</b> GLMM avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Conditions d’application des GLMM</a><ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Vérification de la distribution des effets aléatoires</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Homogénéité des variances au sein des groupes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Inférence dans les modèles GLMM</a><ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#sect0941"><i class="fa fa-check"></i><b>9.4.1</b> Inférence pour les effets fixes</a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#sect0942"><i class="fa fa-check"></i><b>9.4.2</b> Inférence pour les effets aléatoires, effet global</a></li>
<li class="chapter" data-level="9.4.3" data-path="sect094.html"><a href="sect094.html#sect0943"><i class="fa fa-check"></i><b>9.4.3</b> Inférence pour les effets aléatoires, des constantes et des pentes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Conclusion sur les GLMM</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Mise en œuvre des GLMM dans R</a><ul>
<li class="chapter" data-level="9.6.1" data-path="sect096.html"><a href="sect096.html#sect0961"><i class="fa fa-check"></i><b>9.6.1</b> Ajustement du modèle avec uniquement une constante aléatoire</a></li>
<li class="chapter" data-level="9.6.2" data-path="sect096.html"><a href="sect096.html#sect0962"><i class="fa fa-check"></i><b>9.6.2</b> Ajustement du modèle avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sect097.html"><a href="sect097.html"><i class="fa fa-check"></i><b>9.7</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Régressions multiniveaux</a><ul>
<li class="chapter" data-level="10.1" data-path="sect101.html"><a href="sect101.html"><i class="fa fa-check"></i><b>10.1</b> Modèles multiniveaux : deux intérêts majeurs</a><ul>
<li class="chapter" data-level="10.1.1" data-path="sect101.html"><a href="sect101.html#sect1011"><i class="fa fa-check"></i><b>10.1.1</b> Répartition de la variance entre les différents niveaux</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect101.html"><a href="sect101.html#sect1012"><i class="fa fa-check"></i><b>10.1.2</b> Estimation des coefficients aux différents niveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect102.html"><a href="sect102.html"><i class="fa fa-check"></i><b>10.2</b> Différents types de modèles multiniveaux</a><ul>
<li class="chapter" data-level="10.2.1" data-path="sect102.html"><a href="sect102.html#sect1021"><i class="fa fa-check"></i><b>10.2.1</b> Description du jeu de données utilisé</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect102.html"><a href="sect102.html#sect1022"><i class="fa fa-check"></i><b>10.2.2</b> Démarche classique pour les modèles multiniveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect103.html"><a href="sect103.html"><i class="fa fa-check"></i><b>10.3</b> Conditions d’application des régressions multiniveaux</a></li>
<li class="chapter" data-level="10.4" data-path="sect104.html"><a href="sect104.html"><i class="fa fa-check"></i><b>10.4</b> Mise en œuvre dans R</a><ul>
<li class="chapter" data-level="10.4.1" data-path="sect104.html"><a href="sect104.html#sect1041"><i class="fa fa-check"></i><b>10.4.1</b> Le modèle vide</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect104.html"><a href="sect104.html#sect1042"><i class="fa fa-check"></i><b>10.4.2</b> Modèle avec les variables indépendantes du niveau 1</a></li>
<li class="chapter" data-level="10.4.3" data-path="sect104.html"><a href="sect104.html#sect1043"><i class="fa fa-check"></i><b>10.4.3</b> Modèle avec les variables indépendantes aux niveaux 1 et 2</a></li>
<li class="chapter" data-level="10.4.4" data-path="sect104.html"><a href="sect104.html#sect10414"><i class="fa fa-check"></i><b>10.4.4</b> Modèle complet avec une interaction</a></li>
<li class="chapter" data-level="10.4.5" data-path="sect104.html"><a href="sect104.html#sect1045"><i class="fa fa-check"></i><b>10.4.5</b> Comparaison des quatre modèles</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect105.html"><a href="sect105.html"><i class="fa fa-check"></i><b>10.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> Modèles généralisés additifs</a><ul>
<li class="chapter" data-level="11.1" data-path="sect111.html"><a href="sect111.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a><ul>
<li class="chapter" data-level="11.1.1" data-path="sect111.html"><a href="sect111.html#sect1111"><i class="fa fa-check"></i><b>11.1.1</b> Non linéarité fonctionnelle</a></li>
<li class="chapter" data-level="11.1.2" data-path="sect111.html"><a href="sect111.html#sect1112"><i class="fa fa-check"></i><b>11.1.2</b> Non linéarité avec des polynomiales</a></li>
<li class="chapter" data-level="11.1.3" data-path="sect111.html"><a href="sect111.html#sect1113"><i class="fa fa-check"></i><b>11.1.3</b> Non linéarité par segments</a></li>
<li class="chapter" data-level="11.1.4" data-path="sect111.html"><a href="sect111.html#sect1114"><i class="fa fa-check"></i><b>11.1.4</b> Non linéarité avec des <em>splines</em></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sect112.html"><a href="sect112.html"><i class="fa fa-check"></i><b>11.2</b> <em>Spline</em> de régression et <em>spline</em> de lissage</a></li>
<li class="chapter" data-level="11.3" data-path="sect113.html"><a href="sect113.html"><i class="fa fa-check"></i><b>11.3</b> Interprétation d’une <em>spline</em></a></li>
<li class="chapter" data-level="11.4" data-path="sect114.html"><a href="sect114.html"><i class="fa fa-check"></i><b>11.4</b> Multicolinéarité non linéaire</a></li>
<li class="chapter" data-level="11.5" data-path="sect115.html"><a href="sect115.html"><i class="fa fa-check"></i><b>11.5</b> <em>Splines</em> avancées</a><ul>
<li class="chapter" data-level="11.5.1" data-path="sect115.html"><a href="sect115.html#sect1151"><i class="fa fa-check"></i><b>11.5.1</b> <em>Splines</em> cycliques</a></li>
<li class="chapter" data-level="11.5.2" data-path="sect115.html"><a href="sect115.html#sect1152"><i class="fa fa-check"></i><b>11.5.2</b> Splines par groupe</a></li>
<li class="chapter" data-level="11.5.3" data-path="sect115.html"><a href="sect115.html#sect1153"><i class="fa fa-check"></i><b>11.5.3</b> <em>Splines</em> multivariées et <em>splines</em> d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="sect116.html"><a href="sect116.html"><i class="fa fa-check"></i><b>11.6</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="11.7" data-path="sect117.html"><a href="sect117.html"><i class="fa fa-check"></i><b>11.7</b> GAMM</a></li>
<li class="chapter" data-level="11.8" data-path="sect118.html"><a href="sect118.html"><i class="fa fa-check"></i><b>11.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>V Analyses exploratoires multivariées</b></span></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> Méthodes factorielles</a><ul>
<li class="chapter" data-level="12.1" data-path="sect121.html"><a href="sect121.html"><i class="fa fa-check"></i><b>12.1</b> Aperçu des méthodes factorielles</a><ul>
<li class="chapter" data-level="12.1.1" data-path="sect121.html"><a href="sect121.html#sect1211"><i class="fa fa-check"></i><b>12.1.1</b> Méthodes factorielles et types de données</a></li>
<li class="chapter" data-level="12.1.2" data-path="sect121.html"><a href="sect121.html#sect1212"><i class="fa fa-check"></i><b>12.1.2</b> Bref historique des méthodes factorielles</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sect122.html"><a href="sect122.html"><i class="fa fa-check"></i><b>12.2</b> Analyses en composantes principales (ACP)</a><ul>
<li class="chapter" data-level="12.2.1" data-path="sect122.html"><a href="sect122.html#sect1221"><i class="fa fa-check"></i><b>12.2.1</b> Recherche d’une simplification</a></li>
<li class="chapter" data-level="12.2.2" data-path="sect122.html"><a href="sect122.html#sect1222"><i class="fa fa-check"></i><b>12.2.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.2.3" data-path="sect122.html"><a href="sect122.html#sect1223"><i class="fa fa-check"></i><b>12.2.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sect123.html"><a href="sect123.html"><i class="fa fa-check"></i><b>12.3</b> Analyse factorielle des correspondances (AFC)</a><ul>
<li class="chapter" data-level="12.3.1" data-path="sect123.html"><a href="sect123.html#sect1231"><i class="fa fa-check"></i><b>12.3.1</b> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
<li class="chapter" data-level="12.3.2" data-path="sect123.html"><a href="sect123.html#sect1232"><i class="fa fa-check"></i><b>12.3.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.3.3" data-path="sect123.html"><a href="sect123.html#sect1233"><i class="fa fa-check"></i><b>12.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="sect124.html"><a href="sect124.html"><i class="fa fa-check"></i><b>12.4</b> Analyse de correspondances multiples (ACM)</a><ul>
<li class="chapter" data-level="12.4.1" data-path="sect124.html"><a href="sect124.html#sect1241"><i class="fa fa-check"></i><b>12.4.1</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.4.2" data-path="sect124.html"><a href="sect124.html#sect1242"><i class="fa fa-check"></i><b>12.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="sect125.html"><a href="sect125.html"><i class="fa fa-check"></i><b>12.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> Méthodes de classification non supervisée</a><ul>
<li class="chapter" data-level="13.1" data-path="sect131.html"><a href="sect131.html"><i class="fa fa-check"></i><b>13.1</b> Méthodes de classification : un aperçu</a></li>
<li class="chapter" data-level="13.2" data-path="sect132.html"><a href="sect132.html"><i class="fa fa-check"></i><b>13.2</b> Notions essentielles en classification</a><ul>
<li class="chapter" data-level="13.2.1" data-path="sect132.html"><a href="sect132.html#sect1321"><i class="fa fa-check"></i><b>13.2.1</b> Distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="sect132.html"><a href="sect132.html#sect1322"><i class="fa fa-check"></i><b>13.2.2</b> Inertie</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="sect133.html"><a href="sect133.html"><i class="fa fa-check"></i><b>13.3</b> Classification ascendante hiérarchique</a><ul>
<li class="chapter" data-level="13.3.1" data-path="sect133.html"><a href="sect133.html#sect1331"><i class="fa fa-check"></i><b>13.3.1</b> Fonctionnement de l’algorithme</a></li>
<li class="chapter" data-level="13.3.2" data-path="sect133.html"><a href="sect133.html#sect1332"><i class="fa fa-check"></i><b>13.3.2</b> Choisir le bon nombre de groupes</a></li>
<li class="chapter" data-level="13.3.3" data-path="sect133.html"><a href="sect133.html#sect1333"><i class="fa fa-check"></i><b>13.3.3</b> Limites de la classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="13.3.4" data-path="sect133.html"><a href="sect133.html#sect1334"><i class="fa fa-check"></i><b>13.3.4</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sect134.html"><a href="sect134.html"><i class="fa fa-check"></i><b>13.4</b> Nuées dynamiques</a><ul>
<li class="chapter" data-level="13.4.1" data-path="sect134.html"><a href="sect134.html#sect1341"><i class="fa fa-check"></i><b>13.4.1</b> <em>K-means</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="sect134.html"><a href="sect134.html#sect1342"><i class="fa fa-check"></i><b>13.4.2</b> K-médianes</a></li>
<li class="chapter" data-level="13.4.3" data-path="sect134.html"><a href="sect134.html#sect1343"><i class="fa fa-check"></i><b>13.4.3</b> K-médoïds</a></li>
<li class="chapter" data-level="13.4.4" data-path="sect134.html"><a href="sect134.html#sect1344"><i class="fa fa-check"></i><b>13.4.4</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="13.4.5" data-path="sect134.html"><a href="sect134.html#sect1346"><i class="fa fa-check"></i><b>13.4.5</b> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sect135.html"><a href="sect135.html"><i class="fa fa-check"></i><b>13.5</b> Conclusion sur la cinquième partie</a></li>
<li class="chapter" data-level="13.6" data-path="sect136.html"><a href="sect136.html"><i class="fa fa-check"></i><b>13.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="annexes.html"><a href="annexes.html"><i class="fa fa-check"></i><b>14</b> Annexes</a><ul>
<li class="chapter" data-level="14.1" data-path="annexe1.html"><a href="annexe1.html"><i class="fa fa-check"></i><b>14.1</b> Table des valeurs critiques de khi-deux</a></li>
<li class="chapter" data-level="14.2" data-path="annexe2.html"><a href="annexe2.html"><i class="fa fa-check"></i><b>14.2</b> Table des valeurs critiques de Fisher</a></li>
<li class="chapter" data-level="14.3" data-path="annexe3.html"><a href="annexe3.html"><i class="fa fa-check"></i><b>14.3</b> Table des valeurs critiques de <em>t</em></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect032" class="section level2">
<h2><span class="header-section-number">3.2</span> Principaux graphiques</h2>
<div class="bloc_objectif">
<p>Puisque vous avez désormais une certaine connaissance des bases de la grammaire des graphiques implémentées par <code>ggplot2</code>, vous apprendrez dans les sous-sections suivantes à construire les principaux graphiques que vous utiliserez régulièrement ou que vous présenterez dans un article scientifique.</p>
</div>
<div id="sect0321" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Histogramme</h3>
<p>L’histogramme permet de décrire graphiquement la forme de la distribution d’une variable. Pour le réaliser, nous utilisons la fonction <code>geom_histogram</code>. Le paramètre le plus important est le nombre de barres (<code>bins</code>) qui composent l’histogramme. Plus ce nombre est grand, plus l’histogramme est précis et, à l’inverse, plus il est petit, plus l’histogramme est simplifié. En revanche, il faut éviter d’utiliser un nombre de barres trop élevé comparativement au nombre d’observations disponibles dans le jeu de données, sinon l’histogramme risque d’avoir plein de trous.</p>
<div id="sect03211" class="section level4">
<h4><span class="header-section-number">3.2.1.1</span> Histogramme simple</h4>
<p>Générons quatre variables ayant respectivement une distribution gaussienne, Student, Gamma et bêta, puis réalisons un histogramme pour chacune de ces variables et combinons-les avec la fonction <code>ggarrange</code> (figure <a href="sect032.html#fig:fig318">3.21</a>).</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="sect032.html#cb401-1"></a>distribs &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb401-2"><a href="sect032.html#cb401-2"></a>  <span class="dt">gaussien =</span> <span class="kw">rnorm</span>(<span class="dv">1000</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="fl">1.5</span>),</span>
<span id="cb401-3"><a href="sect032.html#cb401-3"></a>  <span class="dt">gamma =</span> <span class="kw">rgamma</span>(<span class="dv">1000</span>, <span class="dt">shape =</span> <span class="dv">2</span>, <span class="dt">rate =</span> <span class="dv">12</span>),</span>
<span id="cb401-4"><a href="sect032.html#cb401-4"></a>  <span class="dt">beta =</span> <span class="kw">rbeta</span>(<span class="dv">1000</span>,<span class="dt">shape1 =</span> <span class="dv">5</span>, <span class="dt">shape2 =</span> <span class="dv">1</span>, <span class="dt">ncp =</span> <span class="dv">2</span>),</span>
<span id="cb401-5"><a href="sect032.html#cb401-5"></a>  <span class="dt">student =</span> <span class="kw">rt</span>(<span class="dv">1000</span>,<span class="dt">ncp =</span> <span class="dv">20</span>, <span class="dt">df =</span> <span class="dv">5</span>)</span>
<span id="cb401-6"><a href="sect032.html#cb401-6"></a>)</span>
<span id="cb401-7"><a href="sect032.html#cb401-7"></a></span>
<span id="cb401-8"><a href="sect032.html#cb401-8"></a>plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> distribs) <span class="op">+</span></span>
<span id="cb401-9"><a href="sect032.html#cb401-9"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gaussien), <span class="dt">bins =</span> <span class="dv">50</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#e63946&quot;</span>)<span class="op">+</span></span>
<span id="cb401-10"><a href="sect032.html#cb401-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;fréquences&quot;</span>)<span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">130</span>))</span>
<span id="cb401-11"><a href="sect032.html#cb401-11"></a></span>
<span id="cb401-12"><a href="sect032.html#cb401-12"></a>plot2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> distribs) <span class="op">+</span></span>
<span id="cb401-13"><a href="sect032.html#cb401-13"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gamma), <span class="dt">bins =</span> <span class="dv">50</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#f1faee&quot;</span>)<span class="op">+</span></span>
<span id="cb401-14"><a href="sect032.html#cb401-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;fréquences&quot;</span>)<span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">130</span>))</span>
<span id="cb401-15"><a href="sect032.html#cb401-15"></a></span>
<span id="cb401-16"><a href="sect032.html#cb401-16"></a>plot3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> distribs) <span class="op">+</span></span>
<span id="cb401-17"><a href="sect032.html#cb401-17"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> beta), <span class="dt">bins =</span> <span class="dv">50</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>)<span class="op">+</span></span>
<span id="cb401-18"><a href="sect032.html#cb401-18"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;fréquences&quot;</span>)<span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">130</span>))</span>
<span id="cb401-19"><a href="sect032.html#cb401-19"></a></span>
<span id="cb401-20"><a href="sect032.html#cb401-20"></a>plot4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> distribs) <span class="op">+</span></span>
<span id="cb401-21"><a href="sect032.html#cb401-21"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> student), <span class="dt">bins =</span> <span class="dv">50</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#1d3557&quot;</span>)<span class="op">+</span></span>
<span id="cb401-22"><a href="sect032.html#cb401-22"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;fréquences&quot;</span>)<span class="op">+</span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">130</span>))</span>
<span id="cb401-23"><a href="sect032.html#cb401-23"></a></span>
<span id="cb401-24"><a href="sect032.html#cb401-24"></a>histogrammes &lt;-<span class="st"> </span><span class="kw">list</span>(plot1, plot2, plot3, plot4)</span>
<span id="cb401-25"><a href="sect032.html#cb401-25"></a></span>
<span id="cb401-26"><a href="sect032.html#cb401-26"></a><span class="kw">ggarrange</span>(<span class="dt">plotlist =</span> histogrammes, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig318"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig318-1.png" alt="Histogrammes" width="65%" />
<p class="caption">
Figure 3.21: Histogrammes
</p>
</div>
<p>Notez que cette syntaxe est très lourde. Dans le cas présent, il serait plus judicieux d’utiliser la fonction <code>facet_wrap</code>. Pour cela, nous devons au préalable empiler nos données, ce qui signifie changer la forme du <em>DataFrame</em> actuel, qui comprend quatre colonnes (gaussien, Gamma, bêta et student) et 1000 observations, pour qu’il n’ait plus que deux colonnes (la valeur originale et le nom de l’ancienne colonne) et 4000 observations. La figure <a href="sect032.html#fig:fig319">3.22</a> décrit graphiquement ce processus qui peut être effectué avec la fonction <code>melt</code> du <em>package</em> <code>reshape2</code>.</p>
<div class="figure" style="text-align: center"><span id="fig:fig319"></span>
<img src="images/magie_graphiques/melting.png" alt="Empiler les données d'un DataFrame" width="30%" />
<p class="caption">
Figure 3.22: Empiler les données d’un DataFrame
</p>
</div>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="sect032.html#cb402-1"></a><span class="kw">library</span>(reshape2)</span>
<span id="cb402-2"><a href="sect032.html#cb402-2"></a></span>
<span id="cb402-3"><a href="sect032.html#cb402-3"></a><span class="co">#faire fondre le jeu de données</span></span>
<span id="cb402-4"><a href="sect032.html#cb402-4"></a>melted_distribs &lt;-<span class="st"> </span><span class="kw">melt</span>(distribs, <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&quot;gaussien&quot;</span>, <span class="st">&quot;gamma&quot;</span>,</span>
<span id="cb402-5"><a href="sect032.html#cb402-5"></a>                                                   <span class="st">&quot;beta&quot;</span>,<span class="st">&quot;student&quot;</span>))</span>
<span id="cb402-6"><a href="sect032.html#cb402-6"></a><span class="co">#renommer les colonnes du nouveau DataFrame</span></span>
<span id="cb402-7"><a href="sect032.html#cb402-7"></a><span class="kw">names</span>(melted_distribs) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;distribution&quot;</span>, <span class="st">&quot;valeur&quot;</span>)</span>
<span id="cb402-8"><a href="sect032.html#cb402-8"></a><span class="co">#convertir la variable catégorielle en facteur</span></span>
<span id="cb402-9"><a href="sect032.html#cb402-9"></a>melted_distribs<span class="op">$</span>distribution &lt;-<span class="st"> </span><span class="kw">as.factor</span>(melted_distribs<span class="op">$</span>distribution)</span>
<span id="cb402-10"><a href="sect032.html#cb402-10"></a></span>
<span id="cb402-11"><a href="sect032.html#cb402-11"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> melted_distribs)<span class="op">+</span></span>
<span id="cb402-12"><a href="sect032.html#cb402-12"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> valeur, <span class="dt">fill =</span> distribution), <span class="dt">bins =</span> <span class="dv">50</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>) <span class="op">+</span></span>
<span id="cb402-13"><a href="sect032.html#cb402-13"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">130</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb402-14"><a href="sect032.html#cb402-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;valeur&quot;</span>, </span>
<span id="cb402-15"><a href="sect032.html#cb402-15"></a>       <span class="dt">y =</span> <span class="st">&quot;fréquences&quot;</span>)<span class="op">+</span></span>
<span id="cb402-16"><a href="sect032.html#cb402-16"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#e63946&quot;</span>,<span class="st">&quot;#f1faee&quot;</span>,<span class="st">&quot;#a8dadc&quot;</span>,<span class="st">&quot;#1d3557&quot;</span>))<span class="op">+</span></span>
<span id="cb402-17"><a href="sect032.html#cb402-17"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(distribution), <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="op">+</span></span>
<span id="cb402-18"><a href="sect032.html#cb402-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig320"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig320-1.png" alt="Histogrammes à facettes" width="65%" />
<p class="caption">
Figure 3.23: Histogrammes à facettes
</p>
</div>
</div>
<div id="sect03212" class="section level4">
<h4><span class="header-section-number">3.2.1.2</span> Histogramme de densité</h4>
<p>Les histogrammes que nous venons de construire utilisent la fréquence des observations pour délimiter la hauteur des barres. Il est possible de changer ce comportement pour plutôt utiliser la densité. L’intérêt est notamment de se rapprocher encore de la définition d’une distribution puisqu’avec cette configuration, la somme totale de la surface de l’histogramme est égale à 1. La hauteur de chaque barre représente alors la probabilité d’obtenir l’étendue de valeurs représentées par cette barre. Prenons pour exemple la variable avec la distribution normale que nous venons de voir.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="sect032.html#cb403-1"></a>plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> distribs) <span class="op">+</span></span>
<span id="cb403-2"><a href="sect032.html#cb403-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gaussien, <span class="dt">y =</span> ..density..),</span>
<span id="cb403-3"><a href="sect032.html#cb403-3"></a>                 <span class="dt">bins =</span> <span class="dv">30</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#1d3557&quot;</span>)<span class="op">+</span></span>
<span id="cb403-4"><a href="sect032.html#cb403-4"></a><span class="st">      </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;gaussien&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;densité&quot;</span>)</span>
<span id="cb403-5"><a href="sect032.html#cb403-5"></a></span>
<span id="cb403-6"><a href="sect032.html#cb403-6"></a>plot2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> distribs) <span class="op">+</span></span>
<span id="cb403-7"><a href="sect032.html#cb403-7"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gaussien, <span class="dt">y =</span> ..count..),</span>
<span id="cb403-8"><a href="sect032.html#cb403-8"></a>                 <span class="dt">bins =</span> <span class="dv">30</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>)<span class="op">+</span></span>
<span id="cb403-9"><a href="sect032.html#cb403-9"></a><span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;gaussien&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;fréquences&quot;</span>)</span>
<span id="cb403-10"><a href="sect032.html#cb403-10"></a></span>
<span id="cb403-11"><a href="sect032.html#cb403-11"></a><span class="kw">ggarrange</span>(<span class="dt">plotlist =</span> <span class="kw">list</span>(plot1, plot2), <span class="dt">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig321"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig321-1.png" alt="Histogrammes de densité" width="65%" />
<p class="caption">
Figure 3.24: Histogrammes de densité
</p>
</div>
<p>Le graphique de droite (fréquence) nous indique donc que plus de 60 observations ont une valeur d’environ 5 (entre 4,76 et 5,34, compte tenu de la largeur de la barre), ce qui se traduit par une probabilité de presque 30 % d’obtenir cette valeur en tirant une observation au hasard dans le jeu de données.</p>
</div>
<div id="sect03213" class="section level4">
<h4><span class="header-section-number">3.2.1.3</span> Histogramme avec courbe de distribution</h4>
<p>Les histogrammes sont souvent utilisés pour vérifier graphiquement si une distribution empirique s’approche d’une courbe normale. Pour cela, nous ajoutons sur l’histogramme de la variable empirique la forme qu’aurait une distribution normale parfaite en utilisant la moyenne et l’écart type de la distribution empirique. Pour créer cette figure dans <code>ggplot2</code>, il suffit d’utiliser la fonction <code>stat_function</code> pour créer un nouveau calque. Il est aussi possible d’ajouter une ligne verticale (<code>geom_vline</code>) pour indiquer la moyenne de la distribution.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="sect032.html#cb404-1"></a>moyenne &lt;-<span class="st"> </span><span class="kw">mean</span>(distribs<span class="op">$</span>gaussien)</span>
<span id="cb404-2"><a href="sect032.html#cb404-2"></a>ecart_type &lt;-<span class="st"> </span><span class="kw">sd</span>(distribs<span class="op">$</span>gaussien)</span>
<span id="cb404-3"><a href="sect032.html#cb404-3"></a></span>
<span id="cb404-4"><a href="sect032.html#cb404-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> distribs) <span class="op">+</span></span>
<span id="cb404-5"><a href="sect032.html#cb404-5"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> gaussien, <span class="dt">y =</span> ..density..),</span>
<span id="cb404-6"><a href="sect032.html#cb404-6"></a>                 <span class="dt">bins =</span> <span class="dv">30</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>) <span class="op">+</span></span>
<span id="cb404-7"><a href="sect032.html#cb404-7"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;gaussien&quot;</span>, </span>
<span id="cb404-8"><a href="sect032.html#cb404-8"></a>       <span class="dt">y =</span> <span class="st">&quot;densité&quot;</span>)<span class="op">+</span></span>
<span id="cb404-9"><a href="sect032.html#cb404-9"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> moyenne, <span class="dt">sd =</span> ecart_type), </span>
<span id="cb404-10"><a href="sect032.html#cb404-10"></a>                <span class="dt">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb404-11"><a href="sect032.html#cb404-11"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> moyenne, <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb404-12"><a href="sect032.html#cb404-12"></a><span class="st">  </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="kw">round</span>(moyenne,<span class="dv">2</span>)<span class="op">+</span><span class="fl">0.5</span>, <span class="dt">y =</span> <span class="fl">0.31</span>, <span class="dt">hjust =</span> <span class="st">&#39;left&#39;</span>,</span>
<span id="cb404-13"><a href="sect032.html#cb404-13"></a>           <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&#39;moyenne : &#39;</span>,<span class="kw">round</span>(moyenne,<span class="dv">2</span>),<span class="dt">sep=</span><span class="st">&#39;&#39;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig322"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig322-1.png" alt="Histogramme et courbe normale" width="65%" />
<p class="caption">
Figure 3.25: Histogramme et courbe normale
</p>
</div>
<p>Dans notre cas, nous savons que notre variable est normalement distribuée (car produite avec la fonction <code>rnorm</code>), et nous pouvons constater la grande proximité entre l’histogramme et la courbe normale.</p>
</div>
<div id="sect03214" class="section level4">
<h4><span class="header-section-number">3.2.1.4</span> Histogramme avec coloration des valeurs extrêmes</h4>
<p>Il peut être nécessaire d’attirer le regard sur certaines parties de l’histogramme, comme sur des valeurs extrêmes. Si nous reprenons notre distribution de Student, nous pouvons clairement distinguer un ensemble de valeurs fortes à droite de la distribution. Nous pourrions, dans notre cas, considérer que des valeurs au-delà de 50 constituent des cas extrêmes que nous souhaitons représenter dans une autre couleur. Pour cela, nous devons créer une variable catégorielle nous permettant de distinguer ces cas particuliers.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="sect032.html#cb405-1"></a>distribs<span class="op">$</span>cas_extreme &lt;-<span class="st"> </span><span class="kw">ifelse</span>(distribs<span class="op">$</span>student <span class="op">&gt;=</span><span class="dv">50</span>, <span class="st">&quot;extrême&quot;, &quot;</span>normale<span class="st">&quot;)</span></span>
<span id="cb405-2"><a href="sect032.html#cb405-2"></a></span>
<span id="cb405-3"><a href="sect032.html#cb405-3"></a><span class="st">ggplot(data = distribs) +</span></span>
<span id="cb405-4"><a href="sect032.html#cb405-4"></a><span class="st">  geom_histogram(aes(x = student, y = ..count.., fill = cas_extreme),</span></span>
<span id="cb405-5"><a href="sect032.html#cb405-5"></a><span class="st">                 bins = 30, color = &quot;</span><span class="co">#343a40&quot;)+</span></span>
<span id="cb405-6"><a href="sect032.html#cb405-6"></a>  <span class="kw">scale_fill_manual</span>(<span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#a8dadc&quot;</span>,<span class="st">&quot;#e63946&quot;</span>))<span class="op">+</span></span>
<span id="cb405-7"><a href="sect032.html#cb405-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Distribution de Student&#39;</span>,<span class="dt">x =</span> <span class="st">&quot;valeur&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;fréquence&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig323"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig323-1.png" alt="Histogramme coloré" width="65%" />
<p class="caption">
Figure 3.26: Histogramme coloré
</p>
</div>
</div>
</div>
<div id="sect0322" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Graphique de densité</h3>
<p>L’histogramme est utilisé pour approximer graphiquement la distribution d’une variable. Sa principale limite est de représenter la variable de façon discontinue. Une option intéressante est d’utiliser une version lissée de l’histogramme, soit le graphique de densité. Cette opération de lissage est réalisée le plus souvent à partir de fonctions kernel. Reconstruisons notre figure avec les quatre distributions, mais en utilisant cette fois-ci des graphiques de densité.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="sect032.html#cb406-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> melted_distribs)<span class="op">+</span></span>
<span id="cb406-2"><a href="sect032.html#cb406-2"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">x =</span> valeur, <span class="dt">fill =</span> distribution), <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>) <span class="op">+</span></span>
<span id="cb406-3"><a href="sect032.html#cb406-3"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#e63946&quot;</span>,<span class="st">&quot;#f1faee&quot;</span>,<span class="st">&quot;#a8dadc&quot;</span>,<span class="st">&quot;#1d3557&quot;</span>))<span class="op">+</span></span>
<span id="cb406-4"><a href="sect032.html#cb406-4"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(distribution), <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="op">+</span></span>
<span id="cb406-5"><a href="sect032.html#cb406-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig324"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig324-1.png" alt="Graphiques de densité à facette" width="65%" />
<p class="caption">
Figure 3.27: Graphiques de densité à facette
</p>
</div>
<p>Les graphiques de densité sont souvent utilisés pour comparer la distribution d’une variable pour plusieurs sous-groupes d’une population. Si nous reprenons le jeu de données <em>iris</em>, nous pouvons comparer les longueurs de sépales en fonction des espèces. Nous constatons ainsi que les setosas ont une nette tendance à avoir des sépales plus courts et qu’à l’inverse, les virginicas ont les sépales généralement les plus longs.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="sect032.html#cb407-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> iris)<span class="op">+</span></span>
<span id="cb407-2"><a href="sect032.html#cb407-2"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">fill =</span> Species), </span>
<span id="cb407-3"><a href="sect032.html#cb407-3"></a>               <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.4</span>)<span class="op">+</span></span>
<span id="cb407-4"><a href="sect032.html#cb407-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Longueur de sépales&#39;</span>,</span>
<span id="cb407-5"><a href="sect032.html#cb407-5"></a>       <span class="dt">y =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb407-6"><a href="sect032.html#cb407-6"></a>       <span class="dt">fill =</span> <span class="st">&#39;Espèce&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig325"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig325-1.png" alt="Graphiques de densité superposés" width="65%" />
<p class="caption">
Figure 3.28: Graphiques de densité superposés
</p>
</div>
</div>
<div id="sect0323" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Nuage de points</h3>
<p>Un nuage de points est un outil très intéressant pour visualiser la relation existante entre deux variables. Prenons un exemple concret et analysons le volume de CO<sub>2</sub> produit annuellement par habitant en comparaison avec le niveau d’urbanisation dans l’ensemble des pays à travers le monde. Nous avons extrait ces données sur le site web de la <a href="https://donnees.banquemondiale.org/indicateur" target="_blank">Banque mondiale</a>, puis nous les avons structurés dans un fichier <em>csv</em>.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="sect032.html#cb408-1"></a>data_co2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/graphique/world_urb_co2.csv&quot;</span>, <span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb408-2"><a href="sect032.html#cb408-2"></a><span class="kw">names</span>(data_co2)</span></code></pre></div>
<pre><code>## [1] &quot;country_code&quot; &quot;year&quot;         &quot;Population&quot;   &quot;Urbanisation&quot; &quot;CO2_kt&quot;      
## [6] &quot;Country.Name&quot; &quot;CO2t_hab&quot;     &quot;region7&quot;      &quot;region23&quot;</code></pre>
<div id="sect03231" class="section level4">
<h4><span class="header-section-number">3.2.3.1</span> Nuage de points simple</h4>
<p>Commençons par un nuage de points simple avec l’ensemble des données.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="sect032.html#cb410-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2)<span class="op">+</span></span>
<span id="cb410-2"><a href="sect032.html#cb410-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab))<span class="op">+</span></span>
<span id="cb410-3"><a href="sect032.html#cb410-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Niveau d&#39;urbanisation (%)&quot;</span>,</span>
<span id="cb410-4"><a href="sect032.html#cb410-4"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb410-5"><a href="sect032.html#cb410-5"></a>       <span class="dt">title =</span> <span class="st">&#39;Relation entre urbanisation et production de CO2 par habitant&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig326"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig326-1.png" alt="Nuage de points simple" width="65%" />
<p class="caption">
Figure 3.29: Nuage de points simple
</p>
</div>
<p>À la première lecture de ce graphique, nous observons immédiatement un ensemble de points étranges dont le volume de CO<sub>2</sub> par habitant annuel est au-dessus de 150 tonnes et dont le niveau d’urbanisation est proche de 50 %. Isolons ces données pour observer de quoi il s’agit.</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="sect032.html#cb411-1"></a>cas_etrange &lt;-<span class="st"> </span><span class="kw">subset</span>(data_co2, data_co2<span class="op">$</span>CO2t_hab <span class="op">&gt;=</span><span class="st"> </span><span class="dv">150</span>)</span>
<span id="cb411-2"><a href="sect032.html#cb411-2"></a><span class="kw">print</span>(cas_etrange<span class="op">$</span>Country.Name)</span></code></pre></div>
<pre><code>##  [1] &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot;
## [10] &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot;
## [19] &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot; &quot;Aruba&quot;</code></pre>
<p>Il s’agit d’une petite île néerlandaise des Caraïbes nommée Aruba disposant d’une faible population, mais avec des activités très polluantes (raffinerie et extraction d’or). Nous faisons ici le choix de retirer ces observations puisqu’elles sont assez peu représentatives de la tendance mondiale. Cette démarche si simple relève ainsi de l’analyse exploratoire des données! Sans ce graphique, nous n’aurions probablement jamais identifié ces cas problématiques.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="sect032.html#cb413-1"></a>data_co2 &lt;-<span class="st"> </span><span class="kw">subset</span>(data_co2, data_co2<span class="op">$</span>CO2t_hab <span class="op">&lt;=</span><span class="st"> </span><span class="dv">150</span>)</span></code></pre></div>
<p>Reconstruisons le nuage de points maintenant que ces données aberrantes ont été retirées.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="sect032.html#cb414-1"></a>graphique &lt;-<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2)<span class="op">+</span></span>
<span id="cb414-2"><a href="sect032.html#cb414-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab))<span class="op">+</span></span>
<span id="cb414-3"><a href="sect032.html#cb414-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Niveau d&#39;urbanisation (%)&quot;</span>,</span>
<span id="cb414-4"><a href="sect032.html#cb414-4"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb414-5"><a href="sect032.html#cb414-5"></a>       <span class="dt">title =</span> <span class="st">&#39;Relation entre urbanisation et production de CO2 par habitant&#39;</span>)</span></code></pre></div>
<p>Voilà qui est mieux! Cependant, le grand nombre de points restant rend la lecture du graphique assez difficile puisqu’ils se superposent. Une première option à envisager, dans ce cas, est à la fois d’ajouter de la transparence aux points et de réduire leur taille :</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="sect032.html#cb415-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2)<span class="op">+</span></span>
<span id="cb415-2"><a href="sect032.html#cb415-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab), <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb415-3"><a href="sect032.html#cb415-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Niveau d&#39;urbanisation (%)&quot;</span>,</span>
<span id="cb415-4"><a href="sect032.html#cb415-4"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb415-5"><a href="sect032.html#cb415-5"></a>       <span class="dt">title =</span> <span class="st">&#39;Relation entre urbanisation et production de CO2 par habitant&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig328"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig328-1.png" alt="Nuage de points simple avec transparence" width="65%" />
<p class="caption">
Figure 3.30: Nuage de points simple avec transparence
</p>
</div>
</div>
<div id="sect03232" class="section level4">
<h4><span class="header-section-number">3.2.3.2</span> Nuage de points avec densité</h4>
<p>Bien que la transparence nous aide un peu à distinguer les secteurs du graphique avec le plus de points, il serait plus efficace d’abandonner la géométrie des points pour la remplacer par une géométrie de densité en deux dimensions. Une première approche consiste à diviser l’espace du graphique en petits carrés et à compter le nombre de points tombant dans chaque carré (en somme, un histogramme en deux dimensions).</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="sect032.html#cb416-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2)<span class="op">+</span></span>
<span id="cb416-2"><a href="sect032.html#cb416-2"></a><span class="st">  </span><span class="kw">geom_bin2d</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab), <span class="dt">bins =</span> <span class="dv">50</span>) <span class="op">+</span></span>
<span id="cb416-3"><a href="sect032.html#cb416-3"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">type =</span> <span class="st">&quot;viridis&quot;</span>) <span class="op">+</span></span>
<span id="cb416-4"><a href="sect032.html#cb416-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Niveau d&#39;urbanisation (%)&quot;</span>,</span>
<span id="cb416-5"><a href="sect032.html#cb416-5"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb416-6"><a href="sect032.html#cb416-6"></a>       <span class="dt">fill =</span> <span class="st">&quot;Effectif&quot;</span>,</span>
<span id="cb416-7"><a href="sect032.html#cb416-7"></a>       <span class="dt">title =</span> <span class="st">&#39;Relation entre urbanisation et production de CO2 par habitant&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig329"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig329-1.png" alt="Nuage de points simple" width="65%" />
<p class="caption">
Figure 3.31: Nuage de points simple
</p>
</div>
<p>Nous observons ainsi une forte concentration dans le bas du graphique; les pays avec des rejets annuels de CO<sub>2</sub> supérieurs à 15 tonnes par habitant sont relativement rares. Pour les personnes préférant les représentations plus élaborées, il est aussi possible de diviser l’espace du graphique avec des hexagones en utilisant le <em>package</em> <code>hexbin</code>.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="sect032.html#cb417-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2)<span class="op">+</span></span>
<span id="cb417-2"><a href="sect032.html#cb417-2"></a><span class="st">  </span><span class="kw">geom_hex</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab), <span class="dt">bins =</span> <span class="dv">50</span>) <span class="op">+</span></span>
<span id="cb417-3"><a href="sect032.html#cb417-3"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">type =</span> <span class="st">&quot;viridis&quot;</span>) <span class="op">+</span></span>
<span id="cb417-4"><a href="sect032.html#cb417-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Niveau d&#39;urbanisation (%)&quot;</span>,</span>
<span id="cb417-5"><a href="sect032.html#cb417-5"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb417-6"><a href="sect032.html#cb417-6"></a>       <span class="dt">fill =</span> <span class="st">&quot;Effectif&quot;</span>,</span>
<span id="cb417-7"><a href="sect032.html#cb417-7"></a>       <span class="dt">title =</span> <span class="st">&#39;Relation entre urbanisation et production de CO2 par habitant&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig330"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig330-1.png" alt="Densité en deux dimensions par hexagones" width="65%" />
<p class="caption">
Figure 3.32: Densité en deux dimensions par hexagones
</p>
</div>
<p>Enfin, il est aussi possible de réaliser une version lissée de ces graphiques avec une fonction kernel en deux dimensions (<code>stat_density_2d</code>) :</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="sect032.html#cb418-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2)<span class="op">+</span></span>
<span id="cb418-2"><a href="sect032.html#cb418-2"></a><span class="st">  </span><span class="kw">stat_density_2d</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab, <span class="dt">fill =</span> ..density..), </span>
<span id="cb418-3"><a href="sect032.html#cb418-3"></a>                  <span class="dt">geom =</span> <span class="st">&quot;raster&quot;</span>, <span class="dt">n =</span> <span class="dv">50</span>, <span class="dt">contour =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb418-4"><a href="sect032.html#cb418-4"></a><span class="st">  </span><span class="kw">scale_fill_continuous</span>(<span class="dt">type =</span> <span class="st">&quot;viridis&quot;</span>) <span class="op">+</span></span>
<span id="cb418-5"><a href="sect032.html#cb418-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Niveau d&#39;urbanisation (%)&quot;</span>,</span>
<span id="cb418-6"><a href="sect032.html#cb418-6"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb418-7"><a href="sect032.html#cb418-7"></a>       <span class="dt">fill =</span> <span class="st">&quot;densité&quot;</span>,</span>
<span id="cb418-8"><a href="sect032.html#cb418-8"></a>       <span class="dt">title =</span> <span class="st">&#39;Relation entre urbanisation et production de CO2 par habitant&#39;</span>)<span class="op">+</span></span>
<span id="cb418-9"><a href="sect032.html#cb418-9"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">25</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig331"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig331-1.png" alt="Densité lissée en deux dimensions" width="65%" />
<p class="caption">
Figure 3.33: Densité lissée en deux dimensions
</p>
</div>
</div>
<div id="sect03233" class="section level4">
<h4><span class="header-section-number">3.2.3.3</span> Nuage de points et droite de régression</h4>
<p>Afin de faire ressortir une éventuelle relation entre les variables représentées sur les deux axes, il est possible d’afficher la droite de régression sur le graphique entre X et Y. Cette opération s’effectue avec la fonction <code>geom_smooth</code>.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="sect032.html#cb419-1"></a>graphique &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2)<span class="op">+</span></span>
<span id="cb419-2"><a href="sect032.html#cb419-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab), <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb419-3"><a href="sect032.html#cb419-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab), <span class="dt">method =</span> lm, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb419-4"><a href="sect032.html#cb419-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Niveau d&#39;urbanisation (%)&quot;</span>,</span>
<span id="cb419-5"><a href="sect032.html#cb419-5"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb419-6"><a href="sect032.html#cb419-6"></a>       <span class="dt">title =</span> <span class="st">&#39;Relation entre urbanisation et production de CO2 par habitant&#39;</span>)</span></code></pre></div>
<p>Notez que l’argument <code>method = lm</code> permet d’indiquer que nous souhaitons utiliser une régression linéaire (<em>linear model</em>) pour tracer la géométrie (une droite de régression). La droite semble bien indiquer une relation positive entre les deux variables : une augmentation de l’urbanisation serait associée à une augmentation de la production annuelle de CO<sub>2</sub> par habitant. Nous pourrions également vérifier si une relation non linéaire serait plus adaptée au jeu de données. Dans notre cas, une relation quadratique pourrait produire un meilleur ajustement.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="sect032.html#cb420-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2)<span class="op">+</span></span>
<span id="cb420-2"><a href="sect032.html#cb420-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab), <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb420-3"><a href="sect032.html#cb420-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab), <span class="dt">method =</span> lm, </span>
<span id="cb420-4"><a href="sect032.html#cb420-4"></a>              <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">**</span><span class="dv">2</span>))<span class="op">+</span></span>
<span id="cb420-5"><a href="sect032.html#cb420-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Niveau d&#39;urbanisation (%)&quot;</span>,</span>
<span id="cb420-6"><a href="sect032.html#cb420-6"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb420-7"><a href="sect032.html#cb420-7"></a>       <span class="dt">title =</span> <span class="st">&#39;Relation entre urbanisation et production de CO2 par habitant&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig333"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig333-1.png" alt="Nuage de points avec droite de régression quadratique" width="65%" />
<p class="caption">
Figure 3.34: Nuage de points avec droite de régression quadratique
</p>
</div>
<p>La régression quadratique (avec <em>x</em> au carré) nous indique ainsi que l’impact du niveau d’urbanisation est plus important à mesure que ce niveau augmente. Vous pouvez également constater que la courbe ne prédit pas de valeurs négatives comparativement à la droite précédente. Il est également possible d’ajuster une courbe sans choisir au préalable sa forme (dans le cas précédent <span class="math inline">\(x^2\)</span>) en utilisant une méthode d’ajustement local appelée <em>loess</em>.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="sect032.html#cb421-1"></a>graphique &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2)<span class="op">+</span></span>
<span id="cb421-2"><a href="sect032.html#cb421-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab), <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb421-3"><a href="sect032.html#cb421-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Urbanisation, <span class="dt">y =</span> CO2t_hab), <span class="dt">method =</span> loess, </span>
<span id="cb421-4"><a href="sect032.html#cb421-4"></a>              <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb421-5"><a href="sect032.html#cb421-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Niveau d&#39;urbanisation (%)&quot;</span>,</span>
<span id="cb421-6"><a href="sect032.html#cb421-6"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb421-7"><a href="sect032.html#cb421-7"></a>       <span class="dt">title =</span> <span class="st">&#39;Relation entre urbanisation et production de CO2 par habitant&#39;</span>)</span></code></pre></div>
<p>La relation non linéaire révèle davantage d’informations : l’augmentation de l’urbanisation est associée à une augmentation de l’émission de CO<sub>2</sub> par habitant uniquement jusqu’à 75 % d’urbanisation; au-delà de ce seuil, la relation ne tient plus. Ces résultats semblent cohérents avec l’évolution classique de l’économie d’un pays passant progressivement d’une économie agricole, à une économie industrialisée et finalement une économie de services.</p>
</div>
</div>
<div id="sect0324" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Graphique en ligne</h3>
<p>Un graphique en ligne permet de représenter l’évolution d’une variable, généralement dans le temps. Dans le jeu de données précédent, nous disposons des émissions de CO<sub>2</sub> par habitant de nombreux pays sur plusieurs années. Nous pouvons ainsi représenter l’évolution des émissions pour chaque pays avec un graphique en ligne. Pour éviter de le surcharger, cet exercice est réalisé uniquement sur les pays de l’Europe de l’Ouest.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="sect032.html#cb422-1"></a><span class="co"># conversion de la variable year textuelle en variable numérique</span></span>
<span id="cb422-2"><a href="sect032.html#cb422-2"></a>data_co2<span class="op">$</span>an &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(data_co2<span class="op">$</span>year)</span>
<span id="cb422-3"><a href="sect032.html#cb422-3"></a><span class="co"># extraction des données d&#39;Europe de l&#39;Ouest</span></span>
<span id="cb422-4"><a href="sect032.html#cb422-4"></a>data_europe &lt;-<span class="st"> </span><span class="kw">subset</span>(data_co2, data_co2<span class="op">$</span>region23 <span class="op">==</span><span class="st"> &quot;Europe de l&#39;Ouest&quot;</span>)</span>
<span id="cb422-5"><a href="sect032.html#cb422-5"></a><span class="co"># choix des valeurs pour l&#39;axe des x</span></span>
<span id="cb422-6"><a href="sect032.html#cb422-6"></a>x_ticks &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1960</span>,<span class="dv">2020</span>,<span class="dv">10</span>)</span>
<span id="cb422-7"><a href="sect032.html#cb422-7"></a></span>
<span id="cb422-8"><a href="sect032.html#cb422-8"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_europe)<span class="op">+</span></span>
<span id="cb422-9"><a href="sect032.html#cb422-9"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> an, <span class="dt">y =</span> CO2t_hab, <span class="dt">color =</span> Country.Name))<span class="op">+</span></span>
<span id="cb422-10"><a href="sect032.html#cb422-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Années&quot;</span>,</span>
<span id="cb422-11"><a href="sect032.html#cb422-11"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb422-12"><a href="sect032.html#cb422-12"></a>       <span class="dt">color =</span> <span class="st">&quot;Pays&quot;</span>,</span>
<span id="cb422-13"><a href="sect032.html#cb422-13"></a>       <span class="dt">title =</span> <span class="st">&#39;Évolution de la production de CO2 par habitant&#39;</span>) <span class="op">+</span></span>
<span id="cb422-14"><a href="sect032.html#cb422-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> x_ticks, <span class="dt">labels =</span> x_ticks)<span class="op">+</span></span>
<span id="cb422-15"><a href="sect032.html#cb422-15"></a><span class="st">  </span><span class="kw">theme_tufte</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig335"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig335-1.png" alt="Graphique en ligne" width="65%" />
<p class="caption">
Figure 3.35: Graphique en ligne
</p>
</div>
<p>Nous remarquons notamment qu’aucune donnée, avant 2005, n’est disponible pour le Liechtenstein.</p>
<div id="sect03241" class="section level4">
<h4><span class="header-section-number">3.2.4.1</span> Barre d’erreur et en bande</h4>
<p>Sur un graphique, il est souvent pertinent de représenter l’incertitude que nous avons sur nos données. Cela peut être fait à l’aide de barres d’erreur ou à l’aide de polygones délimitant les marges d’incertitude. En guise d’exemple, admettons que les données précédentes sont fiables à plus ou moins 10 %. En d’autres termes, la valeur d’émission de CO<sub>2</sub> annuelle serait relativement incertaine et pourrait se situer dans un intervalle de 10 % autour de la valeur fournie par la Banque mondiale. Nous obtenons ainsi une borne inférieure (valeur donnée - 10 %) et une borne supérieure (valeur donnée + 10 %). Nous pouvons facilement calculer ces bornes et les faire apparaître dans notre graphique précédent.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="sect032.html#cb423-1"></a>data_europe<span class="op">$</span>borne_basse &lt;-<span class="st"> </span>data_europe<span class="op">$</span>CO2t_hab <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span>data_europe<span class="op">$</span>CO2t_hab</span>
<span id="cb423-2"><a href="sect032.html#cb423-2"></a>data_europe<span class="op">$</span>borne_haute &lt;-<span class="st"> </span>data_europe<span class="op">$</span>CO2t_hab <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span> <span class="op">*</span><span class="st"> </span>data_europe<span class="op">$</span>CO2t_hab</span>
<span id="cb423-3"><a href="sect032.html#cb423-3"></a></span>
<span id="cb423-4"><a href="sect032.html#cb423-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_europe)<span class="op">+</span></span>
<span id="cb423-5"><a href="sect032.html#cb423-5"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> an, <span class="dt">y =</span> CO2t_hab, <span class="dt">color =</span> Country.Name), <span class="dt">size =</span> <span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb423-6"><a href="sect032.html#cb423-6"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> an, <span class="dt">ymin =</span> borne_basse, <span class="dt">ymax =</span> borne_haute, <span class="dt">color =</span> Country.Name))<span class="op">+</span></span>
<span id="cb423-7"><a href="sect032.html#cb423-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Années&quot;</span>,</span>
<span id="cb423-8"><a href="sect032.html#cb423-8"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb423-9"><a href="sect032.html#cb423-9"></a>       <span class="dt">color =</span> <span class="st">&quot;Pays&quot;</span>,</span>
<span id="cb423-10"><a href="sect032.html#cb423-10"></a>       <span class="dt">title =</span> <span class="st">&#39;Évolution de la production de CO2 par habitant&#39;</span>) <span class="op">+</span></span>
<span id="cb423-11"><a href="sect032.html#cb423-11"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> x_ticks, <span class="dt">labels =</span> x_ticks)<span class="op">+</span></span>
<span id="cb423-12"><a href="sect032.html#cb423-12"></a><span class="st">  </span><span class="kw">theme_tufte</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig336"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig336-1.png" alt="Graphique en ligne avec barres d'erreur" width="65%" />
<p class="caption">
Figure 3.36: Graphique en ligne avec barres d’erreur
</p>
</div>
<p>Ces barres d’erreurs indiquent notamment qu’il n’y a finalement aucun écart significatif entre la Belgique, les Pays-Bas et l’Allemagne à partir des années 1990. Une autre option de représentation est d’utiliser des polygones avec la fonction <code>geom_ribbon</code>.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="sect032.html#cb424-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_europe)<span class="op">+</span></span>
<span id="cb424-2"><a href="sect032.html#cb424-2"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> an, <span class="dt">y =</span> CO2t_hab, <span class="dt">color =</span> Country.Name), <span class="dt">size =</span> <span class="fl">0.7</span>)<span class="op">+</span></span>
<span id="cb424-3"><a href="sect032.html#cb424-3"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x =</span> an, <span class="dt">ymin =</span> borne_basse, <span class="dt">ymax =</span> borne_haute,</span>
<span id="cb424-4"><a href="sect032.html#cb424-4"></a>                  <span class="dt">fill =</span> Country.Name), <span class="dt">alpha =</span> <span class="fl">0.4</span>)<span class="op">+</span></span>
<span id="cb424-5"><a href="sect032.html#cb424-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Années&quot;</span>,</span>
<span id="cb424-6"><a href="sect032.html#cb424-6"></a>       <span class="dt">y =</span> <span class="st">&#39;Tonnes de CO2 annuelle / habitant&#39;</span>,</span>
<span id="cb424-7"><a href="sect032.html#cb424-7"></a>       <span class="dt">color =</span> <span class="st">&quot;Pays&quot;</span>,</span>
<span id="cb424-8"><a href="sect032.html#cb424-8"></a>       <span class="dt">title =</span> <span class="st">&#39;Évolution de la production de CO2 par habitant&#39;</span>) <span class="op">+</span></span>
<span id="cb424-9"><a href="sect032.html#cb424-9"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> x_ticks, <span class="dt">labels =</span> x_ticks)<span class="op">+</span></span>
<span id="cb424-10"><a href="sect032.html#cb424-10"></a><span class="st">  </span><span class="kw">theme_tufte</span>()<span class="op">+</span></span>
<span id="cb424-11"><a href="sect032.html#cb424-11"></a><span class="st">  </span><span class="kw">guides</span>( <span class="dt">fill =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig337"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig337-1.png" alt="Graphique en ligne avec marge d'erreur" width="65%" />
<p class="caption">
Figure 3.37: Graphique en ligne avec marge d’erreur
</p>
</div>
<p>Le message du graphique est le même. Notez que nous avons utilisé ici la fonction <code>guides</code> pour retirer de la légende les couleurs associées au remplissage des marges d’erreur. Ces couleurs sont les mêmes que celles des lignes et il n’est pas utile de dédoubler la légende. De nombreuses méthodes statistiques produisent des résultats accompagnés d’une mesure de l’incertitude associée à ces résultats. Représenter cette incertitude est crucial pour que le lecteur puisse délimiter la portée des conclusions de vos analyses.</p>
</div>
</div>
<div id="sect0325" class="section level3">
<h3><span class="header-section-number">3.2.5</span> Boîte à moustaches</h3>
<p>Les boîtes à moustaches (<em>box plot</em> en anglais) sont des graphiques permettant de comparer les moyennes et les intervalles interquartiles d’une variable continue selon plusieurs groupes d’une population. Si nous reprenons notre exemple précédent, nous pourrions comparer, en fonction de la région du monde, la moyenne de production annuelle de CO<sub>2</sub> par habitant. Pour cela, il suffit d’utiliser la fonction <code>geom_boxplot</code>.</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="sect032.html#cb425-1"></a><span class="co">#retirer les observations n&#39;étant pas associées à une région</span></span>
<span id="cb425-2"><a href="sect032.html#cb425-2"></a>data_co2_comp &lt;-<span class="st"> </span><span class="kw">subset</span>(data_co2, <span class="kw">is.na</span>(data_co2<span class="op">$</span>region7) <span class="op">==</span><span class="st"> </span>F)</span>
<span id="cb425-3"><a href="sect032.html#cb425-3"></a></span>
<span id="cb425-4"><a href="sect032.html#cb425-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2_comp)<span class="op">+</span></span>
<span id="cb425-5"><a href="sect032.html#cb425-5"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> region7, <span class="dt">x =</span> CO2t_hab))<span class="op">+</span></span>
<span id="cb425-6"><a href="sect032.html#cb425-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Tonnes de CO2 par an et habitant&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Région&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig338"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig338-1.png" alt="Boîtes à moustaches" width="65%" />
<p class="caption">
Figure 3.38: Boîtes à moustaches
</p>
</div>
<p>La barre centrale d’une boîte représente la moyenne. Les extrémités de la boîte représentent le premier et le troisième quartile. Plus une boîte est allongée, plus les situations sont diversifiées pour les observations appartenant au groupe représenté par la boîte. Au contraire, une boîte étroite indique un groupe homogène. Notez qu’en inversant les variables dans les axes <em>X</em> et <em>Y</em>, nous obtiendrions des boîtes à moustaches verticales. Cependant, les noms des régions étant assez longs, cela nécessiterait d’avoir un graphique très large. Améliorons quelque peu le rendu de ce graphique en ajoutant des titres.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="sect032.html#cb426-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2_comp)<span class="op">+</span></span>
<span id="cb426-2"><a href="sect032.html#cb426-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> region7, <span class="dt">x =</span> CO2t_hab))<span class="op">+</span></span>
<span id="cb426-3"><a href="sect032.html#cb426-3"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))<span class="op">+</span></span>
<span id="cb426-4"><a href="sect032.html#cb426-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Tonnes de CO2 par an et habitant&quot;</span>,</span>
<span id="cb426-5"><a href="sect032.html#cb426-5"></a>       <span class="dt">y =</span> <span class="st">&#39;Région&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig339"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig339-1.png" alt="Boîtes à moustaches améliorées" width="65%" />
<p class="caption">
Figure 3.39: Boîtes à moustaches améliorées
</p>
</div>
<p>Les points noirs sur le graphique représentent des valeurs extrêmes, soit des observations situées à plus de 1,5 intervalle interquartile d’une extrémité de la boîte. Pour mieux rendre compte de la densité d’observations le long de chaque boîte à moustaches, il est possible de les représenter directement avec la fonction <code>geom_jitter</code>.</p>
<div class="figure" style="text-align: center"><span id="fig:fig340"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig340-1.png" alt="Boîtes à moustaches avec observations" width="65%" />
<p class="caption">
Figure 3.40: Boîtes à moustaches avec observations
</p>
</div>
<p>Notez que pour éviter que les valeurs extrêmes identifiées par la fonction <code>geom_boxplot</code> se superposent avec les points représentant les observations, nous les avons supprimées avec l’argument <code>outlier.shape = NA</code>.</p>
</div>
<div id="sect0326" class="section level3">
<h3><span class="header-section-number">3.2.6</span> Graphique en violon</h3>
<p>Les boîtes à moustaches donnent des informations pertinentes sur le centre et la dispersion d’une variable en fonction de sous groupes de la population. Cependant, une grande partie de l’information reste masquée par la représentation sous forme de boîte. Une solution est de remplacer la simple boîte par la distribution de la variable étudiée. Nous obtenons ainsi des graphiques en violon (<code>geom_violin</code>). Considérant les très grands écarts que nous avons observés entre les régions avec les boîtes à moustaches, il est préférable de tracer les graphiques en violon en excluant les régions Afrique Sub-Saharienne et Asie du Sud.</p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="sect032.html#cb427-1"></a><span class="co"># retirons les observations de régions que nous ne souhaitons par garder</span></span>
<span id="cb427-2"><a href="sect032.html#cb427-2"></a>data_co2_comp &lt;-<span class="st"> </span><span class="kw">subset</span>(data_co2, (<span class="op">!</span><span class="st"> </span>data_co2<span class="op">$</span>region7 <span class="op">%in%</span><span class="st"> </span></span>
<span id="cb427-3"><a href="sect032.html#cb427-3"></a><span class="st">                                     </span><span class="kw">c</span>(<span class="st">&quot;Sub-Saharan Africa&quot;</span>, <span class="st">&quot;South Asia&quot;</span>)) </span>
<span id="cb427-4"><a href="sect032.html#cb427-4"></a>                        <span class="op">&amp;</span><span class="st"> </span><span class="kw">is.na</span>(data_co2<span class="op">$</span>region7)<span class="op">==</span><span class="ot">FALSE</span>)</span>
<span id="cb427-5"><a href="sect032.html#cb427-5"></a></span>
<span id="cb427-6"><a href="sect032.html#cb427-6"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2_comp)<span class="op">+</span></span>
<span id="cb427-7"><a href="sect032.html#cb427-7"></a><span class="st">  </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">y =</span> region7,<span class="dt">x =</span> CO2t_hab))<span class="op">+</span></span>
<span id="cb427-8"><a href="sect032.html#cb427-8"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))<span class="op">+</span></span>
<span id="cb427-9"><a href="sect032.html#cb427-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Tonnes de CO2 annuelle / habitant&quot;</span>,</span>
<span id="cb427-10"><a href="sect032.html#cb427-10"></a>       <span class="dt">y =</span> <span class="st">&#39;&#39;</span>)<span class="op">+</span></span>
<span id="cb427-11"><a href="sect032.html#cb427-11"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">12</span>, <span class="dt">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig341"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig341-1.png" alt="Graphiques en violon" width="65%" />
<p class="caption">
Figure 3.41: Graphiques en violon
</p>
</div>
<p>Ces distributions permettent notamment de souligner que deux groupes distincts se retrouvent en Amérique du Nord. L’un dont les émissions annuelles de CO<sub>2</sub> par habitant sont inférieures à 12 tonnes (ligne bleue) et l’autre pour lequel elles sont supérieures. En explorant les données, nous constatons que les Bermudes appartiennent au groupe Amérique du Nord, mais ont des niveaux d’émission inférieurs à ceux du Canada et des États-Unis, ce qui explique cette distribution bimodale. Cette information était masquée avec les boîtes à moustaches. Finalement, il est aussi possible de superposer un graphique en violon et une boîte à moustaches pour bénéficier des avantages des deux.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="sect032.html#cb428-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_co2_comp)<span class="op">+</span></span>
<span id="cb428-2"><a href="sect032.html#cb428-2"></a><span class="st">  </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">y =</span> region7,<span class="dt">x =</span> CO2t_hab))<span class="op">+</span></span>
<span id="cb428-3"><a href="sect032.html#cb428-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> region7,<span class="dt">x =</span> CO2t_hab), <span class="dt">width =</span> <span class="fl">0.15</span>)<span class="op">+</span></span>
<span id="cb428-4"><a href="sect032.html#cb428-4"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))<span class="op">+</span></span>
<span id="cb428-5"><a href="sect032.html#cb428-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Tonnes de CO2 annuelle / habitant&quot;</span>,</span>
<span id="cb428-6"><a href="sect032.html#cb428-6"></a>       <span class="dt">y =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig342"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig342-1.png" alt="Graphiques en violon et boîtes à moustaches" width="65%" />
<p class="caption">
Figure 3.42: Graphiques en violon et boîtes à moustaches
</p>
</div>
</div>
<div id="sect0327" class="section level3">
<h3><span class="header-section-number">3.2.7</span> Graphique en barre</h3>
<p>Les graphiques en barre permettent de représenter des quantités (hauteur des barres) réparties dans des catégories (une barre par catégorie). Nous proposons ici un exemple avec des données de déplacements issues de l’<em>Enquête origine-destination 2017 - Région Québec-Lévis</em>, au niveau des grands secteurs. La figure <a href="sect032.html#fig:fig342">3.42</a>, tirée du <a href="https://www.transports.gouv.qc.ca/fr/ministere/Planification-transports/enquetes-origine-destination/quebec/2017/Documents/EOD17_faits_saillants_VF.pdf">rapport</a> intitulé <em>La mobilité des personnes dans la région de Québec-Lévis (Volet Enquête-ménages : faits saillants)</em> délimite ces grands secteurs.</p>
<div class="figure" style="text-align: center"><span id="fig:fig343"></span>
<img src="images/magie_graphiques/carte_secteurs.jpg" alt="Grands secteurs de Québec" width="60%" />
<p class="caption">
Figure 3.43: Grands secteurs de Québec
</p>
</div>
<p>Nous représentons pour chaque secteur le nombre moyen de déplacements entrant et sortant un jour de semaine en heures de pointe. Les données sont présentées sous forme d’une matrice carrée (avec autant de lignes que de colonnes). L’intersection de la ligne A et de la colonne C indique le nombre de personnes partant du secteur A pour se rendre au secteur C. À l’inverse, l’intersection de la ligne C et de la colonne A indique le nombre de personnes partant du secteur C pour se rendre au secteur A. En sommant les valeurs de chaque ligne, nous obtienons le nombre total de départs par secteur tandis que le nombre d’arrivées est la somme de chaque colonne. Ces opérations peuvent simplement être effectuées avec les fonctions <code>rowSums</code> et <code>colSums</code>.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="sect032.html#cb429-1"></a><span class="co"># Chargement des donneées</span></span>
<span id="cb429-2"><a href="sect032.html#cb429-2"></a>matriceOD &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&#39;data/graphique/Quebec_2017_OD_MJ.csv&#39;</span>,</span>
<span id="cb429-3"><a href="sect032.html#cb429-3"></a>                 <span class="dt">header =</span> <span class="ot">FALSE</span>, <span class="dt">sep =</span> <span class="st">&#39;;&#39;</span>) <span class="co"># fichier csv sans entête</span></span>
<span id="cb429-4"><a href="sect032.html#cb429-4"></a></span>
<span id="cb429-5"><a href="sect032.html#cb429-5"></a><span class="co"># Calcul des sommes en lignes et en colonnes</span></span>
<span id="cb429-6"><a href="sect032.html#cb429-6"></a>tot_depart &lt;-<span class="st"> </span><span class="kw">rowSums</span>(matriceOD)</span>
<span id="cb429-7"><a href="sect032.html#cb429-7"></a>tot_arrivee &lt;-<span class="st"> </span><span class="kw">colSums</span>(matriceOD)</span>
<span id="cb429-8"><a href="sect032.html#cb429-8"></a></span>
<span id="cb429-9"><a href="sect032.html#cb429-9"></a><span class="co"># Création d&#39;un DataFrame avec les valeurs et les noms des secteurs</span></span>
<span id="cb429-10"><a href="sect032.html#cb429-10"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">depart =</span> tot_depart,</span>
<span id="cb429-11"><a href="sect032.html#cb429-11"></a>                 <span class="dt">arrivee =</span> tot_arrivee, </span>
<span id="cb429-12"><a href="sect032.html#cb429-12"></a>                 <span class="dt">secteur =</span> <span class="kw">c</span>(<span class="st">&#39;Arr. de Beauport (Québec)&#39;</span>,</span>
<span id="cb429-13"><a href="sect032.html#cb429-13"></a>                            <span class="st">&#39;Arr. de Charlesbourg (Québec)&#39;</span>,</span>
<span id="cb429-14"><a href="sect032.html#cb429-14"></a>                            <span class="st">&#39;Arr. des Rivières (Québec)&#39;</span>,</span>
<span id="cb429-15"><a href="sect032.html#cb429-15"></a>                            <span class="st">&#39;Arr. de la Cité-Limoilou (Québec)&#39;</span>,</span>
<span id="cb429-16"><a href="sect032.html#cb429-16"></a>                            <span class="st">&#39;Arr. de la Haute-Saint-Charles (Québec)&#39;</span>,</span>
<span id="cb429-17"><a href="sect032.html#cb429-17"></a>                            <span class="st">&#39;Arr. de Sainte-Foy-Sillery-Cap-Rouge (Québec)&#39;</span>,</span>
<span id="cb429-18"><a href="sect032.html#cb429-18"></a>                            <span class="st">&#39;Arr.de Desjardins (Lévis)&#39;</span>,</span>
<span id="cb429-19"><a href="sect032.html#cb429-19"></a>                            <span class="st">&#39;Arr. des Chutes–de-la-Chaudière-Est (Lévis)&#39;</span>,</span>
<span id="cb429-20"><a href="sect032.html#cb429-20"></a>                            <span class="st">&#39;Arr. des Chutes de la Chaudière-Ouest (Lévis)&#39;</span>,</span>
<span id="cb429-21"><a href="sect032.html#cb429-21"></a>                            <span class="st">&#39;Ceinture Nord&#39;</span>,</span>
<span id="cb429-22"><a href="sect032.html#cb429-22"></a>                            <span class="st">&#39;Ceinture Sud&#39;</span>,</span>
<span id="cb429-23"><a href="sect032.html#cb429-23"></a>                            <span class="st">&#39;Hors Territoire&#39;</span>),</span>
<span id="cb429-24"><a href="sect032.html#cb429-24"></a>                 <span class="dt">code =</span> <span class="kw">c</span>(<span class="st">&#39;A&#39;</span>,<span class="st">&#39;B&#39;</span>,<span class="st">&#39;C&#39;</span>,<span class="st">&#39;D&#39;</span>,<span class="st">&#39;E&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;G&#39;</span>,<span class="st">&#39;H&#39;</span>,<span class="st">&#39;I&#39;</span>,<span class="st">&#39;J&#39;</span>,<span class="st">&#39;K&#39;</span>,<span class="st">&#39;X&#39;</span>))</span>
<span id="cb429-25"><a href="sect032.html#cb429-25"></a></span>
<span id="cb429-26"><a href="sect032.html#cb429-26"></a><span class="co"># Création des deux graphiques en barre</span></span>
<span id="cb429-27"><a href="sect032.html#cb429-27"></a>plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df)<span class="op">+</span></span>
<span id="cb429-28"><a href="sect032.html#cb429-28"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> code, <span class="dt">weight =</span> depart))<span class="op">+</span></span>
<span id="cb429-29"><a href="sect032.html#cb429-29"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&#39;Départs&#39;</span>,</span>
<span id="cb429-30"><a href="sect032.html#cb429-30"></a>       <span class="dt">x =</span> <span class="st">&#39;total&#39;</span>,</span>
<span id="cb429-31"><a href="sect032.html#cb429-31"></a>       <span class="dt">y =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb429-32"><a href="sect032.html#cb429-32"></a></span>
<span id="cb429-33"><a href="sect032.html#cb429-33"></a>plot2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df)<span class="op">+</span></span>
<span id="cb429-34"><a href="sect032.html#cb429-34"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> code, <span class="dt">weight =</span> arrivee))<span class="op">+</span></span>
<span id="cb429-35"><a href="sect032.html#cb429-35"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&#39;Arrivées&#39;</span>,</span>
<span id="cb429-36"><a href="sect032.html#cb429-36"></a>       <span class="dt">x =</span> <span class="st">&#39;total&#39;</span>,</span>
<span id="cb429-37"><a href="sect032.html#cb429-37"></a>       <span class="dt">y =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb429-38"><a href="sect032.html#cb429-38"></a></span>
<span id="cb429-39"><a href="sect032.html#cb429-39"></a><span class="co"># Stocker les graphiques dans une liste et composer une figure</span></span>
<span id="cb429-40"><a href="sect032.html#cb429-40"></a>list_plot &lt;-<span class="st"> </span><span class="kw">list</span>(plot1, plot2)</span>
<span id="cb429-41"><a href="sect032.html#cb429-41"></a>tot_plot &lt;-<span class="st"> </span><span class="kw">ggarrange</span>(<span class="dt">plotlist =</span> list_plot, <span class="dt">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb429-42"><a href="sect032.html#cb429-42"></a></span>
<span id="cb429-43"><a href="sect032.html#cb429-43"></a><span class="co"># Création d&#39;une légende pour associer le code de chaque secteur </span></span>
<span id="cb429-44"><a href="sect032.html#cb429-44"></a><span class="co"># à son nom. Pour cela nous concaténons en premier les lettres et les noms.</span></span>
<span id="cb429-45"><a href="sect032.html#cb429-45"></a><span class="co"># Nous fusionons ensuite le tout en les séparant par le symbole \n représentant </span></span>
<span id="cb429-46"><a href="sect032.html#cb429-46"></a><span class="co"># un saut de ligne.</span></span>
<span id="cb429-47"><a href="sect032.html#cb429-47"></a>nom_secteurs &lt;-<span class="st"> </span><span class="kw">paste</span>(df<span class="op">$</span>code, df<span class="op">$</span>secteur, <span class="dt">sep=</span> <span class="st">&#39; : &#39;</span>)</span>
<span id="cb429-48"><a href="sect032.html#cb429-48"></a>string_names &lt;-<span class="st"> </span><span class="kw">paste</span>(nom_secteurs, <span class="dt">collapse =</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb429-49"><a href="sect032.html#cb429-49"></a></span>
<span id="cb429-50"><a href="sect032.html#cb429-50"></a>titre &lt;-<span class="st"> &quot;Déplacements journaliers moyens en heures de pointe&quot;</span></span>
<span id="cb429-51"><a href="sect032.html#cb429-51"></a><span class="co"># Production finale de la figure</span></span>
<span id="cb429-52"><a href="sect032.html#cb429-52"></a><span class="kw">annotate_figure</span>(tot_plot,</span>
<span id="cb429-53"><a href="sect032.html#cb429-53"></a>                <span class="dt">top =</span> <span class="kw">text_grob</span>(titre, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">just =</span> <span class="st">&quot;left&quot;</span>),</span>
<span id="cb429-54"><a href="sect032.html#cb429-54"></a>                <span class="dt">right =</span> <span class="kw">text_grob</span>(string_names, <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="dt">size =</span> <span class="dv">8</span>,</span>
<span id="cb429-55"><a href="sect032.html#cb429-55"></a>                                  <span class="dt">just =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">x =</span> <span class="fl">0.05</span>) <span class="co"># position du texte</span></span>
<span id="cb429-56"><a href="sect032.html#cb429-56"></a>                )</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig344"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig344-1.png" alt="Graphiques en barre simples" width="75%" />
<p class="caption">
Figure 3.44: Graphiques en barre simples
</p>
</div>
<p>Plutôt que de représenter les arrivées et les départs dans deux graphiques séparés, il est possible de les empiler dans un même graphique en barre. Nous devons au préalable « faire fondre nos données » avec la fonction <code>melt</code>.</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="sect032.html#cb430-1"></a><span class="co"># Faire fondre le jeu de données (empiler les colonnes depart et arrivee)</span></span>
<span id="cb430-2"><a href="sect032.html#cb430-2"></a>melted_df &lt;-<span class="st"> </span><span class="kw">melt</span>(df, <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">&#39;code&#39;</span>), <span class="dt">measure.vars =</span> <span class="kw">c</span>(<span class="st">&#39;depart&#39;</span>,<span class="st">&#39;arrivee&#39;</span>))</span>
<span id="cb430-3"><a href="sect032.html#cb430-3"></a><span class="kw">names</span>(melted_df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;code&#39;</span>,<span class="st">&#39;deplacement&#39;</span>,<span class="st">&#39;effectif&#39;</span>)</span>
<span id="cb430-4"><a href="sect032.html#cb430-4"></a><span class="co"># Ajouter les accents dans la colonne déplacement</span></span>
<span id="cb430-5"><a href="sect032.html#cb430-5"></a>melted_df<span class="op">$</span>deplacement &lt;-<span class="st"> </span><span class="kw">ifelse</span>(melted_df<span class="op">$</span>deplacement <span class="op">==</span><span class="st"> &#39;depart&#39;</span>, <span class="st">&#39;départs&#39;</span>, <span class="st">&#39;arrivées&#39;</span>)</span>
<span id="cb430-6"><a href="sect032.html#cb430-6"></a></span>
<span id="cb430-7"><a href="sect032.html#cb430-7"></a><span class="co"># Comparaison du format original et du format &quot;fondu&quot;</span></span>
<span id="cb430-8"><a href="sect032.html#cb430-8"></a><span class="kw">head</span>(df)</span></code></pre></div>
<pre><code>##    depart arrivee                                       secteur code
## V1  49241   34777                     Arr. de Beauport (Québec)    A
## V2  48909   36344                 Arr. de Charlesbourg (Québec)    B
## V3  48044   67198                    Arr. des Rivières (Québec)    C
## V4  63132  108138             Arr. de la Cité-Limoilou (Québec)    D
## V5  57367   30859       Arr. de la Haute-Saint-Charles (Québec)    E
## V6  86504  112379 Arr. de Sainte-Foy-Sillery-Cap-Rouge (Québec)    F</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="sect032.html#cb432-1"></a><span class="kw">head</span>(melted_df)</span></code></pre></div>
<pre><code>##   code deplacement effectif
## 1    A     départs    49241
## 2    B     départs    48909
## 3    C     départs    48044
## 4    D     départs    63132
## 5    E     départs    57367
## 6    F     départs    86504</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="sect032.html#cb434-1"></a><span class="co"># Réalisation du graphique</span></span>
<span id="cb434-2"><a href="sect032.html#cb434-2"></a>plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> melted_df)<span class="op">+</span></span>
<span id="cb434-3"><a href="sect032.html#cb434-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> code,<span class="dt">weight =</span> effectif, <span class="dt">fill =</span> deplacement),<span class="dt">color =</span> <span class="st">&#39;#e3e3e3&#39;</span>)<span class="op">+</span></span>
<span id="cb434-4"><a href="sect032.html#cb434-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#e63946&quot;</span>,<span class="st">&quot;#1d3557&quot;</span>))<span class="op">+</span></span>
<span id="cb434-5"><a href="sect032.html#cb434-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> titre,</span>
<span id="cb434-6"><a href="sect032.html#cb434-6"></a>       <span class="dt">y =</span> <span class="st">&#39;Effectifs&#39;</span>,</span>
<span id="cb434-7"><a href="sect032.html#cb434-7"></a>       <span class="dt">x =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb434-8"><a href="sect032.html#cb434-8"></a>       <span class="dt">fill =</span> <span class="st">&#39;Déplacements&#39;</span>)</span>
<span id="cb434-9"><a href="sect032.html#cb434-9"></a></span>
<span id="cb434-10"><a href="sect032.html#cb434-10"></a><span class="kw">annotate_figure</span>(plot1,<span class="dt">right =</span> <span class="kw">text_grob</span>(string_names, <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="dt">size =</span> <span class="dv">7</span>,</span>
<span id="cb434-11"><a href="sect032.html#cb434-11"></a>                                  <span class="dt">just =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">x =</span> <span class="fl">0.05</span>)) <span class="co"># position du texte)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig345"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig345-1.png" alt="Graphique en barre empilée" width="65%" />
<p class="caption">
Figure 3.45: Graphique en barre empilée
</p>
</div>
</div>
<div id="sect0328" class="section level3">
<h3><span class="header-section-number">3.2.8</span> Graphique circulaire</h3>
<p>Une option directe au graphique en barre est le graphique ou diagramme circulaire, appelé aussi graphique en tarte (pour les personnes à la dent sucrée) ou en camembert (pour celles amatrices de fromage). Il est suffissamment connu et utilisé pour qu’aucune présentation ne s’impose. Pour être exact, un graphique en tarte n’est rien d’autre qu’un graphique en barre dont le système de coordonnées a été modifié. Cela impose cependant de calculer à l’avance la position des étiquettes que nous souhaitons ajouter sur le graphique. Reprenons les données de production mondiale de CO<sub>2</sub> et calculons les productions totales par région géographique en 2015.</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="sect032.html#cb435-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb435-2"><a href="sect032.html#cb435-2"></a></span>
<span id="cb435-3"><a href="sect032.html#cb435-3"></a><span class="co"># Extraire les données de 2018 pour lesquelles nous connaissons la région</span></span>
<span id="cb435-4"><a href="sect032.html#cb435-4"></a>data_co2_<span class="dv">2015</span> &lt;-<span class="st"> </span><span class="kw">subset</span>(data_co2,data_co2<span class="op">$</span>year <span class="op">==</span><span class="st"> &quot;2015&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="st"> </span><span class="kw">is.na</span>(data_co2<span class="op">$</span>region7))</span>
<span id="cb435-5"><a href="sect032.html#cb435-5"></a></span>
<span id="cb435-6"><a href="sect032.html#cb435-6"></a><span class="co"># Effectuer la somme du CO2 par région</span></span>
<span id="cb435-7"><a href="sect032.html#cb435-7"></a>co2_<span class="dv">2015</span> &lt;-<span class="st"> </span>data_co2_<span class="dv">2015</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb435-8"><a href="sect032.html#cb435-8"></a><span class="st">  </span><span class="kw">group_by</span>(region7) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb435-9"><a href="sect032.html#cb435-9"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">total_co2 =</span> <span class="kw">sum</span>(CO2_kt,<span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb435-10"><a href="sect032.html#cb435-10"></a></span>
<span id="cb435-11"><a href="sect032.html#cb435-11"></a><span class="co"># Attribuer un code à chaque région pour faciliter la lecture</span></span>
<span id="cb435-12"><a href="sect032.html#cb435-12"></a>co2_<span class="dv">2015</span><span class="op">$</span>code &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>,<span class="st">&quot;F&quot;</span>,<span class="st">&quot;G&quot;</span>)</span>
<span id="cb435-13"><a href="sect032.html#cb435-13"></a></span>
<span id="cb435-14"><a href="sect032.html#cb435-14"></a><span class="co"># Modifier l&#39;ordre des données, calculer les proportions et la position des labels</span></span>
<span id="cb435-15"><a href="sect032.html#cb435-15"></a>df &lt;-<span class="st"> </span>co2_<span class="dv">2015</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb435-16"><a href="sect032.html#cb435-16"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(code)) <span class="op">%&gt;%</span></span>
<span id="cb435-17"><a href="sect032.html#cb435-17"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prop =</span> total_co2 <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(co2_<span class="dv">2015</span><span class="op">$</span>total_co2) <span class="op">*</span><span class="dv">100</span>) <span class="op">%&gt;%</span></span>
<span id="cb435-18"><a href="sect032.html#cb435-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ypos =</span> <span class="kw">cumsum</span>(prop)<span class="op">-</span><span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>prop )</span>
<span id="cb435-19"><a href="sect032.html#cb435-19"></a></span>
<span id="cb435-20"><a href="sect032.html#cb435-20"></a><span class="co"># Préparer la légende (pourcentages et vrais noms)</span></span>
<span id="cb435-21"><a href="sect032.html#cb435-21"></a>nom_region &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">paste</span>(df<span class="op">$</span>code, <span class="st">&quot; : &quot;</span>, df<span class="op">$</span>region7, <span class="st">&quot;(&quot;</span>, <span class="kw">round</span>(df<span class="op">$</span>prop,<span class="dv">1</span>),<span class="st">&quot;%)&quot;</span>))</span>
<span id="cb435-22"><a href="sect032.html#cb435-22"></a>string_region &lt;-<span class="st"> </span><span class="kw">paste</span>(nom_region, <span class="dt">collapse =</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>)</span>
<span id="cb435-23"><a href="sect032.html#cb435-23"></a></span>
<span id="cb435-24"><a href="sect032.html#cb435-24"></a><span class="co"># Construire le graphique</span></span>
<span id="cb435-25"><a href="sect032.html#cb435-25"></a>plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y=</span>prop, <span class="dt">fill=</span>code)) <span class="op">+</span></span>
<span id="cb435-26"><a href="sect032.html#cb435-26"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">width=</span><span class="dv">1</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb435-27"><a href="sect032.html#cb435-27"></a><span class="st">  </span><span class="kw">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">start=</span><span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb435-28"><a href="sect032.html#cb435-28"></a><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb435-29"><a href="sect032.html#cb435-29"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb435-30"><a href="sect032.html#cb435-30"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ypos, <span class="dt">label =</span> code), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb435-31"><a href="sect032.html#cb435-31"></a><span class="st">  </span><span class="kw">scale_fill_grey</span>()<span class="op">+</span></span>
<span id="cb435-32"><a href="sect032.html#cb435-32"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Proportion du CO2 émis en 2015&quot;</span>)</span>
<span id="cb435-33"><a href="sect032.html#cb435-33"></a></span>
<span id="cb435-34"><a href="sect032.html#cb435-34"></a><span class="co"># Ajouter la légende</span></span>
<span id="cb435-35"><a href="sect032.html#cb435-35"></a><span class="kw">annotate_figure</span>(plot1,<span class="dt">right =</span> <span class="kw">text_grob</span>(string_region, <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="dt">size =</span> <span class="dv">9</span>,</span>
<span id="cb435-36"><a href="sect032.html#cb435-36"></a>                                  <span class="dt">just =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">x =</span> <span class="fl">0.05</span>)) <span class="co"># position du texte)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig346"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig346-1.png" alt="Graphique en tarte" width="65%" />
<p class="caption">
Figure 3.46: Graphique en tarte
</p>
</div>
<p>Si à la place de la géométrie <code>geom_bar</code>, vous utilisez <code>geom_rect</code>, vous pouvez convertir votre graphique en tarte en graphique en anneau (ou en beigne, pour les personnes à la dent sucrée) :</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="sect032.html#cb436-1"></a><span class="co"># Calculer la limite inférieure et supérieure du beigne</span></span>
<span id="cb436-2"><a href="sect032.html#cb436-2"></a>df<span class="op">$</span>ymax &lt;-<span class="st"> </span><span class="kw">cumsum</span>(df<span class="op">$</span>prop)</span>
<span id="cb436-3"><a href="sect032.html#cb436-3"></a>df<span class="op">$</span>ymin &lt;-<span class="st">  </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">head</span>(df<span class="op">$</span>ymax, <span class="dt">n=</span><span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb436-4"><a href="sect032.html#cb436-4"></a></span>
<span id="cb436-5"><a href="sect032.html#cb436-5"></a><span class="co"># Construire le graphique</span></span>
<span id="cb436-6"><a href="sect032.html#cb436-6"></a>plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">ymax=</span>ymax, <span class="dt">ymin=</span>ymin, </span>
<span id="cb436-7"><a href="sect032.html#cb436-7"></a>                        <span class="dt">xmax=</span><span class="dv">4</span>, <span class="dt">xmin=</span><span class="dv">3</span>,</span>
<span id="cb436-8"><a href="sect032.html#cb436-8"></a>                        <span class="dt">y=</span>prop, <span class="dt">fill=</span>code)) <span class="op">+</span></span>
<span id="cb436-9"><a href="sect032.html#cb436-9"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb436-10"><a href="sect032.html#cb436-10"></a><span class="st">  </span><span class="kw">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">start=</span><span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb436-11"><a href="sect032.html#cb436-11"></a><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb436-12"><a href="sect032.html#cb436-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span></span>
<span id="cb436-13"><a href="sect032.html#cb436-13"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="fl">3.5</span>,<span class="dt">y =</span> ypos, <span class="dt">label =</span> code), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb436-14"><a href="sect032.html#cb436-14"></a><span class="st">  </span><span class="kw">scale_fill_grey</span>()<span class="op">+</span></span>
<span id="cb436-15"><a href="sect032.html#cb436-15"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))<span class="op">+</span></span>
<span id="cb436-16"><a href="sect032.html#cb436-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Proportion du CO2 émis en 2015&quot;</span>)</span>
<span id="cb436-17"><a href="sect032.html#cb436-17"></a></span>
<span id="cb436-18"><a href="sect032.html#cb436-18"></a><span class="co"># Ajouter la légende</span></span>
<span id="cb436-19"><a href="sect032.html#cb436-19"></a><span class="kw">annotate_figure</span>(plot1,<span class="dt">right =</span> <span class="kw">text_grob</span>(string_region, <span class="dt">face =</span> <span class="st">&quot;italic&quot;</span>, <span class="dt">size =</span> <span class="dv">8</span>,</span>
<span id="cb436-20"><a href="sect032.html#cb436-20"></a>                                  <span class="dt">just =</span> <span class="st">&quot;left&quot;</span>, <span class="dt">x =</span> <span class="fl">0.05</span>)) <span class="co"># position du texte)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig347"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig347-1.png" alt="Graphique en anneau" width="65%" />
<p class="caption">
Figure 3.47: Graphique en anneau
</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect031.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect033.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MethodesQuantitScSocialesBolR.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
