<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.7 Mise en œuvre dans R | Méthodes quantitatives en sciences sociales : un grand bol d’R</title>
  <meta name="description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7.7 Mise en œuvre dans R | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://laeq.github.io/LivreStatistique_website/" />
  <meta property="og:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="github-repo" content="LAEQ/livre_statistique_Phil_Jere" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.7 Mise en œuvre dans R | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  
  <meta name="twitter:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="twitter:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio et Jérémy Gelb" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect076.html"/>
<link rel="next" href="sect078.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d'R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Un manuel conçu comme un projet collaboratif</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment lire ce livre?</a></li>
<li class="chapter" data-level="" data-path="sect003B.html"><a href="sect003B.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en sciences sociales?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="sect007.html"><a href="sect007.html"><i class="fa fa-check"></i>Dédicace toute spéciale à Cargo et Ambrée</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auteurs.html"><a href="auteurs.html"><i class="fa fa-check"></i>À propos des auteurs</a></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Prise en main de R</a><ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Histoire et philosophie de R</a></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Environnement de travail</a><ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Installation de R</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Environnement RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect0123"><i class="fa fa-check"></i><b>1.2.3</b> Installation et chargement un <em>package</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#aide-disponible"><i class="fa fa-check"></i><b>1.2.4</b> Aide disponible</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Bases du langage R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> <em>Hello World</em>!</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Objets et expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="sect013.html"><a href="sect013.html#sect0_133"><i class="fa fa-check"></i><b>1.3.3</b> Fonctions et arguments</a></li>
<li class="chapter" data-level="1.3.4" data-path="sect013.html"><a href="sect013.html#sect0134"><i class="fa fa-check"></i><b>1.3.4</b> Principaux types de données</a></li>
<li class="chapter" data-level="1.3.5" data-path="sect013.html"><a href="sect013.html#sect0135"><i class="fa fa-check"></i><b>1.3.5</b> Opérateurs</a></li>
<li class="chapter" data-level="1.3.6" data-path="sect013.html"><a href="sect013.html#sect0136"><i class="fa fa-check"></i><b>1.3.6</b> Structures de données</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Manipulation de données</a><ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Manipulation d’un <em>DataFrame</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.5</b> Code R bien structuré</a></li>
<li class="chapter" data-level="1.6" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.6</b> Enregistrement des résultats</a></li>
<li class="chapter" data-level="1.7" data-path="sect018.html"><a href="sect018.html"><i class="fa fa-check"></i><b>1.7</b> Session de travail</a></li>
<li class="chapter" data-level="1.8" data-path="sect019.html"><a href="sect019.html"><i class="fa fa-check"></i><b>1.8</b> Conclusion et ressources pertinentes</a></li>
<li class="chapter" data-level="1.9" data-path="sect0110.html"><a href="sect0110.html"><i class="fa fa-check"></i><b>1.9</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>II Analyses univariées et graphiques dans R</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Statistiques descriptives univariées</a><ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion et types de variable</a><ul>
<li class="chapter" data-level="2.1.1" data-path="sect021.html"><a href="sect021.html#sect0211"><i class="fa fa-check"></i><b>2.1.1</b> Notion de variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="sect021.html"><a href="sect021.html#sect0212"><i class="fa fa-check"></i><b>2.1.2</b> Types de variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Types de données</a><ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Données secondaires <em>versus</em> données primaires</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Données transversales <em>versus</em> données longitudinales</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Données spatiales versus données aspatiales</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Données individuelles <em>versus</em> données agrégées</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Statistique descriptive et statistique inférentielle</a><ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Population, échantillon et inférence</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Deux grandes familles de méthodes statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Notion de distribution</a><ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#définition-générale"><i class="fa fa-check"></i><b>2.4.1</b> Définition générale</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#anatomie-dune-distribution"><i class="fa fa-check"></i><b>2.4.2</b> Anatomie d’une distribution</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#principales-distributions"><i class="fa fa-check"></i><b>2.4.3</b> Principales distributions</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#conclusion-sur-les-distributions"><i class="fa fa-check"></i><b>2.4.4</b> Conclusion sur les distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Statistiques descriptives sur des variables quantitatives</a><ul>
<li class="chapter" data-level="2.5.1" data-path="sect025.html"><a href="sect025.html#sect0251"><i class="fa fa-check"></i><b>2.5.1</b> Paramètres de tendance centrale</a></li>
<li class="chapter" data-level="2.5.2" data-path="sect025.html"><a href="sect025.html#sect0252"><i class="fa fa-check"></i><b>2.5.2</b> Paramètres de position</a></li>
<li class="chapter" data-level="2.5.3" data-path="sect025.html"><a href="sect025.html#sect0253"><i class="fa fa-check"></i><b>2.5.3</b> Paramètres de dispersion</a></li>
<li class="chapter" data-level="2.5.4" data-path="sect025.html"><a href="sect025.html#sect0254"><i class="fa fa-check"></i><b>2.5.4</b> Paramètres de forme</a></li>
<li class="chapter" data-level="2.5.5" data-path="sect025.html"><a href="sect025.html#sect0255"><i class="fa fa-check"></i><b>2.5.5</b> Transformation des variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="sect025.html"><a href="sect025.html#sect0256"><i class="fa fa-check"></i><b>2.5.6</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a><ul>
<li class="chapter" data-level="2.6.1" data-path="sect026.html"><a href="sect026.html#sect0261"><i class="fa fa-check"></i><b>2.6.1</b> Fréquences</a></li>
<li class="chapter" data-level="2.6.2" data-path="sect026.html"><a href="sect026.html#sect0262"><i class="fa fa-check"></i><b>2.6.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sect027.html"><a href="sect027.html"><i class="fa fa-check"></i><b>2.7</b> Statistiques descriptives pondérées : pour aller plus loin</a></li>
<li class="chapter" data-level="2.8" data-path="sect028.html"><a href="sect028.html"><i class="fa fa-check"></i><b>2.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Magie des graphiques</a><ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Philosophie du ggplot2</a><ul>
<li class="chapter" data-level="3.1.1" data-path="sect031.html"><a href="sect031.html#sect0311"><i class="fa fa-check"></i><b>3.1.1</b> Grammaire</a></li>
<li class="chapter" data-level="3.1.2" data-path="sect031.html"><a href="sect031.html#sect0312"><i class="fa fa-check"></i><b>3.1.2</b> Types de géométries</a></li>
<li class="chapter" data-level="3.1.3" data-path="sect031.html"><a href="sect031.html#sect0313"><i class="fa fa-check"></i><b>3.1.3</b> Habillage</a></li>
<li class="chapter" data-level="3.1.4" data-path="sect031.html"><a href="sect031.html#utilisation-des-thèmes"><i class="fa fa-check"></i><b>3.1.4</b> Utilisation des thèmes</a></li>
<li class="chapter" data-level="3.1.5" data-path="sect031.html"><a href="sect031.html#sect0314"><i class="fa fa-check"></i><b>3.1.5</b> Composition d’une figure avec plusieurs graphiques</a></li>
<li class="chapter" data-level="3.1.6" data-path="sect031.html"><a href="sect031.html#sect0315"><i class="fa fa-check"></i><b>3.1.6</b> Couleur</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Principaux graphiques</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0321"><i class="fa fa-check"></i><b>3.2.1</b> Histogramme</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0322"><i class="fa fa-check"></i><b>3.2.2</b> Graphique de densité</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0323"><i class="fa fa-check"></i><b>3.2.3</b> Nuage de points</a></li>
<li class="chapter" data-level="3.2.4" data-path="sect032.html"><a href="sect032.html#sect0324"><i class="fa fa-check"></i><b>3.2.4</b> Graphique en ligne</a></li>
<li class="chapter" data-level="3.2.5" data-path="sect032.html"><a href="sect032.html#sect0325"><i class="fa fa-check"></i><b>3.2.5</b> Boîte à moustaches</a></li>
<li class="chapter" data-level="3.2.6" data-path="sect032.html"><a href="sect032.html#sect0326"><i class="fa fa-check"></i><b>3.2.6</b> Graphique en violon</a></li>
<li class="chapter" data-level="3.2.7" data-path="sect032.html"><a href="sect032.html#sect0327"><i class="fa fa-check"></i><b>3.2.7</b> Graphique en barre</a></li>
<li class="chapter" data-level="3.2.8" data-path="sect032.html"><a href="sect032.html#sect0328"><i class="fa fa-check"></i><b>3.2.8</b> Graphique circulaire</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Graphiques spéciaux</a><ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Graphique en radar</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Diagramme d’accord</a></li>
<li class="chapter" data-level="3.3.3" data-path="sect033.html"><a href="sect033.html#sect0333"><i class="fa fa-check"></i><b>3.3.3</b> Nuage de mots</a></li>
<li class="chapter" data-level="3.3.4" data-path="sect033.html"><a href="sect033.html#sect0334"><i class="fa fa-check"></i><b>3.3.4</b> Carte proportionnelle</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Cartes</a></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Exportation des graphiques</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Conclusion sur les graphiques</a></li>
</ul></li>
<li class="part"><span><b>III Analyses bivariées</b></span></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Relation linéaire entre deux variables quantitatives</a><ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Bref retour sur le postulat de la relation linéaire</a></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Covariance</a><ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Formulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect043.html"><a href="sect043.html"><i class="fa fa-check"></i><b>4.3</b> Corrélation</a><ul>
<li class="chapter" data-level="4.3.1" data-path="sect043.html"><a href="sect043.html#sect0431"><i class="fa fa-check"></i><b>4.3.1</b> Formulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="sect043.html"><a href="sect043.html#sect0432"><i class="fa fa-check"></i><b>4.3.2</b> Interprétation</a></li>
<li class="chapter" data-level="4.3.3" data-path="sect043.html"><a href="sect043.html#sect0433"><i class="fa fa-check"></i><b>4.3.3</b> Corrélations pour des variables anormalement distribuées (coefficient de Spearman, tau de Kendall)</a></li>
<li class="chapter" data-level="4.3.4" data-path="sect043.html"><a href="sect043.html#sect0434"><i class="fa fa-check"></i><b>4.3.4</b> Corrélations robustes (<em>Biweight midcorrelation</em>, <em>Percentage bend correlation</em> et la corrélation <em>pi</em> de Shepherd)</a></li>
<li class="chapter" data-level="4.3.5" data-path="sect043.html"><a href="sect043.html#sect0435"><i class="fa fa-check"></i><b>4.3.5</b> Significativité des coefficients de corrélation</a></li>
<li class="chapter" data-level="4.3.6" data-path="sect043.html"><a href="sect043.html#sect0436"><i class="fa fa-check"></i><b>4.3.6</b> Corrélation partielle</a></li>
<li class="chapter" data-level="4.3.7" data-path="sect043.html"><a href="sect043.html#sect0437"><i class="fa fa-check"></i><b>4.3.7</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.3.8" data-path="sect043.html"><a href="sect043.html#sect0438"><i class="fa fa-check"></i><b>4.3.8</b> Comment rapporter des valeurs de corrélations?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.4</b> Régression linéaire simple</a><ul>
<li class="chapter" data-level="4.4.1" data-path="sect044.html"><a href="sect044.html#sect0441"><i class="fa fa-check"></i><b>4.4.1</b> Principe de base de la régression linéaire simple</a></li>
<li class="chapter" data-level="4.4.2" data-path="sect044.html"><a href="sect044.html#sect0442"><i class="fa fa-check"></i><b>4.4.2</b> Formulation de la droite de régression des moindres carrés ordinaires</a></li>
<li class="chapter" data-level="4.4.3" data-path="sect044.html"><a href="sect044.html#sect0443"><i class="fa fa-check"></i><b>4.4.3</b> Mesure de la qualité d’ajustement du modèle</a></li>
<li class="chapter" data-level="4.4.4" data-path="sect044.html"><a href="sect044.html#sect0444"><i class="fa fa-check"></i><b>4.4.4</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.4.5" data-path="sect044.html"><a href="sect044.html#sect0445"><i class="fa fa-check"></i><b>4.4.5</b> Comment rapporter une régression linéaire simple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Relation entre deux variables qualitatives</a><ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Construction de tableau de contingence</a></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Test du khi-deux</a></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Interprétation d’un tableau de contingence</a></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Relation entre une variable qualitative et une variable quantitative</a><ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Relation entre une variable quantitative et une variable qualitative à deux modalités</a><ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Test <em>t</em> et ses différentes variantes</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Test non paramétrique de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a><ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Analyse de variance</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Test non paramétrique de Kruskal-Wallis</a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="6.2.4" data-path="sect062.html"><a href="sect062.html#sect0624"><i class="fa fa-check"></i><b>6.2.4</b> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Conclusion sur la troisième partie</a></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>IV Modèles de régression</b></span></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Régression linéaire multiple</a><ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Principes de base de la régression linéaire multiple</a><ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Un peu d’équations…</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Hypothèses de la régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Évaluation de la qualité d’ajustement du modèle</a><ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Mesures de la qualité d’un modèle</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Comparaison des modèles incrémentiels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Différentes mesures pour les coefficients de régression</a><ul>
<li class="chapter" data-level="7.4.1" data-path="sect074.html"><a href="sect074.html#sect0741"><i class="fa fa-check"></i><b>7.4.1</b> Coefficients de régression : évaluer l’effet des variables indépendantes</a></li>
<li class="chapter" data-level="7.4.2" data-path="sect074.html"><a href="sect074.html#sect0742"><i class="fa fa-check"></i><b>7.4.2</b> Coefficients de régression standardisés : repérer les variables les plus importantes du modèle</a></li>
<li class="chapter" data-level="7.4.3" data-path="sect074.html"><a href="sect074.html#sect0743"><i class="fa fa-check"></i><b>7.4.3</b> Significativité des coefficients de régression : valeurs de <em>t</em> et de <em>p</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="sect074.html"><a href="sect074.html#sect0744"><i class="fa fa-check"></i><b>7.4.4</b> Intervalle de confiance des coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Introduction de variables explicatives particulières</a><ul>
<li class="chapter" data-level="7.5.1" data-path="sect075.html"><a href="sect075.html#sect0751"><i class="fa fa-check"></i><b>7.5.1</b> Exploration des relations non linéaires</a></li>
<li class="chapter" data-level="7.5.2" data-path="sect075.html"><a href="sect075.html#sect0752"><i class="fa fa-check"></i><b>7.5.2</b> Variable indépendante qualitative dichotomique</a></li>
<li class="chapter" data-level="7.5.3" data-path="sect075.html"><a href="sect075.html#sect0753"><i class="fa fa-check"></i><b>7.5.3</b> Variable indépendante qualitative polytomique</a></li>
<li class="chapter" data-level="7.5.4" data-path="sect075.html"><a href="sect075.html#sect0754"><i class="fa fa-check"></i><b>7.5.4</b> Variables d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sect076.html"><a href="sect076.html"><i class="fa fa-check"></i><b>7.6</b> Diagnostics de la régression</a><ul>
<li class="chapter" data-level="7.6.1" data-path="sect076.html"><a href="sect076.html#sect0761"><i class="fa fa-check"></i><b>7.6.1</b> Nombre d’observations</a></li>
<li class="chapter" data-level="7.6.2" data-path="sect076.html"><a href="sect076.html#sect0762"><i class="fa fa-check"></i><b>7.6.2</b> Normalité des résidus</a></li>
<li class="chapter" data-level="7.6.3" data-path="sect076.html"><a href="sect076.html#sect0763"><i class="fa fa-check"></i><b>7.6.3</b> Linéarité et homoscédasticité des résidus</a></li>
<li class="chapter" data-level="7.6.4" data-path="sect076.html"><a href="sect076.html#sect0764"><i class="fa fa-check"></i><b>7.6.4</b> Absence de multicolinéarité excessive</a></li>
<li class="chapter" data-level="7.6.5" data-path="sect076.html"><a href="sect076.html#sect0766"><i class="fa fa-check"></i><b>7.6.5</b> Absence d’observations aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sect077.html"><a href="sect077.html"><i class="fa fa-check"></i><b>7.7</b> Mise en œuvre dans R</a><ul>
<li class="chapter" data-level="7.7.1" data-path="sect077.html"><a href="sect077.html#sect0771"><i class="fa fa-check"></i><b>7.7.1</b> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
<li class="chapter" data-level="7.7.2" data-path="sect077.html"><a href="sect077.html#sect0772"><i class="fa fa-check"></i><b>7.7.2</b> Comparaison des modèles</a></li>
<li class="chapter" data-level="7.7.3" data-path="sect077.html"><a href="sect077.html#sect0773"><i class="fa fa-check"></i><b>7.7.3</b> Diagnostic sur un modèle</a></li>
<li class="chapter" data-level="7.7.4" data-path="sect077.html"><a href="sect077.html#sect0774"><i class="fa fa-check"></i><b>7.7.4</b> Graphiques pour les effets marginaux</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sect078.html"><a href="sect078.html"><i class="fa fa-check"></i><b>7.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Régressions linéaires généralisées (GLM)</a><ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Qu’est qu’un modèle GLM?</a><ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Formulation d’un GLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Autres distributions et rôle de la fonction de lien</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Conditions d’application</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Résidus et déviance</a></li>
<li class="chapter" data-level="8.1.5" data-path="sect081.html"><a href="sect081.html#sect0815"><i class="fa fa-check"></i><b>8.1.5</b> Vérification l’ajustement</a></li>
<li class="chapter" data-level="8.1.6" data-path="sect081.html"><a href="sect081.html#sect0816"><i class="fa fa-check"></i><b>8.1.6</b> Comparaison de deux modèles GLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Modèles GLM pour des variables qualitatives</a><ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Modèle logistique binomial</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Modèle probit binomial</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Modèle logistique des cotes proportionnelles</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Modèle logistique multinomial</a></li>
<li class="chapter" data-level="8.2.5" data-path="sect082.html"><a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives"><i class="fa fa-check"></i><b>8.2.5</b> Conclusion sur les modèles pour des variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.3</b> Modèles GLM pour des variables de comptage</a><ul>
<li class="chapter" data-level="8.3.1" data-path="sect084.html"><a href="sect084.html#sect0841"><i class="fa fa-check"></i><b>8.3.1</b> Modèle de Poisson</a></li>
<li class="chapter" data-level="8.3.2" data-path="sect084.html"><a href="sect084.html#sect0842"><i class="fa fa-check"></i><b>8.3.2</b> Modèle binomial négatif</a></li>
<li class="chapter" data-level="8.3.3" data-path="sect084.html"><a href="sect084.html#sect0843"><i class="fa fa-check"></i><b>8.3.3</b> Modèle de Poisson avec excès fixe de zéros</a></li>
<li class="chapter" data-level="8.3.4" data-path="sect084.html"><a href="sect084.html#sect0844"><i class="fa fa-check"></i><b>8.3.4</b> Modèle de Poisson avec excès ajusté de zéros</a></li>
<li class="chapter" data-level="8.3.5" data-path="sect084.html"><a href="sect084.html#sect0845"><i class="fa fa-check"></i><b>8.3.5</b> Conclusion sur les modèles destinés à des variables de comptage</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sect085.html"><a href="sect085.html"><i class="fa fa-check"></i><b>8.4</b> Modèles GLM pour des variables continues</a><ul>
<li class="chapter" data-level="8.4.1" data-path="sect085.html"><a href="sect085.html#sect0851"><i class="fa fa-check"></i><b>8.4.1</b> Modèle GLM gaussien</a></li>
<li class="chapter" data-level="8.4.2" data-path="sect085.html"><a href="sect085.html#sect0852"><i class="fa fa-check"></i><b>8.4.2</b> Modèle GLM avec une distribution de Student</a></li>
<li class="chapter" data-level="8.4.3" data-path="sect085.html"><a href="sect085.html#sect0853"><i class="fa fa-check"></i><b>8.4.3</b> Modèle GLM avec distribution Gamma</a></li>
<li class="chapter" data-level="8.4.4" data-path="sect085.html"><a href="sect085.html#sect0854"><i class="fa fa-check"></i><b>8.4.4</b> Modèle GLM avec une distribution bêta</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sect086.html"><a href="sect086.html"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="8.6" data-path="sect087.html"><a href="sect087.html"><i class="fa fa-check"></i><b>8.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Régressions à effets mixtes (GLMM)</a><ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Indépendance des observations et effets de groupes</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Terminologie: effets fixes et effets aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Principes de base des GLMM</a><ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> GLMM avec constantes aléatoires</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.2</b> GLMM avec pentes aléatoires</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.3</b> GLMM avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Conditions d’application des GLMM</a><ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Vérification de la distribution des effets aléatoires</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Homogénéité des variances au sein des groupes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Inférence dans les modèles GLMM</a><ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#sect0941"><i class="fa fa-check"></i><b>9.4.1</b> Inférence pour les effets fixes</a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#sect0942"><i class="fa fa-check"></i><b>9.4.2</b> Inférence pour les effets aléatoires, effet global</a></li>
<li class="chapter" data-level="9.4.3" data-path="sect094.html"><a href="sect094.html#sect0943"><i class="fa fa-check"></i><b>9.4.3</b> Inférence pour les effets aléatoires, des constantes et des pentes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Conclusion sur les GLMM</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Mise en œuvre des GLMM dans R</a><ul>
<li class="chapter" data-level="9.6.1" data-path="sect096.html"><a href="sect096.html#sect0961"><i class="fa fa-check"></i><b>9.6.1</b> Ajustement du modèle avec uniquement une constante aléatoire</a></li>
<li class="chapter" data-level="9.6.2" data-path="sect096.html"><a href="sect096.html#sect0962"><i class="fa fa-check"></i><b>9.6.2</b> Ajustement du modèle avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sect097.html"><a href="sect097.html"><i class="fa fa-check"></i><b>9.7</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Régressions multiniveaux</a><ul>
<li class="chapter" data-level="10.1" data-path="sect101.html"><a href="sect101.html"><i class="fa fa-check"></i><b>10.1</b> Modèles multiniveaux : deux intérêts majeurs</a><ul>
<li class="chapter" data-level="10.1.1" data-path="sect101.html"><a href="sect101.html#sect1011"><i class="fa fa-check"></i><b>10.1.1</b> Répartition de la variance entre les différents niveaux</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect101.html"><a href="sect101.html#sect1012"><i class="fa fa-check"></i><b>10.1.2</b> Estimation des coefficients aux différents niveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect102.html"><a href="sect102.html"><i class="fa fa-check"></i><b>10.2</b> Différents types de modèles multiniveaux</a><ul>
<li class="chapter" data-level="10.2.1" data-path="sect102.html"><a href="sect102.html#sect1021"><i class="fa fa-check"></i><b>10.2.1</b> Description du jeu de données utilisé</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect102.html"><a href="sect102.html#sect1022"><i class="fa fa-check"></i><b>10.2.2</b> Démarche classique pour les modèles multiniveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect103.html"><a href="sect103.html"><i class="fa fa-check"></i><b>10.3</b> Conditions d’application des régressions multiniveaux</a></li>
<li class="chapter" data-level="10.4" data-path="sect104.html"><a href="sect104.html"><i class="fa fa-check"></i><b>10.4</b> Mise en œuvre dans R</a><ul>
<li class="chapter" data-level="10.4.1" data-path="sect104.html"><a href="sect104.html#sect1041"><i class="fa fa-check"></i><b>10.4.1</b> Le modèle vide</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect104.html"><a href="sect104.html#sect1042"><i class="fa fa-check"></i><b>10.4.2</b> Modèle avec les variables indépendantes du niveau 1</a></li>
<li class="chapter" data-level="10.4.3" data-path="sect104.html"><a href="sect104.html#sect1043"><i class="fa fa-check"></i><b>10.4.3</b> Modèle avec les variables indépendantes aux niveaux 1 et 2</a></li>
<li class="chapter" data-level="10.4.4" data-path="sect104.html"><a href="sect104.html#sect10414"><i class="fa fa-check"></i><b>10.4.4</b> Modèle complet avec une interaction</a></li>
<li class="chapter" data-level="10.4.5" data-path="sect104.html"><a href="sect104.html#sect1045"><i class="fa fa-check"></i><b>10.4.5</b> Comparaison des quatre modèles</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect105.html"><a href="sect105.html"><i class="fa fa-check"></i><b>10.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> Modèles généralisés additifs</a><ul>
<li class="chapter" data-level="11.1" data-path="sect111.html"><a href="sect111.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a><ul>
<li class="chapter" data-level="11.1.1" data-path="sect111.html"><a href="sect111.html#sect1111"><i class="fa fa-check"></i><b>11.1.1</b> Non linéarité fonctionnelle</a></li>
<li class="chapter" data-level="11.1.2" data-path="sect111.html"><a href="sect111.html#sect1112"><i class="fa fa-check"></i><b>11.1.2</b> Non linéarité avec des polynomiales</a></li>
<li class="chapter" data-level="11.1.3" data-path="sect111.html"><a href="sect111.html#sect1113"><i class="fa fa-check"></i><b>11.1.3</b> Non linéarité par segments</a></li>
<li class="chapter" data-level="11.1.4" data-path="sect111.html"><a href="sect111.html#sect1114"><i class="fa fa-check"></i><b>11.1.4</b> Non linéarité avec des <em>splines</em></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sect112.html"><a href="sect112.html"><i class="fa fa-check"></i><b>11.2</b> <em>Spline</em> de régression et <em>spline</em> de lissage</a></li>
<li class="chapter" data-level="11.3" data-path="sect113.html"><a href="sect113.html"><i class="fa fa-check"></i><b>11.3</b> Interprétation d’une <em>spline</em></a></li>
<li class="chapter" data-level="11.4" data-path="sect114.html"><a href="sect114.html"><i class="fa fa-check"></i><b>11.4</b> Multicolinéarité non linéaire</a></li>
<li class="chapter" data-level="11.5" data-path="sect115.html"><a href="sect115.html"><i class="fa fa-check"></i><b>11.5</b> <em>Splines</em> avancées</a><ul>
<li class="chapter" data-level="11.5.1" data-path="sect115.html"><a href="sect115.html#sect1151"><i class="fa fa-check"></i><b>11.5.1</b> <em>Splines</em> cycliques</a></li>
<li class="chapter" data-level="11.5.2" data-path="sect115.html"><a href="sect115.html#sect1152"><i class="fa fa-check"></i><b>11.5.2</b> Splines par groupe</a></li>
<li class="chapter" data-level="11.5.3" data-path="sect115.html"><a href="sect115.html#sect1153"><i class="fa fa-check"></i><b>11.5.3</b> <em>Splines</em> multivariées et <em>splines</em> d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="sect116.html"><a href="sect116.html"><i class="fa fa-check"></i><b>11.6</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="11.7" data-path="sect117.html"><a href="sect117.html"><i class="fa fa-check"></i><b>11.7</b> GAMM</a></li>
<li class="chapter" data-level="11.8" data-path="sect118.html"><a href="sect118.html"><i class="fa fa-check"></i><b>11.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>V Analyses exploratoires multivariées</b></span></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> Méthodes factorielles</a><ul>
<li class="chapter" data-level="12.1" data-path="sect121.html"><a href="sect121.html"><i class="fa fa-check"></i><b>12.1</b> Aperçu des méthodes factorielles</a><ul>
<li class="chapter" data-level="12.1.1" data-path="sect121.html"><a href="sect121.html#sect1211"><i class="fa fa-check"></i><b>12.1.1</b> Méthodes factorielles et types de données</a></li>
<li class="chapter" data-level="12.1.2" data-path="sect121.html"><a href="sect121.html#sect1212"><i class="fa fa-check"></i><b>12.1.2</b> Bref historique des méthodes factorielles</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sect122.html"><a href="sect122.html"><i class="fa fa-check"></i><b>12.2</b> Analyses en composantes principales (ACP)</a><ul>
<li class="chapter" data-level="12.2.1" data-path="sect122.html"><a href="sect122.html#sect1221"><i class="fa fa-check"></i><b>12.2.1</b> Recherche d’une simplification</a></li>
<li class="chapter" data-level="12.2.2" data-path="sect122.html"><a href="sect122.html#sect1222"><i class="fa fa-check"></i><b>12.2.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.2.3" data-path="sect122.html"><a href="sect122.html#sect1223"><i class="fa fa-check"></i><b>12.2.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sect123.html"><a href="sect123.html"><i class="fa fa-check"></i><b>12.3</b> Analyse factorielle des correspondances (AFC)</a><ul>
<li class="chapter" data-level="12.3.1" data-path="sect123.html"><a href="sect123.html#sect1231"><i class="fa fa-check"></i><b>12.3.1</b> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
<li class="chapter" data-level="12.3.2" data-path="sect123.html"><a href="sect123.html#sect1232"><i class="fa fa-check"></i><b>12.3.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.3.3" data-path="sect123.html"><a href="sect123.html#sect1233"><i class="fa fa-check"></i><b>12.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="sect124.html"><a href="sect124.html"><i class="fa fa-check"></i><b>12.4</b> Analyse de correspondances multiples (ACM)</a><ul>
<li class="chapter" data-level="12.4.1" data-path="sect124.html"><a href="sect124.html#sect1241"><i class="fa fa-check"></i><b>12.4.1</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.4.2" data-path="sect124.html"><a href="sect124.html#sect1242"><i class="fa fa-check"></i><b>12.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="sect125.html"><a href="sect125.html"><i class="fa fa-check"></i><b>12.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> Méthodes de classification non supervisée</a><ul>
<li class="chapter" data-level="13.1" data-path="sect131.html"><a href="sect131.html"><i class="fa fa-check"></i><b>13.1</b> Méthodes de classification : un aperçu</a></li>
<li class="chapter" data-level="13.2" data-path="sect132.html"><a href="sect132.html"><i class="fa fa-check"></i><b>13.2</b> Notions essentielles en classification</a><ul>
<li class="chapter" data-level="13.2.1" data-path="sect132.html"><a href="sect132.html#sect1321"><i class="fa fa-check"></i><b>13.2.1</b> Distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="sect132.html"><a href="sect132.html#sect1322"><i class="fa fa-check"></i><b>13.2.2</b> Inertie</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="sect133.html"><a href="sect133.html"><i class="fa fa-check"></i><b>13.3</b> Classification ascendante hiérarchique</a><ul>
<li class="chapter" data-level="13.3.1" data-path="sect133.html"><a href="sect133.html#sect1331"><i class="fa fa-check"></i><b>13.3.1</b> Fonctionnement de l’algorithme</a></li>
<li class="chapter" data-level="13.3.2" data-path="sect133.html"><a href="sect133.html#sect1332"><i class="fa fa-check"></i><b>13.3.2</b> Choisir le bon nombre de groupes</a></li>
<li class="chapter" data-level="13.3.3" data-path="sect133.html"><a href="sect133.html#sect1333"><i class="fa fa-check"></i><b>13.3.3</b> Limites de la classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="13.3.4" data-path="sect133.html"><a href="sect133.html#sect1334"><i class="fa fa-check"></i><b>13.3.4</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sect134.html"><a href="sect134.html"><i class="fa fa-check"></i><b>13.4</b> Nuées dynamiques</a><ul>
<li class="chapter" data-level="13.4.1" data-path="sect134.html"><a href="sect134.html#sect1341"><i class="fa fa-check"></i><b>13.4.1</b> <em>K-means</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="sect134.html"><a href="sect134.html#sect1342"><i class="fa fa-check"></i><b>13.4.2</b> K-médianes</a></li>
<li class="chapter" data-level="13.4.3" data-path="sect134.html"><a href="sect134.html#sect1343"><i class="fa fa-check"></i><b>13.4.3</b> K-médoïds</a></li>
<li class="chapter" data-level="13.4.4" data-path="sect134.html"><a href="sect134.html#sect1344"><i class="fa fa-check"></i><b>13.4.4</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="13.4.5" data-path="sect134.html"><a href="sect134.html#sect1346"><i class="fa fa-check"></i><b>13.4.5</b> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sect135.html"><a href="sect135.html"><i class="fa fa-check"></i><b>13.5</b> Conclusion sur la cinquième partie</a></li>
<li class="chapter" data-level="13.6" data-path="sect136.html"><a href="sect136.html"><i class="fa fa-check"></i><b>13.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="annexes.html"><a href="annexes.html"><i class="fa fa-check"></i><b>14</b> Annexes</a><ul>
<li class="chapter" data-level="14.1" data-path="annexe1.html"><a href="annexe1.html"><i class="fa fa-check"></i><b>14.1</b> Table des valeurs critiques de khi-deux</a></li>
<li class="chapter" data-level="14.2" data-path="annexe2.html"><a href="annexe2.html"><i class="fa fa-check"></i><b>14.2</b> Table des valeurs critiques de Fisher</a></li>
<li class="chapter" data-level="14.3" data-path="annexe3.html"><a href="annexe3.html"><i class="fa fa-check"></i><b>14.3</b> Table des valeurs critiques de <em>t</em></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect077" class="section level2">
<h2><span class="header-section-number">7.7</span> Mise en œuvre dans R</h2>
<div id="sect0771" class="section level3">
<h3><span class="header-section-number">7.7.1</span> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></h3>
<p>Les fonctions de base <code>lm</code>, <code>summary()</code> et <code>confint()</code> permettent respectivement 1) de construire un modèle, 2) d’afficher ces résultats et 3) d’obtenir les intervalles de confiance des coefficients de régression :</p>
<ul>
<li><code>monModele &lt;- lm(Y ~X1+X2+..+Xk)</code> avec <em>Y</em> étant la variable dépendante et les variables indépendantes (<code>X1 à Xk</code>) étant séparées par le signe +.</li>
<li><code>summary(monModele)</code></li>
<li><code>confint(monModele, level=.95)</code>.</li>
</ul>
<p>Dans la syntaxe ci-dessous, vous retrouverez les différents modèles abordés dans les sections précédentes; remarquez que toutes que les lignes <code>summary</code> sont mises en commentaires afin de ne pas afficher les résultats des modèles.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="sect077.html#cb682-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb682-2"><a href="sect077.html#cb682-2"></a><span class="kw">load</span>(<span class="st">&quot;data/lm/DataVegetation.RData&quot;</span>)</span>
<span id="cb682-3"><a href="sect077.html#cb682-3"></a></span>
<span id="cb682-4"><a href="sect077.html#cb682-4"></a><span class="co"># 1er modèle de régression</span></span>
<span id="cb682-5"><a href="sect077.html#cb682-5"></a>modele1 &lt;-<span class="st"> </span><span class="kw">lm</span>(VegPct <span class="op">~</span><span class="st"> </span>HABHA<span class="op">+</span>AgeMedian<span class="op">+</span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR,</span>
<span id="cb682-6"><a href="sect077.html#cb682-6"></a>              <span class="dt">data =</span> DataFinal)</span>
<span id="cb682-7"><a href="sect077.html#cb682-7"></a><span class="co"># summary(Modele1)</span></span>
<span id="cb682-8"><a href="sect077.html#cb682-8"></a></span>
<span id="cb682-9"><a href="sect077.html#cb682-9"></a><span class="co"># 2e modèle de régression : fonction polynomiale d&#39;ordre 2 (poly(AgeMedian,2))</span></span>
<span id="cb682-10"><a href="sect077.html#cb682-10"></a>modele2 &lt;-<span class="st"> </span><span class="kw">lm</span>(VegPct <span class="op">~</span><span class="st"> </span>HABHA<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR,</span>
<span id="cb682-11"><a href="sect077.html#cb682-11"></a>              <span class="dt">data =</span> DataFinal)</span>
<span id="cb682-12"><a href="sect077.html#cb682-12"></a><span class="co"># summary(Modele2)</span></span>
<span id="cb682-13"><a href="sect077.html#cb682-13"></a></span>
<span id="cb682-14"><a href="sect077.html#cb682-14"></a><span class="co"># 3e modèle de régression : forme logarithmique (log(HABHA))</span></span>
<span id="cb682-15"><a href="sect077.html#cb682-15"></a>modele3 &lt;-<span class="st"> </span><span class="kw">lm</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR,</span>
<span id="cb682-16"><a href="sect077.html#cb682-16"></a>              <span class="dt">data =</span> DataFinal)</span>
<span id="cb682-17"><a href="sect077.html#cb682-17"></a><span class="co"># summary(Modele3)</span></span>
<span id="cb682-18"><a href="sect077.html#cb682-18"></a></span>
<span id="cb682-19"><a href="sect077.html#cb682-19"></a><span class="co"># 4e modèle de régression : VI dichotomique</span></span>
<span id="cb682-20"><a href="sect077.html#cb682-20"></a><span class="co"># création de la variable dichotomique (VilleMtl)</span></span>
<span id="cb682-21"><a href="sect077.html#cb682-21"></a>DataFinal<span class="op">$</span>VilleMtl &lt;-<span class="st"> </span><span class="kw">ifelse</span>(DataFinal<span class="op">$</span>SDRNOM <span class="op">==</span><span class="st"> &quot;Montréal&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb682-22"><a href="sect077.html#cb682-22"></a>modele4 &lt;-<span class="st"> </span><span class="kw">lm</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR<span class="op">+</span></span>
<span id="cb682-23"><a href="sect077.html#cb682-23"></a><span class="st">                       </span>VilleMtl, <span class="co"># variable dichotomique</span></span>
<span id="cb682-24"><a href="sect077.html#cb682-24"></a>              <span class="dt">data =</span> DataFinal)</span>
<span id="cb682-25"><a href="sect077.html#cb682-25"></a><span class="co"># summary(Modele4)</span></span>
<span id="cb682-26"><a href="sect077.html#cb682-26"></a></span>
<span id="cb682-27"><a href="sect077.html#cb682-27"></a><span class="co"># 5e modèle de régression : VI polytomique</span></span>
<span id="cb682-28"><a href="sect077.html#cb682-28"></a><span class="co"># création de la variable polytomique (Munic)</span></span>
<span id="cb682-29"><a href="sect077.html#cb682-29"></a>DataFinal<span class="op">$</span>Munic &lt;-<span class="st"> </span><span class="kw">relevel</span>(DataFinal<span class="op">$</span>SDRNOM, <span class="dt">ref=</span><span class="st">&quot;Montréal&quot;</span>)</span>
<span id="cb682-30"><a href="sect077.html#cb682-30"></a>modele5 &lt;-<span class="st"> </span><span class="kw">lm</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR<span class="op">+</span></span>
<span id="cb682-31"><a href="sect077.html#cb682-31"></a><span class="st">                       </span>Munic, <span class="dt">data =</span> DataFinal)</span>
<span id="cb682-32"><a href="sect077.html#cb682-32"></a><span class="co"># summary(Modele5)</span></span>
<span id="cb682-33"><a href="sect077.html#cb682-33"></a></span>
<span id="cb682-34"><a href="sect077.html#cb682-34"></a></span>
<span id="cb682-35"><a href="sect077.html#cb682-35"></a><span class="co"># 6e modèle de régression : interaction entre deux VI continues, </span></span>
<span id="cb682-36"><a href="sect077.html#cb682-36"></a><span class="co"># soit DistCBDkm*Pct_014</span></span>
<span id="cb682-37"><a href="sect077.html#cb682-37"></a>modele6 &lt;-<span class="st"> </span><span class="kw">lm</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR<span class="op">+</span></span>
<span id="cb682-38"><a href="sect077.html#cb682-38"></a><span class="st">                       </span>DistCBDkm<span class="op">+</span>DistCBDkm<span class="op">*</span>Pct_<span class="dv">014</span>,</span>
<span id="cb682-39"><a href="sect077.html#cb682-39"></a>                <span class="dt">data =</span> DataFinal)</span>
<span id="cb682-40"><a href="sect077.html#cb682-40"></a><span class="co"># summary(Modele6)</span></span>
<span id="cb682-41"><a href="sect077.html#cb682-41"></a></span>
<span id="cb682-42"><a href="sect077.html#cb682-42"></a><span class="co"># 7e modèle de régression : interaction entre une VI continue et une VI dichotomique,</span></span>
<span id="cb682-43"><a href="sect077.html#cb682-43"></a><span class="co"># soit VilleMtl*Pct_FR</span></span>
<span id="cb682-44"><a href="sect077.html#cb682-44"></a>modele8 &lt;-<span class="st"> </span><span class="kw">lm</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR<span class="op">+</span></span>
<span id="cb682-45"><a href="sect077.html#cb682-45"></a><span class="st">                       </span>VilleMtl<span class="op">*</span>Pct_FR,</span>
<span id="cb682-46"><a href="sect077.html#cb682-46"></a>                <span class="dt">data =</span> DataFinal)</span>
<span id="cb682-47"><a href="sect077.html#cb682-47"></a><span class="co"># summary(Modele7)</span></span></code></pre></div>
<p>À la figure <a href="sect077.html#fig:figOutputRegression">7.12</a>, les résultats de la régression linéaire multiple, obtenus avec la <code>summary(monModele)</code>, sont présentés en quatre sections distinctes :</p>
<ol style="list-style-type: lower-alpha">
<li>Le rappel de l’équation du modèle.</li>
<li>Quelques statistiques descriptives sur les résidus du modèle, soit la différence entre les valeurs observées et prédites.</li>
<li>Un tableau pour les coefficients de régression comprenant plusieurs colonnes, à savoir les coefficients de régression (<code>Estimate</code>), l’erreur type du coefficient (<code>Std. Error</code>), la valeur de <em>t</em> (<code>t value</code>) et la probabilité associée à la valeur de <em>t</em> (<code>Pr(&gt;|t|)</code>). La première ligne de ce tableau (<code>Estimate</code>) est pour la constante (<em>Intercept</em> en anglais) et celles qui suivent sont pour les variables indépendantes.</li>
<li>Les mesures d’ajustement du modèle, dont le RMSE (<code>Residual standard error</code>), les R<sup>2</sup> classique (<code>Multiple R-squared</code>) et ajusté (<code>Adjusted R-squared</code>), la statistique <em>F</em> avec le nombre de degrés de liberté en lignes (nombre d’observations) et en colonnes (<em>n-k-1</em>) ainsi que la valeur de <em>p</em> qui est lui associée (<code>F-statistic:  1223 on 6 and 10203 DF,  p-value: &lt; 2.2e-16</code>).</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:figOutputRegression"></span>
<img src="images/lm/SortiesLM.jpg" alt="Différentes parties obtenues avec la fonction summary(Modèle)" width="75%" />
<p class="caption">
Figure 7.12: Différentes parties obtenues avec la fonction summary(Modèle)
</p>
</div>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="sect077.html#cb683-1"></a><span class="co"># Intervalle de confiance des coefficients à 95 %</span></span>
<span id="cb683-2"><a href="sect077.html#cb683-2"></a><span class="kw">confint</span>(modele3)</span></code></pre></div>
<pre><code>##                            2.5 %        97.5 %
## (Intercept)           50.8684505   54.79255157
## log(HABHA)            -7.1847527   -6.52495353
## poly(AgeMedian, 2)1  -18.5676034   42.53686203
## poly(AgeMedian, 2)2 -313.4726002 -258.81630119
## Pct_014                0.8793672    1.00190861
## Pct_65P                0.2699504    0.34250907
## Pct_MV                -0.0557951   -0.01681481
## Pct_FR                -0.3659445   -0.32269562</code></pre>
</div>
<div id="sect0772" class="section level3">
<h3><span class="header-section-number">7.7.2</span> Comparaison des modèles</h3>
<p>Tel que détaillé à la section <a href="sect073.html#sect0732">7.3.2</a>, pour comparer des modèles imbriqués, il convient d’analyser les valeurs du R<sup>2</sup> ajusté et du <em>F</em> incrémentiel, ce qui peut être fait en trois étapes.</p>
<p><strong>Première étape.</strong> Il peut être judicieux d’afficher l’équation des différents modèles afin de se remémorer les VI introduites dans chacun d’eux, et ce, avec la fonction <code>MonModèle$call$formula</code>.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="sect077.html#cb685-1"></a><span class="co"># Rappel des équations des huit modèles </span></span>
<span id="cb685-2"><a href="sect077.html#cb685-2"></a><span class="kw">print</span>(modele1<span class="op">$</span>call<span class="op">$</span>formula)</span></code></pre></div>
<pre><code>## VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + Pct_MV + Pct_FR</code></pre>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="sect077.html#cb687-1"></a><span class="kw">print</span>(modele2<span class="op">$</span>call<span class="op">$</span>formula)</span></code></pre></div>
<pre><code>## VegPct ~ HABHA + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + 
##     Pct_FR</code></pre>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="sect077.html#cb689-1"></a><span class="kw">print</span>(modele3<span class="op">$</span>call<span class="op">$</span>formula)</span></code></pre></div>
<pre><code>## VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
##     Pct_MV + Pct_FR</code></pre>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="sect077.html#cb691-1"></a><span class="kw">print</span>(modele4<span class="op">$</span>call<span class="op">$</span>formula)</span></code></pre></div>
<pre><code>## VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
##     Pct_MV + Pct_FR + VilleMtl</code></pre>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="sect077.html#cb693-1"></a><span class="kw">print</span>(modele5<span class="op">$</span>call<span class="op">$</span>formula)</span></code></pre></div>
<pre><code>## VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
##     Pct_MV + Pct_FR + Munic</code></pre>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="sect077.html#cb695-1"></a><span class="kw">print</span>(modele6<span class="op">$</span>call<span class="op">$</span>formula)</span></code></pre></div>
<pre><code>## VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
##     Pct_MV + Pct_FR + DistCBDkm + DistCBDkm * Pct_014</code></pre>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="sect077.html#cb697-1"></a><span class="kw">print</span>(modele7<span class="op">$</span>call<span class="op">$</span>formula)</span></code></pre></div>
<pre><code>## VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
##     Pct_MV + Pct_FR + VilleMtl + VilleMtlX_Pct_FR</code></pre>
<p><strong>Deuxième étape.</strong> La syntaxe ci-dessous vous permet de comparer les R<sup>2</sup> ajustés des différents modèles. Nous constatons ainsi que :</p>
<ul>
<li>La valeur du R<sup>2</sup> ajusté du modèle 2 est supérieure à celle du modèle 1 (0,4378 versus 0,4179), signalant que la forme polynomiale d’ordre 2 pour l’âge médian des bâtiments (<code>poly(AgeMedian, 2)</code>) améliore la prédiction comparativement à la forme originelle de (<code>AgeMedian</code>).</li>
<li>La valeur du R<sup>2</sup> ajusté du modèle 3 est supérieure à celle du modèle 2 (0,4653 versus 0,4378), signalant que la forme logarithmique pour la densité de population (<code>log(HABHA)</code>) améliore la prédiction comparativement à la forme originelle (<code>HABHA</code>).</li>
<li>La valeur du R<sup>2</sup> ajusté du modèle 4 est supérieure à celle du modèle 3 (0,4863 versus 0,4653), signalant que l’introduction de la variable dichotomique (<code>VilleMtl</code>) pour la municipalité apporte un gain de variance expliquée non négligeable.</li>
<li>La valeur du R<sup>2</sup> ajusté du modèle 5 est supérieure à celle du modèle 4 (0,5064 versus 0,4863), signalant que l’introduction de la variable polytomique pour les municipalités de l’île de Montréal (<code>Muni</code>) améliore la prédiction du modèle comparativement à la variable dichotomique (<code>VilleMtl</code>).</li>
<li>La valeur du R<sup>2</sup> ajusté du modèle 6 est supérieure à celle du modèle 2 (0,4953 versus 0,4378), signalant que l’introduction d’une variable d’interaction entre deux variables continues (<code>DistCBDkm + DistCBDkm * Pct_014</code>) apporte également un gain substantiel comparativement au modèle 2, ne comprenant pas cette variable d’interaction.</li>
<li>La valeur du R<sup>2</sup> ajusté du modèle 7 est supérieure à celle du modèle 2 (0,4877 versus 0,4378), signalant que l’introduction d’une variable d’interaction entre une variable continue et la variable dichotomique (<code>DistCBDkm + DistCBDkm * Pct_014</code>) apporte également un gain substantiel comparativement au modèle 2, ne comprenant pas cette variable d’interaction.</li>
</ul>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="sect077.html#cb699-1"></a><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Comparaison des R2 ajustés :&quot;</span>,</span>
<span id="cb699-2"><a href="sect077.html#cb699-2"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Modèle 1.&quot;</span>, <span class="kw">round</span>(<span class="kw">summary</span>(modele1)<span class="op">$</span>adj.r.squared,<span class="dv">4</span>), </span>
<span id="cb699-3"><a href="sect077.html#cb699-3"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Modèle 2.&quot;</span>, <span class="kw">round</span>(<span class="kw">summary</span>(modele2)<span class="op">$</span>adj.r.squared,<span class="dv">4</span>), </span>
<span id="cb699-4"><a href="sect077.html#cb699-4"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Modèle 3.&quot;</span>, <span class="kw">round</span>(<span class="kw">summary</span>(modele3)<span class="op">$</span>adj.r.squared,<span class="dv">4</span>), </span>
<span id="cb699-5"><a href="sect077.html#cb699-5"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Modèle 4.&quot;</span>, <span class="kw">round</span>(<span class="kw">summary</span>(modele4)<span class="op">$</span>adj.r.squared,<span class="dv">4</span>), </span>
<span id="cb699-6"><a href="sect077.html#cb699-6"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Modèle 5.&quot;</span>, <span class="kw">round</span>(<span class="kw">summary</span>(modele5)<span class="op">$</span>adj.r.squared,<span class="dv">4</span>), </span>
<span id="cb699-7"><a href="sect077.html#cb699-7"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Modèle 6.&quot;</span>, <span class="kw">round</span>(<span class="kw">summary</span>(modele6)<span class="op">$</span>adj.r.squared,<span class="dv">4</span>), </span>
<span id="cb699-8"><a href="sect077.html#cb699-8"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Modèle 7.&quot;</span>, <span class="kw">round</span>(<span class="kw">summary</span>(modele7)<span class="op">$</span>adj.r.squared,<span class="dv">4</span>)</span>
<span id="cb699-9"><a href="sect077.html#cb699-9"></a>)</span></code></pre></div>
<pre><code>## 
## Comparaison des R2 ajustés : 
## Modèle 1. 0.4179 
## Modèle 2. 0.4378 
## Modèle 3. 0.4653 
## Modèle 4. 0.4863 
## Modèle 5. 0.5064 
## Modèle 6. 0.4953 
## Modèle 7. 0.4877</code></pre>
<p><strong>Troisième étape.</strong> La syntaxe ci-dessous permet d’obtenir le <em>F</em> incrémentiel pour des modèles ne comprenant pas le même nombre de variables dépendantes, et ce, en utilisant la fonction <code>anova(modele1, modele2, ..., modelen)</code>.</p>
<p>Par exemple, la syntaxe <code>anova(modele1, modele2)</code> permet de comparer les deux modèles et signale que le gain de variance expliquée entre les deux modèles (R<sup>2</sup> de 0,4179 et de 0,4378) est significatif (<em>F</em> incrémentiel = 362,64; <em>p</em> &lt; 0,001).</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="sect077.html#cb701-1"></a><span class="co"># Comparaison des deux modèles uniquement (modèles 1 et 2)</span></span>
<span id="cb701-2"><a href="sect077.html#cb701-2"></a><span class="kw">anova</span>(modele1, modele2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + Pct_MV + Pct_FR
## Model 2: VegPct ~ HABHA + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + 
##     Pct_FR
##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1  10203 2046427                                  
## 2  10202 1976182  1     70245 362.64 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Il est aussi possible de comparer plusieurs modèles simultanément. Notez que dans la syntaxe ci-dessous, le troisième modèle n’est pas inclus, car il comprend le même nombre de variables indépendantes que le second modèle; il en va de même pour le sixième modèle comparativement au cinquième. Ici aussi, l’analyse des valeurs de <em>F</em> et de <em>p</em> vous permettent de vérifier si les modèles, et donc leurs R<sup>2</sup> ajustés, sont significativement différents (quand <em>p</em> &lt; 0,05).</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="sect077.html#cb703-1"></a><span class="co"># Comparaison de plusieurs modèles</span></span>
<span id="cb703-2"><a href="sect077.html#cb703-2"></a><span class="kw">anova</span>(modele1, modele2, modele4, modele5, modele7)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: VegPct ~ HABHA + AgeMedian + Pct_014 + Pct_65P + Pct_MV + Pct_FR
## Model 2: VegPct ~ HABHA + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + 
##     Pct_FR
## Model 3: VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
##     Pct_MV + Pct_FR + VilleMtl
## Model 4: VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
##     Pct_MV + Pct_FR + Munic
## Model 5: VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + 
##     Pct_MV + Pct_FR + VilleMtl + VilleMtlX_Pct_FR
##   Res.Df     RSS  Df Sum of Sq        F    Pr(&gt;F)    
## 1  10203 2046427                                     
## 2  10202 1976182   1     70245  412.995 &lt; 2.2e-16 ***
## 3  10201 1805547   1    170636 1003.224 &lt; 2.2e-16 ***
## 4  10188 1732849  13     72698   32.878 &lt; 2.2e-16 ***
## 5  10200 1800664 -12    -67815   33.226 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="bloc_attention">
<p><strong>Quel modèle choisir?</strong></p>
<p>Nous avons déjà évoqué le principe de parcimonie. À titre de rappel, l’ajout de variables indépendantes qui s’avèrent significatives fait inévitablement augmenter la variance expliquée et ainsi la valeur R<sup>2</sup> ajusté. Par contre, elle peut rendre le modèle plus complexe à analyser, voire entraîner un surajustement du modèle. Nous avons vu que l’introduction des variables ditchtomique, polytomique et d’interaction avait pour effet d’augmenter la capacité de prédiction du modèle. Quoi qu’il en soit, le gain de variance expliquée s’élève à environ 4nbsp;% entre le troisième modèle versus le cinquième et le sixième :</p>
<ul>
<li>Modèle 3 (R<sup>2</sup>=0,465). <code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + Pct_FR</code></li>
<li>Modèle 5 (R<sup>2</sup>=0,506). <code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Muni</code></li>
<li>Modèle 6 (R<sup>2</sup>=0,495). <code>VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + Pct_65P + Pct_MV + Pct_FR + DistCBDkm + DistCBDkm * Pct_014</code></li>
</ul>
<p>Par conséquent, il est légitime de se questionner sur le bien-fondé de conserver ces variables indépendantes additionnelles : <code>Muni</code> pour le modèle 5 et <code>DistCBDkm + DistCBDkm * Pct_014</code> pour le modèle 6. Trois options sont alors envisageables :</p>
<ul>
<li>Bien entendu, conservez l’une ou l’autre de ces variables additionnelles si elles sont initialement reliées à votre cadre théorique.</li>
<li>Conservez l’une ou l’autre de ces variables additionnelles si elles permettent de répondre à une question spécifique (non prévue initialement) et si les associations ainsi révélées méritent, selon vous, discussion.</li>
<li>Supprimez-les si leur apport est limité et ne fait que complexifier le modèle.</li>
</ul>
</div>
</div>
<div id="sect0773" class="section level3">
<h3><span class="header-section-number">7.7.3</span> Diagnostic sur un modèle</h3>
<div id="sect07731" class="section level4">
<h4><span class="header-section-number">7.7.3.1</span> Vérification le nombre d’observations</h4>
<p>La syntaxe suivante permet de vérifier si le nombre d’observations est suffisant pour tester le R<sup>2</sup> et chacune des variables indépendantes.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="sect077.html#cb705-1"></a>modele3 &lt;-<span class="st"> </span><span class="kw">lm</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb705-2"><a href="sect077.html#cb705-2"></a><span class="st">                       </span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR, <span class="dt">data =</span> DataFinal)</span>
<span id="cb705-3"><a href="sect077.html#cb705-3"></a></span>
<span id="cb705-4"><a href="sect077.html#cb705-4"></a><span class="co"># Nombre d&#39;observation</span></span>
<span id="cb705-5"><a href="sect077.html#cb705-5"></a>nobs &lt;-<span class="st"> </span><span class="kw">length</span>(modele3<span class="op">$</span>fitted.values)</span>
<span id="cb705-6"><a href="sect077.html#cb705-6"></a></span>
<span id="cb705-7"><a href="sect077.html#cb705-7"></a><span class="co"># Nombre de variables indépendantes (coefficients moins la constante)</span></span>
<span id="cb705-8"><a href="sect077.html#cb705-8"></a>k &lt;-<span class="st"> </span><span class="kw">length</span>(modele3<span class="op">$</span>coefficients)<span class="op">-</span><span class="dv">1</span></span>
<span id="cb705-9"><a href="sect077.html#cb705-9"></a></span>
<span id="cb705-10"><a href="sect077.html#cb705-10"></a><span class="co"># Première règle de pouce</span></span>
<span id="cb705-11"><a href="sect077.html#cb705-11"></a><span class="cf">if</span>(nobs <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span><span class="op">+</span>(<span class="dv">8</span><span class="op">*</span>k)){</span>
<span id="cb705-12"><a href="sect077.html#cb705-12"></a>    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Nombre d&#39;observations suffisant pour tester le R2&quot;</span>)</span>
<span id="cb705-13"><a href="sect077.html#cb705-13"></a>}<span class="cf">else</span>{</span>
<span id="cb705-14"><a href="sect077.html#cb705-14"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Attention! Nombre d&#39;observations insuffisant pour tester le R2&quot;</span>)</span>
<span id="cb705-15"><a href="sect077.html#cb705-15"></a>}</span></code></pre></div>
<pre><code>## 
## Nombre d&#39;observations suffisant pour tester le R2</code></pre>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="sect077.html#cb707-1"></a><span class="co"># Deuxième règle de pouce</span></span>
<span id="cb707-2"><a href="sect077.html#cb707-2"></a><span class="cf">if</span>(nobs <span class="op">&gt;=</span><span class="st"> </span><span class="dv">104</span><span class="op">+</span>k){</span>
<span id="cb707-3"><a href="sect077.html#cb707-3"></a>    <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Nombre d&#39;observations suffisant pour tester individuellement chaque VI&quot;</span>)</span>
<span id="cb707-4"><a href="sect077.html#cb707-4"></a>}<span class="cf">else</span>{</span>
<span id="cb707-5"><a href="sect077.html#cb707-5"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Attention! Nombre d&#39;observations insuffisant&quot;</span>,</span>
<span id="cb707-6"><a href="sect077.html#cb707-6"></a>  <span class="st">&quot;</span><span class="ch">\n</span><span class="st">pour tester individuellement chaque VI&quot;</span>)</span>
<span id="cb707-7"><a href="sect077.html#cb707-7"></a>}</span></code></pre></div>
<pre><code>## 
## Nombre d&#39;observations suffisant pour tester individuellement chaque VI</code></pre>
</div>
<div id="sect07732" class="section level4">
<h4><span class="header-section-number">7.7.3.2</span> Vérification la normalité des résidus</h4>
<p>La syntaxe suivante permet de vérifier la normalité des résidus selon les trois démarches classiques : 1) coefficients d’asymétrie et d’aplatissement, 2) test de normalité de Jarque-Bera (fonction <code>JarqueBeraTest</code> du <em>package</em> <code>DescTools</code>) et 3) les graphiques (histogramme avec courbe normale et diagramme quantile-quantile).</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="sect077.html#cb709-1"></a><span class="kw">library</span>(DescTools)</span>
<span id="cb709-2"><a href="sect077.html#cb709-2"></a><span class="kw">library</span>(stats)</span>
<span id="cb709-3"><a href="sect077.html#cb709-3"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb709-4"><a href="sect077.html#cb709-4"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb709-5"><a href="sect077.html#cb709-5"></a></span>
<span id="cb709-6"><a href="sect077.html#cb709-6"></a><span class="co"># Vecteur pour les résidus du modèle</span></span>
<span id="cb709-7"><a href="sect077.html#cb709-7"></a>residus &lt;-<span class="st"> </span>modele3<span class="op">$</span>residuals</span>
<span id="cb709-8"><a href="sect077.html#cb709-8"></a></span>
<span id="cb709-9"><a href="sect077.html#cb709-9"></a><span class="co"># 1. coefficients d’asymétrie et d’aplatissement </span></span>
<span id="cb709-10"><a href="sect077.html#cb709-10"></a><span class="kw">c</span>(<span class="dt">Skewness=</span> <span class="kw">round</span>(DescTools<span class="op">::</span><span class="kw">Skew</span>(residus),<span class="dv">3</span>), </span>
<span id="cb709-11"><a href="sect077.html#cb709-11"></a>  <span class="dt">Kurtosis =</span> <span class="kw">round</span>(DescTools<span class="op">::</span><span class="kw">Kurt</span>(residus),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Skewness Kurtosis 
##   -0.263    1.149</code></pre>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="sect077.html#cb711-1"></a><span class="co"># 2. Test de normalité de Jarque-Bera</span></span>
<span id="cb711-2"><a href="sect077.html#cb711-2"></a><span class="kw">JarqueBeraTest</span>(residus)</span></code></pre></div>
<pre><code>## 
##  Robust Jarque Bera Test
## 
## data:  residus
## X-squared = 528.51, df = 2, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="sect077.html#cb713-1"></a><span class="co"># 3. Graphiques </span></span>
<span id="cb713-2"><a href="sect077.html#cb713-2"></a>Ghisto &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb713-3"><a href="sect077.html#cb713-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> residus, <span class="dt">y =</span> ..density..),</span>
<span id="cb713-4"><a href="sect077.html#cb713-4"></a>                 <span class="dt">bins =</span> <span class="dv">30</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>) <span class="op">+</span></span>
<span id="cb713-5"><a href="sect077.html#cb713-5"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </span>
<span id="cb713-6"><a href="sect077.html#cb713-6"></a>                <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(residus),</span>
<span id="cb713-7"><a href="sect077.html#cb713-7"></a>                            <span class="dt">sd =</span> <span class="kw">sd</span>(residus)), </span>
<span id="cb713-8"><a href="sect077.html#cb713-8"></a>                <span class="dt">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb713-9"><a href="sect077.html#cb713-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Histogramme et courbe normale&quot;</span>,</span>
<span id="cb713-10"><a href="sect077.html#cb713-10"></a>      <span class="dt">y =</span> <span class="st">&quot;densité&quot;</span>, <span class="st">&quot;Résidus du modèle&quot;</span>)</span>
<span id="cb713-11"><a href="sect077.html#cb713-11"></a></span>
<span id="cb713-12"><a href="sect077.html#cb713-12"></a>Gqqplot &lt;-<span class="st"> </span><span class="kw">qplot</span>(<span class="dt">sample =</span> residus)<span class="op">+</span></span>
<span id="cb713-13"><a href="sect077.html#cb713-13"></a><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">line.p =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>),</span>
<span id="cb713-14"><a href="sect077.html#cb713-14"></a>               <span class="dt">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="dt">size=</span><span class="fl">1.2</span>)<span class="op">+</span></span>
<span id="cb713-15"><a href="sect077.html#cb713-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Diagramme quantile-quantile&quot;</span>,</span>
<span id="cb713-16"><a href="sect077.html#cb713-16"></a>     <span class="dt">x=</span><span class="st">&quot;Valeurs théoriques&quot;</span>,</span>
<span id="cb713-17"><a href="sect077.html#cb713-17"></a>     <span class="dt">y =</span> <span class="st">&quot;Résidus&quot;</span>)</span>
<span id="cb713-18"><a href="sect077.html#cb713-18"></a></span>
<span id="cb713-19"><a href="sect077.html#cb713-19"></a><span class="kw">ggarrange</span>(Ghisto, Gqqplot, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:VerifierNormaliteResidusDia"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/VerifierNormaliteResidusDia-1.png" alt="Diagnostic : la normalité des résidus" width="75%" />
<p class="caption">
Figure 7.13: Diagnostic : la normalité des résidus
</p>
</div>
</div>
<div id="sect07733" class="section level4">
<h4><span class="header-section-number">7.7.3.3</span> Évaluation de la linéarité et l’homoscédasticité des résidus</h4>
<p>La syntaxe suivante permet de vérifier si l’hypothèse d’homoscédasticité des résidus est respectée avec : 1) un nuage de points entre les valeurs prédites et des résidus, 3) les graphiques (histogramme avec courbe normale et diagramme quantile-quantile) et 2) le test de Breusch-Pagan (fonction <code>bptest</code> du <em>package</em> <code>lmtest</code>).</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="sect077.html#cb714-1"></a><span class="co"># 1. Test de Breusch-Pagan pour vérifier l&#39;homoscédasticité</span></span>
<span id="cb714-2"><a href="sect077.html#cb714-2"></a><span class="kw">library</span>(lmtest)</span>
<span id="cb714-3"><a href="sect077.html#cb714-3"></a><span class="kw">bptest</span>(modele3)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  modele3
## BP = 1651.5, df = 7, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="sect077.html#cb716-1"></a><span class="cf">if</span>(<span class="kw">bptest</span>(modele3)<span class="op">$</span>p.value <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span>){</span>
<span id="cb716-2"><a href="sect077.html#cb716-2"></a>  <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Attention : problème d&#39;hétéroscédasticité des résidus&quot;</span>)</span>
<span id="cb716-3"><a href="sect077.html#cb716-3"></a>}<span class="cf">else</span>{</span>
<span id="cb716-4"><a href="sect077.html#cb716-4"></a>   <span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Parfait : homoscédasticité des résidus&quot;</span>)</span>
<span id="cb716-5"><a href="sect077.html#cb716-5"></a>}</span></code></pre></div>
<pre><code>## 
## Attention : problème d&#39;hétéroscédasticité des résidus</code></pre>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="sect077.html#cb718-1"></a><span class="co"># 2. Graphique entre les valeurs prédites et les résidus</span></span>
<span id="cb718-2"><a href="sect077.html#cb718-2"></a>residus &lt;-<span class="st">  </span>modele3<span class="op">$</span>residuals</span>
<span id="cb718-3"><a href="sect077.html#cb718-3"></a>ypredits &lt;-<span class="st"> </span>modele3<span class="op">$</span>fitted.values</span>
<span id="cb718-4"><a href="sect077.html#cb718-4"></a></span>
<span id="cb718-5"><a href="sect077.html#cb718-5"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb718-6"><a href="sect077.html#cb718-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ypredits, <span class="dt">y =</span> residus),</span>
<span id="cb718-7"><a href="sect077.html#cb718-7"></a>                 <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>,</span>
<span id="cb718-8"><a href="sect077.html#cb718-8"></a>                 <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb718-9"><a href="sect077.html#cb718-9"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ypredits, <span class="dt">y =</span> residus), </span>
<span id="cb718-10"><a href="sect077.html#cb718-10"></a>              <span class="dt">method =</span> lm, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb718-11"><a href="sect077.html#cb718-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Valeurs prédites&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Résidus&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:DiaHomoscedasticite"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/DiaHomoscedasticite-1.png" alt="Distribution des résidus en fonction des valeurs prédites" width="75%" />
<p class="caption">
Figure 7.14: Distribution des résidus en fonction des valeurs prédites
</p>
</div>
</div>
<div id="sect07734" class="section level4">
<h4><span class="header-section-number">7.7.3.4</span> Vérification la multicolinéarité excessive</h4>
<p>Pour vérifier la présence ou l’absence de multicolinéarité excessive, nous utilisons habituellement la fonction <code>vif</code> du <em>package</em> <code>car</code>.</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="sect077.html#cb719-1"></a><span class="kw">library</span>(car)</span>
<span id="cb719-2"><a href="sect077.html#cb719-2"></a></span>
<span id="cb719-3"><a href="sect077.html#cb719-3"></a><span class="co"># facteur d&#39;inflation de la variance</span></span>
<span id="cb719-4"><a href="sect077.html#cb719-4"></a><span class="kw">round</span>(car<span class="op">::</span><span class="kw">vif</span>(modele3),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                     GVIF Df GVIF^(1/(2*Df))
## log(HABHA)         1.289  1           1.136
## poly(AgeMedian, 2) 1.387  2           1.085
## Pct_014            1.518  1           1.232
## Pct_65P            1.304  1           1.142
## Pct_MV             1.480  1           1.217
## Pct_FR             1.730  1           1.315</code></pre>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="sect077.html#cb721-1"></a><span class="co"># problème de multicolinéarité (VIF &gt; 10)?</span></span>
<span id="cb721-2"><a href="sect077.html#cb721-2"></a>car<span class="op">::</span><span class="kw">vif</span>(modele3) <span class="op">&gt;</span><span class="st"> </span><span class="dv">10</span></span></code></pre></div>
<pre><code>##                     GVIF    Df GVIF^(1/(2*Df))
## log(HABHA)         FALSE FALSE           FALSE
## poly(AgeMedian, 2) FALSE FALSE           FALSE
## Pct_014            FALSE FALSE           FALSE
## Pct_65P            FALSE FALSE           FALSE
## Pct_MV             FALSE FALSE           FALSE
## Pct_FR             FALSE FALSE           FALSE</code></pre>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="sect077.html#cb723-1"></a><span class="co"># problème de multicolinéarité (VIF &gt; 5)?</span></span>
<span id="cb723-2"><a href="sect077.html#cb723-2"></a>car<span class="op">::</span><span class="kw">vif</span>(modele3) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span> </span></code></pre></div>
<pre><code>##                     GVIF    Df GVIF^(1/(2*Df))
## log(HABHA)         FALSE FALSE           FALSE
## poly(AgeMedian, 2) FALSE FALSE           FALSE
## Pct_014            FALSE FALSE           FALSE
## Pct_65P            FALSE FALSE           FALSE
## Pct_MV             FALSE FALSE           FALSE
## Pct_FR             FALSE FALSE           FALSE</code></pre>
</div>
<div id="sect07735" class="section level4">
<h4><span class="header-section-number">7.7.3.5</span> Répérage des valeurs très influentes du modèle</h4>
<p>La syntaxe suivante permet d’évaluer le nombre de valeurs très influentes dans le modèle avec les critères de <span class="math inline">\(\mbox{4/n}\)</span>, <span class="math inline">\(\mbox{8/n}\)</span> et <span class="math inline">\(\mbox{16/n}\)</span> pour la distance de Cook.</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="sect077.html#cb725-1"></a>nobs &lt;-<span class="st"> </span><span class="kw">length</span>(modele3<span class="op">$</span>fitted.values)</span>
<span id="cb725-2"><a href="sect077.html#cb725-2"></a>DistanceCook &lt;-<span class="st"> </span><span class="kw">cooks.distance</span>(modele3)</span>
<span id="cb725-3"><a href="sect077.html#cb725-3"></a>n4 &lt;-<span class="st"> </span><span class="kw">length</span>(DistanceCook[DistanceCook <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span><span class="op">/</span>nobs])</span>
<span id="cb725-4"><a href="sect077.html#cb725-4"></a>n8 &lt;-<span class="st"> </span><span class="kw">length</span>(DistanceCook[DistanceCook <span class="op">&gt;</span><span class="st"> </span><span class="dv">8</span><span class="op">/</span>nobs])</span>
<span id="cb725-5"><a href="sect077.html#cb725-5"></a>n16 &lt;-<span class="st">  </span><span class="kw">length</span>(DistanceCook[DistanceCook <span class="op">&gt;</span><span class="st"> </span><span class="dv">16</span><span class="op">/</span>nobs])</span>
<span id="cb725-6"><a href="sect077.html#cb725-6"></a><span class="kw">cat</span>(<span class="st">&quot;Nombre d&#39;observations =&quot;</span>, nobs, <span class="st">&quot;(100 %)&quot;</span>,</span>
<span id="cb725-7"><a href="sect077.html#cb725-7"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st"> 4/n =&quot;</span>, <span class="kw">round</span>(<span class="dv">4</span><span class="op">/</span>nobs,<span class="dv">5</span>),</span>
<span id="cb725-8"><a href="sect077.html#cb725-8"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st"> 8/n =&quot;</span>, <span class="kw">round</span>(<span class="dv">8</span><span class="op">/</span>nobs,<span class="dv">5</span>),</span>
<span id="cb725-9"><a href="sect077.html#cb725-9"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st"> 16/n =&quot;</span>, <span class="kw">round</span>(<span class="dv">16</span><span class="op">/</span>nobs,<span class="dv">5</span>),</span>
<span id="cb725-10"><a href="sect077.html#cb725-10"></a><span class="st">&quot;</span><span class="ch">\n</span><span class="st">Observations avec une valeur supérieure ou égale aux différents seuils&quot;</span>,</span>
<span id="cb725-11"><a href="sect077.html#cb725-11"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st"> 4/n =&quot;</span>, n4, <span class="st">&quot;soit&quot;</span>, <span class="kw">round</span>(n4<span class="op">/</span>nobs<span class="op">*</span><span class="dv">100</span>,<span class="dv">2</span>),<span class="st">&quot; %&quot;</span>,</span>
<span id="cb725-12"><a href="sect077.html#cb725-12"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st"> 8/n =&quot;</span>, n8, <span class="st">&quot;soit&quot;</span>, <span class="kw">round</span>(n8<span class="op">/</span>nobs<span class="op">*</span><span class="dv">100</span>,<span class="dv">2</span>),<span class="st">&quot; %&quot;</span>,</span>
<span id="cb725-13"><a href="sect077.html#cb725-13"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st"> 16/n =&quot;</span>, n16, <span class="st">&quot;soit&quot;</span>, <span class="kw">round</span>(n16<span class="op">/</span>nobs<span class="op">*</span><span class="dv">100</span>,<span class="dv">2</span>), <span class="st">&quot; %&quot;</span></span>
<span id="cb725-14"><a href="sect077.html#cb725-14"></a>    )</span></code></pre></div>
<pre><code>## Nombre d&#39;observations = 10210 (100 %) 
##  4/n = 0.00039 
##  8/n = 0.00078 
##  16/n = 0.00157 
## Observations avec une valeur supérieure ou égale aux différents seuils 
##  4/n = 604 soit 5.92  % 
##  8/n = 285 soit 2.79  % 
##  16/n = 132 soit 1.29  %</code></pre>
<p>Vous pouvez également construire un nuage de points avec la distance de Cook et l’effet de levier (<em>leverage value</em>) pour repérer visuellement les observations très influentes.</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="sect077.html#cb727-1"></a><span class="kw">library</span>(car)</span>
<span id="cb727-2"><a href="sect077.html#cb727-2"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb727-3"><a href="sect077.html#cb727-3"></a>DistanceCook &lt;-<span class="st"> </span><span class="kw">cooks.distance</span>(modele3)</span>
<span id="cb727-4"><a href="sect077.html#cb727-4"></a>LeverageValue &lt;-<span class="st"> </span><span class="kw">hatvalues</span>(modele3)</span>
<span id="cb727-5"><a href="sect077.html#cb727-5"></a></span>
<span id="cb727-6"><a href="sect077.html#cb727-6"></a>G1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb727-7"><a href="sect077.html#cb727-7"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> LeverageValue, <span class="dt">y =</span> DistanceCook), </span>
<span id="cb727-8"><a href="sect077.html#cb727-8"></a>             <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb727-9"><a href="sect077.html#cb727-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Effet levier&quot;</span>,</span>
<span id="cb727-10"><a href="sect077.html#cb727-10"></a>       <span class="dt">y =</span> <span class="st">&#39;Distance de Cook&#39;</span>,</span>
<span id="cb727-11"><a href="sect077.html#cb727-11"></a>       <span class="dt">title =</span> <span class="st">&#39;Repérer les valeurs influentes&#39;</span>,</span>
<span id="cb727-12"><a href="sect077.html#cb727-12"></a>       <span class="dt">subtitle =</span> <span class="st">&#39;(toutes les observations)&#39;</span>)</span>
<span id="cb727-13"><a href="sect077.html#cb727-13"></a></span>
<span id="cb727-14"><a href="sect077.html#cb727-14"></a>G2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb727-15"><a href="sect077.html#cb727-15"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> LeverageValue, <span class="dt">y =</span> DistanceCook), </span>
<span id="cb727-16"><a href="sect077.html#cb727-16"></a>             <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb727-17"><a href="sect077.html#cb727-17"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="fl">0.01</span>)<span class="op">+</span></span>
<span id="cb727-18"><a href="sect077.html#cb727-18"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>,<span class="fl">0.01</span>)<span class="op">+</span></span>
<span id="cb727-19"><a href="sect077.html#cb727-19"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Effet levier&quot;</span>,</span>
<span id="cb727-20"><a href="sect077.html#cb727-20"></a>       <span class="dt">y =</span> <span class="st">&#39;Distance de Cook&#39;</span>,</span>
<span id="cb727-21"><a href="sect077.html#cb727-21"></a>       <span class="dt">title =</span> <span class="st">&#39;Repérer les valeurs influentes&#39;</span>,</span>
<span id="cb727-22"><a href="sect077.html#cb727-22"></a>       <span class="dt">subtitle =</span> <span class="st">&#39;(agrandissement)&#39;</span>)</span>
<span id="cb727-23"><a href="sect077.html#cb727-23"></a></span>
<span id="cb727-24"><a href="sect077.html#cb727-24"></a><span class="kw">ggarrange</span>(G1,G2, <span class="dt">nrow=</span><span class="dv">1</span>, <span class="dt">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:DiaGraphCookLev"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/DiaGraphCookLev-1.png" alt="Repérage graphique des valeurs influentes du modèle" width="75%" />
<p class="caption">
Figure 7.15: Repérage graphique des valeurs influentes du modèle
</p>
</div>
</div>
<div id="sect07736" class="section level4">
<h4><span class="header-section-number">7.7.3.6</span> Construction d’un nouveau modèle en supprimant les observations très influentes du modèle</h4>
<p>Dans un premier temps, il convient de construire un nouveau modèle sans les valeurs influentes du modèle de départ.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="sect077.html#cb728-1"></a><span class="co"># Nombre d&#39;observation dans le modèle 3</span></span>
<span id="cb728-2"><a href="sect077.html#cb728-2"></a>nobs &lt;-<span class="kw">length</span>(modele3<span class="op">$</span>fitted.values)</span>
<span id="cb728-3"><a href="sect077.html#cb728-3"></a></span>
<span id="cb728-4"><a href="sect077.html#cb728-4"></a><span class="co"># Distance de Cook</span></span>
<span id="cb728-5"><a href="sect077.html#cb728-5"></a>cook &lt;-<span class="st"> </span><span class="kw">cooks.distance</span>(modele3)</span>
<span id="cb728-6"><a href="sect077.html#cb728-6"></a></span>
<span id="cb728-7"><a href="sect077.html#cb728-7"></a><span class="co"># Les observations très influentes avec le critère de 16/n</span></span>
<span id="cb728-8"><a href="sect077.html#cb728-8"></a>DataSansOutliers &lt;-<span class="st"> </span><span class="kw">cbind</span>(DataFinal, cook)</span>
<span id="cb728-9"><a href="sect077.html#cb728-9"></a>DataSansOutliers &lt;-<span class="st"> </span>DataSansOutliers[DataSansOutliers<span class="op">$</span>cook  <span class="op">&lt;</span><span class="st"> </span><span class="dv">8</span><span class="op">/</span>nobs, ]</span>
<span id="cb728-10"><a href="sect077.html#cb728-10"></a>modele3b &lt;-<span class="st"> </span><span class="kw">lm</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR,</span>
<span id="cb728-11"><a href="sect077.html#cb728-11"></a>              <span class="dt">data =</span> DataSansOutliers)</span>
<span id="cb728-12"><a href="sect077.html#cb728-12"></a>nobsb &lt;-<span class="kw">length</span>(modele3b<span class="op">$</span>fitted.values)</span></code></pre></div>
<p>Comparez les valeurs du R<sup>2</sup> ajusté des deux modèles. Habituellement, la suppression des valeurs très influentes s’accompagne d’une augmentation du R<sup>2</sup> ajusté. C’est notamment le cas ici puisque sa valeur grimpe de 0,4653 à 0,5684, signalant ainsi un gain important pour la variance expliquée.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="sect077.html#cb729-1"></a><span class="co"># Comparaison des mesures d&#39;ajustement</span></span>
<span id="cb729-2"><a href="sect077.html#cb729-2"></a><span class="kw">cat</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Comparaison des R2 ajustés :&quot;</span>,</span>
<span id="cb729-3"><a href="sect077.html#cb729-3"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Modèle de départ (n=&quot;</span>, nobs, <span class="st">&quot;), &quot;</span>,</span>
<span id="cb729-4"><a href="sect077.html#cb729-4"></a>    <span class="kw">round</span>(<span class="kw">summary</span>(modele3)<span class="op">$</span>adj.r.squared,<span class="dv">4</span>), </span>
<span id="cb729-5"><a href="sect077.html#cb729-5"></a>    </span>
<span id="cb729-6"><a href="sect077.html#cb729-6"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Modèle sans les observations très influentes (n=&quot;</span>, nobsb, <span class="st">&quot;), &quot;</span>,</span>
<span id="cb729-7"><a href="sect077.html#cb729-7"></a>    <span class="kw">round</span>(<span class="kw">summary</span>(modele3b)<span class="op">$</span>adj.r.squared,<span class="dv">4</span>),</span>
<span id="cb729-8"><a href="sect077.html#cb729-8"></a>    <span class="dt">sep=</span><span class="st">&quot;&quot;</span></span>
<span id="cb729-9"><a href="sect077.html#cb729-9"></a>)</span></code></pre></div>
<pre><code>## 
## Comparaison des R2 ajustés :
## Modèle de départ (n=10210), 0.4653
## Modèle sans les observations très influentes (n=9925), 0.5684</code></pre>
<p>Pour le modèle, il convient alors de refaire le diagnostic de la régression et de vérifier si la suppression des observations très influentes a amélioré : 1) la normalité, la linéarité et l’homoscédasticité des résidus, 2) la multicolinéarité excessive et 3) l’absence de valeurs trop influentes.</p>
<p><strong>La normalité des résidus s’est-elle ou non améliorée?</strong></p>
<p>Pour ce faire, comparez les valeurs d’asymétrie,d’aplatissement et du test de Jarque-Bera et les graphiques de normalité. À la lecture des valeurs :</p>
<ul>
<li>l’asymétrie est très similaire (-0,260 à -0,265);</li>
<li>l’aplatissement s’est amélioré (1,183 à 0,164);</li>
<li>le test de Jarque-Bera signale toujours un problème de normalité (<em>p</em> &lt; 0,001), mais sa valeur a nettement diminué (548,7 à 131,24);</li>
<li>les graphiques démontrent une nette amélioration de la normalité des résidus.</li>
</ul>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb731-1"><a href="sect077.html#cb731-1"></a><span class="co"># 1. coefficients d’asymétrie et d’aplatissement </span></span>
<span id="cb731-2"><a href="sect077.html#cb731-2"></a>resmodele3  &lt;-<span class="st"> </span><span class="kw">rstudent</span>(modele3)</span>
<span id="cb731-3"><a href="sect077.html#cb731-3"></a>resmodele3b &lt;-<span class="st"> </span><span class="kw">rstudent</span>(modele3b)</span>
<span id="cb731-4"><a href="sect077.html#cb731-4"></a>  </span>
<span id="cb731-5"><a href="sect077.html#cb731-5"></a><span class="kw">c</span>(<span class="dt">Skewness=</span> <span class="kw">round</span>(<span class="kw">Skew</span>(resmodele3),<span class="dv">3</span>), </span>
<span id="cb731-6"><a href="sect077.html#cb731-6"></a>  <span class="dt">Kurtosis =</span> <span class="kw">round</span>(<span class="kw">Kurt</span>(resmodele3),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Skewness1 Skewness2 Skewness3 Skewness4 Kurtosis1 Kurtosis2 Kurtosis3 Kurtosis4 
##    -0.260     0.024   -10.739     0.000     1.185     0.048    24.448     0.000</code></pre>
<div class="sourceCode" id="cb733"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb733-1"><a href="sect077.html#cb733-1"></a><span class="kw">c</span>(<span class="dt">Skewness=</span> <span class="kw">round</span>(<span class="kw">Skew</span>(resmodele3b),<span class="dv">3</span>), </span>
<span id="cb733-2"><a href="sect077.html#cb733-2"></a>  <span class="dt">Kurtosis =</span> <span class="kw">round</span>(<span class="kw">Kurt</span>(resmodele3b),<span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Skewness1 Skewness2 Skewness3 Skewness4 Kurtosis1 Kurtosis2 Kurtosis3 Kurtosis4 
##    -0.265     0.025   -10.790     0.000     0.165     0.049     3.360     0.000</code></pre>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="sect077.html#cb735-1"></a><span class="co"># 2. Test de normalité de Jarque-Bera</span></span>
<span id="cb735-2"><a href="sect077.html#cb735-2"></a><span class="kw">JarqueBeraTest</span>(resmodele3)</span></code></pre></div>
<pre><code>## 
##  Robust Jarque Bera Test
## 
## data:  resmodele3
## X-squared = 548.7, df = 2, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb737"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb737-1"><a href="sect077.html#cb737-1"></a><span class="kw">JarqueBeraTest</span>(resmodele3b)</span></code></pre></div>
<pre><code>## 
##  Robust Jarque Bera Test
## 
## data:  resmodele3b
## X-squared = 131.24, df = 2, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb739"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb739-1"><a href="sect077.html#cb739-1"></a><span class="co"># 3. Graphiques </span></span>
<span id="cb739-2"><a href="sect077.html#cb739-2"></a>Ghisto1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb739-3"><a href="sect077.html#cb739-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> resmodele3, <span class="dt">y =</span> ..density..),</span>
<span id="cb739-4"><a href="sect077.html#cb739-4"></a>                 <span class="dt">bins =</span> <span class="dv">30</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>) <span class="op">+</span></span>
<span id="cb739-5"><a href="sect077.html#cb739-5"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm,  <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(resmodele3),</span>
<span id="cb739-6"><a href="sect077.html#cb739-6"></a>                                          <span class="dt">sd =</span> <span class="kw">sd</span>(resmodele3)), </span>
<span id="cb739-7"><a href="sect077.html#cb739-7"></a>                <span class="dt">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb739-8"><a href="sect077.html#cb739-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Modèle de départ&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;densité&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Résidus studentisés&quot;</span>)</span>
<span id="cb739-9"><a href="sect077.html#cb739-9"></a></span>
<span id="cb739-10"><a href="sect077.html#cb739-10"></a>Gqqplot1 &lt;-<span class="st"> </span><span class="kw">qplot</span>(<span class="dt">sample =</span> residus)<span class="op">+</span></span>
<span id="cb739-11"><a href="sect077.html#cb739-11"></a><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">line.p =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="dt">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="dt">size=</span><span class="fl">1.2</span>)<span class="op">+</span></span>
<span id="cb739-12"><a href="sect077.html#cb739-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Modèle de départ&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Valeurs théoriques&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Résidus studentisés&quot;</span>)</span>
<span id="cb739-13"><a href="sect077.html#cb739-13"></a></span>
<span id="cb739-14"><a href="sect077.html#cb739-14"></a>Ghisto2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb739-15"><a href="sect077.html#cb739-15"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> resmodele3b, <span class="dt">y =</span> ..density..),</span>
<span id="cb739-16"><a href="sect077.html#cb739-16"></a>                 <span class="dt">bins =</span> <span class="dv">30</span>, <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>) <span class="op">+</span></span>
<span id="cb739-17"><a href="sect077.html#cb739-17"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm,  <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(resmodele3b),</span>
<span id="cb739-18"><a href="sect077.html#cb739-18"></a>                                          <span class="dt">sd =</span> <span class="kw">sd</span>(resmodele3b)), </span>
<span id="cb739-19"><a href="sect077.html#cb739-19"></a>                <span class="dt">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="dt">size =</span> <span class="fl">1.2</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb739-20"><a href="sect077.html#cb739-20"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Modèle après suppression&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Valeurs théoriques&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Résidus studentisés&quot;</span>)</span>
<span id="cb739-21"><a href="sect077.html#cb739-21"></a></span>
<span id="cb739-22"><a href="sect077.html#cb739-22"></a>Gqqplot2 &lt;-<span class="st"> </span><span class="kw">qplot</span>(<span class="dt">sample =</span> resmodele3b)<span class="op">+</span></span>
<span id="cb739-23"><a href="sect077.html#cb739-23"></a><span class="st">  </span><span class="kw">geom_qq_line</span>(<span class="dt">line.p =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="dt">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="dt">size=</span><span class="fl">1.2</span>)<span class="op">+</span></span>
<span id="cb739-24"><a href="sect077.html#cb739-24"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Modèle après suppression&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Valeurs théoriques&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Résidus studentisés&quot;</span>)</span>
<span id="cb739-25"><a href="sect077.html#cb739-25"></a></span>
<span id="cb739-26"><a href="sect077.html#cb739-26"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb739-27"><a href="sect077.html#cb739-27"></a><span class="kw">ggarrange</span>(Ghisto1, Ghisto2, Gqqplot1, Gqqplot2, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ResidusCompa"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/ResidusCompa-1.png" alt="Normalité des résidus avant et après la suppression des valeurs influentes" width="65%" />
<p class="caption">
Figure 7.16: Normalité des résidus avant et après la suppression des valeurs influentes
</p>
</div>
<p><strong>Le problème d’hétéroscédasticité est-il corrigé?</strong></p>
<ul>
<li>la valeur du test de Breusch-Pagan est beaucoup plus faible, mais il semble persister un problème d’hétéroscédasticité.</li>
</ul>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="sect077.html#cb740-1"></a><span class="co"># homoscédasticité des résidus améliorée ou non?</span></span>
<span id="cb740-2"><a href="sect077.html#cb740-2"></a><span class="kw">library</span>(lmtest)</span>
<span id="cb740-3"><a href="sect077.html#cb740-3"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb740-4"><a href="sect077.html#cb740-4"></a></span>
<span id="cb740-5"><a href="sect077.html#cb740-5"></a><span class="kw">bptest</span>(modele3)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  modele3
## BP = 1651.5, df = 7, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="sect077.html#cb742-1"></a><span class="kw">bptest</span>(modele3b)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  modele3b
## BP = 640.53, df = 7, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb744-1"><a href="sect077.html#cb744-1"></a>resmodele3  &lt;-<span class="st"> </span><span class="kw">residuals</span>(modele3)</span>
<span id="cb744-2"><a href="sect077.html#cb744-2"></a>resmodele3b &lt;-<span class="st"> </span><span class="kw">residuals</span>(modele3b)</span>
<span id="cb744-3"><a href="sect077.html#cb744-3"></a>ypredits3 &lt;-<span class="st"> </span>modele3<span class="op">$</span>fitted.values</span>
<span id="cb744-4"><a href="sect077.html#cb744-4"></a>ypredits3b &lt;-<span class="st"> </span>modele3b<span class="op">$</span>fitted.values</span>
<span id="cb744-5"><a href="sect077.html#cb744-5"></a></span>
<span id="cb744-6"><a href="sect077.html#cb744-6"></a>G1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb744-7"><a href="sect077.html#cb744-7"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ypredits3, <span class="dt">y =</span> resmodele3),</span>
<span id="cb744-8"><a href="sect077.html#cb744-8"></a>                 <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb744-9"><a href="sect077.html#cb744-9"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ypredits3, <span class="dt">y =</span> resmodele3),  <span class="dt">method =</span> lm, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb744-10"><a href="sect077.html#cb744-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Modèle de départ&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Valeurs prédites&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Résidus studentisés&quot;</span>)</span>
<span id="cb744-11"><a href="sect077.html#cb744-11"></a></span>
<span id="cb744-12"><a href="sect077.html#cb744-12"></a>G2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb744-13"><a href="sect077.html#cb744-13"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ypredits3b, <span class="dt">y =</span> resmodele3b),</span>
<span id="cb744-14"><a href="sect077.html#cb744-14"></a>                 <span class="dt">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="fl">0.8</span>) <span class="op">+</span></span>
<span id="cb744-15"><a href="sect077.html#cb744-15"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ypredits3b, <span class="dt">y =</span> resmodele3b),  <span class="dt">method =</span> lm, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb744-16"><a href="sect077.html#cb744-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Modèle après suppression&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Valeurs prédites&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Résidus studentisés&quot;</span>)</span>
<span id="cb744-17"><a href="sect077.html#cb744-17"></a></span>
<span id="cb744-18"><a href="sect077.html#cb744-18"></a><span class="kw">ggarrange</span>(G1, G2, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:HomosComp"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/HomosComp-1.png" alt="Amélioration de l'homoscédasticité des résidus" width="65%" />
<p class="caption">
Figure 7.17: Amélioration de l’homoscédasticité des résidus
</p>
</div>
<p>Finalement, il convient de comparer les coefficients de régression.</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="sect077.html#cb745-1"></a><span class="co"># Comparaison des coefficients</span></span>
<span id="cb745-2"><a href="sect077.html#cb745-2"></a><span class="kw">summary</span>(modele3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + 
##     Pct_65P + Pct_MV + Pct_FR, data = DataFinal)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -66.848  -8.660   0.381   8.961  83.269 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          5.283e+01  1.001e+00  52.781  &lt; 2e-16 ***
## log(HABHA)          -6.855e+00  1.683e-01 -40.730  &lt; 2e-16 ***
## poly(AgeMedian, 2)1  1.198e+01  1.559e+01   0.769 0.441958    
## poly(AgeMedian, 2)2 -2.861e+02  1.394e+01 -20.525  &lt; 2e-16 ***
## Pct_014              9.406e-01  3.126e-02  30.093  &lt; 2e-16 ***
## Pct_65P              3.062e-01  1.851e-02  16.546  &lt; 2e-16 ***
## Pct_MV              -3.630e-02  9.943e-03  -3.651 0.000262 ***
## Pct_FR              -3.443e-01  1.103e-02 -31.212  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 13.57 on 10202 degrees of freedom
## Multiple R-squared:  0.4657, Adjusted R-squared:  0.4653 
## F-statistic:  1270 on 7 and 10202 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="sect077.html#cb747-1"></a><span class="kw">summary</span>(modele3b)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = VegPct ~ log(HABHA) + poly(AgeMedian, 2) + Pct_014 + 
##     Pct_65P + Pct_MV + Pct_FR, data = DataSansOutliers)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -46.417  -7.734   0.456   8.290  40.085 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          6.748e+01  9.869e-01  68.370  &lt; 2e-16 ***
## log(HABHA)          -1.000e+01  1.720e-01 -58.167  &lt; 2e-16 ***
## poly(AgeMedian, 2)1  4.357e+01  1.387e+01   3.142  0.00168 ** 
## poly(AgeMedian, 2)2 -3.564e+02  1.250e+01 -28.510  &lt; 2e-16 ***
## Pct_014              8.351e-01  2.870e-02  29.101  &lt; 2e-16 ***
## Pct_65P              2.271e-01  1.807e-02  12.566  &lt; 2e-16 ***
## Pct_MV              -8.517e-03  9.109e-03  -0.935  0.34976    
## Pct_FR              -2.924e-01  1.028e-02 -28.440  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.96 on 9917 degrees of freedom
## Multiple R-squared:  0.5687, Adjusted R-squared:  0.5684 
## F-statistic:  1868 on 7 and 9917 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div id="sect0774" class="section level3">
<h3><span class="header-section-number">7.7.4</span> Graphiques pour les effets marginaux</h3>
<p>Tel que signalé ultérieurement, il est courant de représenter l’effet marginal d’une VI sur une VD, une fois contrôlées les autres VI. Pour ce faire, il est possible d’utiliser les <em>packages</em> <code>ggplot2</code> et <code>ggeffects</code>.</p>
<div id="sect07741" class="section level4">
<h4><span class="header-section-number">7.7.4.1</span> Effet marginal pour une variable continue</h4>
<p>La syntaxe ci-dessous illustre comment obtenir un graphique pour nos quatre variables explicatives. Bien entendu, si le coefficient de régression est positif (comme pour les pourcentages de jeunes de moins de 15 ans et les personnes âgées), la pente est alors montante, et inversement descendante pour des coefficients négatifs (comme pour les personnes ayant déclaré appartenir à une minorité visible et les personnes à faible revenu). En outre, plus la valeur absolue du coefficient est forte, plus la pente est prononcée.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="sect077.html#cb749-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb749-2"><a href="sect077.html#cb749-2"></a><span class="kw">library</span>(ggeffects)</span>
<span id="cb749-3"><a href="sect077.html#cb749-3"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb749-4"><a href="sect077.html#cb749-4"></a></span>
<span id="cb749-5"><a href="sect077.html#cb749-5"></a><span class="co"># Création d&#39;un DataFrame pour les valeurs prédites pour chaque VI continue</span></span>
<span id="cb749-6"><a href="sect077.html#cb749-6"></a>fitV1 &lt;-<span class="st"> </span><span class="kw">ggpredict</span>(modele3, <span class="dt">terms =</span> <span class="st">&quot;Pct_014&quot;</span>)</span>
<span id="cb749-7"><a href="sect077.html#cb749-7"></a>fitV2 &lt;-<span class="st"> </span><span class="kw">ggpredict</span>(modele3, <span class="dt">terms =</span> <span class="st">&quot;Pct_65P&quot;</span>)</span>
<span id="cb749-8"><a href="sect077.html#cb749-8"></a>fitV3 &lt;-<span class="st"> </span><span class="kw">ggpredict</span>(modele3, <span class="dt">terms =</span> <span class="st">&quot;Pct_MV&quot;</span>)</span>
<span id="cb749-9"><a href="sect077.html#cb749-9"></a>fitV4 &lt;-<span class="st"> </span><span class="kw">ggpredict</span>(modele3, <span class="dt">terms =</span> <span class="st">&quot;Pct_FR&quot;</span>)</span>
<span id="cb749-10"><a href="sect077.html#cb749-10"></a></span>
<span id="cb749-11"><a href="sect077.html#cb749-11"></a><span class="co"># Construction des graphiques</span></span>
<span id="cb749-12"><a href="sect077.html#cb749-12"></a>G1 &lt;-<span class="kw">ggplot</span>(fitV1, <span class="kw">aes</span>(x, predicted)) <span class="op">+</span></span>
<span id="cb749-13"><a href="sect077.html#cb749-13"></a><span class="st">    </span><span class="co"># ligne de régression</span></span>
<span id="cb749-14"><a href="sect077.html#cb749-14"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb749-15"><a href="sect077.html#cb749-15"></a><span class="st">    </span><span class="co"># intervalle de confiance à 95 %</span></span>
<span id="cb749-16"><a href="sect077.html#cb749-16"></a><span class="st">    </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low, <span class="dt">ymax =</span> conf.high), <span class="dt">alpha =</span> <span class="fl">.3</span>)<span class="op">+</span></span>
<span id="cb749-17"><a href="sect077.html#cb749-17"></a><span class="st">    </span><span class="co">#  Titres</span></span>
<span id="cb749-18"><a href="sect077.html#cb749-18"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;valeur prédite Y&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Moins de 15 ans (%)&quot;</span>)</span>
<span id="cb749-19"><a href="sect077.html#cb749-19"></a></span>
<span id="cb749-20"><a href="sect077.html#cb749-20"></a>G2 &lt;-<span class="kw">ggplot</span>(fitV2, <span class="kw">aes</span>(x, predicted)) <span class="op">+</span></span>
<span id="cb749-21"><a href="sect077.html#cb749-21"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb749-22"><a href="sect077.html#cb749-22"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low, <span class="dt">ymax =</span> conf.high), <span class="dt">alpha =</span> <span class="fl">.3</span>)<span class="op">+</span></span>
<span id="cb749-23"><a href="sect077.html#cb749-23"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;valeur prédite Y&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;65 ans et plus (%)&quot;</span>)</span>
<span id="cb749-24"><a href="sect077.html#cb749-24"></a></span>
<span id="cb749-25"><a href="sect077.html#cb749-25"></a>G3 &lt;-<span class="kw">ggplot</span>(fitV3, <span class="kw">aes</span>(x, predicted)) <span class="op">+</span></span>
<span id="cb749-26"><a href="sect077.html#cb749-26"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb749-27"><a href="sect077.html#cb749-27"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low, <span class="dt">ymax =</span> conf.high), <span class="dt">alpha =</span> <span class="fl">.3</span>)<span class="op">+</span></span>
<span id="cb749-28"><a href="sect077.html#cb749-28"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;valeur prédite Y&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Minorités visibles (%)&quot;</span>)</span>
<span id="cb749-29"><a href="sect077.html#cb749-29"></a></span>
<span id="cb749-30"><a href="sect077.html#cb749-30"></a>G4 &lt;-<span class="kw">ggplot</span>(fitV4, <span class="kw">aes</span>(x, predicted)) <span class="op">+</span></span>
<span id="cb749-31"><a href="sect077.html#cb749-31"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb749-32"><a href="sect077.html#cb749-32"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low, <span class="dt">ymax =</span> conf.high), <span class="dt">alpha =</span> <span class="fl">.3</span>)<span class="op">+</span></span>
<span id="cb749-33"><a href="sect077.html#cb749-33"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;valeur prédite Y&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Personne à faible revenu (%)&quot;</span>)</span>
<span id="cb749-34"><a href="sect077.html#cb749-34"></a></span>
<span id="cb749-35"><a href="sect077.html#cb749-35"></a><span class="co"># Assemblage des graphiques</span></span>
<span id="cb749-36"><a href="sect077.html#cb749-36"></a><span class="kw">ggarrange</span>(G1, G2, G3, G4, <span class="dt">ncol =</span><span class="dv">2</span>, <span class="dt">nrow =</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:EffetMarginalVariablesContinues"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/EffetMarginalVariablesContinues-1.png" alt="Effets marginaux pour des variables continues" width="85%" />
<p class="caption">
Figure 7.18: Effets marginaux pour des variables continues
</p>
</div>
</div>
<div id="sect07742" class="section level4">
<h4><span class="header-section-number">7.7.4.2</span> Effet marginal pour une variable avec une fonction polynomiale d’ordre 2</h4>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="sect077.html#cb750-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb750-2"><a href="sect077.html#cb750-2"></a><span class="kw">library</span>(ggeffects)</span>
<span id="cb750-3"><a href="sect077.html#cb750-3"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb750-4"><a href="sect077.html#cb750-4"></a></span>
<span id="cb750-5"><a href="sect077.html#cb750-5"></a>fitAgeMedian &lt;-<span class="st"> </span><span class="kw">ggpredict</span>(modele3, <span class="dt">terms =</span> <span class="st">&quot;AgeMedian&quot;</span>)</span>
<span id="cb750-6"><a href="sect077.html#cb750-6"></a></span>
<span id="cb750-7"><a href="sect077.html#cb750-7"></a> <span class="kw">ggplot</span>(fitAgeMedian, <span class="kw">aes</span>(x, predicted)) <span class="op">+</span></span>
<span id="cb750-8"><a href="sect077.html#cb750-8"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&#39;green&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb750-9"><a href="sect077.html#cb750-9"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low, <span class="dt">ymax =</span> conf.high), <span class="dt">alpha =</span> <span class="fl">.3</span>)<span class="op">+</span></span>
<span id="cb750-10"><a href="sect077.html#cb750-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Variable sous forme polynomiale (ordre 2)&quot;</span>,</span>
<span id="cb750-11"><a href="sect077.html#cb750-11"></a>       <span class="dt">y=</span><span class="st">&quot;VD: valeur prédite&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Âge médian des bâtiments&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:Titi"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/Titi-1.png" alt="Effet marginal d'une variable avec un fonction polynomiale d'ordre 2" width="70%" />
<p class="caption">
Figure 7.19: Effet marginal d’une variable avec un fonction polynomiale d’ordre 2
</p>
</div>
</div>
<div id="sect07743" class="section level4">
<h4><span class="header-section-number">7.7.4.3</span> Effet marginal pour une variable transformée en logarithme</h4>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="sect077.html#cb751-1"></a>fitHabHa &lt;-<span class="st"> </span><span class="kw">ggpredict</span>(modele3, <span class="dt">terms =</span> <span class="st">&quot;HABHA&quot;</span>)</span>
<span id="cb751-2"><a href="sect077.html#cb751-2"></a></span>
<span id="cb751-3"><a href="sect077.html#cb751-3"></a><span class="kw">ggplot</span>(fitHabHa, <span class="kw">aes</span>(x, predicted)) <span class="op">+</span></span>
<span id="cb751-4"><a href="sect077.html#cb751-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb751-5"><a href="sect077.html#cb751-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low, <span class="dt">ymax =</span> conf.high), <span class="dt">alpha =</span> <span class="fl">.3</span>)<span class="op">+</span></span>
<span id="cb751-6"><a href="sect077.html#cb751-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;VD: valeur prédite&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Habitants km2&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:EffetMarginalVariableLog"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/EffetMarginalVariableLog-1.png" alt="Effet du logarithme de la densité" width="75%" />
<p class="caption">
Figure 7.20: Effet du logarithme de la densité
</p>
</div>
</div>
<div id="sect07744" class="section level4">
<h4><span class="header-section-number">7.7.4.4</span> Effet marginal pour une variable dichotomique</h4>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="sect077.html#cb752-1"></a><span class="co"># Valeurs prédites selon le modèle avec la variable dichotomique</span></span>
<span id="cb752-2"><a href="sect077.html#cb752-2"></a>fitVilleMtl &lt;-<span class="st"> </span><span class="kw">ggpredict</span>(modele4, <span class="dt">terms =</span> <span class="st">&quot;VilleMtl&quot;</span>)</span>
<span id="cb752-3"><a href="sect077.html#cb752-3"></a></span>
<span id="cb752-4"><a href="sect077.html#cb752-4"></a><span class="co"># Graphique</span></span>
<span id="cb752-5"><a href="sect077.html#cb752-5"></a><span class="kw">ggplot</span>(fitVilleMtl, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>predicted)) <span class="op">+</span></span>
<span id="cb752-6"><a href="sect077.html#cb752-6"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">fill=</span><span class="st">&quot;wheat&quot;</span>) <span class="op">+</span></span>
<span id="cb752-7"><a href="sect077.html#cb752-7"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low, <span class="dt">ymax =</span> conf.high), <span class="dt">alpha =</span> <span class="fl">.9</span>,<span class="dt">position =</span> <span class="kw">position_dodge</span>())<span class="op">+</span></span>
<span id="cb752-8"><a href="sect077.html#cb752-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Effet marginal de la ville de Montréal sur la végétation&quot;</span>,</span>
<span id="cb752-9"><a href="sect077.html#cb752-9"></a>       <span class="dt">x=</span><span class="st">&quot;Municipalités de la région de Montréal&quot;</span>,</span>
<span id="cb752-10"><a href="sect077.html#cb752-10"></a>       <span class="dt">y=</span><span class="st">&quot;Couverture végétation de l&#39;îlot (%)&quot;</span>)<span class="op">+</span></span>
<span id="cb752-11"><a href="sect077.html#cb752-11"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb752-12"><a href="sect077.html#cb752-12"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Autre municipalité&quot;</span>, <span class="st">&quot;Ville de Montréal&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:EffetMarginalDichCode"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/EffetMarginalDichCode-1.png" alt="Effet marginal d'une variable dichotomique" width="70%" />
<p class="caption">
Figure 7.21: Effet marginal d’une variable dichotomique
</p>
</div>
</div>
<div id="sect07745" class="section level4">
<h4><span class="header-section-number">7.7.4.5</span> Effet marginal pour une variable polytomique</h4>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="sect077.html#cb753-1"></a><span class="co"># Valeurs prédites selon le modèle avec la variable polytomique</span></span>
<span id="cb753-2"><a href="sect077.html#cb753-2"></a>fitVilles &lt;-<span class="st"> </span><span class="kw">ggpredict</span>(modele5, <span class="dt">terms =</span> <span class="st">&quot;Munic&quot;</span>)</span>
<span id="cb753-3"><a href="sect077.html#cb753-3"></a></span>
<span id="cb753-4"><a href="sect077.html#cb753-4"></a><span class="co"># Graphique</span></span>
<span id="cb753-5"><a href="sect077.html#cb753-5"></a>Graphique &lt;-<span class="st"> </span><span class="kw">ggplot</span>(fitVilles, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>predicted)) <span class="op">+</span></span>
<span id="cb753-6"><a href="sect077.html#cb753-6"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">fill=</span><span class="st">&quot;wheat&quot;</span>) <span class="op">+</span></span>
<span id="cb753-7"><a href="sect077.html#cb753-7"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> conf.low, <span class="dt">ymax =</span> conf.high), <span class="dt">alpha =</span> <span class="fl">.9</span>,<span class="dt">position =</span> <span class="kw">position_dodge</span>())<span class="op">+</span></span>
<span id="cb753-8"><a href="sect077.html#cb753-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Effet marginal de la ville de Montréal sur la végétation&quot;</span>,</span>
<span id="cb753-9"><a href="sect077.html#cb753-9"></a>       <span class="dt">x=</span><span class="st">&quot;Municipalités de la région de Montréal&quot;</span>,</span>
<span id="cb753-10"><a href="sect077.html#cb753-10"></a>       <span class="dt">y=</span><span class="st">&quot;Couverture végétation de l&#39;îlot (%)&quot;</span>)</span>
<span id="cb753-11"><a href="sect077.html#cb753-11"></a></span>
<span id="cb753-12"><a href="sect077.html#cb753-12"></a><span class="co"># Rotation du graphique</span></span>
<span id="cb753-13"><a href="sect077.html#cb753-13"></a>Graphique <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:EffetMarginalPolyT"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/EffetMarginalPolyT-1.png" alt="Effet marginal d'une variable polytomique" width="70%" />
<p class="caption">
Figure 7.22: Effet marginal d’une variable polytomique
</p>
</div>
</div>
<div id="sect07746" class="section level4">
<h4><span class="header-section-number">7.7.4.6</span> Effet marginal pour une variable d’interaction (deux VI continues)</h4>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="sect077.html#cb754-1"></a><span class="kw">library</span>(metR) <span class="co"># pour ajouter des labels aux contours</span></span>
<span id="cb754-2"><a href="sect077.html#cb754-2"></a></span>
<span id="cb754-3"><a href="sect077.html#cb754-3"></a>df &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb754-4"><a href="sect077.html#cb754-4"></a>  <span class="dt">DistCBDkm =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">33</span>,<span class="fl">0.1</span>),</span>
<span id="cb754-5"><a href="sect077.html#cb754-5"></a>  <span class="dt">Pct_FR =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">95</span>,<span class="dv">1</span>),</span>
<span id="cb754-6"><a href="sect077.html#cb754-6"></a>  <span class="dt">HABHA =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>HABHA),</span>
<span id="cb754-7"><a href="sect077.html#cb754-7"></a>  <span class="dt">AgeMedian =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>AgeMedian),</span>
<span id="cb754-8"><a href="sect077.html#cb754-8"></a>  <span class="dt">Pct_014 =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>Pct_<span class="dv">014</span>),</span>
<span id="cb754-9"><a href="sect077.html#cb754-9"></a>  <span class="dt">Pct_65P =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>Pct_65P),</span>
<span id="cb754-10"><a href="sect077.html#cb754-10"></a>  <span class="dt">Pct_MV =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>Pct_MV)</span>
<span id="cb754-11"><a href="sect077.html#cb754-11"></a>)</span>
<span id="cb754-12"><a href="sect077.html#cb754-12"></a></span>
<span id="cb754-13"><a href="sect077.html#cb754-13"></a>df<span class="op">$</span>DistCBDkmX_Pct_FR &lt;-<span class="st">  </span>df<span class="op">$</span>DistCBDkm <span class="op">*</span><span class="st"> </span>df<span class="op">$</span>Pct_FR</span>
<span id="cb754-14"><a href="sect077.html#cb754-14"></a>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(modele6, <span class="dt">newdata =</span> df, <span class="dt">se =</span> T)</span>
<span id="cb754-15"><a href="sect077.html#cb754-15"></a>df<span class="op">$</span>pred &lt;-<span class="st"> </span>pred<span class="op">$</span>fit</span>
<span id="cb754-16"><a href="sect077.html#cb754-16"></a>df<span class="op">$</span>pred_se &lt;-<span class="st"> </span>pred<span class="op">$</span>se.fit</span>
<span id="cb754-17"><a href="sect077.html#cb754-17"></a>df<span class="op">$</span>lower &lt;-<span class="st"> </span>df<span class="op">$</span>pred <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>df<span class="op">$</span>pred_se</span>
<span id="cb754-18"><a href="sect077.html#cb754-18"></a>df<span class="op">$</span>upper &lt;-<span class="st"> </span>df<span class="op">$</span>pred <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>df<span class="op">$</span>pred_se</span>
<span id="cb754-19"><a href="sect077.html#cb754-19"></a></span>
<span id="cb754-20"><a href="sect077.html#cb754-20"></a>P1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df) <span class="op">+</span><span class="st"> </span></span>
<span id="cb754-21"><a href="sect077.html#cb754-21"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DistCBDkm, <span class="dt">y =</span> Pct_FR, <span class="dt">fill =</span> pred)) <span class="op">+</span></span>
<span id="cb754-22"><a href="sect077.html#cb754-22"></a><span class="st">  </span><span class="kw">stat_contour</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DistCBDkm, <span class="dt">y =</span> Pct_FR, <span class="dt">z =</span> pred), </span>
<span id="cb754-23"><a href="sect077.html#cb754-23"></a>               <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb754-24"><a href="sect077.html#cb754-24"></a><span class="st">  </span><span class="kw">geom_text_contour</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DistCBDkm, <span class="dt">y =</span> Pct_FR, <span class="dt">z =</span> pred), )<span class="op">+</span></span>
<span id="cb754-25"><a href="sect077.html#cb754-25"></a><span class="st">  </span><span class="kw">scale_fill_viridis</span>(<span class="dt">discrete=</span><span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb754-26"><a href="sect077.html#cb754-26"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Distance au centre-ville&quot;</span>, </span>
<span id="cb754-27"><a href="sect077.html#cb754-27"></a>       <span class="dt">y =</span> <span class="st">&quot;Pers à faible revenu (%)&quot;</span>,</span>
<span id="cb754-28"><a href="sect077.html#cb754-28"></a>       <span class="dt">fill =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb754-29"><a href="sect077.html#cb754-29"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Prédiction&quot;</span>)</span>
<span id="cb754-30"><a href="sect077.html#cb754-30"></a></span>
<span id="cb754-31"><a href="sect077.html#cb754-31"></a>P2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df) <span class="op">+</span><span class="st"> </span></span>
<span id="cb754-32"><a href="sect077.html#cb754-32"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DistCBDkm, <span class="dt">y =</span> Pct_FR, <span class="dt">fill =</span> lower)) <span class="op">+</span></span>
<span id="cb754-33"><a href="sect077.html#cb754-33"></a><span class="st">  </span><span class="kw">stat_contour</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DistCBDkm, <span class="dt">y =</span> Pct_FR, <span class="dt">z =</span> lower), </span>
<span id="cb754-34"><a href="sect077.html#cb754-34"></a>               <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb754-35"><a href="sect077.html#cb754-35"></a><span class="st">  </span><span class="kw">geom_text_contour</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DistCBDkm, <span class="dt">y =</span> Pct_FR, <span class="dt">z =</span> lower), )<span class="op">+</span></span>
<span id="cb754-36"><a href="sect077.html#cb754-36"></a><span class="st">  </span><span class="kw">scale_fill_viridis</span>(<span class="dt">discrete=</span><span class="ot">FALSE</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb754-37"><a href="sect077.html#cb754-37"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Distance au centre-ville&quot;</span>, </span>
<span id="cb754-38"><a href="sect077.html#cb754-38"></a>       <span class="dt">y =</span> <span class="st">&quot;Pers à faible revenu (%)&quot;</span>,</span>
<span id="cb754-39"><a href="sect077.html#cb754-39"></a>       <span class="dt">fill =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb754-40"><a href="sect077.html#cb754-40"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;IC 2,5 %&quot;</span>)</span>
<span id="cb754-41"><a href="sect077.html#cb754-41"></a></span>
<span id="cb754-42"><a href="sect077.html#cb754-42"></a>P3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df) <span class="op">+</span><span class="st"> </span></span>
<span id="cb754-43"><a href="sect077.html#cb754-43"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DistCBDkm, <span class="dt">y =</span> Pct_FR, <span class="dt">fill =</span> upper)) <span class="op">+</span></span>
<span id="cb754-44"><a href="sect077.html#cb754-44"></a><span class="st">  </span><span class="kw">stat_contour</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DistCBDkm, <span class="dt">y =</span> Pct_FR, <span class="dt">z =</span> upper), </span>
<span id="cb754-45"><a href="sect077.html#cb754-45"></a>               <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb754-46"><a href="sect077.html#cb754-46"></a><span class="st">  </span><span class="kw">geom_text_contour</span>(<span class="kw">aes</span>(<span class="dt">x =</span> DistCBDkm, <span class="dt">y =</span> Pct_FR, <span class="dt">z =</span> upper), )<span class="op">+</span></span>
<span id="cb754-47"><a href="sect077.html#cb754-47"></a><span class="st">  </span><span class="kw">scale_fill_viridis</span>(<span class="dt">discrete=</span><span class="ot">FALSE</span>)<span class="op">+</span><span class="st"> </span></span>
<span id="cb754-48"><a href="sect077.html#cb754-48"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Distance au centre-ville&quot;</span>, </span>
<span id="cb754-49"><a href="sect077.html#cb754-49"></a>       <span class="dt">y =</span> <span class="st">&quot;Pers à faible revenu (%)&quot;</span>,</span>
<span id="cb754-50"><a href="sect077.html#cb754-50"></a>       <span class="dt">fill =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb754-51"><a href="sect077.html#cb754-51"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;IC 97,5 %&quot;</span>)</span>
<span id="cb754-52"><a href="sect077.html#cb754-52"></a></span>
<span id="cb754-53"><a href="sect077.html#cb754-53"></a><span class="kw">ggarrange</span>(P1,P2,P3,<span class="dt">common.legend =</span> F, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ModeleInteraction2heatex"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/ModeleInteraction2heatex-1.png" alt="Effet marginal de l'interaction entre deux variables continues" width="95%" />
<p class="caption">
Figure 7.23: Effet marginal de l’interaction entre deux variables continues
</p>
</div>
</div>
<div id="sect07747" class="section level4">
<h4><span class="header-section-number">7.7.4.7</span> Effet marginal pour une variable d’interaction (une VI continue et une VI dichotomique)</h4>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="sect077.html#cb755-1"></a>df &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb755-2"><a href="sect077.html#cb755-2"></a>  <span class="dt">VilleMtl =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb755-3"><a href="sect077.html#cb755-3"></a>  <span class="dt">Pct_FR =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">95</span>,<span class="dv">1</span>),</span>
<span id="cb755-4"><a href="sect077.html#cb755-4"></a>  <span class="dt">HABHA =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>HABHA),</span>
<span id="cb755-5"><a href="sect077.html#cb755-5"></a>  <span class="dt">AgeMedian =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>AgeMedian),</span>
<span id="cb755-6"><a href="sect077.html#cb755-6"></a>  <span class="dt">Pct_014 =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>Pct_<span class="dv">014</span>),</span>
<span id="cb755-7"><a href="sect077.html#cb755-7"></a>  <span class="dt">Pct_65P =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>Pct_65P),</span>
<span id="cb755-8"><a href="sect077.html#cb755-8"></a>  <span class="dt">Pct_MV =</span> <span class="kw">mean</span>(DataFinal<span class="op">$</span>Pct_MV)</span>
<span id="cb755-9"><a href="sect077.html#cb755-9"></a>)</span>
<span id="cb755-10"><a href="sect077.html#cb755-10"></a>df<span class="op">$</span>VilleMtlX_Pct_FR &lt;-<span class="st"> </span>df<span class="op">$</span>VilleMtl <span class="op">*</span><span class="st"> </span>df<span class="op">$</span>Pct_FR</span>
<span id="cb755-11"><a href="sect077.html#cb755-11"></a></span>
<span id="cb755-12"><a href="sect077.html#cb755-12"></a><span class="kw">head</span>(df, <span class="dt">n=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>##   VilleMtl Pct_FR   HABHA AgeMedian  Pct_014  Pct_65P   Pct_MV VilleMtlX_Pct_FR
## 1        0      0 87.7694  52.11494 15.89268 14.86761 20.96675                0
## 2        1      0 87.7694  52.11494 15.89268 14.86761 20.96675                0
## 3        0      1 87.7694  52.11494 15.89268 14.86761 20.96675                0
## 4        1      1 87.7694  52.11494 15.89268 14.86761 20.96675                1
## 5        0      2 87.7694  52.11494 15.89268 14.86761 20.96675                0</code></pre>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="sect077.html#cb757-1"></a>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(modele7, <span class="dt">se =</span> T, <span class="dt">newdata =</span> df)</span>
<span id="cb757-2"><a href="sect077.html#cb757-2"></a>df<span class="op">$</span>pred &lt;-<span class="st"> </span>pred<span class="op">$</span>fit</span>
<span id="cb757-3"><a href="sect077.html#cb757-3"></a>df<span class="op">$</span>upper &lt;-<span class="st"> </span>df<span class="op">$</span>pred <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>pred<span class="op">$</span>se.fit</span>
<span id="cb757-4"><a href="sect077.html#cb757-4"></a>df<span class="op">$</span>lower &lt;-<span class="st"> </span>df<span class="op">$</span>pred <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>pred<span class="op">$</span>se.fit</span>
<span id="cb757-5"><a href="sect077.html#cb757-5"></a></span>
<span id="cb757-6"><a href="sect077.html#cb757-6"></a>df<span class="op">$</span>VilleMtl_str &lt;-<span class="st"> </span><span class="kw">ifelse</span>(df<span class="op">$</span>VilleMtl<span class="op">==</span><span class="dv">0</span>,<span class="st">&quot;Autre municipalité&quot;</span>,<span class="st">&quot;Ville de Montréal&quot;</span>)</span>
<span id="cb757-7"><a href="sect077.html#cb757-7"></a>DataFinal<span class="op">$</span>VilleMtl_str &lt;-<span class="st"> </span><span class="kw">ifelse</span>(DataFinal<span class="op">$</span>VilleMtl<span class="op">==</span><span class="dv">0</span>,<span class="st">&quot;Autre municipalité&quot;</span>,<span class="st">&quot;Ville de Montréal&quot;</span>)</span>
<span id="cb757-8"><a href="sect077.html#cb757-8"></a></span>
<span id="cb757-9"><a href="sect077.html#cb757-9"></a>cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Autre municipalité&quot;</span> =<span class="st">&quot;#1d3557&quot;</span> ,<span class="st">&quot;Ville de Montréal&quot;</span>=<span class="st">&quot;#e63946&quot;</span>)</span>
<span id="cb757-10"><a href="sect077.html#cb757-10"></a></span>
<span id="cb757-11"><a href="sect077.html#cb757-11"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df) <span class="op">+</span></span>
<span id="cb757-12"><a href="sect077.html#cb757-12"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> DataFinal, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Pct_FR, <span class="dt">y =</span> VegPct, <span class="dt">color =</span> VilleMtl_str),</span>
<span id="cb757-13"><a href="sect077.html#cb757-13"></a>             <span class="dt">size =</span> <span class="fl">0.2</span>, <span class="dt">alpha =</span> <span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb757-14"><a href="sect077.html#cb757-14"></a><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Pct_FR, <span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper, <span class="dt">group =</span> VilleMtl_str),</span>
<span id="cb757-15"><a href="sect077.html#cb757-15"></a>              <span class="dt">fill =</span> <span class="kw">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>))<span class="op">+</span></span>
<span id="cb757-16"><a href="sect077.html#cb757-16"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Pct_FR, <span class="dt">y =</span> pred, <span class="dt">color =</span> VilleMtl_str), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb757-17"><a href="sect077.html#cb757-17"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> cols)<span class="op">+</span></span>
<span id="cb757-18"><a href="sect077.html#cb757-18"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Personnes à faible revenu (%)&quot;</span>,</span>
<span id="cb757-19"><a href="sect077.html#cb757-19"></a>       <span class="dt">y =</span> <span class="st">&quot;Densité de végétation prédite (%)&quot;</span>,</span>
<span id="cb757-20"><a href="sect077.html#cb757-20"></a>       <span class="dt">color =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ModeleInteractionBinaireeffectex"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/ModeleInteractionBinaireeffectex-1.png" alt="Graphique de l’effet marginal de l’interaction entre une variable quantitative et qualitative" width="2100" />
<p class="caption">
Figure 7.24: Graphique de l’effet marginal de l’interaction entre une variable quantitative et qualitative
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect076.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect078.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MethodesQuantitScSocialesBolR.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
