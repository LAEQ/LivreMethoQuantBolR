<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.1 Agrégats d’entités spatiales ponctuelles | Notes de cours GMQ405 : Modélisation et analyse spatiale</title>
  <meta name="description" content="Mettre le description du cours." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="4.1 Agrégats d’entités spatiales ponctuelles | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Mettre le description du cours." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.1 Agrégats d’entités spatiales ponctuelles | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  
  <meta name="twitter:description" content="Mettre le description du cours." />
  <meta name="twitter:image" content="/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio, département de géomatique appliquée, Université de Sherbrooke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chap04.html"/>
<link rel="next" href="sect042.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GMQ405 : modélisation et analyse spatiale</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Comment lire ce manuel?</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en géomatique appliquée et utiliser R?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
</ul></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Manipulation des données spatiales dans R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Importation de données géographiques</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sect011.html"><a href="sect011.html#sect0111"><i class="fa fa-check"></i><b>1.1.1</b> Importation de données vectorielles</a></li>
<li class="chapter" data-level="1.1.2" data-path="sect011.html"><a href="sect011.html#sect0112"><i class="fa fa-check"></i><b>1.1.2</b> Importation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Manipulation de données vectorielles</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Fonctions relatives à la projection cartographique</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Fonctions d’opérations géométriques sur une couche</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect01213"><i class="fa fa-check"></i><b>1.2.3</b> Fonctions d’opérations géométriques entre deux couches</a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#sect0124"><i class="fa fa-check"></i><b>1.2.4</b> Fonctions de mesures géométriques et de récupération des coordonnées géographiques</a></li>
<li class="chapter" data-level="1.2.5" data-path="sect012.html"><a href="sect012.html#sect0125"><i class="fa fa-check"></i><b>1.2.5</b> Jointures spatiales</a></li>
<li class="chapter" data-level="1.2.6" data-path="sect012.html"><a href="sect012.html#sect0126"><i class="fa fa-check"></i><b>1.2.6</b> Requêtes spatiales</a></li>
<li class="chapter" data-level="1.2.7" data-path="sect012.html"><a href="sect012.html#sect0127"><i class="fa fa-check"></i><b>1.2.7</b> Manipulation des données attributaires</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Manipulation de données <em>raster</em></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> Mosaïquage et découpage d’images</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Requêtes attributaires sur des images</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Exportation de données spatiales de R vers des formats géographiques</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Exportation de données vectorielles <code>sf</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Exportation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect015.html"><a href="sect015.html"><i class="fa fa-check"></i><b>1.5</b> Cartographie avec R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sect015.html"><a href="sect015.html#sect0151"><i class="fa fa-check"></i><b>1.5.1</b> Manipulation des couches géométriques</a></li>
<li class="chapter" data-level="1.5.2" data-path="sect015.html"><a href="sect015.html#sect0152"><i class="fa fa-check"></i><b>1.5.2</b> Cartes interactives</a></li>
<li class="chapter" data-level="1.5.3" data-path="sect015.html"><a href="sect015.html#sect0153"><i class="fa fa-check"></i><b>1.5.3</b> Mise en page d’une carte</a></li>
<li class="chapter" data-level="1.5.4" data-path="sect015.html"><a href="sect015.html#sect0154"><i class="fa fa-check"></i><b>1.5.4</b> Exportation d’une carte</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.6</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="1.7" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.7</b> Exercices de révision</a></li>
</ul></li>
<li class="part"><span><b>II Autocorrélation spatiale</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Autocorrélation spatiale</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion d’autocorrélation spatiale</a></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Matrices de pondération spatiale</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Matrices de contiguïté</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Matrices de proximité spatiale</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Standardisation des matrices de pondération spatiale en ligne</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Construction de matrices de pondération spatiale dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Autocorrélation spatiale globale</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Statistique du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Autocorrélation spatiale locale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#sect0241"><i class="fa fa-check"></i><b>2.4.1</b> Statistiques locales de Getis et Ord : repérer les points chauds et froids</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#sect0242"><i class="fa fa-check"></i><b>2.4.2</b> Version locale du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#sect0243"><i class="fa fa-check"></i><b>2.4.3</b> Nuage de points du <em>I</em> de Moran d’Anselin</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Méthodes de répartition ponctuelle</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Fréquence et densité des points dans l’espace d’étude</a></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Analyse centrographique</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0311"><i class="fa fa-check"></i><b>3.2.1</b> Paramètres de tendance centrale d’un semis de points</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0312"><i class="fa fa-check"></i><b>3.2.2</b> Paramètres de dispersion d’un semis de points</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0313"><i class="fa fa-check"></i><b>3.2.3</b> Mise en œuvre de l’analyse centrographique dans R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Forme d’un semis de points</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Méthode du plus proche voisin</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Méthode des quadrats</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Identification des agrégats spatiaux</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sect034.html"><a href="sect034.html#sect0341"><i class="fa fa-check"></i><b>3.4.1</b> Cartographie de la densité dans une maille irrégulière</a></li>
<li class="chapter" data-level="3.4.2" data-path="sect034.html"><a href="sect034.html#sect0342"><i class="fa fa-check"></i><b>3.4.2</b> Cartographie de la densité dans une maille régulière</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Méthodes de détection d’agrégats spatiaux et spatio-temporels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Agrégats d’entités spatiales ponctuelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sect041.html"><a href="sect041.html#sect0411"><i class="fa fa-check"></i><b>4.1.1</b> DBSCAN : agrégats spatiaux</a></li>
<li class="chapter" data-level="4.1.2" data-path="sect041.html"><a href="sect041.html#sect0412"><i class="fa fa-check"></i><b>4.1.2</b> ST-DBSCAN : agrégats spatio-temporels</a></li>
<li class="chapter" data-level="4.1.3" data-path="sect041.html"><a href="sect041.html#sect0414"><i class="fa fa-check"></i><b>4.1.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Méthodes de balayage de Kulldorff</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Objectifs de la méthode, types d’analyses, de modèles et d’agrégats</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Principes de base de la méthode</a></li>
<li class="chapter" data-level="4.2.3" data-path="sect042.html"><a href="sect042.html#sect043"><i class="fa fa-check"></i><b>4.2.3</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="4.4" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Mesures d’accessibilité spatiale selon les différents de modes de transport</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Notions relatives à l’analyse de réseau</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sect051.html"><a href="sect051.html#sect0511"><i class="fa fa-check"></i><b>5.1.1</b> Définition d’un réseau</a></li>
<li class="chapter" data-level="5.1.2" data-path="sect051.html"><a href="sect051.html#sect0512"><i class="fa fa-check"></i><b>5.1.2</b> Principaux problèmes résolus en analyse de réseau</a></li>
<li class="chapter" data-level="5.1.3" data-path="sect051.html"><a href="sect051.html#sect0513"><i class="fa fa-check"></i><b>5.1.3</b> Analyse de réseau et entités polygonales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Construction d’un réseau avec R5R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sect052.html"><a href="sect052.html#sect0521"><i class="fa fa-check"></i><b>5.2.1</b> Extraction des données spatiales pour R5R</a></li>
<li class="chapter" data-level="5.2.2" data-path="sect052.html"><a href="sect052.html#sect0522"><i class="fa fa-check"></i><b>5.2.2</b> Construction du réseau avec R5R</a></li>
<li class="chapter" data-level="5.2.3" data-path="sect052.html"><a href="sect052.html#sect0523"><i class="fa fa-check"></i><b>5.2.3</b> Calcul d’itinéraires avec R5R selon le mode de transport</a></li>
<li class="chapter" data-level="5.2.4" data-path="sect052.html"><a href="sect052.html#sect0524"><i class="fa fa-check"></i><b>5.2.4</b> Calcul de matrices OD selon différents modes de transport</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mesures d’accessibilité</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sect053.html"><a href="sect053.html#sect0531"><i class="fa fa-check"></i><b>5.3.1</b> Notion d’accessibilité</a></li>
<li class="chapter" data-level="5.3.2" data-path="sect053.html"><a href="sect053.html#sect0532"><i class="fa fa-check"></i><b>5.3.2</b> Accessibilité spatiale potentielle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Mesures d’accessibilité spatiale potentielle dans R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="sect054.html"><a href="sect054.html#sect0541"><i class="fa fa-check"></i><b>5.4.1</b> Accessibilité spatiale potentielle aux supermarchés</a></li>
<li class="chapter" data-level="5.4.2" data-path="sect054.html"><a href="sect054.html#sect0542"><i class="fa fa-check"></i><b>5.4.2</b> Accessibilité spatiale potentielle aux patinoires extérieures</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Introduction aux modèles de régression spatiale</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Modèles spatiaux autorégressifs</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Les différents modèles</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Quel modèle choisir?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Autres approches de modélisation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Modèles généralisées additifs (GAM) avec une <em>spline</em> bivariée sur les coordonnées géographiques</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> GAM avec <em>random markov field</em></a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Modèle SEVM (<em>Spatial eigenvector mapping</em>)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Modèles géographiquement pondérées</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sect063.html"><a href="sect063.html#sect0631"><i class="fa fa-check"></i><b>6.3.1</b> Modèles GWR classique</a></li>
<li class="chapter" data-level="6.3.2" data-path="sect063.html"><a href="sect063.html#sect0632"><i class="fa fa-check"></i><b>6.3.2</b> Modèles GWR mixte</a></li>
<li class="chapter" data-level="6.3.3" data-path="sect063.html"><a href="sect063.html#sect0633"><i class="fa fa-check"></i><b>6.3.3</b> Modèle MGWR</a></li>
<li class="chapter" data-level="6.3.4" data-path="sect063.html"><a href="sect063.html#sect0634"><i class="fa fa-check"></i><b>6.3.4</b> Modèles MGWR avec autocorrélation spatiale (MGWRSAR)</a></li>
<li class="chapter" data-level="6.3.5" data-path="sect063.html"><a href="sect063.html#sect0635"><i class="fa fa-check"></i><b>6.3.5</b> Extension des modèles GWR pour des variables binaires et de comptages</a></li>
<li class="chapter" data-level="6.3.6" data-path="sect063.html"><a href="sect063.html#sect0636"><i class="fa fa-check"></i><b>6.3.6</b> Autres extensions de la GWR : un aperçu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Introduction aux méthodes de classification spatiale</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Bref retour sur les méthodes de classification non-supervisées</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sect071.html"><a href="sect071.html#sect0711"><i class="fa fa-check"></i><b>7.1.1</b> Classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="7.1.2" data-path="sect071.html"><a href="sect071.html#sect0712"><i class="fa fa-check"></i><b>7.1.2</b> <em>K-means</em></a></li>
<li class="chapter" data-level="7.1.3" data-path="sect071.html"><a href="sect071.html#sect0713"><i class="fa fa-check"></i><b>7.1.3</b> <em>Fuzzy c-means</em></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Méthodes de classification par agrégation intégrant une constrainte spatiale</a></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Classifications spatiales</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Classification ascendante hiérarchique spatiale (<em>ClustGeo</em>)</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> <em>Spatial fuzzy c-means</em> (SFCM)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Méthodes d’interpolation spatiale</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Méthodes déterministes</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Interpolation polynomiale locale</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Interpolation de l’inverse à la distance - <em>IDW</em></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Méthodes géostatistiques</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Krigeage simple</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Krigeage universel</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Co-krigeage</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Krigeage résiduel</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect083.html"><a href="sect083.html"><i class="fa fa-check"></i><b>8.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="8.4" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Analyse spatiale par l’analyse d’images</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Fonctions mathématiques, booléennes, relationnelles et conditionnelles sur les images</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Fonctions mathématiques</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Fonctions booléennes</a></li>
<li class="chapter" data-level="9.1.3" data-path="sect091.html"><a href="sect091.html#sect0913"><i class="fa fa-check"></i><b>9.1.3</b> Fonctions relationnelles</a></li>
<li class="chapter" data-level="9.1.4" data-path="sect091.html"><a href="sect091.html#sect0914"><i class="fa fa-check"></i><b>9.1.4</b> Fonctions conditionnelles</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Fonctions locales, focales, zonales et globales sur les images</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> Fonctions locales</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0922"><i class="fa fa-check"></i><b>9.2.2</b> Fonctions focales</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.3</b> Fonctions zonales</a></li>
<li class="chapter" data-level="9.2.4" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.4</b> Fonctions globales</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Fonctions de surface</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Élevation</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Pente</a></li>
<li class="chapter" data-level="9.3.3" data-path="sect093.html"><a href="sect093.html#sect0933"><i class="fa fa-check"></i><b>9.3.3</b> Ombrage</a></li>
<li class="chapter" data-level="9.3.4" data-path="sect093.html"><a href="sect093.html#sect0934"><i class="fa fa-check"></i><b>9.3.4</b> Visibilité</a></li>
<li class="chapter" data-level="9.3.5" data-path="sect093.html"><a href="sect093.html#sect0935"><i class="fa fa-check"></i><b>9.3.5</b> Sky-view factor Index</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Données spatiotemporelles en mode image</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#fichier-netcdf"><i class="fa fa-check"></i><b>9.4.1</b> Fichier <em>netCDF</em></a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#exemples-applicatifs"><i class="fa fa-check"></i><b>9.4.2</b> Exemples applicatifs</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Correction des exercices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect1001.html"><a href="sect1001.html"><i class="fa fa-check"></i><b>10.1</b> Exercices du chapitre 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect1001.html"><a href="sect1001.html#sect10011"><i class="fa fa-check"></i><b>10.1.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect1001.html"><a href="sect1001.html#sect10012"><i class="fa fa-check"></i><b>10.1.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="sect1001.html"><a href="sect1001.html#sect10013"><i class="fa fa-check"></i><b>10.1.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="sect1001.html"><a href="sect1001.html#sect10014"><i class="fa fa-check"></i><b>10.1.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect1002.html"><a href="sect1002.html"><i class="fa fa-check"></i><b>10.2</b> Exercices du chapitre 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect1002.html"><a href="sect1002.html#sect10021"><i class="fa fa-check"></i><b>10.2.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect1002.html"><a href="sect1002.html#sect10022"><i class="fa fa-check"></i><b>10.2.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.2.3" data-path="sect1002.html"><a href="sect1002.html#sect10023"><i class="fa fa-check"></i><b>10.2.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.2.4" data-path="sect1002.html"><a href="sect1002.html#sect10024"><i class="fa fa-check"></i><b>10.2.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect1003.html"><a href="sect1003.html"><i class="fa fa-check"></i><b>10.3</b> Exercices du chapitre 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sect1003.html"><a href="sect1003.html#sect10031"><i class="fa fa-check"></i><b>10.3.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="sect1003.html"><a href="sect1003.html#sect10032"><i class="fa fa-check"></i><b>10.3.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.3.3" data-path="sect1003.html"><a href="sect1003.html#sect10033"><i class="fa fa-check"></i><b>10.3.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sect1004.html"><a href="sect1004.html"><i class="fa fa-check"></i><b>10.4</b> Exercices du chapitre 4</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect1004.html"><a href="sect1004.html#sect10041"><i class="fa fa-check"></i><b>10.4.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect1004.html"><a href="sect1004.html#sect10042"><i class="fa fa-check"></i><b>10.4.2</b> Exercice 2</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect1005.html"><a href="sect1005.html"><i class="fa fa-check"></i><b>10.5</b> Exercices du chapitre 5</a></li>
<li class="chapter" data-level="10.6" data-path="sect1006.html"><a href="sect1006.html"><i class="fa fa-check"></i><b>10.6</b> Exercices du chapitre 6</a></li>
<li class="chapter" data-level="10.7" data-path="sect1007.html"><a href="sect1007.html"><i class="fa fa-check"></i><b>10.7</b> Exercices du chapitre 7</a></li>
<li class="chapter" data-level="10.8" data-path="sect1008.html"><a href="sect1008.html"><i class="fa fa-check"></i><b>10.8</b> Exercices du chapitre 8</a></li>
<li class="chapter" data-level="10.9" data-path="sect1009.html"><a href="sect1009.html"><i class="fa fa-check"></i><b>10.9</b> Exercices du chapitre 9</a></li>
<li class="chapter" data-level="10.10" data-path="sect1011.html"><a href="sect1011.html"><i class="fa fa-check"></i><b>10.10</b> Exercices du chapitre 11</a></li>
<li class="chapter" data-level="10.11" data-path="sect1012.html"><a href="sect1012.html"><i class="fa fa-check"></i><b>10.11</b> Excercice du chapitre 12</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours GMQ405 :
Modélisation et analyse spatiale</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect041" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Agrégats d’entités spatiales ponctuelles<a href="sect041.html#sect041" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sect0411" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> DBSCAN : agrégats spatiaux<a href="sect041.html#sect0411" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="bloc_objectif">
<p>Dans le chapitre précédent, portant sur les <em>méthodes de répartition ponctuelles</em>, nous avons abordé la méthode KDE permettant de cartographier la densité de points dans une maille régulière (section <a href="sect034.html#sect0342">3.4.2</a>). La carte de chaleur obtenue avec le KDE représente les valeurs de densité (variable continue) pour les pixels couvrant le territoire à l’étude.</p>
<p>Avec l’algorithme DBSCAN <span class="citation">(<a href="#ref-DBSCAN1996" role="doc-biblioref">Ester et al. 1996</a>)</span>, l’objectif est différent : il s’agit d’identifier des agrégats spatiaux d’évènements ponctuels dans un territoire donné (par exemple, des cas de maladies, d’accidents, d’espèces fauniques ou végétales, de crimes, etc.). Autrement dit, il s’agit d’identifier plusieurs régions du territoire à l’étude dans lesquelles la densité de points est forte.</p>
<p>Concrètement, si la méthode KDE renvoie une variable continue pour l’ensemble du territoire, l’algorithme DBSCAN renvoie une variable qualitative uniquement pour les points du jeu de données.</p>
</div>
<div id="sect04111" class="section level4 hasAnchor" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Fonctionnement de DBSCAN<a href="sect041.html#sect04111" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>DBSCAN (<em><strong>D</strong>ensity-<strong>B</strong>ased <strong>S</strong>patial <strong>C</strong>lustering of <strong>A</strong>pplications with <strong>N</strong>oise</em>) est un algorithme de classification non supervisée qui regroupe des observations en fonction de <strong>leur densité</strong> dans un espace à deux, trois ou <em>n</em> dimensions <span class="citation">(<a href="#ref-DBSCAN1996" role="doc-biblioref">Ester et al. 1996</a>)</span>. Comme pour toute autre méthode de classification non supervisée, ces dimensions sont des variables. Par conséquent, en appliquant DBSCAN sur les coordonnées géographiques d’entités ponctuelles 2D (<em>x</em>, <em>y</em>) ou 3D (<em>x</em>, <em>y</em>, <em>z</em>), nous classifions les points du jeu de données.</p>
<p>Prenons un jeu de données fictives (figure <a href="sect041.html#fig:DonnesFictivesDBSCAN">4.1</a>.a). À l’œil nu, nous identifions clairement cinq régions distinctes avec une forte densité de points et des zones de faible densité; ces dernières étant représentées par les points noirs avec DBSCAN (figure <a href="sect041.html#fig:DonnesFictivesDBSCAN">4.1</a>.b).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DonnesFictivesDBSCAN"></span>
<img src="GMQ405_files/figure-html/DonnesFictivesDBSCAN-1.png" alt="Jeu de données fictives et classification DBSCAN avec cinq classes" width="75%" />
<p class="caption">
Figure 4.1: Jeu de données fictives et classification DBSCAN avec cinq classes
</p>
</div>
<p>L’intérêt majeur de l’algorithme DBSCAN est qu’il est basé sur la <strong>densité des points</strong> et non sur la <strong>distance entre les points</strong> comme les algorithmes classiques de classification non supervisée que sont les k-moyennes, k-médianes, k-médoïdes ou la classification ascendante hiérarchique. Tel qu’illustré à la figure <a href="sect041.html#fig:AutresMethodesClassifNonSuperv">4.2</a>, utiliser la distance pour identifier cinq groupes de points renvoient des résultats peu convaincants. D’une part, tous les points appartiennent à une classe, sans séparer les régions de fortes et de faibles densité. D’autre part, les algorithmes classiques basés sur la distance ne parviennent pas à bien identifier les deux agrégats circulaires (bleu et rouge à la figure <a href="sect041.html#fig:DonnesFictivesDBSCAN">4.1</a>.b) et parfois linéaires (vert et mauve à la figure <a href="sect041.html#fig:DonnesFictivesDBSCAN">4.1</a>.b).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:AutresMethodesClassifNonSuperv"></span>
<img src="GMQ405_files/figure-html/AutresMethodesClassifNonSuperv-1.png" alt="Classification avec d'autres algorithmes basés sur la distance" width="75%" />
<p class="caption">
Figure 4.2: Classification avec d’autres algorithmes basés sur la distance
</p>
</div>
<p>L’algorithme DBSCAN comprend deux paramètres qui doivent être définis par la personne utilisatrice :</p>
<ul>
<li><strong>Le rayon de recherche</strong>, dénommé <span class="math inline">\(\epsilon\)</span> (epsilon), habituellement basé sur la distance euclidienne. Les distances de Manhattan ou réticulaires peuvent aussi être utilisées.</li>
<li><strong>Le nombre minimum de points</strong>, dénommé <span class="math inline">\(MinPts\)</span>, requis pour qu’un point, incluant lui-même, soit considéré comme un point central et appartienne à un agrégat, un regroupement (<em>cluster</em> en anglais).</li>
</ul>
<div class="bloc_notes">
<p><strong>Avantage de DBSCAN : nul besoin de spécifier le nombre d’agrégats (<em>clusters</em>)!</strong></p>
<p>Comparativement à d’autres méthodes de classification non supervisées comme les k-moyennes, k-médianes et k-médoïdes, DBSCAN ne requiert pas de spécifier le nombre de classes à identifier dans le jeu de données. Autrement dit, appliqué à des géométries ponctuelles, l’algorithme DBSCAN détecte autant d’agrégats spatiaux que nécessaires en fonction des valeurs des deux paramètres (<span class="math inline">\(\epsilon\)</span> et <span class="math inline">\(MinPts\)</span>).</p>
</div>
<p>À la figure <a href="sect041.html#fig:TypesPointsDBSCAN">4.3</a>, nous appliquons l’algorithme DBSCAN à un semis de points avec un rayon de recherche de 500 mètres (<span class="math inline">\(\epsilon=500\)</span>) et un nombre minimum de cinq points (<span class="math inline">\(MinPts = 5\)</span>). Dans un premier temps, l’algorithme distingue trois types de points :</p>
<ol style="list-style-type: decimal">
<li>Des <strong>points centraux</strong> (<em>core points</em> en anglais) qui ont au moins cinq points (incluant eux-mêmes) dans un rayon de 500 mètres (points rouges).</li>
<li>Des <strong>points frontières</strong> (<em>border points</em>) qui ont moins de cinq points (incluant eux-mêmes) dans un rayon de 500 mètres, mais qui sont inclus dans la zone tampon de 500 mètres d’un point central (points bleus).</li>
<li>Des <strong>points aberrants</strong> (<em>noise points</em>) qui ont moins de cinq points (incluant eux-mêmes) dans un rayon de 500 mètres et qui ne sont pas inclus dans la zone tampon d’un point central (points noirs).</li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:TypesPointsDBSCAN"></span>
<img src="images/Chap04/DbscanTypesPoints.png" alt="Trois types de points identifiés par l'algorithme DBSCAN" width="75%" />
<p class="caption">
Figure 4.3: Trois types de points identifiés par l’algorithme DBSCAN
</p>
</div>
<p>Par la suite, les étapes de l’algorithme sont les suivantes :</p>
<ul>
<li><strong>Étape 1.</strong> Formation du premier agrégat
<ul>
<li>Nous tirons au hasard un point central et l’assignons au premier agrégat (groupe ou <em>cluster</em>).</li>
<li>Puis, les points compris dans la zone tampon du premier point central sont ajoutés à ce premier agrégat.</li>
<li>De façon itérative, nous étendons l’agrégat avec les points centraux ou frontières qui sont compris dans les zones tampons des points ajoutés précédemment.</li>
</ul></li>
<li><strong>Étape 2.</strong> Formation d’autres agrégats
<ul>
<li>Lorsque le premier agrégat est complété, nous tirons au hasard un autre point central n’appartenant pas au premier agrégat.</li>
<li>Nous appliquons la même démarche qu’à l’étape 1 pour étendre et compléter cet autre agrégat.</li>
<li>Les deux sous-étapes ci-dessus sont répétées jusqu’à que tous les points centraux et frontières soient assignés à un agrégat.</li>
</ul></li>
</ul>
<p>Nous obtenons ainsi <em>k</em> agrégats (valeurs de 1 à <em>k</em>) tandis que les points aberrants sont affectés à la même classe (valeur de 0 habituellement). Appliqué au semis de points, DBSCAN a détecté deux agrégats et quatre points aberrants (figure <a href="sect041.html#fig:ResultatsDBSCAN">4.4</a>)</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ResultatsDBSCAN"></span>
<img src="images/Chap04/DbscanResultats.png" alt="Résultats de l'algorithme DBSCAN" width="75%" />
<p class="caption">
Figure 4.4: Résultats de l’algorithme DBSCAN
</p>
</div>
</div>
<div id="sect04112" class="section level4 hasAnchor" number="4.1.1.2">
<h4><span class="header-section-number">4.1.1.2</span> Sensibilité et optimisation des paramètres de DBSCAN<a href="sect041.html#sect04112" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Les résultats de l’algorithme de DBSCAN varient en fonction de ses deux paramètres, soit le rayon de recherche (<span class="math inline">\(\epsilon\)</span>) et le nombre minimum de points (<span class="math inline">\(MinPts\)</span>).</p>
<p>Concernant le paramètre <span class="math inline">\(\epsilon\)</span>, plus sa valeur est réduite, plus le nombre de points identifiés comme aberrants est important. Inversement, plus elle est grande, plus le nombre d’agrégats diminue. En guise d’illustration, faisons varier la valeur du rayon en maintenant à cinq le nombre minimum de points :</p>
<ul>
<li>Avec un rayon de 250 mètres, cinq agrégats sont identifiés tandis que 29 points sont considérés comme du bruit (figure <a href="sect041.html#fig:VariationResultatsDBSCAN">4.5</a>.a).</li>
<li>Avec un rayon de 500 mètres, la solution semble plus optimale avec deux agrégats et cinq points aberrants (figure <a href="sect041.html#fig:VariationResultatsDBSCAN">4.5</a>.b).</li>
<li>Avec un rayon de 1000 mètres, deux agrégats sont aussi identifiés. Par contre, il ne reste plus qu’un point aberrant. Par conséquent, quatre points qui, à l’œil nu, sont très éloignés d’un agrégat y sont pourtant affectés (figure <a href="sect041.html#fig:VariationResultatsDBSCAN">4.5</a>.c).</li>
<li>Avec un rayon de 1500 mètres, tous les points sont affectés à un et un seul agrégat (figure <a href="sect041.html#fig:VariationResultatsDBSCAN">4.5</a>.d).</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:VariationResultatsDBSCAN"></span>
<img src="images/Chap04/DbscanResultatsVariation.png" alt="Variations de résultats de l'algorithme DBSCAN selon la taille du rayon" width="75%" />
<p class="caption">
Figure 4.5: Variations de résultats de l’algorithme DBSCAN selon la taille du rayon
</p>
</div>
<p>Concernant le paramètre <span class="math inline">\(MinPts\)</span>, plusieurs règles de pouce (à la louche) ont été proposées pour fixer sa valeur :</p>
<ul>
<li><span class="math inline">\(MinPts \geq dim(D) + 1\)</span>, c’est-à-dire que sa valeur doit être minimalement égale au nombre de dimensions plus un (variables) du jeu de données.</li>
<li><span class="math inline">\(MinPts = dim(D) \times 2\)</span>, c’est-à dire que le nombre de points devrait être égal à deux fois le nombre de dimensions du tableau <span class="citation">(<a href="#ref-sander1998density" role="doc-biblioref">Sander et al. 1998</a>)</span>.</li>
<li><span class="math inline">\(MinPts = 4\)</span> quand le jeu de données ne comprend que deux dimensions <span class="citation">(<a href="#ref-DBSCAN1996" role="doc-biblioref">Ester et al. 1996</a>)</span>, soit un critère qui s’applique à des géométries ponctuelles 2D.</li>
</ul>
<p>Une fois fixé le nombre minimal de points, nous pouvons optimiser la valeur du rayon de recherche de la façon suivante :</p>
<ul>
<li>Pour chacun des points, nous calculons la distance au <em>k</em><sup>ième</sup> point le plus proche.</li>
<li>Nous trions les valeurs obtenues pour construire un graphique en courbe.</li>
<li>Dans ce graphique, le <em>critère du coude</em> est utilisé pour repérer la ou les valeurs signalant un décrochement dans la courbe. À la lecture de la figure <a href="sect041.html#fig:KPlusProcheDbScan">4.6</a>, les valeurs d’epsilon (<span class="math inline">\(\epsilon\)</span>) à retenir pourraient être 300, 350, 425 et 450 mètres.</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:KPlusProcheDbScan"></span>
<img src="GMQ405_files/figure-html/KPlusProcheDbScan-1.png" alt="Optimisation de la valeur d'epsilon" width="65%" />
<p class="caption">
Figure 4.6: Optimisation de la valeur d’epsilon
</p>
</div>
<p>Si vous repérez plusieurs seuils de distance dans le graphique des distances au <em>k</em> plus proche voisin, réalisez et comparez les résultats des DBSCAN avec ces valeurs d’epsilon. À la figure <a href="sect041.html#fig:DbscanResultatsOptimatisationEpsilon">4.7</a>, nous constatons que les résultats avec des seuils de 425 et 450 sont identiques et semblent optimaux. Par contre, la solution avec un rayon de 350 mètres identifie deux points aberrants qui pourraient être intégrés au deuxième agrégat tandis que celle avec un rayon de 300 mètres identifie un agrégat supplémentaire, mais classifie de nombreux points comme aberrants.</p>
<div class="bloc_attention">
<p><strong>Quel résultat choisir parmi les quatre solutions?</strong></p>
<p>Comme pour toute analyse de classification, votre choix peut être objectif et reposer uniquement sur des indicateurs statistiques (ici, le graphique des distances au <em>k</em> plus proche voisin). Il devrait aussi s’appuyer sur vos connaissances du terrain. Selon vous, l’identification d’un troisième agrégat avec une valeur d’epsilon fixée à 300 mètres pourrait refléter une réalité terrain particulièrement intéressante qui motiverait fortement le choix de cette solution.</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DbscanResultatsOptimatisationEpsilon"></span>
<img src="images/Chap04/DbscanResultatsOptimatisationEpsilon.png" alt="Comparaison de solutions DBSCAN avec différentes valeurs d'epsilon" width="75%" />
<p class="caption">
Figure 4.7: Comparaison de solutions DBSCAN avec différentes valeurs d’epsilon
</p>
</div>
<div class="bloc_aller_loin">
<p><strong>Autres algorithmes de classification non supervisée basée sur la densité</strong></p>
<p>Bien que DBSCAN soit certainement l’algorithme le plus utilisé, d’autres algorithmes basés sur la densité peuvent être utilisés pour détecter des agrégats spatiaux de points, notamment :</p>
<ul>
<li>HDBSCAN (<em><strong>H</strong>ierarchical <strong>D</strong>ensity-<strong>B</strong>ased <strong>S</strong>patial <strong>C</strong>lustering of <strong>A</strong>pplications with <strong>N</strong>oise</em>) <span class="citation">(<a href="#ref-HDBSCAN2013" role="doc-biblioref">Campello, Moulavi et Sander 2013</a>)</span>. Brièvement, cette version modifiée de DBSCAN permet d’obtenir une hiérarchie de partitions, comme dans une classification ascendante hiérarchique.</li>
<li>OPTICS (<em><strong>O</strong>rdering <strong>P</strong>oints <strong>T</strong>o <strong>I</strong>dentify the <strong>C</strong>lustering <strong>S</strong>tructure</em>) <span class="citation">(<a href="#ref-HDBSCAN2013" role="doc-biblioref">Campello, Moulavi et Sander 2013</a>)</span>. À titre de rappel, l’algorithme DBSCAN a deux paramètres, soit le nombre minimal de points (<span class="math inline">\(MinPts\)</span>) et la distance de voisinage (<span class="math inline">\(\epsilon\)</span>). Avec OPTICS, le second paramètre n’a pas besoin d’être spécifié. Succinctement, pour chaque point du jeu de données, il utilise la distance au <span class="math inline">\(k\)</span> (<span class="math inline">\(MinPts\)</span>) plus proche voisin.</li>
</ul>
<p><strong>Application à des évènements localisés sur un réseau de rues</strong></p>
<p>Lorsque les évènements sont localisés sur un réseau de rues (des accidents par exemple), il convient d’utiliser une autre métrique que la distance euclidienne pour le rayon de recherche (<span class="math inline">\(\epsilon\)</span>), soit la distance du chemin le plus court à travers le réseau de rues. Plusieurs solutions ont été récemment proposées :</p>
<ul>
<li><a href="https://geoffboeing.com/2018/04/network-based-spatial-clustering/">un code Python</a> basé sur la librairie <a href="https://geoffboeing.com/2016/11/osmnx-python-street-networks/">OSMnx</a> proposé par Geoff Boeing.</li>
<li><a href="https://jeremygelb.github.io/spNetwork/articles/web_vignettes/SpaceTimeDBscan.html?fbclid=IwAR3cComlNZlkxjUDJXIC78OXpL934W1cEuZuZBnATuhqBvrdnoErTui5j">un code R</a> utilisant les <em>packages</em> <code>spNetwork</code> et <code>dbscan</code> proposé par Jérémy Gelb. Le premier est utilisé pour construire la matrice de distance entre les points à partir d’un réseau de rues tandis que le second est utilisé pour l’algorithme DBSCAN.</li>
</ul>
</div>
</div>
</div>
<div id="sect0412" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> ST-DBSCAN : agrégats spatio-temporels<a href="sect041.html#sect0412" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Derya Birant et Alp Kut <span class="citation">(<a href="#ref-birant2007st" role="doc-biblioref">2007</a>)</span> ont proposé une modification de l’algorithme de DBSCAN afin qu’il puisse s’appliquer à des données spatio-temporelles (<span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, <span class="math inline">\(d\)</span>) avec <span class="math inline">\(d\)</span> étant la date de l’évènement. Dénommé ST-DBSCAN, l’algorithme comprend toujours les deux paramètres de DBSCAN (<span class="math inline">\(MinPts\)</span> et <span class="math inline">\(\epsilon\)</span>), auxquels s’ajoute un autre paramètre <span class="math inline">\(\epsilon\)</span> pour le temps (défini en heure, jour, semaine, mois ou année). Autrement dit, deux paramètres de distance sont utilisés : <span class="math inline">\(\epsilon_1\)</span> pour la proximité spatiale (comme avec DBSCAN) et <span class="math inline">\(\epsilon_2\)</span> pour la proximité temporelle <span class="citation">(<a href="#ref-birant2007st" role="doc-biblioref">Birant et Kut 2007</a>)</span>. De la sorte, deux points sont considérés comme voisins si la distance spatiale et la distance temporelle sont toutes deux inférieures aux seuils fixés.</p>
<div class="bloc_attention">
<p><strong>Fenêtre temporelle des points formant un agrégat</strong></p>
<p>Attention, les points formant un agrégat peuvent avoir une fenêtre temporelle bien plus grande que le seuil <span class="math inline">\(\epsilon_2\)</span> fixé. Par exemple, fixons les valeurs de <span class="math inline">\(\epsilon_1\)</span> à 500 mètres et de <span class="math inline">\(\epsilon_2\)</span> à 7 jours. Si le point A (<span class="math inline">\(d\)</span> = 2023-01-15) est distant de 400 mètres du point B (<span class="math inline">\(d\)</span> = 2023-01-20), les deux points sont considérés comme voisins. Par contre, si le point B est distant du point C (<span class="math inline">\(d\)</span> = 2023-01-25) de moins de 500 mètres, il peut être aussi agrégé à l’agrégat puisque l’écart temporel entre B et C est de 5 jours.</p>
<p>Habituellement, plus la valeur de <span class="math inline">\(\epsilon_2\)</span> est faible, plus le nombre de points considérés comme aberrants est important.</p>
</div>
</div>
<div id="sect0414" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Mise en œuvre dans R<a href="sect041.html#sect0414" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect04141" class="section level4 hasAnchor" number="4.1.3.1">
<h4><span class="header-section-number">4.1.3.1</span> DBSCAN<a href="sect041.html#sect04141" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous utilisons le <em>package</em> <code>dbscan</code> <span class="citation">(<a href="#ref-dbscanPackage1" role="doc-biblioref">Hahsler et Piekenbrock 2022</a>; <a href="#ref-dbscanPackage2" role="doc-biblioref">Hahsler, Piekenbrock et Doran 2019</a>)</span> dans lequel sont implémentés plusieurs algorithmes dont DBSCAN, mais aussi OPTICS et HDBSCAN. La fonction <code>dbscan(x, eps, minPts, weights = NULL)</code> comprend plusieurs paramètres :</p>
<ul>
<li><code>x</code>: une matrice, un <em>DataFrame</em>, un objet <code>dist</code> ou un objet <code>frNN</code>.</li>
<li><code>eps</code>: le rayon de recherche epsilon (<span class="math inline">\(\epsilon\)</span>).</li>
<li><code>minPts</code>: le nombre de points minimum requis pour que chaque point soit considéré comme un point central.</li>
<li><code>weights</code>: un vecteur numérique optionnel pour pondérer les points.</li>
</ul>
<p>Pour illustrer le fonctionnement de la méthode DBSCAN, nous avons extrait les accidents d’un <a href="https://donneesouvertes-sherbrooke.opendata.arcgis.com/datasets/64d19d62f0804f5896e4b24c32aea49d_0/explore?location=45.403675%2C-71.960143%2C12.65">jeu de données sur les incidents de sécurité publique survenus sur le territoire de la Ville de Sherbrooke de juillet 2019 à juin 2022</a> (figure <a href="sect041.html#fig:CartoAccidents">4.8</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CartoAccidents"></span>
<img src="GMQ405_files/figure-html/CartoAccidents-1.png" alt="Accidents survenus entre juillet 2019 et juin 2022, Ville de Sherbrooke" width="65%" />
<p class="caption">
Figure 4.8: Accidents survenus entre juillet 2019 et juin 2022, Ville de Sherbrooke
</p>
</div>
<p>Dans le code ci-dessous, nous réalisons trois étapes préalables au calcul de DBSCAN :</p>
<ul>
<li>Importation des accidents.</li>
<li>Récupération des coordonnées (<span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>) des accidents dans une matrice.</li>
<li>Construction du graphique à partir de la distance au quatrième point le plus proche.</li>
</ul>
<p>Nous n’observons pas de décrochement particulier dans la courbe de la figure <a href="sect041.html#fig:GraphiqueAccidentsDist4">4.9</a>. Par conséquent, nous pourrions tout aussi bien retenir comme rayon pour epsilon une distance euclidienne de 250, 500, 1000 ou 1500 mètres.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="sect041.html#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb332-2"><a href="sect041.html#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb332-3"><a href="sect041.html#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dbscan)</span>
<span id="cb332-4"><a href="sect041.html#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb332-5"><a href="sect041.html#cb332-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Importation des accidents</span></span>
<span id="cb332-6"><a href="sect041.html#cb332-6" aria-hidden="true" tabindex="-1"></a>Accidents.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap04/DataAccidentsSherb.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb332-7"><a href="sect041.html#cb332-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Coordonnées géographiques</span></span>
<span id="cb332-8"><a href="sect041.html#cb332-8" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(Accidents.sf)</span>
<span id="cb332-9"><a href="sect041.html#cb332-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Graphique pour la distance au quatrième voisin le plus proche</span></span>
<span id="cb332-10"><a href="sect041.html#cb332-10" aria-hidden="true" tabindex="-1"></a>DistKplusproche <span class="ot">&lt;-</span> <span class="fu">kNNdist</span>(xy, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb332-11"><a href="sect041.html#cb332-11" aria-hidden="true" tabindex="-1"></a>DistKplusproche <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">sort</span>(DistKplusproche, <span class="at">decreasing =</span> <span class="cn">FALSE</span>))</span>
<span id="cb332-12"><a href="sect041.html#cb332-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(DistKplusproche) <span class="ot">&lt;-</span> <span class="st">&quot;distance&quot;</span></span>
<span id="cb332-13"><a href="sect041.html#cb332-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> DistKplusproche)<span class="sc">+</span></span>
<span id="cb332-14"><a href="sect041.html#cb332-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(DistKplusproche), <span class="at">y =</span> distance), <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb332-15"><a href="sect041.html#cb332-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Points triés par ordre croissant selon la distance&quot;</span>,</span>
<span id="cb332-16"><a href="sect041.html#cb332-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Distance au quatrième point le plus proche&quot;</span>)<span class="sc">+</span></span>
<span id="cb332-17"><a href="sect041.html#cb332-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">250</span>, <span class="at">color =</span> <span class="st">&quot;#08306b&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb332-18"><a href="sect041.html#cb332-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">500</span>, <span class="at">color =</span> <span class="st">&quot;#00441b&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb332-19"><a href="sect041.html#cb332-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">1000</span>, <span class="at">color =</span> <span class="st">&quot;#67000d&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb332-20"><a href="sect041.html#cb332-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">1500</span>, <span class="at">color =</span> <span class="st">&quot;#3f007d&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GraphiqueAccidentsDist4"></span>
<img src="GMQ405_files/figure-html/GraphiqueAccidentsDist4-1.png" alt="Optimisation de la valeur d’epsilon pour les accidents" width="65%" />
<p class="caption">
Figure 4.9: Optimisation de la valeur d’epsilon pour les accidents
</p>
</div>
<p>Appliquons la méthode DBSCAN avec un minimum de quatre points et les quatre valeurs de distance euclidienne.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="sect041.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456789</span>)</span>
<span id="cb333-2"><a href="sect041.html#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="do">## DBSCAN avec les quatre distances</span></span>
<span id="cb333-3"><a href="sect041.html#cb333-3" aria-hidden="true" tabindex="-1"></a>dbscan250  <span class="ot">&lt;-</span> <span class="fu">dbscan</span>(xy, <span class="at">eps =</span> <span class="dv">250</span>, <span class="at">minPts =</span> <span class="dv">4</span>)</span>
<span id="cb333-4"><a href="sect041.html#cb333-4" aria-hidden="true" tabindex="-1"></a>dbscan500  <span class="ot">&lt;-</span> <span class="fu">dbscan</span>(xy, <span class="at">eps =</span> <span class="dv">500</span>, <span class="at">minPts =</span> <span class="dv">4</span>)</span>
<span id="cb333-5"><a href="sect041.html#cb333-5" aria-hidden="true" tabindex="-1"></a>dbscan1000 <span class="ot">&lt;-</span> <span class="fu">dbscan</span>(xy, <span class="at">eps =</span> <span class="dv">1000</span>, <span class="at">minPts =</span> <span class="dv">4</span>)</span>
<span id="cb333-6"><a href="sect041.html#cb333-6" aria-hidden="true" tabindex="-1"></a>dbscan1500 <span class="ot">&lt;-</span> <span class="fu">dbscan</span>(xy, <span class="at">eps =</span> <span class="dv">1500</span>, <span class="at">minPts =</span> <span class="dv">4</span>)</span>
<span id="cb333-7"><a href="sect041.html#cb333-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Affichage des résultats</span></span>
<span id="cb333-8"><a href="sect041.html#cb333-8" aria-hidden="true" tabindex="-1"></a>dbscan250</span></code></pre></div>
<pre><code>## DBSCAN clustering for 1106 objects.
## Parameters: eps = 250, minPts = 4
## Using euclidean distances and borderpoints = TRUE
## The clustering contains 45 cluster(s) and 353 noise points.
## 
##   0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19 
## 353   4   6   7   5  15   5   4  22   7   5   5  19 295   4  18   5   4   7   8 
##  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39 
##   4   6  49   4  11   4   4  41   5   4   8  31  25  10   6  23   4   5  18  15 
##  40  41  42  43  44  45 
##   6   4   6   4   7   4 
## 
## Available fields: cluster, eps, minPts, dist, borderPoints</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="sect041.html#cb335-1" aria-hidden="true" tabindex="-1"></a>dbscan500</span></code></pre></div>
<pre><code>## DBSCAN clustering for 1106 objects.
## Parameters: eps = 500, minPts = 4
## Using euclidean distances and borderpoints = TRUE
## The clustering contains 33 cluster(s) and 143 noise points.
## 
##   0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19 
## 143   7   6  14   4   5   5   4   6 734  18   8   6   6   5   9  16   9   5   4 
##  20  21  22  23  24  25  26  27  28  29  30  31  32  33 
##  23   5   3   4   6   5   4   9   6   9   4   4   4   6 
## 
## Available fields: cluster, eps, minPts, dist, borderPoints</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="sect041.html#cb337-1" aria-hidden="true" tabindex="-1"></a>dbscan1000</span></code></pre></div>
<pre><code>## DBSCAN clustering for 1106 objects.
## Parameters: eps = 1000, minPts = 4
## Using euclidean distances and borderpoints = TRUE
## The clustering contains 10 cluster(s) and 42 noise points.
## 
##   0   1   2   3   4   5   6   7   8   9  10 
##  42   8   6  37 962   8   4   6   5  12  16 
## 
## Available fields: cluster, eps, minPts, dist, borderPoints</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="sect041.html#cb339-1" aria-hidden="true" tabindex="-1"></a>dbscan1500</span></code></pre></div>
<pre><code>## DBSCAN clustering for 1106 objects.
## Parameters: eps = 1500, minPts = 4
## Using euclidean distances and borderpoints = TRUE
## The clustering contains 3 cluster(s) and 7 noise points.
## 
##    0    1    2    3 
##    7 1047   12   40 
## 
## Available fields: cluster, eps, minPts, dist, borderPoints</code></pre>
<p>Pour les 1106 accidents du jeu de données, les résultats des quatre DBSCAN ci-dessus sont les suivants :</p>
<ul>
<li>Avec <span class="math inline">\(\epsilon=250\)</span>, 45 agrégats et 353 points aberrants (bruit).</li>
<li>Avec <span class="math inline">\(\epsilon=500\)</span>, 33 agrégats et 143 points aberrants.</li>
<li>Avec <span class="math inline">\(\epsilon=1000\)</span>, 10 agrégats et 42 points aberrants.</li>
<li>Avec <span class="math inline">\(\epsilon=1500\)</span>, 3 agrégats et 7 points aberrants.</li>
</ul>
<p>Pour les <em>n</em> points du jeu de données, l’appartenance à un agrégat est enregistrée dans un vecteur numérique avec des valeurs de 0 à <em>k</em> agrégats (<code>ResultatDbscan$cluster</code>). Notez que la valeur de 0 est attribuée aux points aberrants. Avec ce vecteur, nous enregistrons les résultats dans un nouveau champ de la couche de points <code>sf</code>.</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="sect041.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Enregistrement des résultats de DBSCAN dans la couche de points sf</span></span>
<span id="cb341-2"><a href="sect041.html#cb341-2" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>Dbscan250  <span class="ot">&lt;-</span> <span class="fu">as.character</span>(dbscan250<span class="sc">$</span>cluster)</span>
<span id="cb341-3"><a href="sect041.html#cb341-3" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>Dbscan500  <span class="ot">&lt;-</span> <span class="fu">as.character</span>(dbscan500<span class="sc">$</span>cluster)</span>
<span id="cb341-4"><a href="sect041.html#cb341-4" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>Dbscan1000 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(dbscan1000<span class="sc">$</span>cluster)</span>
<span id="cb341-5"><a href="sect041.html#cb341-5" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>Dbscan1500 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(dbscan1500<span class="sc">$</span>cluster)</span>
<span id="cb341-6"><a href="sect041.html#cb341-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-7"><a href="sect041.html#cb341-7" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>Dbscan250 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(Accidents.sf<span class="sc">$</span>Dbscan250) <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb341-8"><a href="sect041.html#cb341-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">paste0</span>(<span class="st">&quot;0&quot;</span>, Accidents.sf<span class="sc">$</span>Dbscan250),</span>
<span id="cb341-9"><a href="sect041.html#cb341-9" aria-hidden="true" tabindex="-1"></a>                                        Accidents.sf<span class="sc">$</span>Dbscan250)</span>
<span id="cb341-10"><a href="sect041.html#cb341-10" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>Dbscan500 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(Accidents.sf<span class="sc">$</span>Dbscan500) <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb341-11"><a href="sect041.html#cb341-11" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">paste0</span>(<span class="st">&quot;0&quot;</span>, Accidents.sf<span class="sc">$</span>Dbscan500),</span>
<span id="cb341-12"><a href="sect041.html#cb341-12" aria-hidden="true" tabindex="-1"></a>                                        Accidents.sf<span class="sc">$</span>Dbscan500)</span>
<span id="cb341-13"><a href="sect041.html#cb341-13" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>Dbscan1000 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(Accidents.sf<span class="sc">$</span>Dbscan1000) <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb341-14"><a href="sect041.html#cb341-14" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">paste0</span>(<span class="st">&quot;0&quot;</span>, Accidents.sf<span class="sc">$</span>Dbscan1000),</span>
<span id="cb341-15"><a href="sect041.html#cb341-15" aria-hidden="true" tabindex="-1"></a>                                        Accidents.sf<span class="sc">$</span>Dbscan1000)</span>
<span id="cb341-16"><a href="sect041.html#cb341-16" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>Dbscan1500 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(Accidents.sf<span class="sc">$</span>Dbscan1500) <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb341-17"><a href="sect041.html#cb341-17" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">paste0</span>(<span class="st">&quot;0&quot;</span>, Accidents.sf<span class="sc">$</span>Dbscan1500),</span>
<span id="cb341-18"><a href="sect041.html#cb341-18" aria-hidden="true" tabindex="-1"></a>                                        Accidents.sf<span class="sc">$</span>Dbscan1500)</span></code></pre></div>
<p>Nous cartographions finalement les résultats pour les quatre solutions.</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="sect041.html#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb342-2"><a href="sect041.html#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Accidents.sf)<span class="sc">+</span><span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">&quot;Dbscan250&quot;</span>, <span class="at">title =</span> <span class="st">&quot;DBSCAN 250&quot;</span>, <span class="at">size =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p><img src="GMQ405_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="sect041.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Accidents.sf)<span class="sc">+</span><span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">&quot;Dbscan500&quot;</span>, <span class="at">title =</span> <span class="st">&quot;DBSCAN 500&quot;</span>, <span class="at">size =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p><img src="GMQ405_files/figure-html/unnamed-chunk-121-2.png" width="672" /></p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="sect041.html#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Accidents.sf)<span class="sc">+</span><span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">&quot;Dbscan1000&quot;</span>, <span class="at">title =</span> <span class="st">&quot;DBSCAN 1000&quot;</span>, <span class="at">size =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p><img src="GMQ405_files/figure-html/unnamed-chunk-121-3.png" width="672" /></p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="sect041.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Accidents.sf)<span class="sc">+</span><span class="fu">tm_dots</span>(<span class="at">col=</span><span class="st">&quot;Dbscan1500&quot;</span>, <span class="at">title =</span> <span class="st">&quot;DBSCAN 1500&quot;</span>, <span class="at">size =</span> .<span class="dv">5</span>)</span></code></pre></div>
<p><img src="GMQ405_files/figure-html/unnamed-chunk-121-4.png" width="672" /></p>
</div>
<div id="sect04142" class="section level4 hasAnchor" number="4.1.3.2">
<h4><span class="header-section-number">4.1.3.2</span> ST-DBSCAN<a href="sect041.html#sect04142" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour l’algorithme ST-DBSCAN, nous utilisons une <a href="https://github.com/CKerouanton/ST-DBSCAN">fonction R</a> proposée par Colin Kerouanton.</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="sect041.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Fonction pour l&#39;algorithme st-dbscan</span></span>
<span id="cb346-2"><a href="sect041.html#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Source : https://github.com/CKerouanton/ST-DBSCAN_sensitivity</span></span>
<span id="cb346-3"><a href="sect041.html#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param x vecteur pour les coordonnées X des points.</span></span>
<span id="cb346-4"><a href="sect041.html#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param y vecteur pour les coordonnées Y des points.</span></span>
<span id="cb346-5"><a href="sect041.html#cb346-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param eps1 valeur de epsilon pour la distance.</span></span>
<span id="cb346-6"><a href="sect041.html#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param eps2 valeur de epsilon pour le temps.</span></span>
<span id="cb346-7"><a href="sect041.html#cb346-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param minpts nombre de points minimum pour les points centraux.</span></span>
<span id="cb346-8"><a href="sect041.html#cb346-8" aria-hidden="true" tabindex="-1"></a>stdbscan <span class="ot">=</span> <span class="cf">function</span> (x, y, time, eps1, eps2, minpts) {</span>
<span id="cb346-9"><a href="sect041.html#cb346-9" aria-hidden="true" tabindex="-1"></a>  countmode <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)</span>
<span id="cb346-10"><a href="sect041.html#cb346-10" aria-hidden="true" tabindex="-1"></a>  seeds <span class="ot">=</span> <span class="cn">TRUE</span></span>
<span id="cb346-11"><a href="sect041.html#cb346-11" aria-hidden="true" tabindex="-1"></a>  data_spatial  <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(<span class="fu">cbind</span>(y, x)))</span>
<span id="cb346-12"><a href="sect041.html#cb346-12" aria-hidden="true" tabindex="-1"></a>  data_temporal <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(time))</span>
<span id="cb346-13"><a href="sect041.html#cb346-13" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_spatial)</span>
<span id="cb346-14"><a href="sect041.html#cb346-14" aria-hidden="true" tabindex="-1"></a>  classn <span class="ot">&lt;-</span> cv <span class="ot">&lt;-</span> <span class="fu">integer</span>(n)</span>
<span id="cb346-15"><a href="sect041.html#cb346-15" aria-hidden="true" tabindex="-1"></a>  isseed <span class="ot">&lt;-</span> <span class="fu">logical</span>(n)</span>
<span id="cb346-16"><a href="sect041.html#cb346-16" aria-hidden="true" tabindex="-1"></a>  cn <span class="ot">&lt;-</span> <span class="fu">integer</span>(<span class="dv">1</span>)</span>
<span id="cb346-17"><a href="sect041.html#cb346-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-18"><a href="sect041.html#cb346-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb346-19"><a href="sect041.html#cb346-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">%in%</span> countmode)</span>
<span id="cb346-20"><a href="sect041.html#cb346-20" aria-hidden="true" tabindex="-1"></a>      <span class="co">#cat(&quot;Processing point &quot;, i, &quot; of &quot;, n, &quot;.\n&quot;)</span></span>
<span id="cb346-21"><a href="sect041.html#cb346-21" aria-hidden="true" tabindex="-1"></a>      unclass <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span>n)[cv <span class="sc">&lt;</span> <span class="dv">1</span>]</span>
<span id="cb346-22"><a href="sect041.html#cb346-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-23"><a href="sect041.html#cb346-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (cv[i] <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb346-24"><a href="sect041.html#cb346-24" aria-hidden="true" tabindex="-1"></a>      reachables <span class="ot">&lt;-</span> <span class="fu">intersect</span>(unclass[data_spatial[i, unclass] <span class="sc">&lt;=</span> eps1],  </span>
<span id="cb346-25"><a href="sect041.html#cb346-25" aria-hidden="true" tabindex="-1"></a>                              unclass[data_temporal[i, unclass] <span class="sc">&lt;=</span> eps2])</span>
<span id="cb346-26"><a href="sect041.html#cb346-26" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(reachables) <span class="sc">+</span> classn[i] <span class="sc">&lt;</span> minpts)</span>
<span id="cb346-27"><a href="sect041.html#cb346-27" aria-hidden="true" tabindex="-1"></a>        cv[i] <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb346-28"><a href="sect041.html#cb346-28" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> {</span>
<span id="cb346-29"><a href="sect041.html#cb346-29" aria-hidden="true" tabindex="-1"></a>        cn <span class="ot">&lt;-</span> cn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb346-30"><a href="sect041.html#cb346-30" aria-hidden="true" tabindex="-1"></a>        cv[i] <span class="ot">&lt;-</span> cn</span>
<span id="cb346-31"><a href="sect041.html#cb346-31" aria-hidden="true" tabindex="-1"></a>        isseed[i] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb346-32"><a href="sect041.html#cb346-32" aria-hidden="true" tabindex="-1"></a>        reachables <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(reachables, i)</span>
<span id="cb346-33"><a href="sect041.html#cb346-33" aria-hidden="true" tabindex="-1"></a>        unclass <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(unclass, i)</span>
<span id="cb346-34"><a href="sect041.html#cb346-34" aria-hidden="true" tabindex="-1"></a>        classn[reachables] <span class="ot">&lt;-</span> classn[reachables] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb346-35"><a href="sect041.html#cb346-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> (<span class="fu">length</span>(reachables)) {</span>
<span id="cb346-36"><a href="sect041.html#cb346-36" aria-hidden="true" tabindex="-1"></a>          cv[reachables] <span class="ot">&lt;-</span> cn</span>
<span id="cb346-37"><a href="sect041.html#cb346-37" aria-hidden="true" tabindex="-1"></a>          ap <span class="ot">&lt;-</span> reachables</span>
<span id="cb346-38"><a href="sect041.html#cb346-38" aria-hidden="true" tabindex="-1"></a>          reachables <span class="ot">&lt;-</span> <span class="fu">integer</span>()</span>
<span id="cb346-39"><a href="sect041.html#cb346-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-40"><a href="sect041.html#cb346-40" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (i2 <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">along =</span> ap)) {</span>
<span id="cb346-41"><a href="sect041.html#cb346-41" aria-hidden="true" tabindex="-1"></a>            j <span class="ot">&lt;-</span> ap[i2]</span>
<span id="cb346-42"><a href="sect041.html#cb346-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-43"><a href="sect041.html#cb346-43" aria-hidden="true" tabindex="-1"></a>            jreachables <span class="ot">&lt;-</span> <span class="fu">intersect</span>(unclass[data_spatial[j, unclass] <span class="sc">&lt;=</span> eps1], </span>
<span id="cb346-44"><a href="sect041.html#cb346-44" aria-hidden="true" tabindex="-1"></a>                                     unclass[data_temporal[j, unclass] <span class="sc">&lt;=</span> eps2])</span>
<span id="cb346-45"><a href="sect041.html#cb346-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-46"><a href="sect041.html#cb346-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="fu">length</span>(jreachables) <span class="sc">+</span> classn[j] <span class="sc">&gt;=</span> minpts) {</span>
<span id="cb346-47"><a href="sect041.html#cb346-47" aria-hidden="true" tabindex="-1"></a>              isseed[j] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb346-48"><a href="sect041.html#cb346-48" aria-hidden="true" tabindex="-1"></a>              cv[jreachables[cv[jreachables] <span class="sc">&lt;</span> <span class="dv">0</span>]] <span class="ot">&lt;-</span> cn</span>
<span id="cb346-49"><a href="sect041.html#cb346-49" aria-hidden="true" tabindex="-1"></a>              reachables <span class="ot">&lt;-</span> <span class="fu">union</span>(reachables, jreachables[cv[jreachables] <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb346-50"><a href="sect041.html#cb346-50" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb346-51"><a href="sect041.html#cb346-51" aria-hidden="true" tabindex="-1"></a>            classn[jreachables] <span class="ot">&lt;-</span> classn[jreachables] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb346-52"><a href="sect041.html#cb346-52" aria-hidden="true" tabindex="-1"></a>            unclass <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(unclass, j)</span>
<span id="cb346-53"><a href="sect041.html#cb346-53" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb346-54"><a href="sect041.html#cb346-54" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb346-55"><a href="sect041.html#cb346-55" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb346-56"><a href="sect041.html#cb346-56" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb346-57"><a href="sect041.html#cb346-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">length</span>(unclass))</span>
<span id="cb346-58"><a href="sect041.html#cb346-58" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb346-59"><a href="sect041.html#cb346-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb346-60"><a href="sect041.html#cb346-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-61"><a href="sect041.html#cb346-61" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(cv <span class="sc">==</span> (<span class="sc">-</span><span class="dv">1</span>))) {</span>
<span id="cb346-62"><a href="sect041.html#cb346-62" aria-hidden="true" tabindex="-1"></a>    cv[cv <span class="sc">==</span> (<span class="sc">-</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb346-63"><a href="sect041.html#cb346-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb346-64"><a href="sect041.html#cb346-64" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">cluster =</span> cv, <span class="at">eps1 =</span> eps1, <span class="at">eps2 =</span> eps2, <span class="at">minpts =</span> minpts, <span class="at">density =</span> classn)</span>
<span id="cb346-65"><a href="sect041.html#cb346-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(classn)</span>
<span id="cb346-66"><a href="sect041.html#cb346-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (seeds <span class="sc">&amp;&amp;</span> cn <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb346-67"><a href="sect041.html#cb346-67" aria-hidden="true" tabindex="-1"></a>    out<span class="sc">$</span>isseed <span class="ot">&lt;-</span> isseed</span>
<span id="cb346-68"><a href="sect041.html#cb346-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb346-69"><a href="sect041.html#cb346-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>(out) <span class="ot">&lt;-</span> <span class="st">&quot;stdbscan&quot;</span></span>
<span id="cb346-70"><a href="sect041.html#cb346-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb346-71"><a href="sect041.html#cb346-71" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Calculons ST-DBSCAN avec une distance spatiale de 1000 mètres et une distance temporelle de 21 jours. Nous obtenons 26 agrégats et 584 points identifiés comme aberrants.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="sect041.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Importation des accidents</span></span>
<span id="cb347-2"><a href="sect041.html#cb347-2" aria-hidden="true" tabindex="-1"></a>Accidents.sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap04/DataAccidentsSherb.shp&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb347-3"><a href="sect041.html#cb347-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Coordonnées géographiques</span></span>
<span id="cb347-4"><a href="sect041.html#cb347-4" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(Accidents.sf)</span>
<span id="cb347-5"><a href="sect041.html#cb347-5" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>x <span class="ot">&lt;-</span> xy[,<span class="dv">1</span>]</span>
<span id="cb347-6"><a href="sect041.html#cb347-6" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>y <span class="ot">&lt;-</span> xy[,<span class="dv">2</span>]</span>
<span id="cb347-7"><a href="sect041.html#cb347-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Vérifions que le champ DATEINCIDE est bien au format date</span></span>
<span id="cb347-8"><a href="sect041.html#cb347-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Accidents.sf<span class="sc">$</span>DATEINCIDE)</span></code></pre></div>
<pre><code>##  Date[1:1106], format: &quot;2021-12-11&quot; &quot;2022-05-16&quot; &quot;2021-08-12&quot; &quot;2019-08-02&quot; &quot;2020-03-02&quot; ...</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="sect041.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul de st-dbscan avec une distance de 1000 mètres et 21 jours</span></span>
<span id="cb349-2"><a href="sect041.html#cb349-2" aria-hidden="true" tabindex="-1"></a>Resultats.stdbscan <span class="ot">&lt;-</span> <span class="fu">stdbscan</span>(<span class="at">x =</span> Accidents.sf<span class="sc">$</span>x,</span>
<span id="cb349-3"><a href="sect041.html#cb349-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> Accidents.sf<span class="sc">$</span>y,</span>
<span id="cb349-4"><a href="sect041.html#cb349-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">time =</span> Accidents.sf<span class="sc">$</span>DATEINCIDE,</span>
<span id="cb349-5"><a href="sect041.html#cb349-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">eps1 =</span> <span class="dv">1000</span>,</span>
<span id="cb349-6"><a href="sect041.html#cb349-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">eps2 =</span> <span class="dv">21</span>,</span>
<span id="cb349-7"><a href="sect041.html#cb349-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">minpts =</span> <span class="dv">4</span>)</span>
<span id="cb349-8"><a href="sect041.html#cb349-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Enregistrement des résultats de ST-DBSCAN dans la couche de points sf</span></span>
<span id="cb349-9"><a href="sect041.html#cb349-9" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>stdbscan<span class="fl">.1000</span>_21 <span class="ot">&lt;-</span> <span class="fu">as.character</span>(Resultats.stdbscan<span class="sc">$</span>cluster)</span>
<span id="cb349-10"><a href="sect041.html#cb349-10" aria-hidden="true" tabindex="-1"></a>Accidents.sf<span class="sc">$</span>stdbscan<span class="fl">.1000</span>_21 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">nchar</span>(Accidents.sf<span class="sc">$</span>stdbscan<span class="fl">.1000</span>_21) <span class="sc">==</span> <span class="dv">1</span>,</span>
<span id="cb349-11"><a href="sect041.html#cb349-11" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">paste0</span>(<span class="st">&quot;0&quot;</span>, Accidents.sf<span class="sc">$</span>stdbscan<span class="fl">.1000</span>_21),</span>
<span id="cb349-12"><a href="sect041.html#cb349-12" aria-hidden="true" tabindex="-1"></a>                                        Accidents.sf<span class="sc">$</span>stdbscan<span class="fl">.1000</span>_21)</span>
<span id="cb349-13"><a href="sect041.html#cb349-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Nombre de points par agrégat</span></span>
<span id="cb349-14"><a href="sect041.html#cb349-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(Accidents.sf<span class="sc">$</span>stdbscan<span class="fl">.1000</span>_21)</span></code></pre></div>
<pre><code>## 
##  00  01  02  03  04  05  06  07  08  09  10  11  12  13  14  15  16  17  18  19 
## 584   4   6   5   4   4   7   7   4 178 156  13  17   4  22  32   6   7   8   8 
##  20  21  22  23  24  25  26 
##   5   6   4   3   5   4   3</code></pre>
<p>Pour faciliter l’analyse des résultats de ST-DBSCAN, nous conseillons de :</p>
<ol style="list-style-type: decimal">
<li>Construire un tableau récapitulatif pour les agrégats avec le nombre de points, les dates de début et de fin et l’intervalle temporel.</li>
<li>Construire un graphique avec les agrégats (axe des <em>y</em>) et la dimension temporelle (axe des <em>x</em>).</li>
<li>Cartographier les résultats.</li>
</ol>
<p>Le code ci-dessous génère le tableau récapitulatif. Nous constatons ainsi que les agrégats 9 et 10 incluent respectivement 178 et 156 points avec des intervalles temporels importants (respectivement 251 et 319 jours).</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="sect041.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb351-2"><a href="sect041.html#cb351-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Sélection des points appartenant à un agrégat</span></span>
<span id="cb351-3"><a href="sect041.html#cb351-3" aria-hidden="true" tabindex="-1"></a>Agregats <span class="ot">&lt;-</span> <span class="fu">subset</span>(Accidents.sf, </span>
<span id="cb351-4"><a href="sect041.html#cb351-4" aria-hidden="true" tabindex="-1"></a>                   Accidents.sf<span class="sc">$</span>stdbscan<span class="fl">.1000</span>_21 <span class="sc">!=</span> <span class="st">&quot;00&quot;</span>)</span>
<span id="cb351-5"><a href="sect041.html#cb351-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Conversion de la date au format POSIXct</span></span>
<span id="cb351-6"><a href="sect041.html#cb351-6" aria-hidden="true" tabindex="-1"></a>Agregats<span class="sc">$</span>dtPOSIXct <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(Agregats<span class="sc">$</span>DATEINCIDE, <span class="at">format =</span> <span class="st">&quot;%Y/%m/%d&quot;</span>)</span>
<span id="cb351-7"><a href="sect041.html#cb351-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Tableau récapitulatif</span></span>
<span id="cb351-8"><a href="sect041.html#cb351-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>)  </span>
<span id="cb351-9"><a href="sect041.html#cb351-9" aria-hidden="true" tabindex="-1"></a>Tableau.stdbscan <span class="ot">&lt;-</span></span>
<span id="cb351-10"><a href="sect041.html#cb351-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_drop_geometry</span>(Agregats) <span class="sc">%&gt;%</span></span>
<span id="cb351-11"><a href="sect041.html#cb351-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(stdbscan<span class="fl">.1000</span>_21) <span class="sc">%&gt;%</span> </span>
<span id="cb351-12"><a href="sect041.html#cb351-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarize</span>(<span class="at">points =</span> <span class="fu">n</span>(),</span>
<span id="cb351-13"><a href="sect041.html#cb351-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">date.min =</span> <span class="fu">min</span>(DATEINCIDE),</span>
<span id="cb351-14"><a href="sect041.html#cb351-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">date.max =</span> <span class="fu">max</span>(DATEINCIDE),</span>
<span id="cb351-15"><a href="sect041.html#cb351-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">intervalle.jours =</span> <span class="fu">as.numeric</span>(<span class="fu">max</span>(DATEINCIDE)<span class="sc">-</span><span class="fu">min</span>(DATEINCIDE)))</span>
<span id="cb351-16"><a href="sect041.html#cb351-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Affichage du tableau</span></span>
<span id="cb351-17"><a href="sect041.html#cb351-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Tableau.stdbscan, <span class="at">n =</span> <span class="fu">nrow</span>(Tableau.stdbscan))</span></code></pre></div>
<pre><code>## # A tibble: 26 × 5
##    stdbscan.1000_21 points date.min   date.max   intervalle.jours
##    &lt;chr&gt;             &lt;int&gt; &lt;date&gt;     &lt;date&gt;                &lt;dbl&gt;
##  1 01                    4 2019-08-08 2019-09-04               27
##  2 02                    6 2021-12-15 2022-01-25               41
##  3 03                    5 2019-07-21 2019-08-30               40
##  4 04                    4 2020-11-10 2020-12-12               32
##  5 05                    4 2022-01-08 2022-02-13               36
##  6 06                    7 2021-06-09 2021-07-02               23
##  7 07                    7 2020-06-23 2020-08-07               45
##  8 08                    4 2021-09-30 2021-10-27               27
##  9 09                  178 2019-07-02 2020-03-09              251
## 10 10                  156 2021-03-13 2022-01-26              319
## 11 11                   13 2021-07-24 2021-09-11               49
## 12 12                   17 2021-10-21 2022-01-12               83
## 13 13                    4 2021-06-16 2021-07-07               21
## 14 14                   22 2022-04-11 2022-06-27               77
## 15 15                   32 2020-09-11 2020-12-18               98
## 16 16                    6 2020-01-17 2020-02-08               22
## 17 17                    7 2022-05-07 2022-05-30               23
## 18 18                    8 2021-04-01 2021-05-27               56
## 19 19                    8 2020-07-15 2020-09-11               58
## 20 20                    5 2019-07-05 2019-07-31               26
## 21 21                    6 2022-01-15 2022-03-02               46
## 22 22                    4 2020-06-17 2020-06-30               13
## 23 23                    3 2022-03-12 2022-03-18                6
## 24 24                    5 2021-06-29 2021-07-21               22
## 25 25                    4 2021-09-20 2021-10-25               35
## 26 26                    3 2021-04-13 2021-04-26               13</code></pre>
<p>La figure <a href="sect041.html#fig:GraphStScanEps1000Eps21">4.10</a> présente les points et l’étendue temporelle de chaque agrégat.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="sect041.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Construction du graphique</span></span>
<span id="cb353-2"><a href="sect041.html#cb353-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Agregats) <span class="sc">+</span> </span>
<span id="cb353-3"><a href="sect041.html#cb353-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> dtPOSIXct, </span>
<span id="cb353-4"><a href="sect041.html#cb353-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> stdbscan<span class="fl">.1000</span>_21, </span>
<span id="cb353-5"><a href="sect041.html#cb353-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> stdbscan<span class="fl">.1000</span>_21),</span>
<span id="cb353-6"><a href="sect041.html#cb353-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb353-7"><a href="sect041.html#cb353-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_datetime</span>(<span class="at">date_labels =</span> <span class="st">&quot;%Y/%m&quot;</span>)<span class="sc">+</span></span>
<span id="cb353-8"><a href="sect041.html#cb353-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">&quot;Temps&quot;</span>,</span>
<span id="cb353-9"><a href="sect041.html#cb353-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">&quot;Identifiant de l&#39;agrégat&quot;</span>,</span>
<span id="cb353-10"><a href="sect041.html#cb353-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;ST-DBSCAN avec Esp1 = 1000, Esp2 = 21 et MinPts = 4&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GraphStScanEps1000Eps21"></span>
<img src="GMQ405_files/figure-html/GraphStScanEps1000Eps21-1.png" alt="Intervalles temporels des agrégats ST-DBSCAN" width="65%" />
<p class="caption">
Figure 4.10: Intervalles temporels des agrégats ST-DBSCAN
</p>
</div>
<p>La cartographie des agrégats est présentée à la figure <a href="sect041.html#fig:CarteStScanEps1000Eps21">4.11</a> avec en noir les points aberrants.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="sect041.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Création de deux couches : l&#39;une pour les agrégats, l&#39;autre pour les points aberrants</span></span>
<span id="cb354-2"><a href="sect041.html#cb354-2" aria-hidden="true" tabindex="-1"></a>stdbcan.Agregats <span class="ot">&lt;-</span> <span class="fu">subset</span>(Accidents.sf, Accidents.sf<span class="sc">$</span>stdbscan<span class="fl">.1000</span>_21 <span class="sc">!=</span> <span class="st">&quot;00&quot;</span>)</span>
<span id="cb354-3"><a href="sect041.html#cb354-3" aria-hidden="true" tabindex="-1"></a>stdbcan.Bruit    <span class="ot">&lt;-</span> <span class="fu">subset</span>(Accidents.sf, Accidents.sf<span class="sc">$</span>stdbscan<span class="fl">.1000</span>_21 <span class="sc">==</span> <span class="st">&quot;00&quot;</span>)</span>
<span id="cb354-4"><a href="sect041.html#cb354-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Cartographie</span></span>
<span id="cb354-5"><a href="sect041.html#cb354-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb354-6"><a href="sect041.html#cb354-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Arrondiss)<span class="sc">+</span><span class="fu">tm_fill</span>(<span class="at">col=</span><span class="st">&quot;#f7f7f7&quot;</span>)<span class="sc">+</span><span class="fu">tm_borders</span>(<span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb354-7"><a href="sect041.html#cb354-7" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(stdbcan.Bruit)<span class="sc">+</span></span>
<span id="cb354-8"><a href="sect041.html#cb354-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>, <span class="at">size=</span>.<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb354-9"><a href="sect041.html#cb354-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(stdbcan.Agregats)<span class="sc">+</span></span>
<span id="cb354-10"><a href="sect041.html#cb354-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">col=</span><span class="st">&quot;stdbscan.1000_21&quot;</span>, <span class="at">size=</span>.<span class="dv">2</span>, <span class="at">title =</span> <span class="st">&quot;Agrégat&quot;</span>)<span class="sc">+</span></span>
<span id="cb354-11"><a href="sect041.html#cb354-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>, <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;bottom&quot;</span>),</span>
<span id="cb354-12"><a href="sect041.html#cb354-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text.size =</span> .<span class="dv">85</span>, <span class="at">legend.outside =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CarteStScanEps1000Eps21"></span>
<img src="GMQ405_files/figure-html/CarteStScanEps1000Eps21-1.png" alt="Agrégats identifiés avec ST-DBSCAN" width="65%" />
<p class="caption">
Figure 4.11: Agrégats identifiés avec ST-DBSCAN
</p>
</div>
</div>
</div>
</div>
<h3>Références</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-birant2007st" class="csl-entry">
Birant, Derya et Alp Kut. 2007. <span>« ST-DBSCAN: An algorithm for clustering spatial–temporal data. »</span> <em>Data &amp; knowledge engineering</em> 60 (1): 208‑221. <a href="https://doi.org/10.1016/j.datak.2006.01.013">https://doi.org/10.1016/j.datak.2006.01.013</a>.
</div>
<div id="ref-HDBSCAN2013" class="csl-entry">
Campello, Ricardo JGB, Davoud Moulavi et Jörg Sander. 2013. <span>« Density-based clustering based on hierarchical density estimates. »</span> In <em>Advances in Knowledge Discovery and Data Mining: 17th Pacific-Asia Conference, PAKDD 2013, Gold Coast, Australia, April 14-17, 2013, Proceedings, Part II 17</em>, 160‑172. s.n. <a href="http://dx.doi.org/10.1007/978-3-642-37456-2_14">http://dx.doi.org/10.1007/978-3-642-37456-2_14</a>.
</div>
<div id="ref-DBSCAN1996" class="csl-entry">
Ester, Martin, Hans-Peter Kriegel, Jörg Sander et Xiaowei Xu. 1996. <span>« A density-based algorithm for discovering clusters in large spatial databases with noise. »</span> In <em>Proceedings of the Second International Conference on Knowledge Discovery and Data Mining (KDD-96)</em>, 96:226‑231. 34. s.n. <a href="https://dl.acm.org/doi/10.5555/3001460.3001507">https://dl.acm.org/doi/10.5555/3001460.3001507</a>.
</div>
<div id="ref-dbscanPackage1" class="csl-entry">
Hahsler, Michael et Matthew Piekenbrock. 2022. <em>dbscan: Density-Based Spatial Clustering of Applications with Noise (DBSCAN) and Related Algorithms</em>. s.n. <a href="https://CRAN.R-project.org/package=dbscan">https://CRAN.R-project.org/package=dbscan</a>.
</div>
<div id="ref-dbscanPackage2" class="csl-entry">
Hahsler, Michael, Matthew Piekenbrock et Derek Doran. 2019. <span>« <span>dbscan</span>: Fast Density-Based Clustering with <span>R</span>. »</span> <em>Journal of Statistical Software</em> 91 (1): 1‑30. doi:<a href="https://doi.org/10.18637/jss.v091.i01">https://doi.org/10.18637/jss.v091.i01</a>.
</div>
<div id="ref-sander1998density" class="csl-entry">
Sander, Jörg, Martin Ester, Hans-Peter Kriegel et Xiaowei Xu. 1998. <span>« Density-based clustering in spatial databases: The algorithm gdbscan and its applications. »</span> <em>Data mining and knowledge discovery</em> 2: 169‑194.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chap04.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect042.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["GMQ405.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
