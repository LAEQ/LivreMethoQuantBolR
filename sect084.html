<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.3 Modèles GLM pour des variables de comptage | Méthodes quantitatives en sciences sociales : un grand bol d’R</title>
  <meta name="description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="8.3 Modèles GLM pour des variables de comptage | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="github-repo" content="LAEQ/livre_statistique_Phil_Jere" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.3 Modèles GLM pour des variables de comptage | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  
  <meta name="twitter:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="twitter:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio et Jérémy Gelb" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect082.html"/>
<link rel="next" href="sect085.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d'R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Un manuel conçu comme un projet collaboratif</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment lire ce livre?</a></li>
<li class="chapter" data-level="" data-path="sect003B.html"><a href="sect003B.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en sciences sociales?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="sect007.html"><a href="sect007.html"><i class="fa fa-check"></i>Dédicace toute spéciale à Cargo et Ambrée</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auteurs.html"><a href="auteurs.html"><i class="fa fa-check"></i>À propos des auteurs</a></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Prise en main de R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Histoire et philosophie de R</a></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Environnement de travail</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Installation de R</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Environnement RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect0123"><i class="fa fa-check"></i><b>1.2.3</b> Installation et chargement un <em>package</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#aide-disponible"><i class="fa fa-check"></i><b>1.2.4</b> Aide disponible</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Bases du langage R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> <em>Hello World</em>!</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Objets et expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="sect013.html"><a href="sect013.html#sect0_133"><i class="fa fa-check"></i><b>1.3.3</b> Fonctions et arguments</a></li>
<li class="chapter" data-level="1.3.4" data-path="sect013.html"><a href="sect013.html#sect0134"><i class="fa fa-check"></i><b>1.3.4</b> Principaux types de données</a></li>
<li class="chapter" data-level="1.3.5" data-path="sect013.html"><a href="sect013.html#sect0135"><i class="fa fa-check"></i><b>1.3.5</b> Opérateurs</a></li>
<li class="chapter" data-level="1.3.6" data-path="sect013.html"><a href="sect013.html#sect0136"><i class="fa fa-check"></i><b>1.3.6</b> Structures de données</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Manipulation de données</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Manipulation d’un <em>DataFrame</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.5</b> Code R bien structuré</a></li>
<li class="chapter" data-level="1.6" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.6</b> Enregistrement des résultats</a></li>
<li class="chapter" data-level="1.7" data-path="sect018.html"><a href="sect018.html"><i class="fa fa-check"></i><b>1.7</b> Session de travail</a></li>
<li class="chapter" data-level="1.8" data-path="sect019.html"><a href="sect019.html"><i class="fa fa-check"></i><b>1.8</b> Conclusion et ressources pertinentes</a></li>
<li class="chapter" data-level="1.9" data-path="sect0110.html"><a href="sect0110.html"><i class="fa fa-check"></i><b>1.9</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>II Analyses univariées et graphiques dans R</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Statistiques descriptives univariées</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion et types de variable</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="sect021.html"><a href="sect021.html#sect0211"><i class="fa fa-check"></i><b>2.1.1</b> Notion de variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="sect021.html"><a href="sect021.html#sect0212"><i class="fa fa-check"></i><b>2.1.2</b> Types de variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Types de données</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Données secondaires <em>versus</em> données primaires</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Données transversales <em>versus</em> données longitudinales</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Données spatiales versus données aspatiales</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Données individuelles <em>versus</em> données agrégées</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Statistique descriptive et statistique inférentielle</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Population, échantillon et inférence</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Deux grandes familles de méthodes statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Notion de distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#définition-générale"><i class="fa fa-check"></i><b>2.4.1</b> Définition générale</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#anatomie-dune-distribution"><i class="fa fa-check"></i><b>2.4.2</b> Anatomie d’une distribution</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#principales-distributions"><i class="fa fa-check"></i><b>2.4.3</b> Principales distributions</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#conclusion-sur-les-distributions"><i class="fa fa-check"></i><b>2.4.4</b> Conclusion sur les distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Statistiques descriptives sur des variables quantitatives</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="sect025.html"><a href="sect025.html#sect0251"><i class="fa fa-check"></i><b>2.5.1</b> Paramètres de tendance centrale</a></li>
<li class="chapter" data-level="2.5.2" data-path="sect025.html"><a href="sect025.html#sect0252"><i class="fa fa-check"></i><b>2.5.2</b> Paramètres de position</a></li>
<li class="chapter" data-level="2.5.3" data-path="sect025.html"><a href="sect025.html#sect0253"><i class="fa fa-check"></i><b>2.5.3</b> Paramètres de dispersion</a></li>
<li class="chapter" data-level="2.5.4" data-path="sect025.html"><a href="sect025.html#sect0254"><i class="fa fa-check"></i><b>2.5.4</b> Paramètres de forme</a></li>
<li class="chapter" data-level="2.5.5" data-path="sect025.html"><a href="sect025.html#sect0255"><i class="fa fa-check"></i><b>2.5.5</b> Transformation des variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="sect025.html"><a href="sect025.html#sect0256"><i class="fa fa-check"></i><b>2.5.6</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="sect026.html"><a href="sect026.html#sect0261"><i class="fa fa-check"></i><b>2.6.1</b> Fréquences</a></li>
<li class="chapter" data-level="2.6.2" data-path="sect026.html"><a href="sect026.html#sect0262"><i class="fa fa-check"></i><b>2.6.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sect027.html"><a href="sect027.html"><i class="fa fa-check"></i><b>2.7</b> Statistiques descriptives pondérées : pour aller plus loin</a></li>
<li class="chapter" data-level="2.8" data-path="sect028.html"><a href="sect028.html"><i class="fa fa-check"></i><b>2.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Magie des graphiques</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Philosophie du ggplot2</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="sect031.html"><a href="sect031.html#sect0311"><i class="fa fa-check"></i><b>3.1.1</b> Grammaire</a></li>
<li class="chapter" data-level="3.1.2" data-path="sect031.html"><a href="sect031.html#sect0312"><i class="fa fa-check"></i><b>3.1.2</b> Types de géométries</a></li>
<li class="chapter" data-level="3.1.3" data-path="sect031.html"><a href="sect031.html#sect0313"><i class="fa fa-check"></i><b>3.1.3</b> Habillage</a></li>
<li class="chapter" data-level="3.1.4" data-path="sect031.html"><a href="sect031.html#utilisation-des-thèmes"><i class="fa fa-check"></i><b>3.1.4</b> Utilisation des thèmes</a></li>
<li class="chapter" data-level="3.1.5" data-path="sect031.html"><a href="sect031.html#sect0314"><i class="fa fa-check"></i><b>3.1.5</b> Composition d’une figure avec plusieurs graphiques</a></li>
<li class="chapter" data-level="3.1.6" data-path="sect031.html"><a href="sect031.html#sect0315"><i class="fa fa-check"></i><b>3.1.6</b> Couleur</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Principaux graphiques</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0321"><i class="fa fa-check"></i><b>3.2.1</b> Histogramme</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0322"><i class="fa fa-check"></i><b>3.2.2</b> Graphique de densité</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0323"><i class="fa fa-check"></i><b>3.2.3</b> Nuage de points</a></li>
<li class="chapter" data-level="3.2.4" data-path="sect032.html"><a href="sect032.html#sect0324"><i class="fa fa-check"></i><b>3.2.4</b> Graphique en ligne</a></li>
<li class="chapter" data-level="3.2.5" data-path="sect032.html"><a href="sect032.html#sect0325"><i class="fa fa-check"></i><b>3.2.5</b> Boîte à moustaches</a></li>
<li class="chapter" data-level="3.2.6" data-path="sect032.html"><a href="sect032.html#sect0326"><i class="fa fa-check"></i><b>3.2.6</b> Graphique en violon</a></li>
<li class="chapter" data-level="3.2.7" data-path="sect032.html"><a href="sect032.html#sect0327"><i class="fa fa-check"></i><b>3.2.7</b> Graphique en barre</a></li>
<li class="chapter" data-level="3.2.8" data-path="sect032.html"><a href="sect032.html#sect0328"><i class="fa fa-check"></i><b>3.2.8</b> Graphique circulaire</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Graphiques spéciaux</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Graphique en radar</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Diagramme d’accord</a></li>
<li class="chapter" data-level="3.3.3" data-path="sect033.html"><a href="sect033.html#sect0333"><i class="fa fa-check"></i><b>3.3.3</b> Nuage de mots</a></li>
<li class="chapter" data-level="3.3.4" data-path="sect033.html"><a href="sect033.html#sect0334"><i class="fa fa-check"></i><b>3.3.4</b> Carte proportionnelle</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Cartes</a></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Exportation des graphiques</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Conclusion sur les graphiques</a></li>
</ul></li>
<li class="part"><span><b>III Analyses bivariées</b></span></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Relation linéaire entre deux variables quantitatives</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Bref retour sur le postulat de la relation linéaire</a></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Covariance</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Formulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect043.html"><a href="sect043.html"><i class="fa fa-check"></i><b>4.3</b> Corrélation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="sect043.html"><a href="sect043.html#sect0431"><i class="fa fa-check"></i><b>4.3.1</b> Formulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="sect043.html"><a href="sect043.html#sect0432"><i class="fa fa-check"></i><b>4.3.2</b> Interprétation</a></li>
<li class="chapter" data-level="4.3.3" data-path="sect043.html"><a href="sect043.html#sect0433"><i class="fa fa-check"></i><b>4.3.3</b> Corrélations pour des variables anormalement distribuées (coefficient de Spearman, tau de Kendall)</a></li>
<li class="chapter" data-level="4.3.4" data-path="sect043.html"><a href="sect043.html#sect0434"><i class="fa fa-check"></i><b>4.3.4</b> Corrélations robustes (<em>Biweight midcorrelation</em>, <em>Percentage bend correlation</em> et la corrélation <em>pi</em> de Shepherd)</a></li>
<li class="chapter" data-level="4.3.5" data-path="sect043.html"><a href="sect043.html#sect0435"><i class="fa fa-check"></i><b>4.3.5</b> Significativité des coefficients de corrélation</a></li>
<li class="chapter" data-level="4.3.6" data-path="sect043.html"><a href="sect043.html#sect0436"><i class="fa fa-check"></i><b>4.3.6</b> Corrélation partielle</a></li>
<li class="chapter" data-level="4.3.7" data-path="sect043.html"><a href="sect043.html#sect0437"><i class="fa fa-check"></i><b>4.3.7</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.3.8" data-path="sect043.html"><a href="sect043.html#sect0438"><i class="fa fa-check"></i><b>4.3.8</b> Comment rapporter des valeurs de corrélations?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.4</b> Régression linéaire simple</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sect044.html"><a href="sect044.html#sect0441"><i class="fa fa-check"></i><b>4.4.1</b> Principe de base de la régression linéaire simple</a></li>
<li class="chapter" data-level="4.4.2" data-path="sect044.html"><a href="sect044.html#sect0442"><i class="fa fa-check"></i><b>4.4.2</b> Formulation de la droite de régression des moindres carrés ordinaires</a></li>
<li class="chapter" data-level="4.4.3" data-path="sect044.html"><a href="sect044.html#sect0443"><i class="fa fa-check"></i><b>4.4.3</b> Mesure de la qualité d’ajustement du modèle</a></li>
<li class="chapter" data-level="4.4.4" data-path="sect044.html"><a href="sect044.html#sect0444"><i class="fa fa-check"></i><b>4.4.4</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.4.5" data-path="sect044.html"><a href="sect044.html#sect0445"><i class="fa fa-check"></i><b>4.4.5</b> Comment rapporter une régression linéaire simple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Relation entre deux variables qualitatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Construction de tableau de contingence</a></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Test du khi-deux</a></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Interprétation d’un tableau de contingence</a></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Relation entre une variable qualitative et une variable quantitative</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Relation entre une variable quantitative et une variable qualitative à deux modalités</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Test <em>t</em> et ses différentes variantes</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Test non paramétrique de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Analyse de variance</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Test non paramétrique de Kruskal-Wallis</a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="6.2.4" data-path="sect062.html"><a href="sect062.html#sect0624"><i class="fa fa-check"></i><b>6.2.4</b> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Conclusion sur la troisième partie</a></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>IV Modèles de régression</b></span></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Principes de base de la régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Un peu d’équations…</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Hypothèses de la régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Évaluation de la qualité d’ajustement du modèle</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Mesures de la qualité d’un modèle</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Comparaison des modèles incrémentiels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Différentes mesures pour les coefficients de régression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sect074.html"><a href="sect074.html#sect0741"><i class="fa fa-check"></i><b>7.4.1</b> Coefficients de régression : évaluer l’effet des variables indépendantes</a></li>
<li class="chapter" data-level="7.4.2" data-path="sect074.html"><a href="sect074.html#sect0742"><i class="fa fa-check"></i><b>7.4.2</b> Coefficients de régression standardisés : repérer les variables les plus importantes du modèle</a></li>
<li class="chapter" data-level="7.4.3" data-path="sect074.html"><a href="sect074.html#sect0743"><i class="fa fa-check"></i><b>7.4.3</b> Significativité des coefficients de régression : valeurs de <em>t</em> et de <em>p</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="sect074.html"><a href="sect074.html#sect0744"><i class="fa fa-check"></i><b>7.4.4</b> Intervalle de confiance des coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Introduction de variables explicatives particulières</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sect075.html"><a href="sect075.html#sect0751"><i class="fa fa-check"></i><b>7.5.1</b> Exploration des relations non linéaires</a></li>
<li class="chapter" data-level="7.5.2" data-path="sect075.html"><a href="sect075.html#sect0752"><i class="fa fa-check"></i><b>7.5.2</b> Variable indépendante qualitative dichotomique</a></li>
<li class="chapter" data-level="7.5.3" data-path="sect075.html"><a href="sect075.html#sect0753"><i class="fa fa-check"></i><b>7.5.3</b> Variable indépendante qualitative polytomique</a></li>
<li class="chapter" data-level="7.5.4" data-path="sect075.html"><a href="sect075.html#sect0754"><i class="fa fa-check"></i><b>7.5.4</b> Variables d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sect076.html"><a href="sect076.html"><i class="fa fa-check"></i><b>7.6</b> Diagnostics de la régression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sect076.html"><a href="sect076.html#sect0761"><i class="fa fa-check"></i><b>7.6.1</b> Nombre d’observations</a></li>
<li class="chapter" data-level="7.6.2" data-path="sect076.html"><a href="sect076.html#sect0762"><i class="fa fa-check"></i><b>7.6.2</b> Normalité des résidus</a></li>
<li class="chapter" data-level="7.6.3" data-path="sect076.html"><a href="sect076.html#sect0763"><i class="fa fa-check"></i><b>7.6.3</b> Linéarité et homoscédasticité des résidus</a></li>
<li class="chapter" data-level="7.6.4" data-path="sect076.html"><a href="sect076.html#sect0764"><i class="fa fa-check"></i><b>7.6.4</b> Absence de multicolinéarité excessive</a></li>
<li class="chapter" data-level="7.6.5" data-path="sect076.html"><a href="sect076.html#sect0766"><i class="fa fa-check"></i><b>7.6.5</b> Absence d’observations aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sect077.html"><a href="sect077.html"><i class="fa fa-check"></i><b>7.7</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sect077.html"><a href="sect077.html#sect0771"><i class="fa fa-check"></i><b>7.7.1</b> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
<li class="chapter" data-level="7.7.2" data-path="sect077.html"><a href="sect077.html#sect0772"><i class="fa fa-check"></i><b>7.7.2</b> Comparaison des modèles</a></li>
<li class="chapter" data-level="7.7.3" data-path="sect077.html"><a href="sect077.html#sect0773"><i class="fa fa-check"></i><b>7.7.3</b> Diagnostic sur un modèle</a></li>
<li class="chapter" data-level="7.7.4" data-path="sect077.html"><a href="sect077.html#sect0774"><i class="fa fa-check"></i><b>7.7.4</b> Graphiques pour les effets marginaux</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sect078.html"><a href="sect078.html"><i class="fa fa-check"></i><b>7.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Régressions linéaires généralisées (GLM)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Qu’est qu’un modèle GLM?</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Formulation d’un GLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Autres distributions et rôle de la fonction de lien</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Conditions d’application</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Résidus et déviance</a></li>
<li class="chapter" data-level="8.1.5" data-path="sect081.html"><a href="sect081.html#sect0815"><i class="fa fa-check"></i><b>8.1.5</b> Vérification l’ajustement</a></li>
<li class="chapter" data-level="8.1.6" data-path="sect081.html"><a href="sect081.html#sect0816"><i class="fa fa-check"></i><b>8.1.6</b> Comparaison de deux modèles GLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Modèles GLM pour des variables qualitatives</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Modèle logistique binomial</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Modèle probit binomial</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Modèle logistique des cotes proportionnelles</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Modèle logistique multinomial</a></li>
<li class="chapter" data-level="8.2.5" data-path="sect082.html"><a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives"><i class="fa fa-check"></i><b>8.2.5</b> Conclusion sur les modèles pour des variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.3</b> Modèles GLM pour des variables de comptage</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="sect084.html"><a href="sect084.html#sect0841"><i class="fa fa-check"></i><b>8.3.1</b> Modèle de Poisson</a></li>
<li class="chapter" data-level="8.3.2" data-path="sect084.html"><a href="sect084.html#sect0842"><i class="fa fa-check"></i><b>8.3.2</b> Modèle binomial négatif</a></li>
<li class="chapter" data-level="8.3.3" data-path="sect084.html"><a href="sect084.html#sect0843"><i class="fa fa-check"></i><b>8.3.3</b> Modèle de Poisson avec excès fixe de zéros</a></li>
<li class="chapter" data-level="8.3.4" data-path="sect084.html"><a href="sect084.html#sect0844"><i class="fa fa-check"></i><b>8.3.4</b> Modèle de Poisson avec excès ajusté de zéros</a></li>
<li class="chapter" data-level="8.3.5" data-path="sect084.html"><a href="sect084.html#sect0845"><i class="fa fa-check"></i><b>8.3.5</b> Conclusion sur les modèles destinés à des variables de comptage</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sect085.html"><a href="sect085.html"><i class="fa fa-check"></i><b>8.4</b> Modèles GLM pour des variables continues</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sect085.html"><a href="sect085.html#sect0851"><i class="fa fa-check"></i><b>8.4.1</b> Modèle GLM gaussien</a></li>
<li class="chapter" data-level="8.4.2" data-path="sect085.html"><a href="sect085.html#sect0852"><i class="fa fa-check"></i><b>8.4.2</b> Modèle GLM avec une distribution de Student</a></li>
<li class="chapter" data-level="8.4.3" data-path="sect085.html"><a href="sect085.html#sect0853"><i class="fa fa-check"></i><b>8.4.3</b> Modèle GLM avec distribution Gamma</a></li>
<li class="chapter" data-level="8.4.4" data-path="sect085.html"><a href="sect085.html#sect0854"><i class="fa fa-check"></i><b>8.4.4</b> Modèle GLM avec une distribution bêta</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sect086.html"><a href="sect086.html"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="8.6" data-path="sect087.html"><a href="sect087.html"><i class="fa fa-check"></i><b>8.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Régressions à effets mixtes (GLMM)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Indépendance des observations et effets de groupes</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Terminologie: effets fixes et effets aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Principes de base des GLMM</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> GLMM avec constantes aléatoires</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.2</b> GLMM avec pentes aléatoires</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.3</b> GLMM avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Conditions d’application des GLMM</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Vérification de la distribution des effets aléatoires</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Homogénéité des variances au sein des groupes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Inférence dans les modèles GLMM</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#sect0941"><i class="fa fa-check"></i><b>9.4.1</b> Inférence pour les effets fixes</a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#sect0942"><i class="fa fa-check"></i><b>9.4.2</b> Inférence pour les effets aléatoires, effet global</a></li>
<li class="chapter" data-level="9.4.3" data-path="sect094.html"><a href="sect094.html#sect0943"><i class="fa fa-check"></i><b>9.4.3</b> Inférence pour les effets aléatoires, des constantes et des pentes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Conclusion sur les GLMM</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Mise en œuvre des GLMM dans R</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="sect096.html"><a href="sect096.html#sect0961"><i class="fa fa-check"></i><b>9.6.1</b> Ajustement du modèle avec uniquement une constante aléatoire</a></li>
<li class="chapter" data-level="9.6.2" data-path="sect096.html"><a href="sect096.html#sect0962"><i class="fa fa-check"></i><b>9.6.2</b> Ajustement du modèle avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sect097.html"><a href="sect097.html"><i class="fa fa-check"></i><b>9.7</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Régressions multiniveaux</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect101.html"><a href="sect101.html"><i class="fa fa-check"></i><b>10.1</b> Modèles multiniveaux : deux intérêts majeurs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect101.html"><a href="sect101.html#sect1011"><i class="fa fa-check"></i><b>10.1.1</b> Répartition de la variance entre les différents niveaux</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect101.html"><a href="sect101.html#sect1012"><i class="fa fa-check"></i><b>10.1.2</b> Estimation des coefficients aux différents niveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect102.html"><a href="sect102.html"><i class="fa fa-check"></i><b>10.2</b> Différents types de modèles multiniveaux</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect102.html"><a href="sect102.html#sect1021"><i class="fa fa-check"></i><b>10.2.1</b> Description du jeu de données utilisé</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect102.html"><a href="sect102.html#sect1022"><i class="fa fa-check"></i><b>10.2.2</b> Démarche classique pour les modèles multiniveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect103.html"><a href="sect103.html"><i class="fa fa-check"></i><b>10.3</b> Conditions d’application des régressions multiniveaux</a></li>
<li class="chapter" data-level="10.4" data-path="sect104.html"><a href="sect104.html"><i class="fa fa-check"></i><b>10.4</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect104.html"><a href="sect104.html#sect1041"><i class="fa fa-check"></i><b>10.4.1</b> Le modèle vide</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect104.html"><a href="sect104.html#sect1042"><i class="fa fa-check"></i><b>10.4.2</b> Modèle avec les variables indépendantes du niveau 1</a></li>
<li class="chapter" data-level="10.4.3" data-path="sect104.html"><a href="sect104.html#sect1043"><i class="fa fa-check"></i><b>10.4.3</b> Modèle avec les variables indépendantes aux niveaux 1 et 2</a></li>
<li class="chapter" data-level="10.4.4" data-path="sect104.html"><a href="sect104.html#sect10414"><i class="fa fa-check"></i><b>10.4.4</b> Modèle complet avec une interaction</a></li>
<li class="chapter" data-level="10.4.5" data-path="sect104.html"><a href="sect104.html#sect1045"><i class="fa fa-check"></i><b>10.4.5</b> Comparaison des quatre modèles</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect105.html"><a href="sect105.html"><i class="fa fa-check"></i><b>10.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> Modèles généralisés additifs</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sect111.html"><a href="sect111.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="sect111.html"><a href="sect111.html#sect1111"><i class="fa fa-check"></i><b>11.1.1</b> Non linéarité fonctionnelle</a></li>
<li class="chapter" data-level="11.1.2" data-path="sect111.html"><a href="sect111.html#sect1112"><i class="fa fa-check"></i><b>11.1.2</b> Non linéarité avec des polynomiales</a></li>
<li class="chapter" data-level="11.1.3" data-path="sect111.html"><a href="sect111.html#sect1113"><i class="fa fa-check"></i><b>11.1.3</b> Non linéarité par segments</a></li>
<li class="chapter" data-level="11.1.4" data-path="sect111.html"><a href="sect111.html#sect1114"><i class="fa fa-check"></i><b>11.1.4</b> Non linéarité avec des <em>splines</em></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sect112.html"><a href="sect112.html"><i class="fa fa-check"></i><b>11.2</b> <em>Spline</em> de régression et <em>spline</em> de lissage</a></li>
<li class="chapter" data-level="11.3" data-path="sect113.html"><a href="sect113.html"><i class="fa fa-check"></i><b>11.3</b> Interprétation d’une <em>spline</em></a></li>
<li class="chapter" data-level="11.4" data-path="sect114.html"><a href="sect114.html"><i class="fa fa-check"></i><b>11.4</b> Multicolinéarité non linéaire</a></li>
<li class="chapter" data-level="11.5" data-path="sect115.html"><a href="sect115.html"><i class="fa fa-check"></i><b>11.5</b> <em>Splines</em> avancées</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sect115.html"><a href="sect115.html#sect1151"><i class="fa fa-check"></i><b>11.5.1</b> <em>Splines</em> cycliques</a></li>
<li class="chapter" data-level="11.5.2" data-path="sect115.html"><a href="sect115.html#sect1152"><i class="fa fa-check"></i><b>11.5.2</b> Splines par groupe</a></li>
<li class="chapter" data-level="11.5.3" data-path="sect115.html"><a href="sect115.html#sect1153"><i class="fa fa-check"></i><b>11.5.3</b> <em>Splines</em> multivariées et <em>splines</em> d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="sect116.html"><a href="sect116.html"><i class="fa fa-check"></i><b>11.6</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="11.7" data-path="sect117.html"><a href="sect117.html"><i class="fa fa-check"></i><b>11.7</b> GAMM</a></li>
<li class="chapter" data-level="11.8" data-path="sect118.html"><a href="sect118.html"><i class="fa fa-check"></i><b>11.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>V Analyses exploratoires multivariées</b></span></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> Méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sect121.html"><a href="sect121.html"><i class="fa fa-check"></i><b>12.1</b> Aperçu des méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="sect121.html"><a href="sect121.html#sect1211"><i class="fa fa-check"></i><b>12.1.1</b> Méthodes factorielles et types de données</a></li>
<li class="chapter" data-level="12.1.2" data-path="sect121.html"><a href="sect121.html#sect1212"><i class="fa fa-check"></i><b>12.1.2</b> Bref historique des méthodes factorielles</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sect122.html"><a href="sect122.html"><i class="fa fa-check"></i><b>12.2</b> Analyses en composantes principales (ACP)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="sect122.html"><a href="sect122.html#sect1221"><i class="fa fa-check"></i><b>12.2.1</b> Recherche d’une simplification</a></li>
<li class="chapter" data-level="12.2.2" data-path="sect122.html"><a href="sect122.html#sect1222"><i class="fa fa-check"></i><b>12.2.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.2.3" data-path="sect122.html"><a href="sect122.html#sect1223"><i class="fa fa-check"></i><b>12.2.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sect123.html"><a href="sect123.html"><i class="fa fa-check"></i><b>12.3</b> Analyse factorielle des correspondances (AFC)</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="sect123.html"><a href="sect123.html#sect1231"><i class="fa fa-check"></i><b>12.3.1</b> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
<li class="chapter" data-level="12.3.2" data-path="sect123.html"><a href="sect123.html#sect1232"><i class="fa fa-check"></i><b>12.3.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.3.3" data-path="sect123.html"><a href="sect123.html#sect1233"><i class="fa fa-check"></i><b>12.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="sect124.html"><a href="sect124.html"><i class="fa fa-check"></i><b>12.4</b> Analyse de correspondances multiples (ACM)</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="sect124.html"><a href="sect124.html#sect1241"><i class="fa fa-check"></i><b>12.4.1</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.4.2" data-path="sect124.html"><a href="sect124.html#sect1242"><i class="fa fa-check"></i><b>12.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="sect125.html"><a href="sect125.html"><i class="fa fa-check"></i><b>12.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> Méthodes de classification non supervisée</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sect131.html"><a href="sect131.html"><i class="fa fa-check"></i><b>13.1</b> Méthodes de classification : un aperçu</a></li>
<li class="chapter" data-level="13.2" data-path="sect132.html"><a href="sect132.html"><i class="fa fa-check"></i><b>13.2</b> Notions essentielles en classification</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="sect132.html"><a href="sect132.html#sect1321"><i class="fa fa-check"></i><b>13.2.1</b> Distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="sect132.html"><a href="sect132.html#sect1322"><i class="fa fa-check"></i><b>13.2.2</b> Inertie</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="sect133.html"><a href="sect133.html"><i class="fa fa-check"></i><b>13.3</b> Classification ascendante hiérarchique</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="sect133.html"><a href="sect133.html#sect1331"><i class="fa fa-check"></i><b>13.3.1</b> Fonctionnement de l’algorithme</a></li>
<li class="chapter" data-level="13.3.2" data-path="sect133.html"><a href="sect133.html#sect1332"><i class="fa fa-check"></i><b>13.3.2</b> Choisir le bon nombre de groupes</a></li>
<li class="chapter" data-level="13.3.3" data-path="sect133.html"><a href="sect133.html#sect1333"><i class="fa fa-check"></i><b>13.3.3</b> Limites de la classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="13.3.4" data-path="sect133.html"><a href="sect133.html#sect1334"><i class="fa fa-check"></i><b>13.3.4</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sect134.html"><a href="sect134.html"><i class="fa fa-check"></i><b>13.4</b> Nuées dynamiques</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="sect134.html"><a href="sect134.html#sect1341"><i class="fa fa-check"></i><b>13.4.1</b> <em>K-means</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="sect134.html"><a href="sect134.html#sect1342"><i class="fa fa-check"></i><b>13.4.2</b> K-médianes</a></li>
<li class="chapter" data-level="13.4.3" data-path="sect134.html"><a href="sect134.html#sect1343"><i class="fa fa-check"></i><b>13.4.3</b> K-médoïds</a></li>
<li class="chapter" data-level="13.4.4" data-path="sect134.html"><a href="sect134.html#sect1344"><i class="fa fa-check"></i><b>13.4.4</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="13.4.5" data-path="sect134.html"><a href="sect134.html#sect1346"><i class="fa fa-check"></i><b>13.4.5</b> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sect135.html"><a href="sect135.html"><i class="fa fa-check"></i><b>13.5</b> Conclusion sur la cinquième partie</a></li>
<li class="chapter" data-level="13.6" data-path="sect136.html"><a href="sect136.html"><i class="fa fa-check"></i><b>13.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>VI Annexes</b></span></li>
<li class="chapter" data-level="14" data-path="annexe1.html"><a href="annexe1.html"><i class="fa fa-check"></i><b>14</b> Table des valeurs critiques de khi-deux</a></li>
<li class="chapter" data-level="15" data-path="annexe2.html"><a href="annexe2.html"><i class="fa fa-check"></i><b>15</b> Table des valeurs critiques de Fisher</a></li>
<li class="chapter" data-level="16" data-path="annexe3.html"><a href="annexe3.html"><i class="fa fa-check"></i><b>16</b> Table des valeurs critiques de <em>t</em></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect084" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Modèles GLM pour des variables de comptage<a href="sect084.html#sect084" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dans cette section, nous présentons les principaux modèles utilisés pour modéliser des variables de comptage. Il peut s’agir de variables comme le nombre d’accidents à une intersection, le nombre de cafés par quartier, le nombre de cas d’une maladie donnée par entité géographique, etc.</p>
<div id="sect0841" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Modèle de Poisson<a href="sect084.html#sect0841" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le modèle GLM de base pour modéliser une variable de comptage est le modèle de Poisson. Pour rappel, la distribution de Poisson a un seul paramètre: <span class="math inline">\(\lambda\)</span>. Il représente le nombre moyen d’évènements observés sur l’intervalle de temps d’une observation, ainsi que la dispersion de la distribution. En conséquence, <span class="math inline">\(\lambda\)</span> doit être un nombre strictement positif; autrement dit, nous ne pouvons pas observer un nombre négatif d’évènements. Il est donc nécessaire d’utiliser une fonction de lien pour contraindre l’équation de régression sur l’intervalle <span class="math inline">\([0 ,+\infty]\)</span>. La fonction la plus utilisée est le logarithme naturel (<em>log</em>) dont la réciproque est la fonction exponentielle (<em>exp</em>).</p>
<table>
<caption>
<span id="tab:poissondentity">Tableau 8.20: </span>Carte d’identité du modèle de Poisson
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable de comptage
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Poisson
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim Poisson(\lambda)\)</span> <br/> <span class="math inline">\(g(\lambda) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(g(x) =log(x)\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
log
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
<span class="math inline">\(\lambda\)</span>
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Absence d’excès de zéros, absence de sur-dispersion ou de sous-dispersion
</td>
</tr>
</tbody>
</table>
<div id="interprétation-des-paramètres-1" class="section level4 hasAnchor" number="8.3.1.1">
<h4><span class="header-section-number">8.3.1.1</span> Interprétation des paramètres<a href="sect084.html#interprétation-des-paramètres-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Les coefficients du modèle expriment l’effet du changement d’une unité des variables <em>X</em> sur <span class="math inline">\(\lambda\)</span> (le nombre de cas) dans l’échelle logarithmique (<em>log-scale</em>). Pour rappel, l’échelle logarithmique est multiplicative : si nous convertissons les coefficients dans leur échelle originale avec la fonction exponentielle, leur effet n’est plus additif, mais multiplicatif. Prenons un exemple concret, admettons que nous avons ajusté un modèle de Poisson à une variable de comptage <em>Y</em> avec deux variables <span class="math inline">\(X_1\)</span> et <span class="math inline">\(X_2\)</span> et que nous avons obtenus les coefficients suivants :</p>
<p><span class="math inline">\(\beta_0 = 1,8 \text{; } \beta_1 = 0,5 \text{; } \beta_2 = -1,5\)</span></p>
<p>L’interprétation basique (sur l’échelle logarithmique) est la suivante : une augmentation d’une unité de la variable <span class="math inline">\(X_1\)</span> est associée avec une augmentation de 0,5 du logarithme du nombre de cas attendus. Une augmentation d’une unité de la variable <span class="math inline">\(X_2\)</span> est associée avec une réduction de 1,5 unité du logarithme du nombre de cas attendus. Avec la conversion avec la fonction exponentielle, nous obtenons alors :</p>
<ul>
<li><span class="math inline">\(exp\mbox{(0,5) = 1,649}\)</span>, soit une multiplication par 1,649 du nombre de cas attendu (aussi appelé taux d’incident) à chaque augmentation d’une unité de <span class="math inline">\(X_1\)</span>;</li>
<li><span class="math inline">\(exp\mbox{(-1,5) = 0,223}\)</span>, soit une division par 4,54 (1/0,223) du nombre de cas attendu (aussi appelé taux d’incident) à chaque augmentation d’une unité de <span class="math inline">\(X_2\)</span>.</li>
</ul>
<p>Utilisons maintenant notre équation pour effectuer une prédiction si <span class="math inline">\(X_1 = 1\)</span> et <span class="math inline">\(X_2 = 1\)</span>.</p>
<p><span class="math inline">\(\lambda = exp(\mbox{1,8} + (\mbox{0,5}\times 1) + (\mbox{-1,5}\times1)) = \mbox{2,225}\)</span></p>
<p>Si nous augmentons <span class="math inline">\(X_1\)</span> d’une unité, nous obtenons alors :</p>
<p><span class="math inline">\(\lambda = exp(1,8 + (\mbox{0,5}\times 2) + (\mbox{-1,5}\times1)) = \mbox{3,670}\)</span></p>
<p>En ayant augmenté d’une unité <span class="math inline">\(X_1\)</span>, nous avons multiplié notre résultat par 1,649 (<span class="math inline">\(\mbox{2,225} \times \mbox{1,649 = 3,670}\)</span>).</p>
<p>Notez que ces effets se multiplient entre eux. Si nous augmentons à la fois <span class="math inline">\(X_1\)</span> et <span class="math inline">\(X_2\)</span> d’une unité chacune, nous obtenons : <span class="math inline">\(\lambda = exp(1,8 + (\mbox{0,5} \times 2) + (\mbox{-1,5} \times 2)) = \mbox{0,818}\)</span>, ce qui correspond bien à <span class="math inline">\(\mbox{2,225} \times \mbox{1,649} \text{ (effet de  }X_1\text{)} \times \mbox{0,223} \text{ (effet de }X_2\text{)} = \mbox{0,818}\)</span>.</p>
<p>Il existe des fonctions dans R qui calculent ces prédictions à partir des équations des modèles. Il est cependant essentiel de bien saisir ce comportement multiplicatif induit par la fonction de lien <em>log</em>.</p>
<div id="conditions-dapplication-2" class="section level5 hasAnchor" number="8.3.1.1.1">
<h5><span class="header-section-number">8.3.1.1.1</span> Conditions d’application<a href="sect084.html#conditions-dapplication-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Puisque la distribution de Poisson n’a qu’un seul paramètre, le modèle GLM de Poisson est exposé au même problème potentiel de sur-dispersion que les modèles binomiaux de la section précédente. Référez-vous à la section <a href="sect082.html#sectcondapp">8.2.1.2</a> pour davantage de détails sur le problème posé par la sur-dispersion. Pour détecter une potentielle sur-dispersion dans un modèle de Poisson, il est possible, dans un premier temps, de calculer le ratio entre la déviance du modèle et son nombre de degrés de liberté <span class="citation">(<a href="#ref-Saspoiss" role="doc-biblioref">SAS Institute Inc 2020b</a>)</span>. Ce ratio doit être proche de 1, s’il est plus grand, le modèle souffre de sur-dispersion.</p>
<p><span class="math display" id="eq:glm16">\[\begin{equation}
\hat{\phi} = \frac{D(modele)}{N-p}
\tag{8.19}
\end{equation}\]</span>
</p>
<p>avec <span class="math inline">\(N\)</span> et <span class="math inline">\(p\)</span> étant respectivement les nombres d’observations et de paramètres. Il est également possible de tester formellement si la sur-dispersion est significative avec un test de dispersion.</p>
<p>La question de l’excès de zéros a été abordée dans la section <a href="sect024.html#sectpoissonzero">2.4.3.7</a> du chapitre <a href="chap02.html#chap02">2</a>. Il s’agit d’une situation où un plus grand nombre de zéros sont présents dans les données que ce que suppose la distribution de Poisson. Dans ce cas, il convient d’utiliser la distribution de Poisson avec excès de zéros.</p>
</div>
</div>
<div id="exemple-appliqué-dans-r-2" class="section level4 hasAnchor" number="8.3.1.2">
<h4><span class="header-section-number">8.3.1.2</span> Exemple appliqué dans R<a href="sect084.html#exemple-appliqué-dans-r-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour cet exemple, nous reproduisons l’analyse effectuée dans l’article de <span class="citation">Cloutier et al. (<a href="#ref-cloutier2014carrefours" role="doc-biblioref">2014</a>)</span>. L’enjeu de cette étude était de modéliser le nombre de piétons blessés autour de plus de 500 carrefours dans les quartiers centraux de Montréal. Pour cela, trois types de variables étaient utilisées : des variables décrivant l’intersection, des variables décrivant les activités humaines dans un rayon d’un kilomètre autour de l’intersection et des variables représentant le trafic routier autour de l’intersection. Un effet direct de ce type d’étude est bien évidemment l’établissement de meilleures pratiques d’aménagement réduisant les risques encourus par les piétons lors de leurs déplacements en ville. Le tableau <a href="sect084.html#tab:variablepoiss">8.21</a> présente l’ensemble des variables utilisées dans l’analyse.</p>
<table>
<caption>
<span id="tab:variablepoiss">Tableau 8.21: </span>Variables indépendantes utilisées dans le modèle de Poisson
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nom de la variable
</th>
<th style="text-align:left;">
Signification
</th>
<th style="text-align:left;">
Type de variable
</th>
<th style="text-align:left;">
Mesure
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Feux_auto
</td>
<td style="text-align:left;">
Présence de feux de circulation
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
0 = absence; 1 = présence
</td>
</tr>
<tr>
<td style="text-align:left;">
Feux_piet
</td>
<td style="text-align:left;">
Présence de feux de traversée pour les piétons
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
0 = absence; 1 = présence
</td>
</tr>
<tr>
<td style="text-align:left;">
Pass_piet
</td>
<td style="text-align:left;">
Présence d’un passage piéton
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
0 = absence; 1 = présence
</td>
</tr>
<tr>
<td style="text-align:left;">
Terreplein
</td>
<td style="text-align:left;">
Présence d’un terre-plein central
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
0 = absence; 1 = présence
</td>
</tr>
<tr>
<td style="text-align:left;">
Apaisement
</td>
<td style="text-align:left;">
Présence de mesure d’apaisement de la circulation
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
0 = absence; 1 = présence
</td>
</tr>
<tr>
<td style="text-align:left;">
LogEmploi
</td>
<td style="text-align:left;">
Logarithme du nombre d’emplois dans un rayon d’un kilomètre
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Logarithme du nombre d’emploi. Utilisation du logarithme, car la variable est fortement asymétrique
</td>
</tr>
<tr>
<td style="text-align:left;">
Densite_pop
</td>
<td style="text-align:left;">
Densité de population dans un rayon d’un kilomètre
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Habitants par hectare
</td>
</tr>
<tr>
<td style="text-align:left;">
Entropie
</td>
<td style="text-align:left;">
Diversité des occupations du sol dans un rayon d’un kilomètre (indice d’entropie)
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Mesure de 0 à 1; 0 = spécialisation parfaite; 1 = diversité parfaite
</td>
</tr>
<tr>
<td style="text-align:left;">
DensiteInter
</td>
<td style="text-align:left;">
Densité d’intersections dans un rayon d’un kilomètre (connexité)
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Nombre d’intersection par km2
</td>
</tr>
<tr>
<td style="text-align:left;">
Artere
</td>
<td style="text-align:left;">
Présence d’une artère à l’intersection
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
0 = absence; 1 = présence
</td>
</tr>
<tr>
<td style="text-align:left;">
Long_arterePS
</td>
<td style="text-align:left;">
Longueur d’artère dans un rayon d’un kilomètre
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Exprimée en mètres
</td>
</tr>
<tr>
<td style="text-align:left;">
NB_voies5
</td>
<td style="text-align:left;">
Présence d’une cinq voies à l’intersection
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
0 = absence; 1 = présence
</td>
</tr>
</tbody>
</table>
<p>La distribution originale de la variable est décrite à la figure <a href="sect084.html#fig:distripoissmod">8.23</a>. Les barres grises représentent la distribution du nombre d’accidents et les barres rouges une distribution de Poisson ajustée sans variable indépendante (modèle nul). Ce premier graphique peut laisser penser qu’un modèle de Poisson n’est pas nécessairement le plus adapté considérant le grand nombre d’intersections pour lesquelles nous n’avons aucun accident. Cependant, rappelons que la variable <em>Y</em> n’a pas besoin de suivre une distribution de Poisson. Dans un modèle GLM, l’hypothèse que nous formulons est que la variable dépendante (<em>Y</em>) <strong>conditionnée par les variables indépendantes (<em>X</em>)</strong> suit une certaine distribution (ici Poisson).</p>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="sect084.html#cb837-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb837-2"><a href="sect084.html#cb837-2" aria-hidden="true" tabindex="-1"></a>data_accidents <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/glm/accident_pietons.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb837-3"><a href="sect084.html#cb837-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement d&#39;une distribution de Poisson sans variable indépendante</span></span>
<span id="cb837-4"><a href="sect084.html#cb837-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)</span>
<span id="cb837-5"><a href="sect084.html#cb837-5" aria-hidden="true" tabindex="-1"></a>model_poisson <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(data_accidents<span class="sc">$</span>Nbr_acci,<span class="at">distr =</span> <span class="st">&quot;pois&quot;</span>)</span>
<span id="cb837-6"><a href="sect084.html#cb837-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d&#39;un graphique pour comparer les deux distributions</span></span>
<span id="cb837-7"><a href="sect084.html#cb837-7" aria-hidden="true" tabindex="-1"></a>dfpoisson <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">19</span>),</span>
<span id="cb837-8"><a href="sect084.html#cb837-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span><span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">19</span>, model_poisson<span class="sc">$</span>estimate)</span>
<span id="cb837-9"><a href="sect084.html#cb837-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb837-10"><a href="sect084.html#cb837-10" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(data_accidents<span class="sc">$</span>Nbr_acci))</span>
<span id="cb837-11"><a href="sect084.html#cb837-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;nb_accident&quot;</span>,<span class="st">&#39;frequence&#39;</span>)</span>
<span id="cb837-12"><a href="sect084.html#cb837-12" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>nb_accident <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(counts<span class="sc">$</span>nb_accident))</span>
<span id="cb837-13"><a href="sect084.html#cb837-13" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>prop <span class="ot">&lt;-</span> counts<span class="sc">$</span>frequence <span class="sc">/</span> <span class="fu">sum</span>(counts<span class="sc">$</span>frequence)</span>
<span id="cb837-14"><a href="sect084.html#cb837-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb837-15"><a href="sect084.html#cb837-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>nb_accident, <span class="at">weight =</span> prop, <span class="at">fill =</span> <span class="st">&quot;real&quot;</span>), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">data =</span> counts)<span class="sc">+</span></span>
<span id="cb837-16"><a href="sect084.html#cb837-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">weight =</span> y, <span class="at">fill =</span> <span class="st">&quot;adj&quot;</span>), <span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">data =</span> dfpoisson)<span class="sc">+</span></span>
<span id="cb837-17"><a href="sect084.html#cb837-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb837-18"><a href="sect084.html#cb837-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb837-19"><a href="sect084.html#cb837-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;real&quot;</span>,<span class="st">&quot;adj&quot;</span>),</span>
<span id="cb837-20"><a href="sect084.html#cb837-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;distribution originale&quot;</span>, <span class="st">&quot;distribution de Poisson&quot;</span>),</span>
<span id="cb837-21"><a href="sect084.html#cb837-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;real&quot;</span> <span class="ot">=</span> <span class="fu">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>), <span class="st">&quot;adj&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>))<span class="sc">+</span></span>
<span id="cb837-22"><a href="sect084.html#cb837-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb837-23"><a href="sect084.html#cb837-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;nombre d&#39;accidents&quot;</span>,</span>
<span id="cb837-24"><a href="sect084.html#cb837-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:distripoissmod"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/distripoissmod-1.png" alt="Distribution originale du nombre d'accidents par intersection" width="65%" />
<p class="caption">
Figure 8.23: Distribution originale du nombre d’accidents par intersection
</p>
</div>
<p><strong>Vérification des conditions d’application</strong></p>
<p>Comme précédemment, notre première étape est de vérifier l’absence de multicolinéarité excessive avec la fonction <code>vif</code> du <em>package</em> <code>car</code>.</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="sect084.html#cb838-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">glm</span>(Nbr_acci <span class="sc">~</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Pass_piet <span class="sc">+</span> Terreplein <span class="sc">+</span> Apaisement <span class="sc">+</span></span>
<span id="cb838-2"><a href="sect084.html#cb838-2" aria-hidden="true" tabindex="-1"></a>          LogEmploi <span class="sc">+</span> Densite_pop <span class="sc">+</span> Entropie <span class="sc">+</span> DensiteInter <span class="sc">+</span></span>
<span id="cb838-3"><a href="sect084.html#cb838-3" aria-hidden="true" tabindex="-1"></a>          Long_arterePS <span class="sc">+</span> Artere <span class="sc">+</span> NB_voies5,</span>
<span id="cb838-4"><a href="sect084.html#cb838-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb838-5"><a href="sect084.html#cb838-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> data_accidents))</span></code></pre></div>
<pre><code>##     Feux_auto     Feux_piet     Pass_piet    Terreplein    Apaisement     LogEmploi   Densite_pop 
##      2.861708      1.518668      2.321213      1.221683      1.059722      4.763692      1.153096 
##      Entropie  DensiteInter Long_arterePS        Artere     NB_voies5 
##      1.770904      2.040457      4.467841      1.887728      1.520514</code></pre>
<p>Toutes les valeurs de VIF sont inférieures à 5. Notons tout de même que le logarithme de l’emploi et la longueur d’artère dans un rayon d’un kilomètre ont des valeurs de VIF proches de 5. La seconde étape du diagnostic consiste à calculer et à visualiser les distances de Cook.</p>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="sect084.html#cb840-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement d&#39;une première version du modèle</span></span>
<span id="cb840-2"><a href="sect084.html#cb840-2" aria-hidden="true" tabindex="-1"></a>modele <span class="ot">&lt;-</span> <span class="fu">glm</span>(Nbr_acci <span class="sc">~</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Pass_piet <span class="sc">+</span> Terreplein <span class="sc">+</span> Apaisement <span class="sc">+</span></span>
<span id="cb840-3"><a href="sect084.html#cb840-3" aria-hidden="true" tabindex="-1"></a>                LogEmploi <span class="sc">+</span> Densite_pop <span class="sc">+</span> Entropie <span class="sc">+</span> DensiteInter <span class="sc">+</span></span>
<span id="cb840-4"><a href="sect084.html#cb840-4" aria-hidden="true" tabindex="-1"></a>                Long_arterePS <span class="sc">+</span> Artere <span class="sc">+</span> NB_voies5,</span>
<span id="cb840-5"><a href="sect084.html#cb840-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb840-6"><a href="sect084.html#cb840-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data_accidents)</span>
<span id="cb840-7"><a href="sect084.html#cb840-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb840-8"><a href="sect084.html#cb840-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb840-9"><a href="sect084.html#cb840-9" aria-hidden="true" tabindex="-1"></a>cooksd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modele)</span>
<span id="cb840-10"><a href="sect084.html#cb840-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb840-11"><a href="sect084.html#cb840-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cook =</span> cooksd,</span>
<span id="cb840-12"><a href="sect084.html#cb840-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">oid =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cooksd)</span>
<span id="cb840-13"><a href="sect084.html#cb840-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb840-14"><a href="sect084.html#cb840-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df)<span class="sc">+</span></span>
<span id="cb840-15"><a href="sect084.html#cb840-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> oid, <span class="at">y =</span> cook), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb840-16"><a href="sect084.html#cb840-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb840-17"><a href="sect084.html#cb840-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Distance de Cook&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:poisscookdist"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/poisscookdist-1.png" alt="Distances de Cook pour le modèle de Poisson" width="60%" />
<p class="caption">
Figure 8.24: Distances de Cook pour le modèle de Poisson
</p>
</div>
<p>La figure <a href="sect084.html#fig:poisscookdist">8.24</a> signale la présence de trois observations avec des valeurs extrêmement fortes de distance de Cook. Nous les isolons dans un premier temps pour les analyser.</p>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="sect084.html#cb841-1" aria-hidden="true" tabindex="-1"></a>cas_etrange <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_accidents, cooksd<span class="sc">&gt;</span><span class="fl">0.1</span>)</span>
<span id="cb841-2"><a href="sect084.html#cb841-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cas_etrange)</span></code></pre></div>
<pre><code>##     Nbr_acci Feux_auto Feux_piet Pass_piet Terreplein Apaisement EmpTotBuffer Densite_pop  Entropie
## 1         19         1         1         1          1          0     7208.538    5980.923 0.8073926
## 26         7         0         0         1          0          0     1342.625    2751.012 0.0000000
## 428        0         1         1         1          0          1    13122.560   14148.827 0.6643891
##     DensiteInter Long_arterePS Artere NB_voies5 log_acci catego_acci catego_acci2 Arret VAG sum_app
## 1       42.41597       6955.00      1         1 2.995732           1            1     0   1       4
## 26      73.35344       2849.66      0         0 2.079442           1            1     1   1       3
## 428    109.25066       4634.20      0         0 0.000000           0            0     0   0       3
##     LogEmploi AccOrdinal     PopHa
## 1    8.883021          2  5.980923
## 26   7.202382          2  2.751012
## 428  9.482088          0 14.148827</code></pre>
<p>Les deux premiers cas sont des intersections avec de nombreux accidents (respectivement 19 et 7) qui risquent de perturber les estimations du modèle. Le troisième cas ne comprend en revanche aucun accident. Puisqu’il ne s’agit que de trois observations et que leurs distances de Cook sont très nettement supérieures aux autres, nous les retirons du modèle.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="sect084.html#cb843-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_accidents, cooksd<span class="sc">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb843-2"><a href="sect084.html#cb843-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement d&#39;une première version du modèle</span></span>
<span id="cb843-3"><a href="sect084.html#cb843-3" aria-hidden="true" tabindex="-1"></a>modele <span class="ot">&lt;-</span> <span class="fu">glm</span>(Nbr_acci <span class="sc">~</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Pass_piet <span class="sc">+</span> Terreplein <span class="sc">+</span> Apaisement <span class="sc">+</span></span>
<span id="cb843-4"><a href="sect084.html#cb843-4" aria-hidden="true" tabindex="-1"></a>                LogEmploi <span class="sc">+</span> Densite_pop <span class="sc">+</span> Entropie <span class="sc">+</span> DensiteInter <span class="sc">+</span></span>
<span id="cb843-5"><a href="sect084.html#cb843-5" aria-hidden="true" tabindex="-1"></a>                Long_arterePS <span class="sc">+</span> Artere <span class="sc">+</span> NB_voies5,</span>
<span id="cb843-6"><a href="sect084.html#cb843-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb843-7"><a href="sect084.html#cb843-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data2)</span>
<span id="cb843-8"><a href="sect084.html#cb843-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb843-9"><a href="sect084.html#cb843-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb843-10"><a href="sect084.html#cb843-10" aria-hidden="true" tabindex="-1"></a>cooksd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modele)</span>
<span id="cb843-11"><a href="sect084.html#cb843-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb843-12"><a href="sect084.html#cb843-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cook =</span> cooksd,</span>
<span id="cb843-13"><a href="sect084.html#cb843-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">oid =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cooksd)</span>
<span id="cb843-14"><a href="sect084.html#cb843-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb843-15"><a href="sect084.html#cb843-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df)<span class="sc">+</span></span>
<span id="cb843-16"><a href="sect084.html#cb843-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> oid, <span class="at">y =</span> cook), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb843-17"><a href="sect084.html#cb843-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb843-18"><a href="sect084.html#cb843-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;distance de Cook&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:poisscookdist2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/poisscookdist2-1.png" alt="Distances de Cook pour le modèle de Poisson après avoir retiré les valeurs aberrantes" width="60%" />
<p class="caption">
Figure 8.25: Distances de Cook pour le modèle de Poisson après avoir retiré les valeurs aberrantes
</p>
</div>
<p>La figure <a href="sect084.html#fig:poisscookdist2">8.25</a> montre que nous n’avons plus d’observations fortement influentes dans le modèle après avoir retiré les trois observations identifiées précédemment. Nous devons à présent vérifier l’absence de sur-dispersion.</p>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="sect084.html#cb844-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du rapport entre déviance et nombre de degrés de liberté du modèle</span></span>
<span id="cb844-2"><a href="sect084.html#cb844-2" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(modele)<span class="sc">/</span>(<span class="fu">nrow</span>(data2) <span class="sc">-</span> modele<span class="sc">$</span>rank)</span></code></pre></div>
<pre><code>## [1] 1.674691</code></pre>
<p>Le rapport entre la déviance et le nombre de degrés de liberté du modèle est nettement supérieur à 1, indiquant une sur-dispersion excessive. Nous pouvons confirmer ce résultat avec la fonction <code>dispersiontest</code> du <em>package</em> <code>AER</code>.</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="sect084.html#cb846-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AER)</span>
<span id="cb846-2"><a href="sect084.html#cb846-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de sur-dispersion</span></span>
<span id="cb846-3"><a href="sect084.html#cb846-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersiontest</span>(modele)</span></code></pre></div>
<pre><code>## 
##  Overdispersion test
## 
## data:  modele
## z = 5.2737, p-value = 6.686e-08
## alternative hypothesis: true dispersion is greater than 1
## sample estimates:
## dispersion 
##   1.891565</code></pre>
<p>Contrairement à la forme classique d’un modèle de Poisson pour laquelle la dispersion attendue est de 1, le test nous indique qu’une dispersion de 1,89 serait mieux ajustée aux données.</p>
<p>Il est également possible d’illuster cet écart à l’aide d’un graphique représentant les valeurs réelles, les valeurs prédites, ainsi que la variance (sous forme de barres d’erreurs) attendue par le modèle (figure <a href="sect084.html#fig:surdisppoiss">8.26</a>). Nous constatons ainsi que les valeurs réelles (en rouge) ont largement tendance à dépasser la variance attendue par le modèle, surtout pour les valeurs les plus faibles de la distribution.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="sect084.html#cb848-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des prédictions du modèle</span></span>
<span id="cb848-2"><a href="sect084.html#cb848-2" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb848-3"><a href="sect084.html#cb848-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d&#39;un DataFrame pour contenir la prédiction et les vraies valeurs</span></span>
<span id="cb848-4"><a href="sect084.html#cb848-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb848-5"><a href="sect084.html#cb848-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambdas =</span> lambdas,</span>
<span id="cb848-6"><a href="sect084.html#cb848-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">reals =</span> data2<span class="sc">$</span>Nbr_acci</span>
<span id="cb848-7"><a href="sect084.html#cb848-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb848-8"><a href="sect084.html#cb848-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de l&#39;intervalle de confiance à 95 % selon la distribution de Poisson</span></span>
<span id="cb848-9"><a href="sect084.html#cb848-9" aria-hidden="true" tabindex="-1"></a><span class="co"># et stockage dans un second DataFrame</span></span>
<span id="cb848-10"><a href="sect084.html#cb848-10" aria-hidden="true" tabindex="-1"></a>seqa <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">round</span>(<span class="fu">max</span>(lambdas)),<span class="dv">1</span>)</span>
<span id="cb848-11"><a href="sect084.html#cb848-11" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb848-12"><a href="sect084.html#cb848-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambdas =</span> seqa,</span>
<span id="cb848-13"><a href="sect084.html#cb848-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">qpois</span>(<span class="at">p =</span> <span class="fl">0.025</span>, <span class="at">lambda =</span> seqa),</span>
<span id="cb848-14"><a href="sect084.html#cb848-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">qpois</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">lambda =</span> seqa)</span>
<span id="cb848-15"><a href="sect084.html#cb848-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb848-16"><a href="sect084.html#cb848-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des valeurs réelles et prédites (en rouge)</span></span>
<span id="cb848-17"><a href="sect084.html#cb848-17" aria-hidden="true" tabindex="-1"></a><span class="co"># et de leur variance selon le modèle (en noir)</span></span>
<span id="cb848-18"><a href="sect084.html#cb848-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb848-19"><a href="sect084.html#cb848-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> df2,</span>
<span id="cb848-20"><a href="sect084.html#cb848-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> lambdas, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper),</span>
<span id="cb848-21"><a href="sect084.html#cb848-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>)) <span class="sc">+</span> </span>
<span id="cb848-22"><a href="sect084.html#cb848-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df1, </span>
<span id="cb848-23"><a href="sect084.html#cb848-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> lambdas, <span class="at">y =</span> reals),</span>
<span id="cb848-24"><a href="sect084.html#cb848-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span><span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb848-25"><a href="sect084.html#cb848-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;valeurs prédites&#39;</span>,</span>
<span id="cb848-26"><a href="sect084.html#cb848-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;valeurs réelles&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:surdisppoiss"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/surdisppoiss-1.png" alt="Représentation de la sur-dispersion des données dans le modèle de Poisson" width="65%" />
<p class="caption">
Figure 8.26: Représentation de la sur-dispersion des données dans le modèle de Poisson
</p>
</div>
<p>Pour tenir compte de cette particularité des données, nous modifions légèrement le modèle pour utiliser une distribution de quasi-Poisson, intégrant spécifiquement un paramètre de dispersion. Cet ajustement ne modifie pas l’estimation des coefficients du modèle, mais modifie le calcul des erreurs standards et par extension les valeurs de <em>p</em> pour les rendre moins sensibles au problème de sur-dispersion. Une autre approche aurait été de calculer une version robuste des erreurs standards avec le <em>package</em> <code>sandwich</code> comme nous l’avons fait dans la section <a href="sect082.html#sect0821">8.2.1</a> sur le modèle binomial. Après réajustement du modèle, le nouveau paramètre de dispersion estimé est de 1,92.</p>
<div class="bloc_notes">
<p><strong>Les quasi-distributions</strong></p>
<p>Les distributions binomiale et de Poisson ne disposent chacune que d’un paramètre décrivant à la fois leur dispersion et leur espérance. Elles manquent donc de flexibilité et échouent parfois à représenter fidèlement des données avec une forte variance. Il existe donc d’autres distributions, respectivement les distributions quasi-binomiale et quasi-Poisson comprenant chacune un paramètre supplémentaire pour contrôler la dispersion. Bien que cette solution soit attrayante, il ne faut pas perdre de vue que la sur ou la sous dispersion peuvent être causées par l’absence de certaines variables explicatives, la sur-représentation de zéros, ou encore une séparation parfaite de la variable dépendante causée par une variable indépendante.</p>
</div>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="sect084.html#cb849-1" aria-hidden="true" tabindex="-1"></a>modele2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(Nbr_acci <span class="sc">~</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Pass_piet <span class="sc">+</span> Terreplein <span class="sc">+</span> Apaisement <span class="sc">+</span></span>
<span id="cb849-2"><a href="sect084.html#cb849-2" aria-hidden="true" tabindex="-1"></a>                LogEmploi <span class="sc">+</span> Densite_pop <span class="sc">+</span> Entropie <span class="sc">+</span> DensiteInter <span class="sc">+</span></span>
<span id="cb849-3"><a href="sect084.html#cb849-3" aria-hidden="true" tabindex="-1"></a>                Long_arterePS <span class="sc">+</span> Artere <span class="sc">+</span> NB_voies5,</span>
<span id="cb849-4"><a href="sect084.html#cb849-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb849-5"><a href="sect084.html#cb849-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data2)</span></code></pre></div>
<p>Nous pouvons à présent comparer la distribution originale des données et les simulations issues du modèle. Notez que contrairement à la distribution de Poisson simple, il n’existe pas dans R de fonction pour simuler des valeurs issues d’une distribution de quasi-Poisson. Il est cependant possible d’exploiter sa proximité théorique avec la distribution binomiale négative pour définir notre propre fonction de simulation. La figure <a href="sect084.html#fig:comppoissdistr">8.27</a> permet de comparer la distribution originale (en gris) et l’intervalle de confiance à 95 % des simulations (en rouge). Nous remarquons que le modèle semble capturer efficacement la forme générale de la distribution originale. À titre de comparaison, nous pouvons effectuer le même exercice avec la distribution de Poisson classique (le code n’est pas montré pour éviter les répétitions). La figure <a href="sect084.html#fig:comppoissdistr2">8.28</a> montre qu’un simple modèle de Poisson est très éloigné de la distribution originale de <em>Y</em>.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="sect084.html#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition d&#39;une fonction pour simuler des données quasi-Poisson</span></span>
<span id="cb850-2"><a href="sect084.html#cb850-2" aria-hidden="true" tabindex="-1"></a>rqpois <span class="ot">&lt;-</span> <span class="cf">function</span>(n, lambda, disp) {</span>
<span id="cb850-3"><a href="sect084.html#cb850-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rnbinom</span>(<span class="at">n =</span> n, <span class="at">mu =</span> lambda, <span class="at">size =</span> lambda<span class="sc">/</span>(disp<span class="dv">-1</span>))</span>
<span id="cb850-4"><a href="sect084.html#cb850-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb850-5"><a href="sect084.html#cb850-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des valeurs prédites par le modèle</span></span>
<span id="cb850-6"><a href="sect084.html#cb850-6" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele2, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb850-7"><a href="sect084.html#cb850-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération de 1000 simulations pour chaque prédiction</span></span>
<span id="cb850-8"><a href="sect084.html#cb850-8" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> <span class="fu">summary</span>(modele2)<span class="sc">$</span>dispersion</span>
<span id="cb850-9"><a href="sect084.html#cb850-9" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb850-10"><a href="sect084.html#cb850-10" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(preds),<span class="cf">function</span>(i){</span>
<span id="cb850-11"><a href="sect084.html#cb850-11" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> preds[[i]]</span>
<span id="cb850-12"><a href="sect084.html#cb850-12" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rqpois</span>(<span class="at">n =</span> nsim, <span class="at">lambda =</span> lambda, <span class="at">disp =</span> disp))</span>
<span id="cb850-13"><a href="sect084.html#cb850-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb850-14"><a href="sect084.html#cb850-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb850-15"><a href="sect084.html#cb850-15" aria-hidden="true" tabindex="-1"></a>mat_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, cols)</span>
<span id="cb850-16"><a href="sect084.html#cb850-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des données pour le graphique (valeurs réelles)</span></span>
<span id="cb850-17"><a href="sect084.html#cb850-17" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(data2<span class="sc">$</span>Nbr_acci))</span>
<span id="cb850-18"><a href="sect084.html#cb850-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;nb_accident&quot;</span>,<span class="st">&#39;frequence&#39;</span>)</span>
<span id="cb850-19"><a href="sect084.html#cb850-19" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>nb_accident <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(counts<span class="sc">$</span>nb_accident))</span>
<span id="cb850-20"><a href="sect084.html#cb850-20" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>prop <span class="ot">&lt;-</span> counts<span class="sc">$</span>frequence <span class="sc">/</span> <span class="fu">sum</span>(counts<span class="sc">$</span>frequence)</span>
<span id="cb850-21"><a href="sect084.html#cb850-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des données pour le graphique (valeurs simulées)</span></span>
<span id="cb850-22"><a href="sect084.html#cb850-22" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">count =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>)</span>
<span id="cb850-23"><a href="sect084.html#cb850-23" aria-hidden="true" tabindex="-1"></a>count_sims <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>nsim, <span class="cf">function</span>(i){</span>
<span id="cb850-24"><a href="sect084.html#cb850-24" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span> mat_sims[,i]</span>
<span id="cb850-25"><a href="sect084.html#cb850-25" aria-hidden="true" tabindex="-1"></a>  cnt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(sim))</span>
<span id="cb850-26"><a href="sect084.html#cb850-26" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(df1,cnt, <span class="at">by.x=</span><span class="st">&quot;count&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;sim&quot;</span>, <span class="at">all.x =</span> T, <span class="at">all.y=</span>F)</span>
<span id="cb850-27"><a href="sect084.html#cb850-27" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>Freq <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(df2<span class="sc">$</span>Freq),<span class="dv">0</span>,df2<span class="sc">$</span>Freq)</span>
<span id="cb850-28"><a href="sect084.html#cb850-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df2<span class="sc">$</span>Freq)</span>
<span id="cb850-29"><a href="sect084.html#cb850-29" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb850-30"><a href="sect084.html#cb850-30" aria-hidden="true" tabindex="-1"></a>count_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind,count_sims)</span>
<span id="cb850-31"><a href="sect084.html#cb850-31" aria-hidden="true" tabindex="-1"></a>df_sims <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb850-32"><a href="sect084.html#cb850-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">val =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb850-33"><a href="sect084.html#cb850-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">med =</span> <span class="fu">apply</span>(count_sims, <span class="at">MARGIN =</span> <span class="dv">1</span>, median),</span>
<span id="cb850-34"><a href="sect084.html#cb850-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">apply</span>(count_sims, <span class="at">MARGIN =</span> <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.025</span>),</span>
<span id="cb850-35"><a href="sect084.html#cb850-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">apply</span>(count_sims, <span class="at">MARGIN =</span> <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.975</span>)</span>
<span id="cb850-36"><a href="sect084.html#cb850-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb850-37"><a href="sect084.html#cb850-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb850-38"><a href="sect084.html#cb850-38" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb850-39"><a href="sect084.html#cb850-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>nb_accident, <span class="at">weight =</span> frequence), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">data =</span> counts)<span class="sc">+</span></span>
<span id="cb850-40"><a href="sect084.html#cb850-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> val, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper),</span>
<span id="cb850-41"><a href="sect084.html#cb850-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_sims, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">width =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb850-42"><a href="sect084.html#cb850-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> val, <span class="at">y =</span> med), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">1.3</span>, <span class="at">data =</span> df_sims)<span class="sc">+</span></span>
<span id="cb850-43"><a href="sect084.html#cb850-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb850-44"><a href="sect084.html#cb850-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb850-45"><a href="sect084.html#cb850-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb850-46"><a href="sect084.html#cb850-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;nombre d&#39;accidents&quot;</span>,</span>
<span id="cb850-47"><a href="sect084.html#cb850-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;nombre d&#39;occurrences&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:comppoissdistr"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/comppoissdistr-1.png" alt="Comparaison de la distribution originale et des simulations pour le modèle de quasi-Poisson" width="65%" />
<p class="caption">
Figure 8.27: Comparaison de la distribution originale et des simulations pour le modèle de quasi-Poisson
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:comppoissdistr2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/comppoissdistr2-1.png" alt="Comparaison de la distribution originale et des simulations pour le modèle de Poisson" width="65%" />
<p class="caption">
Figure 8.28: Comparaison de la distribution originale et des simulations pour le modèle de Poisson
</p>
</div>
<p>La prochaine étape du diagnostic est l’analyse des résidus simulés. La figure <a href="sect084.html#fig:simrespoiss">8.29</a> indique que les résidus du modèle suivent bien une distribution uniforme et qu’aucune valeur aberrante n’est observable.</p>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="sect084.html#cb851-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération de 1000 simulations pour chaque prédiction</span></span>
<span id="cb851-2"><a href="sect084.html#cb851-2" aria-hidden="true" tabindex="-1"></a>disp <span class="ot">&lt;-</span> <span class="fl">1.918757</span> <span class="co"># trouvable dans le summary(modele2)</span></span>
<span id="cb851-3"><a href="sect084.html#cb851-3" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb851-4"><a href="sect084.html#cb851-4" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(preds),<span class="cf">function</span>(i){</span>
<span id="cb851-5"><a href="sect084.html#cb851-5" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> preds[[i]]</span>
<span id="cb851-6"><a href="sect084.html#cb851-6" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">rqpois</span>(<span class="at">n =</span> nsim, <span class="at">lambda =</span> lambda, <span class="at">disp =</span> disp)</span>
<span id="cb851-7"><a href="sect084.html#cb851-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb851-8"><a href="sect084.html#cb851-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb851-9"><a href="sect084.html#cb851-9" aria-hidden="true" tabindex="-1"></a>mat_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, cols)</span>
<span id="cb851-10"><a href="sect084.html#cb851-10" aria-hidden="true" tabindex="-1"></a>sim_res <span class="ot">&lt;-</span> <span class="fu">createDHARMa</span>(<span class="at">simulatedResponse =</span> mat_sims, </span>
<span id="cb851-11"><a href="sect084.html#cb851-11" aria-hidden="true" tabindex="-1"></a>                            <span class="at">observedResponse =</span> data2<span class="sc">$</span>Nbr_acci,</span>
<span id="cb851-12"><a href="sect084.html#cb851-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fittedPredictedResponse =</span> modele2<span class="sc">$</span>fitted.values,</span>
<span id="cb851-13"><a href="sect084.html#cb851-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">integerResponse =</span> T)</span>
<span id="cb851-14"><a href="sect084.html#cb851-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:simrespoiss"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/simrespoiss-1.png" alt="Analyse globale des résidus simulés pour le modèle de quasi-Poisson" width="65%" />
<p class="caption">
Figure 8.29: Analyse globale des résidus simulés pour le modèle de quasi-Poisson
</p>
</div>
<p>Pour affiner notre diagnostic, nous pouvons également comparer les résidus simulés et chaque variable indépendante. La figure <a href="sect084.html#fig:simrespoiss2">8.30</a> n’indique aucune relation problématique entre nos variables indépendantes et les résidus.</p>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="sect084.html#cb852-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb852-2"><a href="sect084.html#cb852-2" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Feux_auto&quot;</span>, <span class="st">&quot;Feux_piet&quot;</span>, <span class="st">&quot;Pass_piet&quot;</span>, <span class="st">&quot;Terreplein&quot;</span>, <span class="st">&quot;Apaisement&quot;</span>,</span>
<span id="cb852-3"><a href="sect084.html#cb852-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;LogEmploi&quot;</span>, <span class="st">&quot;Densite_pop&quot;</span>, <span class="st">&quot;Entropie&quot;</span>, <span class="st">&quot;DensiteInter&quot;</span>,</span>
<span id="cb852-4"><a href="sect084.html#cb852-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;Long_arterePS&quot;</span>, <span class="st">&quot;Artere&quot;</span>, <span class="st">&quot;NB_voies5&quot;</span>)</span>
<span id="cb852-5"><a href="sect084.html#cb852-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(v <span class="cf">in</span>  vars){</span>
<span id="cb852-6"><a href="sect084.html#cb852-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotResiduals</span>(sim_res, data2[[v]], <span class="at">xlab =</span> v, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;résidus&quot;</span>)</span>
<span id="cb852-7"><a href="sect084.html#cb852-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:simrespoiss2"></span>
<img src="images/glm/simrespoiss2.png" alt="Comparaison des résidus simulés et de chaque variable indépendante" width="100%" />
<p class="caption">
Figure 8.30: Comparaison des résidus simulés et de chaque variable indépendante
</p>
</div>
<p>Maintenant que l’ensemble des diagnostics a été effectué, nous pouvons passer à la vérification de la qualité d’ajustement.</p>
<p><strong>Vérification de la qualité d’ajustement</strong></p>
<p>Pour le calcul des pseudo-R<sup>2</sup>, notez qu’il n’existe pas à proprement parler de <em>loglikelihood</em> pour les quasi-distributions. Pour contourner ce problème, il est possible d’utiliser le <em>loglikelihood</em> d’un simple modèle de Poisson (puisque les coefficients ne changent pas), mais il est important de garder à l’esprit que ces pseudo-R<sup>2</sup> seront d’autant plus faibles que la sur-dispersion originale était forte.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="sect084.html#cb853-1" aria-hidden="true" tabindex="-1"></a>modelnull <span class="ot">&lt;-</span> <span class="fu">glm</span>(Nbr_acci <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb853-2"><a href="sect084.html#cb853-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb853-3"><a href="sect084.html#cb853-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data2)</span>
<span id="cb853-4"><a href="sect084.html#cb853-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rsqs</span>(<span class="at">loglike.full =</span> <span class="fu">logLik</span>(modele),</span>
<span id="cb853-5"><a href="sect084.html#cb853-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">loglike.null =</span> <span class="fu">logLik</span>(modelnull),</span>
<span id="cb853-6"><a href="sect084.html#cb853-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">full.deviance =</span> <span class="fu">deviance</span>(modele),</span>
<span id="cb853-7"><a href="sect084.html#cb853-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">null.deviance =</span> <span class="fu">deviance</span>(modelnull),</span>
<span id="cb853-8"><a href="sect084.html#cb853-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">nb.params =</span> modele<span class="sc">$</span>rank,</span>
<span id="cb853-9"><a href="sect084.html#cb853-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">n =</span> <span class="fu">nrow</span>(data2))</span></code></pre></div>
<pre><code>## $`deviance expliquee`
## [1] 0.4805998
## 
## $`McFadden ajuste`
## &#39;log Lik.&#39; 0.3258375 (df=13)
## 
## $`Cox and Snell`
## &#39;log Lik.&#39; 0.7789704 (df=13)
## 
## $Nagelkerke
## &#39;log Lik.&#39; 0.787958 (df=13)</code></pre>
<p>Le modèle parvient ainsi à expliquer 48 % de la déviance totale. Il obtient un R<sup>2</sup> ajusté de McFadden de 0,33 et un R<sup>2</sup> de Cox et Snell de 0,78.</p>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="sect084.html#cb855-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du RMSE</span></span>
<span id="cb855-2"><a href="sect084.html#cb855-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">predict</span>(modele2, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="sc">-</span> data2<span class="sc">$</span>Nbr_acci)<span class="sc">**</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1.838026</code></pre>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="sect084.html#cb857-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre moyen d&#39;accidents</span></span>
<span id="cb857-2"><a href="sect084.html#cb857-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data2<span class="sc">$</span>Nbr_acci)</span></code></pre></div>
<pre><code>## [1] 1.503984</code></pre>
<p>L’erreur quadratique moyenne du modèle est de 1,84, ce que signifie qu’en moyenne le modèle se trompe d’environ deux accidents pour chaque intersection. Cette valeur est relativement élevée si nous la comparons avec le nombre moyen d’accidents, soit 1,5. Cela s’explique certainement par le grand nombre de zéros dans la variable <em>Y</em> qui tendent à tirer les prédictions vers le bas.</p>
<p><strong>Interprétation des résultats</strong></p>
<p>L’ensemble des coefficients du modèle sont accessibles via la fonction <code>summary</code>. Puisque la fonction de lien du modèle est la fonction <code>log</code>, il est pertinent de convertir les coefficients avec la fonction <code>exp</code> afin de pouvoir les interpréter sur l’échelle originale (<code>nombre d'accidents</code>) plutôt que l’échelle logarithmique (<code>log(nombre d'accidents)</code>). N’oubliez pas que ces effets sont multiplicatifs une fois transformés avec la fonction <code>exp</code>. Nous pouvons également utiliser les erreurs standards pour calculer des intervalles de confiance à 95 % des exponentiels des coefficients. Le tableau <a href="sect084.html#tab:coeffpoiss">8.22</a> présente l’ensemble des informations pertinentes pour l’interprétation des résultats.</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="sect084.html#cb859-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des coefficients en exponentiel et des intervalles de confiance</span></span>
<span id="cb859-2"><a href="sect084.html#cb859-2" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> <span class="fu">summary</span>(modele2)<span class="sc">$</span>coefficients</span>
<span id="cb859-3"><a href="sect084.html#cb859-3" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> tableau[,<span class="dv">1</span>]</span>
<span id="cb859-4"><a href="sect084.html#cb859-4" aria-hidden="true" tabindex="-1"></a>err.std <span class="ot">&lt;-</span> tableau[,<span class="dv">2</span>]</span>
<span id="cb859-5"><a href="sect084.html#cb859-5" aria-hidden="true" tabindex="-1"></a>expcoeff <span class="ot">&lt;-</span> <span class="fu">exp</span>(coeffs)</span>
<span id="cb859-6"><a href="sect084.html#cb859-6" aria-hidden="true" tabindex="-1"></a>exp2<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(coeffs <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>err.std)</span>
<span id="cb859-7"><a href="sect084.html#cb859-7" aria-hidden="true" tabindex="-1"></a>exp975 <span class="ot">&lt;-</span> <span class="fu">exp</span>(coeffs <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>err.std)</span>
<span id="cb859-8"><a href="sect084.html#cb859-8" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> tableau[,<span class="dv">4</span>]</span>
<span id="cb859-9"><a href="sect084.html#cb859-9" aria-hidden="true" tabindex="-1"></a>tableauComplet <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coeffs,err.std,expcoeff,exp2<span class="fl">.5</span>,exp975,pvals)</span>
<span id="cb859-10"><a href="sect084.html#cb859-10" aria-hidden="true" tabindex="-1"></a><span class="co"># print(tableauComplet)</span></span></code></pre></div>
<table>
<caption>
<span id="tab:coeffpoiss">Tableau 8.22: </span>Résultats du modèle de quasi-Poisson
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coeff.
</th>
<th style="text-align:right;">
exp(Coeff.)
</th>
<th style="text-align:right;">
Val.p
</th>
<th style="text-align:right;">
IC 2,5 % exp(Coeff.)
</th>
<th style="text-align:right;">
IC 97,5 % exp(Coeff.)
</th>
<th style="text-align:right;">
Sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Constante
</td>
<td style="text-align:right;">
-3,680
</td>
<td style="text-align:right;">
0,030
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,010
</td>
<td style="text-align:right;">
0,090
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Feux_auto
</td>
<td style="text-align:right;">
1,100
</td>
<td style="text-align:right;">
3,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,970
</td>
<td style="text-align:right;">
4,660
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Feux_piet
</td>
<td style="text-align:right;">
0,330
</td>
<td style="text-align:right;">
1,390
</td>
<td style="text-align:right;">
0,009
</td>
<td style="text-align:right;">
1,090
</td>
<td style="text-align:right;">
1,790
</td>
<td style="text-align:right;">
**
</td>
</tr>
<tr>
<td style="text-align:left;">
Pass_piet
</td>
<td style="text-align:right;">
0,340
</td>
<td style="text-align:right;">
1,400
</td>
<td style="text-align:right;">
0,149
</td>
<td style="text-align:right;">
0,880
</td>
<td style="text-align:right;">
2,200
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Terreplein
</td>
<td style="text-align:right;">
-0,360
</td>
<td style="text-align:right;">
0,700
</td>
<td style="text-align:right;">
0,099
</td>
<td style="text-align:right;">
0,440
</td>
<td style="text-align:right;">
1,050
</td>
<td style="text-align:right;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
Apaisement
</td>
<td style="text-align:right;">
0,290
</td>
<td style="text-align:right;">
1,330
</td>
<td style="text-align:right;">
0,157
</td>
<td style="text-align:right;">
0,880
</td>
<td style="text-align:right;">
1,950
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
LogEmploi
</td>
<td style="text-align:right;">
0,230
</td>
<td style="text-align:right;">
1,260
</td>
<td style="text-align:right;">
0,017
</td>
<td style="text-align:right;">
1,040
</td>
<td style="text-align:right;">
1,520
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
Densite_pop
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Entropie
</td>
<td style="text-align:right;">
-0,420
</td>
<td style="text-align:right;">
0,660
</td>
<td style="text-align:right;">
0,271
</td>
<td style="text-align:right;">
0,320
</td>
<td style="text-align:right;">
1,390
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
DensiteInter
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
0,410
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
1,010
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Long_arterePS
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
0,684
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Artere
</td>
<td style="text-align:right;">
0,030
</td>
<td style="text-align:right;">
1,030
</td>
<td style="text-align:right;">
0,842
</td>
<td style="text-align:right;">
0,780
</td>
<td style="text-align:right;">
1,360
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
NB_voies5
</td>
<td style="text-align:right;">
0,640
</td>
<td style="text-align:right;">
1,890
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,460
</td>
<td style="text-align:right;">
2,440
</td>
<td style="text-align:right;">
***
</td>
</tr>
</tbody>
</table></li>
</ul>
<p>Parmi les variables décrivant les aménagements de l’intersection, nous constatons que les présences d’un feu de circulation et d’un feu de traversée pour les piétons multiplient le nombre attendu d’accidents à une intersection par 3,0 et 1,39. Par contre, les présences d’un passage piéton, d’un terre-plein ou de mesures d’apaisement n’ont pas d’effets significatifs (valeurs de <em>p</em> &gt; 0,05).
Concernant les variables décrivant l’environnement à proximité des intersections, nous observons que la concentration d’emplois et la densité de population contribuent toutes les deux à augmenter le nombre d’accidents à une intersection, bien que leurs effets soient limités. Enfin, la présence d’une rue à cinq voies à l’intersection augmente le nombre d’accidents attendu à l’intersection de 89 %. Nous ne détaillons pas plus les résultats, car nous utilisons le même jeu de données dans les prochaines sections.</p>
</div>
</div>
<div id="sect0842" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Modèle binomial négatif<a href="sect084.html#sect0842" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans le cas où une variable de comptage est marquée par une sur ou sous-dispersion, la distribution de Poisson n’est pas en mesure de capturer efficacement sa variance. Pour contourner ce problème, il est possible d’utiliser la distribution binomiale négative plutôt que la distribution de Poisson (ou quasi-Poisson). Cette distribution peut être décrite comme une généralisation de la distribution de Poisson : elle inclut un second paramètre <span class="math inline">\(\theta\)</span> contrôlant la dispersion. L’intérêt premier de ce changement de distribution est que l’interprétation des paramètres est la même pour les deux modèles, tout en contrôlant directement l’effet d’une potentielle sur ou sous-dispersion.</p>
<table>
<caption>
<span id="tab:nbdentity">Tableau 8.23: </span>Carte d’identité du modèle binomial négatif
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable de comptage
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Négative binomiale
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim NB(\mu,\theta)\)</span> <br/> <span class="math inline">\(g(\mu) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(g(x) =log(x)\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
log
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
<span class="math inline">\(\mu\)</span>
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span> et <span class="math inline">\(\theta\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Absence d’excès de zéros, respect du lien variance-moyenne
</td>
</tr>
</tbody>
</table>
<div id="conditions-dapplication-3" class="section level4 hasAnchor" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> Conditions d’application<a href="sect084.html#conditions-dapplication-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Les conditions d’application d’un modèle binomial négatif sont presque les mêmes que celles d’un modèle de Poisson. La seule différence est que la condition d’absence de sur ou sous-dispersion est remplacée par une condition de respect du lien espérance-variance. En effet, dans un modèle binomial négatif, le paramètre de dispersion <span class="math inline">\(\theta\)</span> est combiné avec <span class="math inline">\(\mu\)</span> (l’espérance) pour exprimer la dispersion de la distribution. Dans le <em>package</em> <code>mgcv</code> que nous utilisons dans l’exemple, le lien entre <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\theta\)</span> et la variance est le suivant :</p>
<p><span class="math display" id="eq:glm17">\[\begin{equation}
variance = \mu + \mu^{\frac{2}{\theta}}
\tag{8.20}
\end{equation}\]</span>
</p>
<p>Il s’agit donc d’un <strong>modèle hétéroscédastique</strong> : sa variance n’est pas fixe, mais varie en fonction de sa propre espérance. Si celle-ci augmente, la variance augmente (comme pour un modèle de Poisson), et l’intensité de cette augmentation est contrôlée par le paramètre <span class="math inline">\(\theta\)</span>. Si cette condition n’est pas respectée, l’analyse des résidus simulés révélera un problème de dispersion.</p>
</div>
<div id="exemple-appliqué-dans-r-3" class="section level4 hasAnchor" number="8.3.2.2">
<h4><span class="header-section-number">8.3.2.2</span> Exemple appliqué dans R<a href="sect084.html#exemple-appliqué-dans-r-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dans l’exemple précédent avec le modèle de Poisson, nous avons observé une certaine sur-dispersion que nous avons contournée en utilisant un modèle de quasi-Poisson. Dans l’article original, les auteurs ont opté pour un modèle binomial négatif, ce que nous reproduisons ici. Les variables utilisées sont les mêmes que pour le modèle de Poisson. Nous utilisons le <em>package</em> <code>mgcv</code> et sa fonction <code>gam</code> pour ajuster le modèle.</p>
<p><strong>Vérification des conditions d’application</strong></p>
<p>Nous avons vu précédemment que nos variables indépendantes ne sont pas marquées par une multicolinéarité forte. Il n’est pas nécessaire de recalculer les valeurs de VIF puisque nous utilisons les mêmes données. La première étape du diagnostic est donc de calculer les distances de Cook.</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="sect084.html#cb860-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv)</span>
<span id="cb860-2"><a href="sect084.html#cb860-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb860-3"><a href="sect084.html#cb860-3" aria-hidden="true" tabindex="-1"></a>data_accidents <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/glm/accident_pietons.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>)</span>
<span id="cb860-4"><a href="sect084.html#cb860-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement d&#39;une première version du modèle</span></span>
<span id="cb860-5"><a href="sect084.html#cb860-5" aria-hidden="true" tabindex="-1"></a>modelnb <span class="ot">&lt;-</span> <span class="fu">gam</span>(Nbr_acci <span class="sc">~</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Pass_piet <span class="sc">+</span> </span>
<span id="cb860-6"><a href="sect084.html#cb860-6" aria-hidden="true" tabindex="-1"></a>                 Terreplein <span class="sc">+</span> Apaisement <span class="sc">+</span></span>
<span id="cb860-7"><a href="sect084.html#cb860-7" aria-hidden="true" tabindex="-1"></a>                LogEmploi <span class="sc">+</span> Densite_pop <span class="sc">+</span> Entropie <span class="sc">+</span> DensiteInter <span class="sc">+</span></span>
<span id="cb860-8"><a href="sect084.html#cb860-8" aria-hidden="true" tabindex="-1"></a>                Long_arterePS <span class="sc">+</span> Artere <span class="sc">+</span> NB_voies5,</span>
<span id="cb860-9"><a href="sect084.html#cb860-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">nb</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb860-10"><a href="sect084.html#cb860-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data_accidents)</span>
<span id="cb860-11"><a href="sect084.html#cb860-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul et affichage des distances de Cook</span></span>
<span id="cb860-12"><a href="sect084.html#cb860-12" aria-hidden="true" tabindex="-1"></a>cooksd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelnb)</span>
<span id="cb860-13"><a href="sect084.html#cb860-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb860-14"><a href="sect084.html#cb860-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">cook =</span> cooksd,</span>
<span id="cb860-15"><a href="sect084.html#cb860-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">oid =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cooksd)</span>
<span id="cb860-16"><a href="sect084.html#cb860-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb860-17"><a href="sect084.html#cb860-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df)<span class="sc">+</span></span>
<span id="cb860-18"><a href="sect084.html#cb860-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> oid, <span class="at">y =</span> cook), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb860-19"><a href="sect084.html#cb860-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;distance de Cook&quot;</span>)<span class="sc">+</span></span>
<span id="cb860-20"><a href="sect084.html#cb860-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb860-21"><a href="sect084.html#cb860-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cookdistnb"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookdistnb-1.png" alt="Distances de Cook pour le modèle binomial négatif" width="65%" />
<p class="caption">
Figure 8.31: Distances de Cook pour le modèle binomial négatif
</p>
</div>
<p>Nous observons, dans la figure <a href="sect084.html#fig:cookdistnb">8.31</a>, que quatre observations se distinguent très nettement des autres.</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="sect084.html#cb861-1" aria-hidden="true" tabindex="-1"></a>cas_etrange <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_accidents, cooksd <span class="sc">&gt;</span> <span class="fl">0.03</span>)</span>
<span id="cb861-2"><a href="sect084.html#cb861-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cas_etrange)</span></code></pre></div>
<pre><code>##    Nbr_acci Feux_auto Feux_piet Pass_piet Terreplein Apaisement EmpTotBuffer Densite_pop  Entropie
## 1        19         1         1         1          1          0     7208.538    5980.923 0.8073926
## 5        12         1         0         1          0          0     8585.350    8655.430 0.7607852
## 26        7         0         0         1          0          0     1342.625    2751.012 0.0000000
## 34        6         0         0         1          0          0    12516.410    8950.942 0.4300549
##    DensiteInter Long_arterePS Artere NB_voies5 log_acci catego_acci catego_acci2 Arret VAG sum_app
## 1      42.41597       6955.00      1         1 2.995732           1            1     0   1       4
## 5      89.11495       6412.27      0         0 2.564949           1            1     0   1       4
## 26     73.35344       2849.66      0         0 2.079442           1            1     1   1       3
## 34     74.91879       8443.01      1         0 1.945910           1            1     1   0       3
##    LogEmploi AccOrdinal    PopHa
## 1   8.883021          2 5.980923
## 5   9.057813          2 8.655430
## 26  7.202382          2 2.751012
## 34  9.434796          2 8.950942</code></pre>
<p>Il s’agit à nouveau de quatre observations avec un grand nombre d’accidents. Nous décidons de les retirer du jeu de données pour ne pas fausser les résultats concernant l’ensemble des autres intersections. Dans une analyse plus détaillée, il serait judicieux de chercher à comprendre pourquoi ces quatre observations sont particulièrement accidentogènes.</p>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="sect084.html#cb863-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_accidents, cooksd <span class="sc">&lt;</span> <span class="fl">0.03</span>)</span>
<span id="cb863-2"><a href="sect084.html#cb863-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement d&#39;une première version du modèle</span></span>
<span id="cb863-3"><a href="sect084.html#cb863-3" aria-hidden="true" tabindex="-1"></a>modelnb <span class="ot">&lt;-</span> <span class="fu">gam</span>(Nbr_acci <span class="sc">~</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Pass_piet <span class="sc">+</span> </span>
<span id="cb863-4"><a href="sect084.html#cb863-4" aria-hidden="true" tabindex="-1"></a>                 Terreplein <span class="sc">+</span> Apaisement <span class="sc">+</span></span>
<span id="cb863-5"><a href="sect084.html#cb863-5" aria-hidden="true" tabindex="-1"></a>                LogEmploi <span class="sc">+</span> Densite_pop <span class="sc">+</span> Entropie <span class="sc">+</span> DensiteInter <span class="sc">+</span></span>
<span id="cb863-6"><a href="sect084.html#cb863-6" aria-hidden="true" tabindex="-1"></a>                Long_arterePS <span class="sc">+</span> Artere <span class="sc">+</span> NB_voies5,</span>
<span id="cb863-7"><a href="sect084.html#cb863-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">nb</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb863-8"><a href="sect084.html#cb863-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> data2)</span>
<span id="cb863-9"><a href="sect084.html#cb863-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul et affichage des distances de Cook</span></span>
<span id="cb863-10"><a href="sect084.html#cb863-10" aria-hidden="true" tabindex="-1"></a>cooksd <span class="ot">&lt;-</span> <span class="fu">cooks.distance</span>(modelnb)</span>
<span id="cb863-11"><a href="sect084.html#cb863-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb863-12"><a href="sect084.html#cb863-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cook =</span> cooksd,</span>
<span id="cb863-13"><a href="sect084.html#cb863-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">oid =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cooksd)</span>
<span id="cb863-14"><a href="sect084.html#cb863-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb863-15"><a href="sect084.html#cb863-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df)<span class="sc">+</span></span>
<span id="cb863-16"><a href="sect084.html#cb863-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> oid, <span class="at">y =</span> cook), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb863-17"><a href="sect084.html#cb863-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;distance de Cook&quot;</span>)<span class="sc">+</span></span>
<span id="cb863-18"><a href="sect084.html#cb863-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb863-19"><a href="sect084.html#cb863-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cookdistnb2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookdistnb2-1.png" alt="Distances de Cook pour le modèle binomial négatif (après avoir retiré quatre observations fortement influentes)" width="65%" />
<p class="caption">
Figure 8.32: Distances de Cook pour le modèle binomial négatif (après avoir retiré quatre observations fortement influentes)
</p>
</div>
<p>Après avoir retiré ces quatre observations, les distances de Cook (figure <a href="sect084.html#fig:cookdistnb2">8.32</a>) ne révèlent plus d’observations fortement influentes dans le modèle. La prochaine étape du diagnostic est donc d’analyser les résidus simulés.</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="sect084.html#cb864-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction de la valeur de theta</span></span>
<span id="cb864-2"><a href="sect084.html#cb864-2" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> modelnb<span class="sc">$</span>family<span class="sc">$</span><span class="fu">getTheta</span>(T)</span>
<span id="cb864-3"><a href="sect084.html#cb864-3" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb864-4"><a href="sect084.html#cb864-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des valeurs prédites par le modèle</span></span>
<span id="cb864-5"><a href="sect084.html#cb864-5" aria-hidden="true" tabindex="-1"></a>mus <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelnb, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb864-6"><a href="sect084.html#cb864-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des simulations</span></span>
<span id="cb864-7"><a href="sect084.html#cb864-7" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mus),<span class="cf">function</span>(i){</span>
<span id="cb864-8"><a href="sect084.html#cb864-8" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> mus[[i]]</span>
<span id="cb864-9"><a href="sect084.html#cb864-9" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">rnbinom</span>(<span class="at">n =</span> nsim, <span class="at">mu =</span> mu, <span class="at">size =</span> theta)</span>
<span id="cb864-10"><a href="sect084.html#cb864-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb864-11"><a href="sect084.html#cb864-11" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb864-12"><a href="sect084.html#cb864-12" aria-hidden="true" tabindex="-1"></a>mat_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, cols)</span>
<span id="cb864-13"><a href="sect084.html#cb864-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des résidus simulés</span></span>
<span id="cb864-14"><a href="sect084.html#cb864-14" aria-hidden="true" tabindex="-1"></a>sim_res <span class="ot">&lt;-</span> <span class="fu">createDHARMa</span>(<span class="at">simulatedResponse =</span> mat_sims, </span>
<span id="cb864-15"><a href="sect084.html#cb864-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">observedResponse =</span> data2<span class="sc">$</span>Nbr_acci,</span>
<span id="cb864-16"><a href="sect084.html#cb864-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fittedPredictedResponse =</span> mus,</span>
<span id="cb864-17"><a href="sect084.html#cb864-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">integerResponse =</span> T)</span>
<span id="cb864-18"><a href="sect084.html#cb864-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage du diagnostic</span></span>
<span id="cb864-19"><a href="sect084.html#cb864-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diagresnb"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/diagresnb-1.png" alt="Diagnostic général des résidus simulés pour le modèle binomial négatif" width="65%" />
<p class="caption">
Figure 8.33: Diagnostic général des résidus simulés pour le modèle binomial négatif
</p>
</div>
<p>La figure <a href="sect084.html#fig:diagresnb">8.33</a> présentant le diagnostic des résidus simulés, montre que ces derniers suivent bien une distribution uniforme et aucun problème de dispersion ni de valeurs aberrantes. La figure <a href="sect084.html#fig:compnbdistr2">8.34</a> permet de comparer la distribution originale de la variable <em>Y</em> et les simulations issues du modèle (intervalles de confiance représentés en bleu). Nous constatons que le modèle parvient bien à reproduire la distribution originale, et ce, même pour les valeurs les plus extrèmes de la distribution.</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="sect084.html#cb865-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des valeurs prédites par le modèle</span></span>
<span id="cb865-2"><a href="sect084.html#cb865-2" aria-hidden="true" tabindex="-1"></a>mus <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelnb, <span class="at">type=</span><span class="st">&quot;response&quot;</span>)</span>
<span id="cb865-3"><a href="sect084.html#cb865-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération de 1000 simulations pour chaque prédiction</span></span>
<span id="cb865-4"><a href="sect084.html#cb865-4" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> modelnb<span class="sc">$</span>family<span class="sc">$</span><span class="fu">getTheta</span>(T)</span>
<span id="cb865-5"><a href="sect084.html#cb865-5" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb865-6"><a href="sect084.html#cb865-6" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(mus),<span class="cf">function</span>(i){</span>
<span id="cb865-7"><a href="sect084.html#cb865-7" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> mus[[i]]</span>
<span id="cb865-8"><a href="sect084.html#cb865-8" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rnbinom</span>(<span class="at">n =</span> nsim, <span class="at">mu =</span> mu, <span class="at">size =</span> theta))</span>
<span id="cb865-9"><a href="sect084.html#cb865-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb865-10"><a href="sect084.html#cb865-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb865-11"><a href="sect084.html#cb865-11" aria-hidden="true" tabindex="-1"></a>mat_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, cols)</span>
<span id="cb865-12"><a href="sect084.html#cb865-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des données pour le graphique (valeurs réelles)</span></span>
<span id="cb865-13"><a href="sect084.html#cb865-13" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(data2<span class="sc">$</span>Nbr_acci))</span>
<span id="cb865-14"><a href="sect084.html#cb865-14" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;nb_accident&quot;</span>,<span class="st">&#39;frequence&#39;</span>)</span>
<span id="cb865-15"><a href="sect084.html#cb865-15" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>nb_accident <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(counts<span class="sc">$</span>nb_accident))</span>
<span id="cb865-16"><a href="sect084.html#cb865-16" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>prop <span class="ot">&lt;-</span> counts<span class="sc">$</span>frequence <span class="sc">/</span> <span class="fu">sum</span>(counts<span class="sc">$</span>frequence)</span>
<span id="cb865-17"><a href="sect084.html#cb865-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des données pour le graphique (valeurs simulées)</span></span>
<span id="cb865-18"><a href="sect084.html#cb865-18" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">count =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>)</span>
<span id="cb865-19"><a href="sect084.html#cb865-19" aria-hidden="true" tabindex="-1"></a>count_sims <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>nsim, <span class="cf">function</span>(i){</span>
<span id="cb865-20"><a href="sect084.html#cb865-20" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span> mat_sims[,i]</span>
<span id="cb865-21"><a href="sect084.html#cb865-21" aria-hidden="true" tabindex="-1"></a>  cnt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(sim))</span>
<span id="cb865-22"><a href="sect084.html#cb865-22" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(df1,cnt, <span class="at">by.x=</span><span class="st">&quot;count&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;sim&quot;</span>, <span class="at">all.x =</span> T, <span class="at">all.y=</span>F)</span>
<span id="cb865-23"><a href="sect084.html#cb865-23" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>Freq <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(df2<span class="sc">$</span>Freq),<span class="dv">0</span>,df2<span class="sc">$</span>Freq)</span>
<span id="cb865-24"><a href="sect084.html#cb865-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df2<span class="sc">$</span>Freq)</span>
<span id="cb865-25"><a href="sect084.html#cb865-25" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb865-26"><a href="sect084.html#cb865-26" aria-hidden="true" tabindex="-1"></a>count_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind,count_sims)</span>
<span id="cb865-27"><a href="sect084.html#cb865-27" aria-hidden="true" tabindex="-1"></a>df_sims <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb865-28"><a href="sect084.html#cb865-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">val =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb865-29"><a href="sect084.html#cb865-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">med =</span> <span class="fu">apply</span>(count_sims, <span class="at">MARGIN =</span> <span class="dv">1</span>, median),</span>
<span id="cb865-30"><a href="sect084.html#cb865-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">apply</span>(count_sims, <span class="at">MARGIN =</span> <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.025</span>),</span>
<span id="cb865-31"><a href="sect084.html#cb865-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">apply</span>(count_sims, <span class="at">MARGIN =</span> <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.975</span>)</span>
<span id="cb865-32"><a href="sect084.html#cb865-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb865-33"><a href="sect084.html#cb865-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage du graphique</span></span>
<span id="cb865-34"><a href="sect084.html#cb865-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb865-35"><a href="sect084.html#cb865-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>nb_accident, <span class="at">weight =</span> frequence), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">data =</span> counts)<span class="sc">+</span></span>
<span id="cb865-36"><a href="sect084.html#cb865-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> val, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper),</span>
<span id="cb865-37"><a href="sect084.html#cb865-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_sims, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">width =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb865-38"><a href="sect084.html#cb865-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> val, <span class="at">y =</span> med), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">1.3</span>, <span class="at">data =</span> df_sims)<span class="sc">+</span></span>
<span id="cb865-39"><a href="sect084.html#cb865-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb865-40"><a href="sect084.html#cb865-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb865-41"><a href="sect084.html#cb865-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb865-42"><a href="sect084.html#cb865-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;nombre d&#39;accidents&quot;</span>,</span>
<span id="cb865-43"><a href="sect084.html#cb865-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;nombre d&#39;occurrences&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:compnbdistr2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/compnbdistr2-1.png" alt="Comparaison de la distribution originale et des simulations pour le modèle binomial négatif" width="65%" />
<p class="caption">
Figure 8.34: Comparaison de la distribution originale et des simulations pour le modèle binomial négatif
</p>
</div>
<p>À titre de comparaison, nous pouvons à nouveau réaliser le graphique permettant de visualiser si la variance attendue par le modèle est proche de celle effectivement observée dans les données. Nous avons constaté avec ce graphique, lorsque nous ajustions un modèle de Poisson, que la variance des données était trop grande comparativement à celle attendue par le modèle (figure <a href="sect084.html#fig:surdisppoiss">8.26</a>).</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="sect084.html#cb866-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des prédictions du modèle</span></span>
<span id="cb866-2"><a href="sect084.html#cb866-2" aria-hidden="true" tabindex="-1"></a>mus <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelnb, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb866-3"><a href="sect084.html#cb866-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d&#39;un DataFrame pour contenir la prédiction et les vraies valeurs</span></span>
<span id="cb866-4"><a href="sect084.html#cb866-4" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb866-5"><a href="sect084.html#cb866-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mus =</span> mus,</span>
<span id="cb866-6"><a href="sect084.html#cb866-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">reals =</span> data2<span class="sc">$</span>Nbr_acci</span>
<span id="cb866-7"><a href="sect084.html#cb866-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb866-8"><a href="sect084.html#cb866-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de l&#39;intervalle de confiance à 95 % selon la distribution de Poisson</span></span>
<span id="cb866-9"><a href="sect084.html#cb866-9" aria-hidden="true" tabindex="-1"></a><span class="co"># et stockage dans un second DataFrame</span></span>
<span id="cb866-10"><a href="sect084.html#cb866-10" aria-hidden="true" tabindex="-1"></a>seqa <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">round</span>(<span class="fu">max</span>(mus)),<span class="dv">1</span>)</span>
<span id="cb866-11"><a href="sect084.html#cb866-11" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb866-12"><a href="sect084.html#cb866-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">mus =</span> seqa,</span>
<span id="cb866-13"><a href="sect084.html#cb866-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">qnbinom</span>(<span class="at">p =</span> <span class="fl">0.025</span>, <span class="at">mu =</span> seqa, <span class="at">size =</span> theta),</span>
<span id="cb866-14"><a href="sect084.html#cb866-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">qnbinom</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mu =</span> seqa, <span class="at">size =</span> theta)</span>
<span id="cb866-15"><a href="sect084.html#cb866-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb866-16"><a href="sect084.html#cb866-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des valeurs réelles et prédites (en rouge)</span></span>
<span id="cb866-17"><a href="sect084.html#cb866-17" aria-hidden="true" tabindex="-1"></a><span class="co"># et de leur variance selon le modèle (en noir)</span></span>
<span id="cb866-18"><a href="sect084.html#cb866-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb866-19"><a href="sect084.html#cb866-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> df2,</span>
<span id="cb866-20"><a href="sect084.html#cb866-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mus, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper),</span>
<span id="cb866-21"><a href="sect084.html#cb866-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>)) <span class="sc">+</span> </span>
<span id="cb866-22"><a href="sect084.html#cb866-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df1, </span>
<span id="cb866-23"><a href="sect084.html#cb866-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> mus, <span class="at">y =</span> reals),</span>
<span id="cb866-24"><a href="sect084.html#cb866-24" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span><span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb866-25"><a href="sect084.html#cb866-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;valeurs prédites&#39;</span>,</span>
<span id="cb866-26"><a href="sect084.html#cb866-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;valeurs réelles&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:surdispnb"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/surdispnb-1.png" alt="Représentation de la sur-dispersion des données dans le modèle de Poisson" width="65%" />
<p class="caption">
Figure 8.35: Représentation de la sur-dispersion des données dans le modèle de Poisson
</p>
</div>
<p>Nous pouvons ainsi constater à la figure <a href="sect084.html#fig:surdispnb">8.35</a> que le modèle binomial négatif autorise une variance bien plus large que le modèle de Poisson et est ainsi mieux ajusté aux données.</p>
<p><strong>Vérification de la qualité d’ajustement</strong></p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="sect084.html#cb867-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des pseudo R2</span></span>
<span id="cb867-2"><a href="sect084.html#cb867-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rsqs</span>(<span class="at">loglike.full =</span> <span class="fu">logLik</span>(modelnb),</span>
<span id="cb867-3"><a href="sect084.html#cb867-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">loglike.null =</span> <span class="fu">logLik</span>(modelnull),</span>
<span id="cb867-4"><a href="sect084.html#cb867-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">full.deviance =</span> <span class="fu">deviance</span>(modelnb),</span>
<span id="cb867-5"><a href="sect084.html#cb867-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">null.deviance =</span> modelnb<span class="sc">$</span>null.deviance,</span>
<span id="cb867-6"><a href="sect084.html#cb867-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">nb.params =</span> modelnb<span class="sc">$</span>rank,</span>
<span id="cb867-7"><a href="sect084.html#cb867-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">n =</span> <span class="fu">nrow</span>(data2))</span></code></pre></div>
<pre><code>## $`deviance expliquee`
## [1] 0.458052
## 
## $`McFadden ajuste`
## &#39;log Lik.&#39; 0.384353 (df=14)
## 
## $`Cox and Snell`
## &#39;log Lik.&#39; 0.8304773 (df=14)
## 
## $Nagelkerke
## &#39;log Lik.&#39; 0.8399731 (df=14)</code></pre>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="sect084.html#cb869-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du RMSE</span></span>
<span id="cb869-2"><a href="sect084.html#cb869-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((<span class="fu">predict</span>(modelnb, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>) <span class="sc">-</span> data2<span class="sc">$</span>Nbr_acci)<span class="sc">**</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 1.825278</code></pre>
<p>Le modèle parvient à expliquer 45 % de la déviance. Il obtient un R<sup>2</sup> ajusté de McFadden de 0,14 et un R<sup>2</sup> de Nagelkerke de 0,42. L’erreur moyenne quadratique de la prédiction est de 1,82, ce qui est identique au modèle de Poisson ajusté précédemment.</p>
<p><strong>Interprétation des résultats</strong></p>
<p>Il est possible d’accéder à l’ensemble des coefficients du modèle via la fonction <code>summary</code>. À nouveau, les coefficients doivent être convertis avec la fonction exponentielle (du fait de la fonction de lien <em>log</em>) et interprétés comme des effets multiplicatifs. Le tableau <a href="sect084.html#tab:coeffsnb">8.24</a> présente les coefficients estimés par le modèle. Les résultats sont très similaires à ceux du modèle de quasi-Poisson original. Nous notons cependant que la variable représentant la présence d’un feu pour piéton n’est plus significative au seuil de 0,05.</p>
<table>
<caption>
<span id="tab:coeffsnb">Tableau 8.24: </span>Résultats du modèle binomial négatif
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coeff.
</th>
<th style="text-align:right;">
exp(Coeff.)
</th>
<th style="text-align:right;">
Val.p
</th>
<th style="text-align:right;">
IC 2,5 % exp(Coeff.)
</th>
<th style="text-align:right;">
IC 97,5 % exp(Coeff.)
</th>
<th style="text-align:right;">
Sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Constante
</td>
<td style="text-align:right;">
-3,880
</td>
<td style="text-align:right;">
0,020
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,010
</td>
<td style="text-align:right;">
0,080
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Feux_auto
</td>
<td style="text-align:right;">
1,130
</td>
<td style="text-align:right;">
3,100
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
2,030
</td>
<td style="text-align:right;">
4,710
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Feux_piet
</td>
<td style="text-align:right;">
0,350
</td>
<td style="text-align:right;">
1,420
</td>
<td style="text-align:right;">
0,016
</td>
<td style="text-align:right;">
1,060
</td>
<td style="text-align:right;">
1,900
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
Pass_piet
</td>
<td style="text-align:right;">
0,220
</td>
<td style="text-align:right;">
1,240
</td>
<td style="text-align:right;">
0,300
</td>
<td style="text-align:right;">
0,830
</td>
<td style="text-align:right;">
1,880
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Terreplein
</td>
<td style="text-align:right;">
-0,340
</td>
<td style="text-align:right;">
0,710
</td>
<td style="text-align:right;">
0,155
</td>
<td style="text-align:right;">
0,440
</td>
<td style="text-align:right;">
1,140
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Apaisement
</td>
<td style="text-align:right;">
0,240
</td>
<td style="text-align:right;">
1,270
</td>
<td style="text-align:right;">
0,315
</td>
<td style="text-align:right;">
0,790
</td>
<td style="text-align:right;">
2,030
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
LogEmploi
</td>
<td style="text-align:right;">
0,230
</td>
<td style="text-align:right;">
1,260
</td>
<td style="text-align:right;">
0,025
</td>
<td style="text-align:right;">
1,030
</td>
<td style="text-align:right;">
1,550
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
Densite_pop
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Entropie
</td>
<td style="text-align:right;">
-0,170
</td>
<td style="text-align:right;">
0,840
</td>
<td style="text-align:right;">
0,669
</td>
<td style="text-align:right;">
0,380
</td>
<td style="text-align:right;">
1,860
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
DensiteInter
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
0,925
</td>
<td style="text-align:right;">
0,990
</td>
<td style="text-align:right;">
1,010
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Long_arterePS
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
0,587
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Artere
</td>
<td style="text-align:right;">
0,110
</td>
<td style="text-align:right;">
1,110
</td>
<td style="text-align:right;">
0,497
</td>
<td style="text-align:right;">
0,820
</td>
<td style="text-align:right;">
1,510
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
NB_voies5
</td>
<td style="text-align:right;">
0,700
</td>
<td style="text-align:right;">
2,010
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,480
</td>
<td style="text-align:right;">
2,750
</td>
<td style="text-align:right;">
***
</td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul>
</div>
</div>
<div id="sect0843" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Modèle de Poisson avec excès fixe de zéros<a href="sect084.html#sect0843" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans le cas où la variable <em>Y</em> comprendrait significativement plus de zéros que ce que suppose une distribution de Poisson, il est possible d’utiliser la distribution de Poisson avec excès de zéros. Pour rappel, cette distribution ajoute un paramètre <em>p</em> contrôlant pour la proportion de zéros dans la distribution. Du point de vue conceptuel, cela revient à formuler l’hypothèse suivante : dans les données que nous avons observées, deux processus distincts sont à l’œuvre. Le premier est issu d’une distribution de Poisson et l’autre produit des zéros qui s’ajoutent aux données. Les zéros produits par la distribution de Poisson sont appelés les <strong>vrais zéros</strong>, alors que ceux produits par le second phénomène sont appelés les <strong>faux zéros</strong>.</p>
<table>
<caption>
<span id="tab:poisszidentity">Tableau 8.25: </span>Carte d’identité du modèle de Poisson avec excès fixe de zéros
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable de comptage
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Poisson avec excès de zéros
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim ZIP(\mu,\theta)\)</span> <br/> <span class="math inline">\(g(\lambda) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(g(x) =log(x)\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
log
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
<span class="math inline">\(\lambda\)</span>
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span> et <em>p</em>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Absence de sur-dispersion
</td>
</tr>
</tbody>
</table>
<p>Dans cette formulation, <em>p</em> est fixé. Nous n’avons donc aucune information sur ce qui produit les zéros supplémentaires, mais seulement leur proportion totale dans le jeu de données.</p>
<div id="interprétation-des-paramètres-2" class="section level4 hasAnchor" number="8.3.3.1">
<h4><span class="header-section-number">8.3.3.1</span> Interprétation des paramètres<a href="sect084.html#interprétation-des-paramètres-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>L’interprétation des paramètres est identique à celle d’un modèle de Poisson. Le paramètre <em>p</em> représente la proportion de faux zéros dans la variable <em>Y</em> une fois que les variables indépendantes sont contrôlées.</p>
</div>
<div id="exemple-appliqué-dans-r-4" class="section level4 hasAnchor" number="8.3.3.2">
<h4><span class="header-section-number">8.3.3.2</span> Exemple appliqué dans R<a href="sect084.html#exemple-appliqué-dans-r-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La variable de comptage des accidents des piétons que nous avons utilisée dans les deux exemples précédents semble être une bonne candidate pour une distribution de Poisson avec excès de zéros. En effet, nous avons pu constater une sur-dispersion dans le modèle de Poisson original, ainsi qu’un nombre important d’intersections sans accident. Tentons donc d’améliorer notre modèle en ajustant un excès fixe de zéros. Nous utilisons la fonction <code>gamlss</code> du <em>package</em> <code>gamlss</code>.</p>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="sect084.html#cb871-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span>
<span id="cb871-2"><a href="sect084.html#cb871-2" aria-hidden="true" tabindex="-1"></a>modelzi <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(<span class="at">formula =</span> Nbr_acci <span class="sc">~</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Pass_piet <span class="sc">+</span></span>
<span id="cb871-3"><a href="sect084.html#cb871-3" aria-hidden="true" tabindex="-1"></a>                    Terreplein <span class="sc">+</span> Apaisement <span class="sc">+</span> LogEmploi <span class="sc">+</span> Densite_pop <span class="sc">+</span> </span>
<span id="cb871-4"><a href="sect084.html#cb871-4" aria-hidden="true" tabindex="-1"></a>                    Entropie <span class="sc">+</span> DensiteInter <span class="sc">+</span> Long_arterePS <span class="sc">+</span> Artere <span class="sc">+</span> NB_voies5,</span>
<span id="cb871-5"><a href="sect084.html#cb871-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sigma.formula =</span> <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb871-6"><a href="sect084.html#cb871-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">ZIP</span>(<span class="at">mu.link =</span> <span class="st">&quot;log&quot;</span>, <span class="at">sigma.link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb871-7"><a href="sect084.html#cb871-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_accidents)</span></code></pre></div>
<pre><code>## GAMLSS-RS iteration 1: Global Deviance = 1516.53 
## GAMLSS-RS iteration 2: Global Deviance = 1514.656 
## GAMLSS-RS iteration 3: Global Deviance = 1514.52 
## GAMLSS-RS iteration 4: Global Deviance = 1514.508 
## GAMLSS-RS iteration 5: Global Deviance = 1514.506 
## GAMLSS-RS iteration 6: Global Deviance = 1514.506</code></pre>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="sect084.html#cb873-1" aria-hidden="true" tabindex="-1"></a>modelnull <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">formula =</span> Nbr_acci <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb873-2"><a href="sect084.html#cb873-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb873-3"><a href="sect084.html#cb873-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_accidents)</span>
<span id="cb873-4"><a href="sect084.html#cb873-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-5"><a href="sect084.html#cb873-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Constante pour p</span></span>
<span id="cb873-6"><a href="sect084.html#cb873-6" aria-hidden="true" tabindex="-1"></a>coeff_p <span class="ot">&lt;-</span> modelzi<span class="sc">$</span>sigma.coefficients</span>
<span id="cb873-7"><a href="sect084.html#cb873-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Coefficient pour p =&quot;</span>, <span class="fu">round</span>(coeff_p,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>## Coefficient pour p = -1.4376</code></pre>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="sect084.html#cb875-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la déviance expliquée</span></span>
<span id="cb875-2"><a href="sect084.html#cb875-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">deviance</span>(modelzi) <span class="sc">/</span> <span class="fu">deviance</span>(modelnull)</span></code></pre></div>
<pre><code>## [1] 0.08267513</code></pre>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="sect084.html#cb877-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la probabilité de base p d&#39;être un faux 0</span></span>
<span id="cb877-2"><a href="sect084.html#cb877-2" aria-hidden="true" tabindex="-1"></a><span class="co"># en appliquant l&#39;inverse de la fonction logistique</span></span>
<span id="cb877-3"><a href="sect084.html#cb877-3" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span>coeff_p) <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>coeff_p))</span></code></pre></div>
<pre><code>## (Intercept) 
##     0.80809</code></pre>
<p>Nous constatons immédiatement que le modèle avec excès fixe de zéros est peu ajusté aux données. Cette version du modèle ne parvient à capter que 8 % de la déviance, ce qui s’explique facilement, car nous n’avons donné aucune variable au modèle pour distinguer les vrais et les faux zéros. Pour cela, nous devons passer au prochain modèle : Poisson avec excès ajusté de zéros. Notons tout de même que d’après ce modèle, 81 % des observations seraient des faux zéros.</p>
</div>
</div>
<div id="sect0844" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Modèle de Poisson avec excès ajusté de zéros<a href="sect084.html#sect0844" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nous avons vu dans le modèle précédent, que l’excès de zéro était conceptualisé comme la combinaison de deux phénomènes, l’un issu d’une distribution de Poisson que nous souhaitons modéliser, et l’autre générant des zéros supplémentaires. Il est possible d’aller plus loin que de simplement contrôler la proportion de zéros supplémentaires en modélisant explicitement ce second processus en ajoutant une deuxième équation au modèle. Cette deuxième équation a pour enjeu de modéliser <em>p</em> (la proportion de 0) à l’aide de variables indépendantes, ces dernières pouvant se retrouver dans les deux parties du modèle. L’idée étant que, pour chaque observation, le modèle évalue sa probabilité d’être un faux zéro (partie binomiale), et le nombre attendu d’accidents.</p>
<table>
<caption>
<span id="tab:poisszadentity">Tableau 8.26: </span>Carte d’identité du modèle de Poisson avec excès ajusté de zéros
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable de comptage
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Poisson avec excès de zéros
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim ZIP(\mu,\theta)\)</span> <br/> <span class="math inline">\(g(\mu) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(s(p) = \alpha_0 + \alpha_X\)</span> <br/> <span class="math inline">\(g(x) =log(x)\)</span> <br/> <span class="math inline">\(s(x) = log(\frac{x}{1-x})\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
log et logistique
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
<span class="math inline">\(\mu\)</span> et <em>p</em>
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\alpha_0\)</span> et <span class="math inline">\(\alpha\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Absence de sur-dispersion
</td>
</tr>
</tbody>
</table>
<div id="interprétation-des-paramètres-3" class="section level4 hasAnchor" number="8.3.4.1">
<h4><span class="header-section-number">8.3.4.1</span> Interprétation des paramètres<a href="sect084.html#interprétation-des-paramètres-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>L’interprétation des paramètres <span class="math inline">\(\beta_0\)</span> et <span class="math inline">\(\beta\)</span> est identique à celle d’un modèle de Poisson. Les paramètres <span class="math inline">\(\alpha_0\)</span> et <span class="math inline">\(\alpha\)</span> sont identiques à ceux d’un modèle binomial. Plus spécifiquement, ces derniers paramètres modélisent la probabilité d’observer des valeurs supérieures à zéro.</p>
</div>
<div id="exemple-appliqué" class="section level4 hasAnchor" number="8.3.4.2">
<h4><span class="header-section-number">8.3.4.2</span> Exemple appliqué<a href="sect084.html#exemple-appliqué" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous avons vu, dans l’exemple précédent, que l’utilisation du modèle avec excès fixe de zéros pour les données d’accident des piétons aux intersections ne donnait pas de résultats satisfaisants. Nous tentons ici d’améliorer le modèle en ajoutant les variables indépendantes significatives du modèle Poisson dans la seconde équation de régression destinée à détecter les faux zéros.</p>
<p><strong>Vérification des conditions d’application</strong></p>
<p>Pour un modèle de Poisson avec excès de zéros, il n’est pas possible de calculer les distances de Cook. Nous devons donc directement passer à l’analyse des résidus simulés.</p>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="sect084.html#cb879-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster une première version du modèle</span></span>
<span id="cb879-2"><a href="sect084.html#cb879-2" aria-hidden="true" tabindex="-1"></a>modelza <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(<span class="at">formula =</span> Nbr_acci <span class="sc">~</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Pass_piet <span class="sc">+</span></span>
<span id="cb879-3"><a href="sect084.html#cb879-3" aria-hidden="true" tabindex="-1"></a>                    Terreplein <span class="sc">+</span> Apaisement <span class="sc">+</span> LogEmploi <span class="sc">+</span> Densite_pop <span class="sc">+</span> </span>
<span id="cb879-4"><a href="sect084.html#cb879-4" aria-hidden="true" tabindex="-1"></a>                    Entropie <span class="sc">+</span> DensiteInter <span class="sc">+</span> Long_arterePS <span class="sc">+</span> Artere <span class="sc">+</span> NB_voies5,</span>
<span id="cb879-5"><a href="sect084.html#cb879-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sigma.formula =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">+</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Densite_pop <span class="sc">+</span> NB_voies5,</span>
<span id="cb879-6"><a href="sect084.html#cb879-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">ZIP</span>(<span class="at">mu.link =</span> <span class="st">&quot;log&quot;</span>, <span class="at">sigma.link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb879-7"><a href="sect084.html#cb879-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_accidents)</span></code></pre></div>
<pre><code>## GAMLSS-RS iteration 1: Global Deviance = 1505.155 
## GAMLSS-RS iteration 2: Global Deviance = 1488.658 
## GAMLSS-RS iteration 3: Global Deviance = 1483.304 
## GAMLSS-RS iteration 4: Global Deviance = 1482.085 
## GAMLSS-RS iteration 5: Global Deviance = 1481.868 
## GAMLSS-RS iteration 6: Global Deviance = 1481.832 
## GAMLSS-RS iteration 7: Global Deviance = 1481.827 
## GAMLSS-RS iteration 8: Global Deviance = 1481.825 
## GAMLSS-RS iteration 9: Global Deviance = 1481.825</code></pre>
<div class="sourceCode" id="cb881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb881-1"><a href="sect084.html#cb881-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire la prédiction des valeurs lambda</span></span>
<span id="cb881-2"><a href="sect084.html#cb881-2" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelza, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">what =</span> <span class="st">&quot;mu&quot;</span>)</span>
<span id="cb881-3"><a href="sect084.html#cb881-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire la prédiction des valeurs p</span></span>
<span id="cb881-4"><a href="sect084.html#cb881-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelza, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">what =</span> <span class="st">&quot;sigma&quot;</span>)</span>
<span id="cb881-5"><a href="sect084.html#cb881-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la combinaison de ces deux éléments</span></span>
<span id="cb881-6"><a href="sect084.html#cb881-6" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> lambdas <span class="sc">*</span> ps</span>
<span id="cb881-7"><a href="sect084.html#cb881-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Effectuer les 1000 simulations</span></span>
<span id="cb881-8"><a href="sect084.html#cb881-8" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb881-9"><a href="sect084.html#cb881-9" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambdas),<span class="cf">function</span>(i){</span>
<span id="cb881-10"><a href="sect084.html#cb881-10" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambdas[[i]]</span>
<span id="cb881-11"><a href="sect084.html#cb881-11" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> ps[[i]]</span>
<span id="cb881-12"><a href="sect084.html#cb881-12" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">rZIP</span>(<span class="at">n =</span> nsim, <span class="at">mu =</span> lambda, <span class="at">sigma =</span> p)</span>
<span id="cb881-13"><a href="sect084.html#cb881-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb881-14"><a href="sect084.html#cb881-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb881-15"><a href="sect084.html#cb881-15" aria-hidden="true" tabindex="-1"></a>mat_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, cols)</span>
<span id="cb881-16"><a href="sect084.html#cb881-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les résidus simulés</span></span>
<span id="cb881-17"><a href="sect084.html#cb881-17" aria-hidden="true" tabindex="-1"></a>sim_res <span class="ot">&lt;-</span> <span class="fu">createDHARMa</span>(<span class="at">simulatedResponse =</span> mat_sims, </span>
<span id="cb881-18"><a href="sect084.html#cb881-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">observedResponse =</span> data_accidents<span class="sc">$</span>Nbr_acci,</span>
<span id="cb881-19"><a href="sect084.html#cb881-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fittedPredictedResponse =</span> preds,</span>
<span id="cb881-20"><a href="sect084.html#cb881-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">integerResponse =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="sect084.html#cb882-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diagzip"></span>
<img src="images/glm/diagzip.png" alt="Diagnostic général des résidus simulés du modèle de Poisson avec excès de zéros ajusté" width="65%" />
<p class="caption">
Figure 8.36: Diagnostic général des résidus simulés du modèle de Poisson avec excès de zéros ajusté
</p>
</div>
<p>La figure <a href="sect084.html#fig:diagzip">8.36</a> indique deux problèmes importants dans le modèle : la présence de valeurs aberrantes ainsi qu’un potentiel problème de dispersion. Nous commençons donc par identifier ces valeurs aberrantes.</p>
<div class="sourceCode" id="cb883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb883-1"><a href="sect084.html#cb883-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Identification des outliers</span></span>
<span id="cb883-2"><a href="sect084.html#cb883-2" aria-hidden="true" tabindex="-1"></a>isOutlier <span class="ot">&lt;-</span> <span class="fu">outliers</span>(sim_res,<span class="at">return =</span> <span class="st">&quot;logical&quot;</span>,<span class="at">lowerQuantile =</span> <span class="fl">0.001</span>,</span>
<span id="cb883-3"><a href="sect084.html#cb883-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">upperQuantile =</span> <span class="fl">0.999</span>)</span>
<span id="cb883-4"><a href="sect084.html#cb883-4" aria-hidden="true" tabindex="-1"></a>cas_etrange <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_accidents, isOutlier)</span>
<span id="cb883-5"><a href="sect084.html#cb883-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cas_etrange)</span></code></pre></div>
<pre><code>##     Nbr_acci Feux_auto Feux_piet Pass_piet Terreplein Apaisement EmpTotBuffer Densite_pop  Entropie
## 1         19         1         1         1          1          0     7208.538    5980.923 0.8073926
## 5         12         1         0         1          0          0     8585.350    8655.430 0.7607852
## 26         7         0         0         1          0          0     1342.625    2751.012 0.0000000
## 44         5         0         0         0          0          0     4998.519    8090.478 0.7879618
## 482        0         0         0         0          0          0     1813.911    8988.260 0.4486079
##     DensiteInter Long_arterePS Artere NB_voies5 log_acci catego_acci catego_acci2 Arret VAG sum_app
## 1       42.41597       6955.00      1         1 2.995732           1            1     0   1       4
## 5       89.11495       6412.27      0         0 2.564949           1            1     0   1       4
## 26      73.35344       2849.66      0         0 2.079442           1            1     1   1       3
## 44      66.86856       4517.65      0         0 1.791759           1            1     1   1       4
## 482     60.93742       3821.78      1         0 0.000000           0            0     0   0       3
##     LogEmploi AccOrdinal    PopHa
## 1    8.883021          2 5.980923
## 5    9.057813          2 8.655430
## 26   7.202382          2 2.751012
## 44   8.516897          2 8.090478
## 482  7.503240          0 8.988260</code></pre>
<p>Nous retirons des données les quelques observations pouvant avoir une trop forte influence sur le modèle. Après réajustement, la figure <a href="sect084.html#fig:diagzip2">8.37</a> nous informe que nous n’avons plus de valeurs aberrantes restantes ni de fort problème de dispersion. En revanche, le premier quantile des résidus tant à être plus faible que ce que nous aurions pu nous attendre d’une distribution uniforme. Ce constat laisse penser que le modèle a du mal à bien identifier les faux zéros. Ce résultat n’est pas étonnant, car aucune variable n’avait été identifiée à cette fin dans l’article original <span class="citation">(<a href="#ref-cloutier2014carrefours" role="doc-biblioref">Cloutier et al. 2014</a>)</span> qui utilisait un modèle binomial négatif.</p>
<div class="sourceCode" id="cb885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb885-1"><a href="sect084.html#cb885-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_accidents, isOutlier<span class="sc">==</span><span class="cn">FALSE</span>)</span>
<span id="cb885-2"><a href="sect084.html#cb885-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster une première version du modèle</span></span>
<span id="cb885-3"><a href="sect084.html#cb885-3" aria-hidden="true" tabindex="-1"></a>modelza <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(<span class="at">formula =</span> Nbr_acci <span class="sc">~</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Pass_piet <span class="sc">+</span></span>
<span id="cb885-4"><a href="sect084.html#cb885-4" aria-hidden="true" tabindex="-1"></a>                    Terreplein <span class="sc">+</span> Apaisement <span class="sc">+</span> LogEmploi <span class="sc">+</span> Densite_pop <span class="sc">+</span> </span>
<span id="cb885-5"><a href="sect084.html#cb885-5" aria-hidden="true" tabindex="-1"></a>                    Entropie <span class="sc">+</span> DensiteInter <span class="sc">+</span> Long_arterePS <span class="sc">+</span> Artere <span class="sc">+</span> NB_voies5,</span>
<span id="cb885-6"><a href="sect084.html#cb885-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sigma.formula =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">+</span> Feux_auto <span class="sc">+</span> Feux_piet <span class="sc">+</span> Densite_pop <span class="sc">+</span> NB_voies5,</span>
<span id="cb885-7"><a href="sect084.html#cb885-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">ZIP</span>(<span class="at">mu.link =</span> <span class="st">&quot;log&quot;</span>, <span class="at">sigma.link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb885-8"><a href="sect084.html#cb885-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data2)</span></code></pre></div>
<pre><code>## GAMLSS-RS iteration 1: Global Deviance = 1390.884 
## GAMLSS-RS iteration 2: Global Deviance = 1381.199 
## GAMLSS-RS iteration 3: Global Deviance = 1378.319 
## GAMLSS-RS iteration 4: Global Deviance = 1377.422 
## GAMLSS-RS iteration 5: Global Deviance = 1377.118 
## GAMLSS-RS iteration 6: Global Deviance = 1377.015 
## GAMLSS-RS iteration 7: Global Deviance = 1376.982 
## GAMLSS-RS iteration 8: Global Deviance = 1376.972 
## GAMLSS-RS iteration 9: Global Deviance = 1376.968 
## GAMLSS-RS iteration 10: Global Deviance = 1376.967 
## GAMLSS-RS iteration 11: Global Deviance = 1376.966</code></pre>
<div class="sourceCode" id="cb887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb887-1"><a href="sect084.html#cb887-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire la prédiction des valeurs lambda</span></span>
<span id="cb887-2"><a href="sect084.html#cb887-2" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelza, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">what =</span> <span class="st">&quot;mu&quot;</span>)</span>
<span id="cb887-3"><a href="sect084.html#cb887-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire la prédiction des valeurs p</span></span>
<span id="cb887-4"><a href="sect084.html#cb887-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelza, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">what =</span> <span class="st">&quot;sigma&quot;</span>)</span>
<span id="cb887-5"><a href="sect084.html#cb887-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la combinaison de ces deux éléments</span></span>
<span id="cb887-6"><a href="sect084.html#cb887-6" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> lambdas <span class="sc">*</span> ps</span>
<span id="cb887-7"><a href="sect084.html#cb887-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Effectuer les 1000 simulations</span></span>
<span id="cb887-8"><a href="sect084.html#cb887-8" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb887-9"><a href="sect084.html#cb887-9" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambdas),<span class="cf">function</span>(i){</span>
<span id="cb887-10"><a href="sect084.html#cb887-10" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambdas[[i]]</span>
<span id="cb887-11"><a href="sect084.html#cb887-11" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> ps[[i]]</span>
<span id="cb887-12"><a href="sect084.html#cb887-12" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">rZIP</span>(<span class="at">n =</span> nsim, <span class="at">mu =</span> lambda, <span class="at">sigma =</span> p)</span>
<span id="cb887-13"><a href="sect084.html#cb887-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb887-14"><a href="sect084.html#cb887-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb887-15"><a href="sect084.html#cb887-15" aria-hidden="true" tabindex="-1"></a>mat_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, cols)</span>
<span id="cb887-16"><a href="sect084.html#cb887-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les résidus simulés</span></span>
<span id="cb887-17"><a href="sect084.html#cb887-17" aria-hidden="true" tabindex="-1"></a>sim_res <span class="ot">&lt;-</span> <span class="fu">createDHARMa</span>(<span class="at">simulatedResponse =</span> mat_sims, </span>
<span id="cb887-18"><a href="sect084.html#cb887-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">observedResponse =</span> data2<span class="sc">$</span>Nbr_acci,</span>
<span id="cb887-19"><a href="sect084.html#cb887-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fittedPredictedResponse =</span> preds,</span>
<span id="cb887-20"><a href="sect084.html#cb887-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">integerResponse =</span> T)</span>
<span id="cb887-21"><a href="sect084.html#cb887-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diagzip2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/diagzip2-1.png" alt="Diagnostic général des résidus simulés du modèle de Poisson avec excès de zéros ajusté (sans valeurs aberrantes)" width="65%" />
<p class="caption">
Figure 8.37: Diagnostic général des résidus simulés du modèle de Poisson avec excès de zéros ajusté (sans valeurs aberrantes)
</p>
</div>
<p>Nous pouvons une fois encore comparer des simulations issues du modèle et de la distribution originale de la variable <em>Y</em>. La figure <a href="sect084.html#fig:compzipdistr">8.38</a> montre clairement que les simulations du modèle (en bleu) sont très éloignées dans la distribution originale (en gris), ce qui remet directement en question la pertinence de ce modèle.</p>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="sect084.html#cb888-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire la prédiction des valeurs lambda</span></span>
<span id="cb888-2"><a href="sect084.html#cb888-2" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelza, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">what =</span> <span class="st">&quot;mu&quot;</span>)</span>
<span id="cb888-3"><a href="sect084.html#cb888-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire la prédiction des valeurs p</span></span>
<span id="cb888-4"><a href="sect084.html#cb888-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelza, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>, <span class="at">what =</span> <span class="st">&quot;sigma&quot;</span>)</span>
<span id="cb888-5"><a href="sect084.html#cb888-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Génération de 1000 simulations pour chaque prédiction</span></span>
<span id="cb888-6"><a href="sect084.html#cb888-6" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb888-7"><a href="sect084.html#cb888-7" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambdas),<span class="cf">function</span>(i){</span>
<span id="cb888-8"><a href="sect084.html#cb888-8" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambdas[[i]]</span>
<span id="cb888-9"><a href="sect084.html#cb888-9" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> ps[[<span class="dv">1</span>]]</span>
<span id="cb888-10"><a href="sect084.html#cb888-10" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">rZIP</span>(nsim,<span class="at">mu=</span>lambda, <span class="at">sigma =</span> p))</span>
<span id="cb888-11"><a href="sect084.html#cb888-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb888-12"><a href="sect084.html#cb888-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb888-13"><a href="sect084.html#cb888-13" aria-hidden="true" tabindex="-1"></a>mat_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, cols)</span>
<span id="cb888-14"><a href="sect084.html#cb888-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des données pour le graphique (valeurs réelles)</span></span>
<span id="cb888-15"><a href="sect084.html#cb888-15" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(data2<span class="sc">$</span>Nbr_acci))</span>
<span id="cb888-16"><a href="sect084.html#cb888-16" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;nb_accident&quot;</span>,<span class="st">&#39;frequence&#39;</span>)</span>
<span id="cb888-17"><a href="sect084.html#cb888-17" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>nb_accident <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(counts<span class="sc">$</span>nb_accident))</span>
<span id="cb888-18"><a href="sect084.html#cb888-18" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>prop <span class="ot">&lt;-</span> counts<span class="sc">$</span>frequence <span class="sc">/</span> <span class="fu">sum</span>(counts<span class="sc">$</span>frequence)</span>
<span id="cb888-19"><a href="sect084.html#cb888-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation des données pour le graphique (valeurs simulées)</span></span>
<span id="cb888-20"><a href="sect084.html#cb888-20" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">count =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>)</span>
<span id="cb888-21"><a href="sect084.html#cb888-21" aria-hidden="true" tabindex="-1"></a>count_sims <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>nsim, <span class="cf">function</span>(i){</span>
<span id="cb888-22"><a href="sect084.html#cb888-22" aria-hidden="true" tabindex="-1"></a>  sim <span class="ot">&lt;-</span> mat_sims[,i]</span>
<span id="cb888-23"><a href="sect084.html#cb888-23" aria-hidden="true" tabindex="-1"></a>  cnt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(sim))</span>
<span id="cb888-24"><a href="sect084.html#cb888-24" aria-hidden="true" tabindex="-1"></a>  df2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(df1,cnt, <span class="at">by.x=</span><span class="st">&quot;count&quot;</span>, <span class="at">by.y =</span> <span class="st">&quot;sim&quot;</span>, <span class="at">all.x =</span> T, <span class="at">all.y=</span>F)</span>
<span id="cb888-25"><a href="sect084.html#cb888-25" aria-hidden="true" tabindex="-1"></a>  df2<span class="sc">$</span>Freq <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(df2<span class="sc">$</span>Freq),<span class="dv">0</span>,df2<span class="sc">$</span>Freq)</span>
<span id="cb888-26"><a href="sect084.html#cb888-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df2<span class="sc">$</span>Freq)</span>
<span id="cb888-27"><a href="sect084.html#cb888-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb888-28"><a href="sect084.html#cb888-28" aria-hidden="true" tabindex="-1"></a>count_sims <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind,count_sims)</span>
<span id="cb888-29"><a href="sect084.html#cb888-29" aria-hidden="true" tabindex="-1"></a>df_sims <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb888-30"><a href="sect084.html#cb888-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">val =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb888-31"><a href="sect084.html#cb888-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">med =</span> <span class="fu">apply</span>(count_sims, <span class="at">MARGIN =</span> <span class="dv">1</span>, median),</span>
<span id="cb888-32"><a href="sect084.html#cb888-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">apply</span>(count_sims, <span class="at">MARGIN =</span> <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.025</span>),</span>
<span id="cb888-33"><a href="sect084.html#cb888-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">apply</span>(count_sims, <span class="at">MARGIN =</span> <span class="dv">1</span>, quantile, <span class="at">probs =</span> <span class="fl">0.975</span>)</span>
<span id="cb888-34"><a href="sect084.html#cb888-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb888-35"><a href="sect084.html#cb888-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage du graphique</span></span>
<span id="cb888-36"><a href="sect084.html#cb888-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb888-37"><a href="sect084.html#cb888-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>nb_accident, <span class="at">weight =</span> frequence), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">data =</span> counts)<span class="sc">+</span></span>
<span id="cb888-38"><a href="sect084.html#cb888-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">x =</span> val, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper),</span>
<span id="cb888-39"><a href="sect084.html#cb888-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> df_sims, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">width =</span> <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb888-40"><a href="sect084.html#cb888-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> val, <span class="at">y =</span> med), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">1.3</span>, <span class="at">data =</span> df_sims)<span class="sc">+</span></span>
<span id="cb888-41"><a href="sect084.html#cb888-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb888-42"><a href="sect084.html#cb888-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb888-43"><a href="sect084.html#cb888-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb888-44"><a href="sect084.html#cb888-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;nombre d&#39;accidents&quot;</span>,</span>
<span id="cb888-45"><a href="sect084.html#cb888-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;nombre d&#39;occurrences&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:compzipdistr"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/compzipdistr-1.png" alt="Comparaison de la distribution originale et des simulations pour le modèle de Poisson avec excès de zéros ajusté" width="65%" />
<p class="caption">
Figure 8.38: Comparaison de la distribution originale et des simulations pour le modèle de Poisson avec excès de zéros ajusté
</p>
</div>
<p><strong>Vérification la qualité d’ajustement</strong></p>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="sect084.html#cb889-1" aria-hidden="true" tabindex="-1"></a>modelenull <span class="ot">&lt;-</span> <span class="fu">glm</span>(Nbr_acci <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb889-2"><a href="sect084.html#cb889-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>),</span>
<span id="cb889-3"><a href="sect084.html#cb889-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data2)</span>
<span id="cb889-4"><a href="sect084.html#cb889-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des R2</span></span>
<span id="cb889-5"><a href="sect084.html#cb889-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rsqs</span>(<span class="at">loglike.full =</span> <span class="fu">logLik</span>(modelza),</span>
<span id="cb889-6"><a href="sect084.html#cb889-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">loglike.null =</span> <span class="fu">logLik</span>(modelenull),</span>
<span id="cb889-7"><a href="sect084.html#cb889-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">full.deviance =</span> <span class="fu">deviance</span>(modelza),</span>
<span id="cb889-8"><a href="sect084.html#cb889-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">null.deviance =</span> <span class="fu">deviance</span>(modelenull),</span>
<span id="cb889-9"><a href="sect084.html#cb889-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">nb.params =</span> modelza<span class="sc">$</span>sigma.df <span class="sc">+</span> modelza<span class="sc">$</span>mu.df,</span>
<span id="cb889-10"><a href="sect084.html#cb889-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">n =</span> <span class="fu">nrow</span>(data2)</span>
<span id="cb889-11"><a href="sect084.html#cb889-11" aria-hidden="true" tabindex="-1"></a>     )</span></code></pre></div>
<pre><code>## $`deviance expliquee`
## [1] 0.1073371
## 
## $`McFadden ajuste`
## &#39;log Lik.&#39; 0.3588483 (df=18)
## 
## $`Cox and Snell`
## &#39;log Lik.&#39; 0.8086509 (df=18)
## 
## $Nagelkerke
## &#39;log Lik.&#39; 0.8186255 (df=18)</code></pre>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="sect084.html#cb891-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du RMSE</span></span>
<span id="cb891-2"><a href="sect084.html#cb891-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">mean</span>((preds <span class="sc">-</span> data2<span class="sc">$</span>Nbr_acci)<span class="sc">**</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 2.635322</code></pre>
<p>Le modèle avec excès de zéro ajusté ne parvient à expliquer que 11 % de la déviance totale. Il obtient toutefois des valeurs de R<sup>2</sup> assez hautes (McFadden ajusté : 0,36, Nagerlkerke : 0,82). Son RMSE est très élevé (2,6), comparativement à celui que nous avons obtenu avec le modèle binomial négatif (1,9). Considérant ces éléments, ce modèle est nettement moins informatif que le modèle binomial négatif et ne devrait pas être retenu. Nous montrons tout de même ici comment interpréter ces résultats.</p>
<p><strong>Interprétation des résultats</strong></p>
<p>L’ensemble des coefficients du modèle sont accessibles avec la fonction <code>summary</code>. Les coefficients dédiés à la partie Poisson (appelée <strong>Mu</strong> dans le résumé) doivent être analysés et interprétés de la même manière que s’ils provenaient d’un modèle de Poisson. Les coefficients appartenant à la partie logistique (appelé <strong>Sigma</strong> dans le résumé) doivent être analysés et interprétés de la même manière que s’ils provenaient d’un modèle logistique.</p>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="sect084.html#cb893-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des résultats</span></span>
<span id="cb893-2"><a href="sect084.html#cb893-2" aria-hidden="true" tabindex="-1"></a>base_table <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelza)</span></code></pre></div>
<pre><code>## ******************************************************************
## Family:  c(&quot;ZIP&quot;, &quot;Poisson Zero Inflated&quot;) 
## 
## Call:  gamlss(formula = Nbr_acci ~ Feux_auto + Feux_piet +  
##     Pass_piet + Terreplein + Apaisement + LogEmploi +  
##     Densite_pop + Entropie + DensiteInter + Long_arterePS +  
##     Artere + NB_voies5, sigma.formula = ~1 + Feux_auto +  
##     Feux_piet + Densite_pop + NB_voies5, family = ZIP(mu.link = &quot;log&quot;,  
##     sigma.link = &quot;logit&quot;), data = data2) 
## 
## Fitting method: RS() 
## 
## ------------------------------------------------------------------
## Mu link function:  log
## Mu Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -2.609e+00  5.419e-01  -4.814 1.98e-06 ***
## Feux_auto      5.779e-01  1.903e-01   3.036  0.00253 ** 
## Feux_piet      4.207e-01  1.048e-01   4.012 6.97e-05 ***
## Pass_piet      3.995e-01  1.938e-01   2.061  0.03987 *  
## Terreplein    -3.348e-01  1.666e-01  -2.010  0.04502 *  
## Apaisement     2.246e-01  1.535e-01   1.463  0.14405    
## LogEmploi      1.663e-01  7.509e-02   2.215  0.02723 *  
## Densite_pop    8.610e-05  1.501e-05   5.735 1.72e-08 ***
## Entropie      -2.894e-01  2.950e-01  -0.981  0.32698    
## DensiteInter   4.035e-03  2.052e-03   1.967  0.04980 *  
## Long_arterePS  1.100e-05  2.024e-05   0.544  0.58698    
## Artere         8.629e-02  1.117e-01   0.772  0.44035    
## NB_voies5      4.295e-01  1.017e-01   4.224 2.87e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## ------------------------------------------------------------------
## Sigma link function:  logit
## Sigma Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  1.004e+00  5.530e-01   1.816  0.07005 . 
## Feux_auto   -1.716e+00  6.031e-01  -2.845  0.00463 **
## Feux_piet    2.661e-01  7.228e-01   0.368  0.71292   
## Densite_pop -1.170e-04  5.469e-05  -2.140  0.03286 * 
## NB_voies5   -1.831e+00  1.227e+00  -1.493  0.13606   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## ------------------------------------------------------------------
## No. of observations in the fit:  500 
## Degrees of Freedom for the fit:  18
##       Residual Deg. of Freedom:  482 
##                       at cycle:  11 
##  
## Global Deviance:     1376.967 
##             AIC:     1412.967 
##             SBC:     1488.829 
## ******************************************************************</code></pre>
<div class="sourceCode" id="cb895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb895-1"><a href="sect084.html#cb895-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiplication par 1000 des coefficients de population</span></span>
<span id="cb895-2"><a href="sect084.html#cb895-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (effet pour 1000 habitants)</span></span>
<span id="cb895-3"><a href="sect084.html#cb895-3" aria-hidden="true" tabindex="-1"></a>base_table[<span class="dv">8</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="sc">*</span> base_table[<span class="dv">8</span>,<span class="dv">1</span>]</span>
<span id="cb895-4"><a href="sect084.html#cb895-4" aria-hidden="true" tabindex="-1"></a>base_table[<span class="dv">8</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="sc">*</span> base_table[<span class="dv">8</span>,<span class="dv">2</span>]</span>
<span id="cb895-5"><a href="sect084.html#cb895-5" aria-hidden="true" tabindex="-1"></a>base_table[<span class="dv">17</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="sc">*</span> base_table[<span class="dv">17</span>,<span class="dv">1</span>]</span>
<span id="cb895-6"><a href="sect084.html#cb895-6" aria-hidden="true" tabindex="-1"></a>base_table[<span class="dv">17</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="sc">*</span> base_table[<span class="dv">17</span>,<span class="dv">2</span>]</span>
<span id="cb895-7"><a href="sect084.html#cb895-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiplication par 1000 des coefficients de longueur artère</span></span>
<span id="cb895-8"><a href="sect084.html#cb895-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (effet pour 1 km)</span></span>
<span id="cb895-9"><a href="sect084.html#cb895-9" aria-hidden="true" tabindex="-1"></a>base_table[<span class="dv">11</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="sc">*</span> base_table[<span class="dv">11</span>,<span class="dv">1</span>]</span>
<span id="cb895-10"><a href="sect084.html#cb895-10" aria-hidden="true" tabindex="-1"></a>base_table[<span class="dv">11</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="sc">*</span> base_table[<span class="dv">11</span>,<span class="dv">2</span>]</span>
<span id="cb895-11"><a href="sect084.html#cb895-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des exponentiels des variables indépendantes</span></span>
<span id="cb895-12"><a href="sect084.html#cb895-12" aria-hidden="true" tabindex="-1"></a><span class="co"># et des intervalles de confiance</span></span>
<span id="cb895-13"><a href="sect084.html#cb895-13" aria-hidden="true" tabindex="-1"></a>expcoeff <span class="ot">&lt;-</span> <span class="fu">exp</span>(base_table[,<span class="dv">1</span>])</span>
<span id="cb895-14"><a href="sect084.html#cb895-14" aria-hidden="true" tabindex="-1"></a>expcoeff2<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(base_table[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> base_table[,<span class="dv">2</span>])</span>
<span id="cb895-15"><a href="sect084.html#cb895-15" aria-hidden="true" tabindex="-1"></a>expcoeff97<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(base_table[,<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> base_table[,<span class="dv">2</span>])</span>
<span id="cb895-16"><a href="sect084.html#cb895-16" aria-hidden="true" tabindex="-1"></a>base_table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(base_table, expcoeff, expcoeff2<span class="fl">.5</span>,expcoeff97<span class="fl">.5</span>)</span>
<span id="cb895-17"><a href="sect084.html#cb895-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer une colonne indiquant le niveau de significativité</span></span>
<span id="cb895-18"><a href="sect084.html#cb895-18" aria-hidden="true" tabindex="-1"></a>sign <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb895-19"><a href="sect084.html#cb895-19" aria-hidden="true" tabindex="-1"></a>  base_table[,<span class="dv">4</span>] <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">&quot;***&quot;</span>,</span>
<span id="cb895-20"><a href="sect084.html#cb895-20" aria-hidden="true" tabindex="-1"></a>  base_table[,<span class="dv">4</span>]  <span class="sc">&gt;=</span> <span class="fl">0.001</span> <span class="sc">&amp;</span>  base_table[,<span class="dv">4</span>]<span class="sc">&lt;</span><span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;**&quot;</span>,</span>
<span id="cb895-21"><a href="sect084.html#cb895-21" aria-hidden="true" tabindex="-1"></a>  base_table[,<span class="dv">4</span>]  <span class="sc">&gt;=</span> <span class="fl">0.01</span> <span class="sc">&amp;</span>  base_table[,<span class="dv">4</span>]<span class="sc">&lt;</span><span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;*&quot;</span>,</span>
<span id="cb895-22"><a href="sect084.html#cb895-22" aria-hidden="true" tabindex="-1"></a>  base_table[,<span class="dv">4</span>]  <span class="sc">&gt;=</span> <span class="fl">0.05</span> <span class="sc">&amp;</span>  base_table[,<span class="dv">4</span>]<span class="sc">&lt;</span><span class="fl">0.1</span> <span class="sc">~</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb895-23"><a href="sect084.html#cb895-23" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;&quot;</span></span>
<span id="cb895-24"><a href="sect084.html#cb895-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb895-25"><a href="sect084.html#cb895-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrondir à trois décimales</span></span>
<span id="cb895-26"><a href="sect084.html#cb895-26" aria-hidden="true" tabindex="-1"></a>base_table <span class="ot">&lt;-</span> <span class="fu">round</span>(base_table,<span class="dv">3</span>)</span>
<span id="cb895-27"><a href="sect084.html#cb895-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Enlever les colonnes de valeurs de t et d&#39;erreur standard</span></span>
<span id="cb895-28"><a href="sect084.html#cb895-28" aria-hidden="true" tabindex="-1"></a>base_table <span class="ot">&lt;-</span> base_table[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)]</span>
<span id="cb895-29"><a href="sect084.html#cb895-29" aria-hidden="true" tabindex="-1"></a>base_table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(base_table, sign)</span>
<span id="cb895-30"><a href="sect084.html#cb895-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Remplacer les 0 dans la colonne pval</span></span>
<span id="cb895-31"><a href="sect084.html#cb895-31" aria-hidden="true" tabindex="-1"></a>base_table[,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(base_table[,<span class="dv">2</span>]<span class="sc">==</span><span class="st">&quot;0&quot;</span>,<span class="st">&quot;&lt;0.001&quot;</span>,base_table[,<span class="dv">2</span>])</span>
<span id="cb895-32"><a href="sect084.html#cb895-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Séparer le tout en deux tableaux</span></span>
<span id="cb895-33"><a href="sect084.html#cb895-33" aria-hidden="true" tabindex="-1"></a>part_poiss <span class="ot">&lt;-</span> base_table[<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>,]</span>
<span id="cb895-34"><a href="sect084.html#cb895-34" aria-hidden="true" tabindex="-1"></a>part_logit <span class="ot">&lt;-</span> base_table[<span class="dv">14</span><span class="sc">:</span><span class="dv">18</span>,]</span>
<span id="cb895-35"><a href="sect084.html#cb895-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Mettre les bons noms de colonnes</span></span>
<span id="cb895-36"><a href="sect084.html#cb895-36" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(part_poiss) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Coeff.&quot;</span>,<span class="st">&quot;Val.p&quot;</span>,<span class="st">&quot;Exp(Coeff.)&quot;</span>,</span>
<span id="cb895-37"><a href="sect084.html#cb895-37" aria-hidden="true" tabindex="-1"></a>                          <span class="st">&quot;IC 2,5 % exp(Coeff.)&quot;</span>,<span class="st">&quot;IC 97,5 % exp(Coeff.)&quot;</span>, <span class="st">&quot;Sign.&quot;</span>)</span>
<span id="cb895-38"><a href="sect084.html#cb895-38" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(part_logit) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Coeff.&quot;</span>,<span class="st">&quot;Val.p&quot;</span>,<span class="st">&quot;RC&quot;</span>,<span class="st">&quot;IC 2,5 % RC&quot;</span>,<span class="st">&quot;IC 97,5 % RC&quot;</span>, <span class="st">&quot;Sign.&quot;</span>)</span></code></pre></div>
<p>Nous rapportons les résultats de ce modèle de Poisson avec excès de zéro ajusté dans les tableaux <a href="sect084.html#tab:zapoisstab1">8.27</a> et <a href="sect084.html#tab:zapoisstab2">8.28</a>.</p>
<table>
<caption>
<span id="tab:zapoisstab1">Tableau 8.27: </span>Résultats de la partie Poisson du modèle de Poisson avec excès de zéros ajusté
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coeff.
</th>
<th style="text-align:right;">
Val.p
</th>
<th style="text-align:right;">
Exp(Coeff.)
</th>
<th style="text-align:right;">
IC 2,5 % exp(Coeff.)
</th>
<th style="text-align:right;">
IC 97,5 % exp(Coeff.)
</th>
<th style="text-align:right;">
Sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
-2.609
</td>
<td style="text-align:right;">
&lt;0.001
</td>
<td style="text-align:right;">
0.074
</td>
<td style="text-align:right;">
0.025
</td>
<td style="text-align:right;">
0.213
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Feux_auto
</td>
<td style="text-align:right;">
0.578
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
1.782
</td>
<td style="text-align:right;">
1.227
</td>
<td style="text-align:right;">
2.588
</td>
<td style="text-align:right;">
**
</td>
</tr>
<tr>
<td style="text-align:left;">
Feux_piet
</td>
<td style="text-align:right;">
0.421
</td>
<td style="text-align:right;">
&lt;0.001
</td>
<td style="text-align:right;">
1.523
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:right;">
1.87
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Pass_piet
</td>
<td style="text-align:right;">
0.399
</td>
<td style="text-align:right;">
0.04
</td>
<td style="text-align:right;">
1.491
</td>
<td style="text-align:right;">
1.02
</td>
<td style="text-align:right;">
2.18
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
Terreplein
</td>
<td style="text-align:right;">
-0.335
</td>
<td style="text-align:right;">
0.045
</td>
<td style="text-align:right;">
0.715
</td>
<td style="text-align:right;">
0.516
</td>
<td style="text-align:right;">
0.992
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
Apaisement
</td>
<td style="text-align:right;">
0.225
</td>
<td style="text-align:right;">
0.144
</td>
<td style="text-align:right;">
1.252
</td>
<td style="text-align:right;">
0.927
</td>
<td style="text-align:right;">
1.691
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
LogEmploi
</td>
<td style="text-align:right;">
0.166
</td>
<td style="text-align:right;">
0.027
</td>
<td style="text-align:right;">
1.181
</td>
<td style="text-align:right;">
1.019
</td>
<td style="text-align:right;">
1.368
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
Densite_pop
</td>
<td style="text-align:right;">
0.086
</td>
<td style="text-align:right;">
&lt;0.001
</td>
<td style="text-align:right;">
1.09
</td>
<td style="text-align:right;">
1.058
</td>
<td style="text-align:right;">
1.122
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Entropie
</td>
<td style="text-align:right;">
-0.289
</td>
<td style="text-align:right;">
0.327
</td>
<td style="text-align:right;">
0.749
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
1.335
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
DensiteInter
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
1.004
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1.008
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
Long_arterePS
</td>
<td style="text-align:right;">
0.011
</td>
<td style="text-align:right;">
0.587
</td>
<td style="text-align:right;">
1.011
</td>
<td style="text-align:right;">
0.972
</td>
<td style="text-align:right;">
1.052
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Artere
</td>
<td style="text-align:right;">
0.086
</td>
<td style="text-align:right;">
0.44
</td>
<td style="text-align:right;">
1.09
</td>
<td style="text-align:right;">
0.876
</td>
<td style="text-align:right;">
1.357
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
NB_voies5
</td>
<td style="text-align:right;">
0.429
</td>
<td style="text-align:right;">
&lt;0.001
</td>
<td style="text-align:right;">
1.536
</td>
<td style="text-align:right;">
1.259
</td>
<td style="text-align:right;">
1.875
</td>
<td style="text-align:right;">
***
</td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<table>
<caption>
<span id="tab:zapoisstab2">Tableau 8.28: </span>Résultats de la partie logistique du modèle de Poisson avec excès de zéros ajusté
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coeff.
</th>
<th style="text-align:right;">
Val.p
</th>
<th style="text-align:right;">
RC
</th>
<th style="text-align:right;">
IC 2,5 % RC
</th>
<th style="text-align:right;">
IC 97,5 % RC
</th>
<th style="text-align:right;">
Sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:right;">
1.004
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
2.729
</td>
<td style="text-align:right;">
0.923
</td>
<td style="text-align:right;">
8.067
</td>
<td style="text-align:right;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
Feux_auto
</td>
<td style="text-align:right;">
-1.716
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.055
</td>
<td style="text-align:right;">
0.586
</td>
<td style="text-align:right;">
**
</td>
</tr>
<tr>
<td style="text-align:left;">
Feux_piet
</td>
<td style="text-align:right;">
0.266
</td>
<td style="text-align:right;">
0.713
</td>
<td style="text-align:right;">
1.305
</td>
<td style="text-align:right;">
0.316
</td>
<td style="text-align:right;">
5.381
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Densite_pop
</td>
<td style="text-align:right;">
-0.117
</td>
<td style="text-align:right;">
0.033
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
0.799
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
NB_voies5
</td>
<td style="text-align:right;">
-1.831
</td>
<td style="text-align:right;">
0.136
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
1.773
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table></li>
</ul>
<p>Nous observons ainsi que la présence d’un feu de circulation divise par 5 les chances de rentrer dans la catégorie d’intersection où des accidents peuvent se produire. De même, la densité de population réduit les chances de passer dans cette catégorie de 11 %.</p>
<p>Concernant les coefficients pour la partie Poisson du modèle, nous observons que les présences d’un feu de circulation et d’un feu pour piéton contribuent à multiplier respectivement par 2 et 1,5 le nombre attendu d’accidents à une intersection. De même, la présence d’un axe de circulation à cinq voies augmente de 57 % le nombre d’accidents. Enfin, la densité de population est aussi associée à une augmentation du nombre d’accidents : pour 1 000 habitants supplémentaires autour de l’intersection, nous augmentons le nombre d’accidents attendu de 9 %.</p>
</div>
</div>
<div id="sect0845" class="section level3 hasAnchor" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> Conclusion sur les modèles destinés à des variables de comptage<a href="sect084.html#sect0845" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans cette section, nous avons vu que modéliser une variable de comptage ne doit pas toujours être réalisé avec une simple distribution de Poisson. Il est nécessaire de tenir compte de la sur ou sous-dispersion potentielle ainsi que de l’excès de zéros. Nous n’avons cependant pas couvert tous les cas. Il est en effet possible d’ajuster des modèles avec une distribution binomiale négative avec excès de zéros (avec le <em>package</em> <code>gamlss</code>), ainsi que des modèles de <strong>Hurdle</strong>. Ces derniers ont une approche différente de celle proposée par les distributions ajustées pour tenir compte de l’excès de zéro que nous détaillons dans l’encadré « pour aller plus loin » ci-dessous. Le processus de sélection du modèle peut être résumé avec la figure <a href="sect084.html#fig:figpoisswork">8.39</a>. Notez que même en suivant cette procédure, rien ne garantit que votre modèle final reflète bien les données que vous étudiez. L’analyse approfondie des résidus et des prédictions du modèle est la seule façon de déterminer si oui ou non le modèle est fiable.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figpoisswork"></span>
<img src="images/glm/poisson_workflow.png" alt="Processus de sélection d'un modèle pour une variable de comptage" width="100%" />
<p class="caption">
Figure 8.39: Processus de sélection d’un modèle pour une variable de comptage
</p>
</div>
<div style="page-break-after: always;"></div>
<div class="bloc_aller_loin">
<p><strong>Modèle de Hurdle <em>versus</em> modèle avec excès de zéro</strong></p>
<p>Les modèles de Hurdle sont une autre catégorie de modèles GLM. Ils peuvent être décrits avec la formulation suivante :</p>
<p><span class="math display" id="eq:glmHurdle">\[\begin{equation}\left\{\begin{array}{c}
Y \sim \text {Binomial}(p) \text { si } y=0 \\
\text { logit }(p)=\beta_{a} X_{a} \\
Y \sim \text { TrPoisson}(\lambda) \text { si } y&gt;0 \\
\log (\lambda)=\beta_{b} X_{b}
\end{array}\right.
\tag{8.21}
\end{equation}\]</span>
</p>
<p>Nous constatons qu’un modèle de Hurdle utilise deux distributions, la première est une distribution binomiale dont l’objectif est de prédire si les observations sont à 0 ou au-dessus de 0. La seconde est une distribution strictement positive (supérieure à 0), il peut s’agir d’une distribution tronquée de Poisson, tronquée binomiale négative, Gamma, log-normale ou autre, dépendamment du phénomène modélisé. Puisque le modèle fait appel à deux distributions, deux équations de régression sont utilisées, l’une pour prédire <em>p</em> (la probabilité d’observer une valeur au-dessus de 0) et l’autre l’espérance (moyenne) de la seconde distribution.</p>
<p>En d’autres termes, un modèle de Hurdle modélise les données à zéro et les données au-delà de 0 comme deux processus différents (chacun avec sa propre distribution). Cette approche se distingue des modèles avec excès de zéros qui utilisent une seule distribution pour décrire l’ensemble des données. D’après un modèle avec excès de zéro, il existe de vrais et de faux zéros que l’on tente de distinguer. Dans un modèle de Hurdle, l’idée est que les zéros constituent une limite. Nous modélisons la probabilité de dépasser cette limite et ensuite la magnitude du dépassement de cette limite.</p>
<p>Prenons un exemple pour rendre la distinction plus concrète. Admettons que nous utilisons un capteur capable de mesurer la concentration de particules fines dans l’air. D’après les spécifications du fabricant, le capteur est capable de mesurer des taux de concentration à partir de 0,001 µg/m<sup>3</sup>. Dans une ville avec des niveaux de concentration très faibles, il est très fréquent que le capteur enregistre des valeurs à zéro. Considérant ce phénomène, il serait judicieux de modéliser le processus avec un modèle de Hurdle Gamma puisque les 0 représentent une limite qui n’a pas été franchie : le seuil de détection du capteur. Nous traitons donc différemment les secteurs au-dessous et au-dessus de ce seuil. Si nous reprenons notre exemple sur les accidents des piétons à des intersections, il est plus judicieux, dans ce cas, de modéliser le phénomène avec un modèle avec excès de zéro puisque nous pouvons observer zéro accident à une intersection dangereuse (vrai zéro) et zéro accident à une intersection sur laquelle aucun piéton ne traverse jamais (faux zéro).</p>
</div>
</div>
</div>
<h3>R&eacute;f&eacute;rences</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-cloutier2014carrefours" class="csl-entry">
Cloutier, Marie-soleil, Mathieu Tremblay, Patrick Morency et Philippe Apparicio. 2014. <span>« Carrefours en milieu urbain: quels risques pour les pi<span>é</span>tons? Exemple empirique des quartiers centraux de Montr<span>é</span>al, Canada. »</span> <em>Recherche Transports Sécurité</em> 30: 3‑20.
</div>
<div id="ref-Saspoiss" class="csl-entry">
———. 2020b. <span>« <span>SAS/STAT 15.2 User’s Guide</span> Poisson Regression | SAS Annotated Output. »</span> <a href="https://stats.idre.ucla.edu/sas/output/poisson-regression/" class="uri">https://stats.idre.ucla.edu/sas/output/poisson-regression/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect082.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect085.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MethodesQuantitScSocialesBolR.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
