<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.2 Modèles GLM pour des variables qualitatives | Méthodes quantitatives en sciences sociales : un grand bol d’R</title>
  <meta name="description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="8.2 Modèles GLM pour des variables qualitatives | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="github-repo" content="LAEQ/livre_statistique_Phil_Jere" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.2 Modèles GLM pour des variables qualitatives | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  
  <meta name="twitter:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="twitter:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio et Jérémy Gelb" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect081.html"/>
<link rel="next" href="sect084.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d'R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Un manuel conçu comme un projet collaboratif</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment lire ce livre?</a></li>
<li class="chapter" data-level="" data-path="sect003B.html"><a href="sect003B.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en sciences sociales?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="sect007.html"><a href="sect007.html"><i class="fa fa-check"></i>Dédicace toute spéciale à Cargo et Ambrée</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auteurs.html"><a href="auteurs.html"><i class="fa fa-check"></i>À propos des auteurs</a></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Prise en main de R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Histoire et philosophie de R</a></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Environnement de travail</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Installation de R</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Environnement RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect0123"><i class="fa fa-check"></i><b>1.2.3</b> Installation et chargement un <em>package</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#aide-disponible"><i class="fa fa-check"></i><b>1.2.4</b> Aide disponible</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Bases du langage R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> <em>Hello World</em>!</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Objets et expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="sect013.html"><a href="sect013.html#sect0_133"><i class="fa fa-check"></i><b>1.3.3</b> Fonctions et arguments</a></li>
<li class="chapter" data-level="1.3.4" data-path="sect013.html"><a href="sect013.html#sect0134"><i class="fa fa-check"></i><b>1.3.4</b> Principaux types de données</a></li>
<li class="chapter" data-level="1.3.5" data-path="sect013.html"><a href="sect013.html#sect0135"><i class="fa fa-check"></i><b>1.3.5</b> Opérateurs</a></li>
<li class="chapter" data-level="1.3.6" data-path="sect013.html"><a href="sect013.html#sect0136"><i class="fa fa-check"></i><b>1.3.6</b> Structures de données</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Manipulation de données</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Manipulation d’un <em>DataFrame</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.5</b> Code R bien structuré</a></li>
<li class="chapter" data-level="1.6" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.6</b> Enregistrement des résultats</a></li>
<li class="chapter" data-level="1.7" data-path="sect018.html"><a href="sect018.html"><i class="fa fa-check"></i><b>1.7</b> Session de travail</a></li>
<li class="chapter" data-level="1.8" data-path="sect019.html"><a href="sect019.html"><i class="fa fa-check"></i><b>1.8</b> Conclusion et ressources pertinentes</a></li>
<li class="chapter" data-level="1.9" data-path="sect0110.html"><a href="sect0110.html"><i class="fa fa-check"></i><b>1.9</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>II Analyses univariées et graphiques dans R</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Statistiques descriptives univariées</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion et types de variable</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="sect021.html"><a href="sect021.html#sect0211"><i class="fa fa-check"></i><b>2.1.1</b> Notion de variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="sect021.html"><a href="sect021.html#sect0212"><i class="fa fa-check"></i><b>2.1.2</b> Types de variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Types de données</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Données secondaires <em>versus</em> données primaires</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Données transversales <em>versus</em> données longitudinales</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Données spatiales versus données aspatiales</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Données individuelles <em>versus</em> données agrégées</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Statistique descriptive et statistique inférentielle</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Population, échantillon et inférence</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Deux grandes familles de méthodes statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Notion de distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#définition-générale"><i class="fa fa-check"></i><b>2.4.1</b> Définition générale</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#anatomie-dune-distribution"><i class="fa fa-check"></i><b>2.4.2</b> Anatomie d’une distribution</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#principales-distributions"><i class="fa fa-check"></i><b>2.4.3</b> Principales distributions</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#conclusion-sur-les-distributions"><i class="fa fa-check"></i><b>2.4.4</b> Conclusion sur les distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Statistiques descriptives sur des variables quantitatives</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="sect025.html"><a href="sect025.html#sect0251"><i class="fa fa-check"></i><b>2.5.1</b> Paramètres de tendance centrale</a></li>
<li class="chapter" data-level="2.5.2" data-path="sect025.html"><a href="sect025.html#sect0252"><i class="fa fa-check"></i><b>2.5.2</b> Paramètres de position</a></li>
<li class="chapter" data-level="2.5.3" data-path="sect025.html"><a href="sect025.html#sect0253"><i class="fa fa-check"></i><b>2.5.3</b> Paramètres de dispersion</a></li>
<li class="chapter" data-level="2.5.4" data-path="sect025.html"><a href="sect025.html#sect0254"><i class="fa fa-check"></i><b>2.5.4</b> Paramètres de forme</a></li>
<li class="chapter" data-level="2.5.5" data-path="sect025.html"><a href="sect025.html#sect0255"><i class="fa fa-check"></i><b>2.5.5</b> Transformation des variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="sect025.html"><a href="sect025.html#sect0256"><i class="fa fa-check"></i><b>2.5.6</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="sect026.html"><a href="sect026.html#sect0261"><i class="fa fa-check"></i><b>2.6.1</b> Fréquences</a></li>
<li class="chapter" data-level="2.6.2" data-path="sect026.html"><a href="sect026.html#sect0262"><i class="fa fa-check"></i><b>2.6.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sect027.html"><a href="sect027.html"><i class="fa fa-check"></i><b>2.7</b> Statistiques descriptives pondérées : pour aller plus loin</a></li>
<li class="chapter" data-level="2.8" data-path="sect028.html"><a href="sect028.html"><i class="fa fa-check"></i><b>2.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Magie des graphiques</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Philosophie du ggplot2</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="sect031.html"><a href="sect031.html#sect0311"><i class="fa fa-check"></i><b>3.1.1</b> Grammaire</a></li>
<li class="chapter" data-level="3.1.2" data-path="sect031.html"><a href="sect031.html#sect0312"><i class="fa fa-check"></i><b>3.1.2</b> Types de géométries</a></li>
<li class="chapter" data-level="3.1.3" data-path="sect031.html"><a href="sect031.html#sect0313"><i class="fa fa-check"></i><b>3.1.3</b> Habillage</a></li>
<li class="chapter" data-level="3.1.4" data-path="sect031.html"><a href="sect031.html#utilisation-des-thèmes"><i class="fa fa-check"></i><b>3.1.4</b> Utilisation des thèmes</a></li>
<li class="chapter" data-level="3.1.5" data-path="sect031.html"><a href="sect031.html#sect0314"><i class="fa fa-check"></i><b>3.1.5</b> Composition d’une figure avec plusieurs graphiques</a></li>
<li class="chapter" data-level="3.1.6" data-path="sect031.html"><a href="sect031.html#sect0315"><i class="fa fa-check"></i><b>3.1.6</b> Couleur</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Principaux graphiques</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0321"><i class="fa fa-check"></i><b>3.2.1</b> Histogramme</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0322"><i class="fa fa-check"></i><b>3.2.2</b> Graphique de densité</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0323"><i class="fa fa-check"></i><b>3.2.3</b> Nuage de points</a></li>
<li class="chapter" data-level="3.2.4" data-path="sect032.html"><a href="sect032.html#sect0324"><i class="fa fa-check"></i><b>3.2.4</b> Graphique en ligne</a></li>
<li class="chapter" data-level="3.2.5" data-path="sect032.html"><a href="sect032.html#sect0325"><i class="fa fa-check"></i><b>3.2.5</b> Boîte à moustaches</a></li>
<li class="chapter" data-level="3.2.6" data-path="sect032.html"><a href="sect032.html#sect0326"><i class="fa fa-check"></i><b>3.2.6</b> Graphique en violon</a></li>
<li class="chapter" data-level="3.2.7" data-path="sect032.html"><a href="sect032.html#sect0327"><i class="fa fa-check"></i><b>3.2.7</b> Graphique en barre</a></li>
<li class="chapter" data-level="3.2.8" data-path="sect032.html"><a href="sect032.html#sect0328"><i class="fa fa-check"></i><b>3.2.8</b> Graphique circulaire</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Graphiques spéciaux</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Graphique en radar</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Diagramme d’accord</a></li>
<li class="chapter" data-level="3.3.3" data-path="sect033.html"><a href="sect033.html#sect0333"><i class="fa fa-check"></i><b>3.3.3</b> Nuage de mots</a></li>
<li class="chapter" data-level="3.3.4" data-path="sect033.html"><a href="sect033.html#sect0334"><i class="fa fa-check"></i><b>3.3.4</b> Carte proportionnelle</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Cartes</a></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Exportation des graphiques</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Conclusion sur les graphiques</a></li>
</ul></li>
<li class="part"><span><b>III Analyses bivariées</b></span></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Relation linéaire entre deux variables quantitatives</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Bref retour sur le postulat de la relation linéaire</a></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Covariance</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Formulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect043.html"><a href="sect043.html"><i class="fa fa-check"></i><b>4.3</b> Corrélation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="sect043.html"><a href="sect043.html#sect0431"><i class="fa fa-check"></i><b>4.3.1</b> Formulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="sect043.html"><a href="sect043.html#sect0432"><i class="fa fa-check"></i><b>4.3.2</b> Interprétation</a></li>
<li class="chapter" data-level="4.3.3" data-path="sect043.html"><a href="sect043.html#sect0433"><i class="fa fa-check"></i><b>4.3.3</b> Corrélations pour des variables anormalement distribuées (coefficient de Spearman, tau de Kendall)</a></li>
<li class="chapter" data-level="4.3.4" data-path="sect043.html"><a href="sect043.html#sect0434"><i class="fa fa-check"></i><b>4.3.4</b> Corrélations robustes (<em>Biweight midcorrelation</em>, <em>Percentage bend correlation</em> et la corrélation <em>pi</em> de Shepherd)</a></li>
<li class="chapter" data-level="4.3.5" data-path="sect043.html"><a href="sect043.html#sect0435"><i class="fa fa-check"></i><b>4.3.5</b> Significativité des coefficients de corrélation</a></li>
<li class="chapter" data-level="4.3.6" data-path="sect043.html"><a href="sect043.html#sect0436"><i class="fa fa-check"></i><b>4.3.6</b> Corrélation partielle</a></li>
<li class="chapter" data-level="4.3.7" data-path="sect043.html"><a href="sect043.html#sect0437"><i class="fa fa-check"></i><b>4.3.7</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.3.8" data-path="sect043.html"><a href="sect043.html#sect0438"><i class="fa fa-check"></i><b>4.3.8</b> Comment rapporter des valeurs de corrélations?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.4</b> Régression linéaire simple</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sect044.html"><a href="sect044.html#sect0441"><i class="fa fa-check"></i><b>4.4.1</b> Principe de base de la régression linéaire simple</a></li>
<li class="chapter" data-level="4.4.2" data-path="sect044.html"><a href="sect044.html#sect0442"><i class="fa fa-check"></i><b>4.4.2</b> Formulation de la droite de régression des moindres carrés ordinaires</a></li>
<li class="chapter" data-level="4.4.3" data-path="sect044.html"><a href="sect044.html#sect0443"><i class="fa fa-check"></i><b>4.4.3</b> Mesure de la qualité d’ajustement du modèle</a></li>
<li class="chapter" data-level="4.4.4" data-path="sect044.html"><a href="sect044.html#sect0444"><i class="fa fa-check"></i><b>4.4.4</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.4.5" data-path="sect044.html"><a href="sect044.html#sect0445"><i class="fa fa-check"></i><b>4.4.5</b> Comment rapporter une régression linéaire simple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Relation entre deux variables qualitatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Construction de tableau de contingence</a></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Test du khi-deux</a></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Interprétation d’un tableau de contingence</a></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Relation entre une variable qualitative et une variable quantitative</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Relation entre une variable quantitative et une variable qualitative à deux modalités</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Test <em>t</em> et ses différentes variantes</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Test non paramétrique de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Analyse de variance</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Test non paramétrique de Kruskal-Wallis</a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="6.2.4" data-path="sect062.html"><a href="sect062.html#sect0624"><i class="fa fa-check"></i><b>6.2.4</b> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Conclusion sur la troisième partie</a></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>IV Modèles de régression</b></span></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Principes de base de la régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Un peu d’équations…</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Hypothèses de la régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Évaluation de la qualité d’ajustement du modèle</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Mesures de la qualité d’un modèle</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Comparaison des modèles incrémentiels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Différentes mesures pour les coefficients de régression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sect074.html"><a href="sect074.html#sect0741"><i class="fa fa-check"></i><b>7.4.1</b> Coefficients de régression : évaluer l’effet des variables indépendantes</a></li>
<li class="chapter" data-level="7.4.2" data-path="sect074.html"><a href="sect074.html#sect0742"><i class="fa fa-check"></i><b>7.4.2</b> Coefficients de régression standardisés : repérer les variables les plus importantes du modèle</a></li>
<li class="chapter" data-level="7.4.3" data-path="sect074.html"><a href="sect074.html#sect0743"><i class="fa fa-check"></i><b>7.4.3</b> Significativité des coefficients de régression : valeurs de <em>t</em> et de <em>p</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="sect074.html"><a href="sect074.html#sect0744"><i class="fa fa-check"></i><b>7.4.4</b> Intervalle de confiance des coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Introduction de variables explicatives particulières</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sect075.html"><a href="sect075.html#sect0751"><i class="fa fa-check"></i><b>7.5.1</b> Exploration des relations non linéaires</a></li>
<li class="chapter" data-level="7.5.2" data-path="sect075.html"><a href="sect075.html#sect0752"><i class="fa fa-check"></i><b>7.5.2</b> Variable indépendante qualitative dichotomique</a></li>
<li class="chapter" data-level="7.5.3" data-path="sect075.html"><a href="sect075.html#sect0753"><i class="fa fa-check"></i><b>7.5.3</b> Variable indépendante qualitative polytomique</a></li>
<li class="chapter" data-level="7.5.4" data-path="sect075.html"><a href="sect075.html#sect0754"><i class="fa fa-check"></i><b>7.5.4</b> Variables d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sect076.html"><a href="sect076.html"><i class="fa fa-check"></i><b>7.6</b> Diagnostics de la régression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sect076.html"><a href="sect076.html#sect0761"><i class="fa fa-check"></i><b>7.6.1</b> Nombre d’observations</a></li>
<li class="chapter" data-level="7.6.2" data-path="sect076.html"><a href="sect076.html#sect0762"><i class="fa fa-check"></i><b>7.6.2</b> Normalité des résidus</a></li>
<li class="chapter" data-level="7.6.3" data-path="sect076.html"><a href="sect076.html#sect0763"><i class="fa fa-check"></i><b>7.6.3</b> Linéarité et homoscédasticité des résidus</a></li>
<li class="chapter" data-level="7.6.4" data-path="sect076.html"><a href="sect076.html#sect0764"><i class="fa fa-check"></i><b>7.6.4</b> Absence de multicolinéarité excessive</a></li>
<li class="chapter" data-level="7.6.5" data-path="sect076.html"><a href="sect076.html#sect0766"><i class="fa fa-check"></i><b>7.6.5</b> Absence d’observations aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sect077.html"><a href="sect077.html"><i class="fa fa-check"></i><b>7.7</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sect077.html"><a href="sect077.html#sect0771"><i class="fa fa-check"></i><b>7.7.1</b> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
<li class="chapter" data-level="7.7.2" data-path="sect077.html"><a href="sect077.html#sect0772"><i class="fa fa-check"></i><b>7.7.2</b> Comparaison des modèles</a></li>
<li class="chapter" data-level="7.7.3" data-path="sect077.html"><a href="sect077.html#sect0773"><i class="fa fa-check"></i><b>7.7.3</b> Diagnostic sur un modèle</a></li>
<li class="chapter" data-level="7.7.4" data-path="sect077.html"><a href="sect077.html#sect0774"><i class="fa fa-check"></i><b>7.7.4</b> Graphiques pour les effets marginaux</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sect078.html"><a href="sect078.html"><i class="fa fa-check"></i><b>7.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Régressions linéaires généralisées (GLM)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Qu’est qu’un modèle GLM?</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Formulation d’un GLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Autres distributions et rôle de la fonction de lien</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Conditions d’application</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Résidus et déviance</a></li>
<li class="chapter" data-level="8.1.5" data-path="sect081.html"><a href="sect081.html#sect0815"><i class="fa fa-check"></i><b>8.1.5</b> Vérification l’ajustement</a></li>
<li class="chapter" data-level="8.1.6" data-path="sect081.html"><a href="sect081.html#sect0816"><i class="fa fa-check"></i><b>8.1.6</b> Comparaison de deux modèles GLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Modèles GLM pour des variables qualitatives</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Modèle logistique binomial</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Modèle probit binomial</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Modèle logistique des cotes proportionnelles</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Modèle logistique multinomial</a></li>
<li class="chapter" data-level="8.2.5" data-path="sect082.html"><a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives"><i class="fa fa-check"></i><b>8.2.5</b> Conclusion sur les modèles pour des variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.3</b> Modèles GLM pour des variables de comptage</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="sect084.html"><a href="sect084.html#sect0841"><i class="fa fa-check"></i><b>8.3.1</b> Modèle de Poisson</a></li>
<li class="chapter" data-level="8.3.2" data-path="sect084.html"><a href="sect084.html#sect0842"><i class="fa fa-check"></i><b>8.3.2</b> Modèle binomial négatif</a></li>
<li class="chapter" data-level="8.3.3" data-path="sect084.html"><a href="sect084.html#sect0843"><i class="fa fa-check"></i><b>8.3.3</b> Modèle de Poisson avec excès fixe de zéros</a></li>
<li class="chapter" data-level="8.3.4" data-path="sect084.html"><a href="sect084.html#sect0844"><i class="fa fa-check"></i><b>8.3.4</b> Modèle de Poisson avec excès ajusté de zéros</a></li>
<li class="chapter" data-level="8.3.5" data-path="sect084.html"><a href="sect084.html#sect0845"><i class="fa fa-check"></i><b>8.3.5</b> Conclusion sur les modèles destinés à des variables de comptage</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sect085.html"><a href="sect085.html"><i class="fa fa-check"></i><b>8.4</b> Modèles GLM pour des variables continues</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sect085.html"><a href="sect085.html#sect0851"><i class="fa fa-check"></i><b>8.4.1</b> Modèle GLM gaussien</a></li>
<li class="chapter" data-level="8.4.2" data-path="sect085.html"><a href="sect085.html#sect0852"><i class="fa fa-check"></i><b>8.4.2</b> Modèle GLM avec une distribution de Student</a></li>
<li class="chapter" data-level="8.4.3" data-path="sect085.html"><a href="sect085.html#sect0853"><i class="fa fa-check"></i><b>8.4.3</b> Modèle GLM avec distribution Gamma</a></li>
<li class="chapter" data-level="8.4.4" data-path="sect085.html"><a href="sect085.html#sect0854"><i class="fa fa-check"></i><b>8.4.4</b> Modèle GLM avec une distribution bêta</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sect086.html"><a href="sect086.html"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="8.6" data-path="sect087.html"><a href="sect087.html"><i class="fa fa-check"></i><b>8.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Régressions à effets mixtes (GLMM)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Indépendance des observations et effets de groupes</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Terminologie: effets fixes et effets aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Principes de base des GLMM</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> GLMM avec constantes aléatoires</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.2</b> GLMM avec pentes aléatoires</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.3</b> GLMM avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Conditions d’application des GLMM</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Vérification de la distribution des effets aléatoires</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Homogénéité des variances au sein des groupes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Inférence dans les modèles GLMM</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#sect0941"><i class="fa fa-check"></i><b>9.4.1</b> Inférence pour les effets fixes</a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#sect0942"><i class="fa fa-check"></i><b>9.4.2</b> Inférence pour les effets aléatoires, effet global</a></li>
<li class="chapter" data-level="9.4.3" data-path="sect094.html"><a href="sect094.html#sect0943"><i class="fa fa-check"></i><b>9.4.3</b> Inférence pour les effets aléatoires, des constantes et des pentes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Conclusion sur les GLMM</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Mise en œuvre des GLMM dans R</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="sect096.html"><a href="sect096.html#sect0961"><i class="fa fa-check"></i><b>9.6.1</b> Ajustement du modèle avec uniquement une constante aléatoire</a></li>
<li class="chapter" data-level="9.6.2" data-path="sect096.html"><a href="sect096.html#sect0962"><i class="fa fa-check"></i><b>9.6.2</b> Ajustement du modèle avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sect097.html"><a href="sect097.html"><i class="fa fa-check"></i><b>9.7</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Régressions multiniveaux</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect101.html"><a href="sect101.html"><i class="fa fa-check"></i><b>10.1</b> Modèles multiniveaux : deux intérêts majeurs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect101.html"><a href="sect101.html#sect1011"><i class="fa fa-check"></i><b>10.1.1</b> Répartition de la variance entre les différents niveaux</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect101.html"><a href="sect101.html#sect1012"><i class="fa fa-check"></i><b>10.1.2</b> Estimation des coefficients aux différents niveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect102.html"><a href="sect102.html"><i class="fa fa-check"></i><b>10.2</b> Différents types de modèles multiniveaux</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect102.html"><a href="sect102.html#sect1021"><i class="fa fa-check"></i><b>10.2.1</b> Description du jeu de données utilisé</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect102.html"><a href="sect102.html#sect1022"><i class="fa fa-check"></i><b>10.2.2</b> Démarche classique pour les modèles multiniveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect103.html"><a href="sect103.html"><i class="fa fa-check"></i><b>10.3</b> Conditions d’application des régressions multiniveaux</a></li>
<li class="chapter" data-level="10.4" data-path="sect104.html"><a href="sect104.html"><i class="fa fa-check"></i><b>10.4</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect104.html"><a href="sect104.html#sect1041"><i class="fa fa-check"></i><b>10.4.1</b> Le modèle vide</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect104.html"><a href="sect104.html#sect1042"><i class="fa fa-check"></i><b>10.4.2</b> Modèle avec les variables indépendantes du niveau 1</a></li>
<li class="chapter" data-level="10.4.3" data-path="sect104.html"><a href="sect104.html#sect1043"><i class="fa fa-check"></i><b>10.4.3</b> Modèle avec les variables indépendantes aux niveaux 1 et 2</a></li>
<li class="chapter" data-level="10.4.4" data-path="sect104.html"><a href="sect104.html#sect10414"><i class="fa fa-check"></i><b>10.4.4</b> Modèle complet avec une interaction</a></li>
<li class="chapter" data-level="10.4.5" data-path="sect104.html"><a href="sect104.html#sect1045"><i class="fa fa-check"></i><b>10.4.5</b> Comparaison des quatre modèles</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect105.html"><a href="sect105.html"><i class="fa fa-check"></i><b>10.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> Modèles généralisés additifs</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sect111.html"><a href="sect111.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="sect111.html"><a href="sect111.html#sect1111"><i class="fa fa-check"></i><b>11.1.1</b> Non linéarité fonctionnelle</a></li>
<li class="chapter" data-level="11.1.2" data-path="sect111.html"><a href="sect111.html#sect1112"><i class="fa fa-check"></i><b>11.1.2</b> Non linéarité avec des polynomiales</a></li>
<li class="chapter" data-level="11.1.3" data-path="sect111.html"><a href="sect111.html#sect1113"><i class="fa fa-check"></i><b>11.1.3</b> Non linéarité par segments</a></li>
<li class="chapter" data-level="11.1.4" data-path="sect111.html"><a href="sect111.html#sect1114"><i class="fa fa-check"></i><b>11.1.4</b> Non linéarité avec des <em>splines</em></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sect112.html"><a href="sect112.html"><i class="fa fa-check"></i><b>11.2</b> <em>Spline</em> de régression et <em>spline</em> de lissage</a></li>
<li class="chapter" data-level="11.3" data-path="sect113.html"><a href="sect113.html"><i class="fa fa-check"></i><b>11.3</b> Interprétation d’une <em>spline</em></a></li>
<li class="chapter" data-level="11.4" data-path="sect114.html"><a href="sect114.html"><i class="fa fa-check"></i><b>11.4</b> Multicolinéarité non linéaire</a></li>
<li class="chapter" data-level="11.5" data-path="sect115.html"><a href="sect115.html"><i class="fa fa-check"></i><b>11.5</b> <em>Splines</em> avancées</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sect115.html"><a href="sect115.html#sect1151"><i class="fa fa-check"></i><b>11.5.1</b> <em>Splines</em> cycliques</a></li>
<li class="chapter" data-level="11.5.2" data-path="sect115.html"><a href="sect115.html#sect1152"><i class="fa fa-check"></i><b>11.5.2</b> Splines par groupe</a></li>
<li class="chapter" data-level="11.5.3" data-path="sect115.html"><a href="sect115.html#sect1153"><i class="fa fa-check"></i><b>11.5.3</b> <em>Splines</em> multivariées et <em>splines</em> d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="sect116.html"><a href="sect116.html"><i class="fa fa-check"></i><b>11.6</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="11.7" data-path="sect117.html"><a href="sect117.html"><i class="fa fa-check"></i><b>11.7</b> GAMM</a></li>
<li class="chapter" data-level="11.8" data-path="sect118.html"><a href="sect118.html"><i class="fa fa-check"></i><b>11.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>V Analyses exploratoires multivariées</b></span></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> Méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sect121.html"><a href="sect121.html"><i class="fa fa-check"></i><b>12.1</b> Aperçu des méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="sect121.html"><a href="sect121.html#sect1211"><i class="fa fa-check"></i><b>12.1.1</b> Méthodes factorielles et types de données</a></li>
<li class="chapter" data-level="12.1.2" data-path="sect121.html"><a href="sect121.html#sect1212"><i class="fa fa-check"></i><b>12.1.2</b> Bref historique des méthodes factorielles</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sect122.html"><a href="sect122.html"><i class="fa fa-check"></i><b>12.2</b> Analyses en composantes principales (ACP)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="sect122.html"><a href="sect122.html#sect1221"><i class="fa fa-check"></i><b>12.2.1</b> Recherche d’une simplification</a></li>
<li class="chapter" data-level="12.2.2" data-path="sect122.html"><a href="sect122.html#sect1222"><i class="fa fa-check"></i><b>12.2.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.2.3" data-path="sect122.html"><a href="sect122.html#sect1223"><i class="fa fa-check"></i><b>12.2.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sect123.html"><a href="sect123.html"><i class="fa fa-check"></i><b>12.3</b> Analyse factorielle des correspondances (AFC)</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="sect123.html"><a href="sect123.html#sect1231"><i class="fa fa-check"></i><b>12.3.1</b> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
<li class="chapter" data-level="12.3.2" data-path="sect123.html"><a href="sect123.html#sect1232"><i class="fa fa-check"></i><b>12.3.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.3.3" data-path="sect123.html"><a href="sect123.html#sect1233"><i class="fa fa-check"></i><b>12.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="sect124.html"><a href="sect124.html"><i class="fa fa-check"></i><b>12.4</b> Analyse de correspondances multiples (ACM)</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="sect124.html"><a href="sect124.html#sect1241"><i class="fa fa-check"></i><b>12.4.1</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.4.2" data-path="sect124.html"><a href="sect124.html#sect1242"><i class="fa fa-check"></i><b>12.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="sect125.html"><a href="sect125.html"><i class="fa fa-check"></i><b>12.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> Méthodes de classification non supervisée</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sect131.html"><a href="sect131.html"><i class="fa fa-check"></i><b>13.1</b> Méthodes de classification : un aperçu</a></li>
<li class="chapter" data-level="13.2" data-path="sect132.html"><a href="sect132.html"><i class="fa fa-check"></i><b>13.2</b> Notions essentielles en classification</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="sect132.html"><a href="sect132.html#sect1321"><i class="fa fa-check"></i><b>13.2.1</b> Distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="sect132.html"><a href="sect132.html#sect1322"><i class="fa fa-check"></i><b>13.2.2</b> Inertie</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="sect133.html"><a href="sect133.html"><i class="fa fa-check"></i><b>13.3</b> Classification ascendante hiérarchique</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="sect133.html"><a href="sect133.html#sect1331"><i class="fa fa-check"></i><b>13.3.1</b> Fonctionnement de l’algorithme</a></li>
<li class="chapter" data-level="13.3.2" data-path="sect133.html"><a href="sect133.html#sect1332"><i class="fa fa-check"></i><b>13.3.2</b> Choisir le bon nombre de groupes</a></li>
<li class="chapter" data-level="13.3.3" data-path="sect133.html"><a href="sect133.html#sect1333"><i class="fa fa-check"></i><b>13.3.3</b> Limites de la classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="13.3.4" data-path="sect133.html"><a href="sect133.html#sect1334"><i class="fa fa-check"></i><b>13.3.4</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sect134.html"><a href="sect134.html"><i class="fa fa-check"></i><b>13.4</b> Nuées dynamiques</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="sect134.html"><a href="sect134.html#sect1341"><i class="fa fa-check"></i><b>13.4.1</b> <em>K-means</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="sect134.html"><a href="sect134.html#sect1342"><i class="fa fa-check"></i><b>13.4.2</b> K-médianes</a></li>
<li class="chapter" data-level="13.4.3" data-path="sect134.html"><a href="sect134.html#sect1343"><i class="fa fa-check"></i><b>13.4.3</b> K-médoïds</a></li>
<li class="chapter" data-level="13.4.4" data-path="sect134.html"><a href="sect134.html#sect1344"><i class="fa fa-check"></i><b>13.4.4</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="13.4.5" data-path="sect134.html"><a href="sect134.html#sect1346"><i class="fa fa-check"></i><b>13.4.5</b> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sect135.html"><a href="sect135.html"><i class="fa fa-check"></i><b>13.5</b> Conclusion sur la cinquième partie</a></li>
<li class="chapter" data-level="13.6" data-path="sect136.html"><a href="sect136.html"><i class="fa fa-check"></i><b>13.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>VI Annexes</b></span></li>
<li class="chapter" data-level="14" data-path="annexe1.html"><a href="annexe1.html"><i class="fa fa-check"></i><b>14</b> Table des valeurs critiques de khi-deux</a></li>
<li class="chapter" data-level="15" data-path="annexe2.html"><a href="annexe2.html"><i class="fa fa-check"></i><b>15</b> Table des valeurs critiques de Fisher</a></li>
<li class="chapter" data-level="16" data-path="annexe3.html"><a href="annexe3.html"><i class="fa fa-check"></i><b>16</b> Table des valeurs critiques de <em>t</em></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect082" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Modèles GLM pour des variables qualitatives<a href="sect082.html#sect082" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nous abordons en premier les principaux GLM utilisés pour modéliser des variables binaires, multinomiales et ordinales. Prenez bien le temps de saisir le fonctionnement du modèle logistique binomial, car il sert de base pour les trois autres modèles présentés.</p>
<div id="sect0821" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Modèle logistique binomial<a href="sect082.html#sect0821" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le modèle logistique binomial est une généralisation du modèle de Bernoulli que nous avons présenté dans l’introduction de cette section. Le modèle logistique binomiale couvre donc deux cas de figure :</p>
<ol style="list-style-type: decimal">
<li>La variable observée est binaire (0 ou 1). Dans ce cas, le modèle logistique binomiale devient un simple modèle de Bernoulli.</li>
<li>La variable observée est un comptage (nombre de réussites) et nous disposons d’une autre variable avec le nombre de réplications de l’expérience. Par exemple, pour chaque intersection d’un réseau routier, nous pourrions avoir le nombre de décès à vélo (variable <em>Y</em> de comptage) et le nombre de collisions vélo / automobile (variable quantifiant le nombre d’expériences, chaque collision étant une expérience).
Spécifiquement, nous tentons de prédire le paramètre <em>p</em> de la distribution binomiale à l’aide de notre équation de régression et de la fonction logistique comme fonction de lien. Notez ici que cette fonction de lien influence directement l’interprétation des paramètres du modèle. Pour rappel, cette fonction est définie comme :</li>
</ol>
<p><span class="math display">\[\begin{equation}
g(x) = ln(\frac{x}{1-x})
\end{equation}\]</span>
</p>
<p>avec <span class="math inline">\(ln\)</span> le logarithme naturel.</p>
<p>Au-delà de sa propriété mathématique assurant que <span class="math inline">\(g(x) \in \mathopen[0,1\mathclose]\)</span>, cette fonction offre une interprétation intéressante. La partie <span class="math inline">\(\frac{x}{1-x}\)</span> est une cote et s’interprète en termes de chances d’observer un évènement. Par exemple, dans le cas des accidents de cyclistes, si la probabilité d’observer un décès suite à une collision est de 0,1, alors la cote de cet évènement est <span class="math inline">\(\frac{\frac{1}{10}}{\frac{9}{10}} = \frac{1}{9}\)</span> soit un contre neuf. Dans un modèle GLM logistique, les coefficients ajustés pour les variables indépendantes représentent des <strong>logarithmes de rapport de cote</strong>, car ils comparent les chances d’observer l’évènement (y = 1) en fonction des valeurs des variables indépendantes.</p>
<table>
<caption>
<span id="tab:binomidentity">Tableau 8.6: </span>Carte d’identité du modèle logistique binomial
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable binaire (0 ou 1) ou comptage de réussite à une expérience (ex : 3 réussites sur 5 expériences)
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Binomiale
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim Binomial(p)\)</span> <br/> <span class="math inline">\(g(p) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(g(x) = log(\frac{x}{1-x})\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
Logistique
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
p
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Non-séparation complète, absence de sur-dispersion ou de sous-dispersion
</td>
</tr>
</tbody>
</table>
<div id="interprétation-des-paramètres" class="section level4 hasAnchor" number="8.2.1.1">
<h4><span class="header-section-number">8.2.1.1</span> Interprétation des paramètres<a href="sect082.html#interprétation-des-paramètres" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Les seuls paramètres à estimer du modèle sont les coefficients <span class="math inline">\(\beta\)</span> et la constante <span class="math inline">\(\beta_0\)</span>. La fonction de lien logistique transforme la valeur de ces coefficients, en conséquence, <strong>ils ne peuvent plus être interprétés directement</strong>. <span class="math inline">\(\beta_0\)</span> et <span class="math inline">\(\beta\)</span> sont exprimés dans une unité particulière: des logarithmes de rapports de cote (<em>log odd ratio</em>). Le rapport de cote est relativement facile à interpréter contrairement à son logarithme. Pour l’obtenir, il suffit d’utiliser la fonction exponentielle (l’inverse de la fonction logarithme) pour passer des log rapport de cote à de simples rapports de cote.
Donc si <span class="math inline">\(exp(\beta)\)</span> est inférieur à 1, il réduit les chances d’observer l’évènement et inversement si <span class="math inline">\(exp(\beta)\)</span> est supérieur à 1.</p>
<p>Par exemple, admettons que nous ayons un coefficient <span class="math inline">\(\beta_1\)</span> de 1,2 pour une variable <span class="math inline">\(X_1\)</span> dans une régression logistique. Il est nécessaire d’utiliser son exponentiel pour l’interpréter de façon intuitive. <span class="math inline">\(exp\mbox{(1,2)} = \mbox{3,32}\)</span>, ce qui signifie que lorsque <span class="math inline">\(X_1\)</span> augmente d’une unité, les chances d’observer 1 plutôt que 0 comme valeur de <em>Y</em> sont multipliées par 3,32. Admettons maintenant que <span class="math inline">\(\beta_1\)</span> vaille −1,2, nous calculons donc <span class="math inline">\(exp\mbox{(-1,2) = 0,30}\)</span>, ce qui signifie qu’à chaque augmentation d’une unité de <span class="math inline">\(X_1\)</span>, les chances d’observer 1 plutôt que 0 comme valeur de <em>Y</em> sont multipliées par 0,30. En d’autres termes,les chances d’observer 1 plutôt que 0 sont divisées par 3,33 (<span class="math inline">\(\mbox{1}/\mbox{0,30} = \mbox{3,33}\)</span>), soit une diminution de 70 % (<span class="math inline">\(\mbox{1}-\mbox{0,3} = \mbox{0,7}\)</span>) des chances d’observer 1 plutôt que 0.</p>
<div class="bloc_aller_loin">
<p><strong>Les rapports de cotes</strong></p>
<p>Le rapport de cote ou rapport des chances est une mesure utilisée pour exprimer l’effet d’un facteur sur une probabilité. Il est très utilisé dans le domaine de la santé, mais aussi des paris. Prenons un exemple concret avec le port du casque à vélo. Si sur 100 accidents impliquant des cyclistes portant un casque, nous observons seulement 3 cas de blessures graves à la tête, contre 15 dans un second groupe de 100 cyclistes ne portant pas de casque, nous pouvons calculer le rapport de cote suivant :</p>
<p><span class="math display">\[\begin{equation}
\frac{p(1-q)}{q(1-p)} = \frac{\mbox{0,15} \times (\mbox{1}-\mbox{0,03})}{\mbox{0,03} \times (\mbox{1}-\mbox{0,15})} = \mbox{5,71}
\end{equation}\]</span>
</p>
<p>avec <em>p</em> la probabilité d’observer le phénomène (ici la blessure grave à la tête) dans le groupe 1 (ici les cyclistes sans casque) et <em>q</em> la probabilité d’observer le phénomène dans le groupe 2 (ici les cyclistes avec un casque). Ce rapport de cote indique que les cyclistes sans casques ont 5,71 fois plus de risques de se blesser gravement à la tête lors d’un accident comparativement aux cyclistes portant un casque.</p>
</div>
</div>
<div id="sectcondapp" class="section level4 hasAnchor" number="8.2.1.2">
<h4><span class="header-section-number">8.2.1.2</span> Conditions d’application<a href="sect082.html#sectcondapp" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La non-séparation complète signifie qu’aucune des variables <em>X</em> n’est, à elle seule, capable de parfaitement distinguer les deux catégories 0 et 1 de la variable <em>Y</em>. Dans un tel cas de figure, les algorithmes d’ajustement utilisés pour estimer les paramètres des modèles sont incapables de converger. Notez aussi l’absurdité de créer un modèle pour prédire une variable <em>Y</em> si une variable <em>X</em> est capable à elle seule de la prédire à coup sûr. Ce problème est appelé un effet de Hauck-Donner. Il est assez facile de le repérer, car la plupart du temps les fonctions de R signalent ce problème (message d’erreur sur la convergence). Sinon, des valeurs extrêmement élevées ou faibles pour certains rapports de cote peuvent aussi indiquer un effet de Hauck-Donner.</p>
<p>La sur-dispersion est un problème spécifique aux distributions n’ayant pas de paramètre de dispersion (binomiale, de Poisson, exponentielle, etc.), pour lesquelles la variance dépend directement de l’espérance. La sur-dispersion désigne une situation dans laquelle les résidus (ou erreurs) d’un modèle sont plus dispersés que ce que suppose la distribution utilisée. À l’inverse, il est aussi possible (mais rare) d’observer des cas de sous-dispersion (lorsque la dispersion des résidus est plus petite que ce que suppose la distribution choisie). Ce cas de figure se produit généralement lorsque le modèle parvient à réaliser une prédiction trop précise pour être crédible. Si vous rencontrez une forte sous-dispersion, cela signifie souvent que l’une de vos variables indépendantes provoque une séparation complète. La meilleure option, dans ce cas, est de supprimer la variable en question du modèle. La variance attendue d’une distribution binomiale est <span class="math inline">\(nb \times p \times(1-p)\)</span>, soit le produit entre le nombre de tirages, la probabilité de réussite et la probabilité d’échec. À titre d’exemple, si nous considérons une distribution binomiale avec un seul tirage et 50 % de chances de réussite, sa variance serait : <span class="math inline">\(1 \times \mbox{0,5} \times \mbox{(1}-\mbox{0,5}) = \mbox{0,25}\)</span>.</p>
<p>Plusieurs raisons peuvent expliquer la présence de sur-dispersion dans une modèle:</p>
<ul>
<li>il manque des variables importantes dans le modèle, conduisant à un mauvais ajustement et donc une sur-dispersion des erreurs;</li>
<li>les observations ne sont pas indépendantes, impliquant qu’une partie de la variance n’est pas contrôlée et augmente les erreurs;</li>
<li>la probabilité de succès de chaque expérience varie d’une répétition à l’autre (différentes distributions).</li>
</ul>
<p>La conséquence directe de la sur-dispersion est la sous-estimation de la variance des coefficients de régression. En d’autres termes, la sur-dispersion conduit à sous-estimer notre incertitude quant aux coefficients obtenus et réduit les valeurs de <em>p</em> calculées pour ces coefficients. Les risques de trouver des résultats significatifs à cause des fluctuations d’échantillonnage augmentent.</p>
<p>Pour détecter une sur-dispersion ou une sous-dispersion dans un modèle logistique binomial, il est possible d’observer les résidus de déviance du modèle. Ces derniers sont supposés suivre une distribution du khi-deux avec <em>n−k</em> degrés de liberté (avec <em>n</em> le nombre d’observations et <em>k</em> le nombre de coefficients dans le modèle). Par conséquent, la somme des résidus de déviance d’un modèle logistique binomiale divisée par le nombre de degrés de liberté devrait être proche de 1. Une légère déviation (jusqu’à 0,15 au-dessus ou au-dessous de 1) n’est pas alarmante; au-delà, il est nécessaire d’ajuster le modèle.</p>
<p>Notez que si la variable <em>Y</em> modélisée est exactement binaire (chaque expérience est indépendante et n’est composée que d’un seul tirage) et que le modèle utilise donc une distribution de Bernoulli, le test précédent pour détecter une éventuelle sur-dispersion n’est pas valide. <span class="citation">Hilbe (<a href="#ref-hilbe2009logistic" role="doc-biblioref">2009</a>)</span> parle de sur-dispersion implicite pour le modèle de Bernoulli et recommande notamment de toujours ajuster les erreurs standards des modèles utilisant des distributions de Bernoulli, binomiale et de Poisson. L’idée ici est d’éviter d’être trop optimiste face à l’incertitude du modèle sur les coefficients et de l’ajuster en conséquence. Pour cela, il est possible d’utiliser des quasi-distributions ou des estimateurs robustes <span class="citation">(<a href="#ref-zeileis2004econometric" role="doc-biblioref">Zeileis 2004</a>)</span>. Notez que si le modèle ne souffre pas de sur ou sous-dispersion, ces ajustements produisent des résultats équivalents aux résultats non ajustés.</p>
</div>
<div id="sectexemplebinom" class="section level4 hasAnchor" number="8.2.1.3">
<h4><span class="header-section-number">8.2.1.3</span> Exemple appliqué dans R<a href="sect082.html#sectexemplebinom" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Présentation des données</strong></p>
<p>Pour illustrer le modèle logistique binomial, nous utilisons ici un jeu de données proposé par l’Union européenne : <a href="https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/P82V9X">l’enquête de déplacement sur la demande pour des systèmes de transports innovants</a>. Pour cette enquête, un échantillon de 1 000 individus représentatifs de la population a été constitué dans chacun des 26 États membres de l’UE, soit un total de 26 000 observations. Pour chaque individu, plusieurs informations ont été collectées relatives à la catégorie socioprofessionnelle, le mode de transport le plus fréquent, le temps du trajet de son déplacement le plus fréquent et son niveau de sensibilité à la cause environnementale. Nous modélisons ici la probabilité qu’un individu déclare utiliser le plus fréquemment le vélo comme moyen de transport. Les variables explicatives sont résumées au tableau <a href="sect082.html#tab:binomdata">8.7</a>. Il existe bien évidemment un grand nombre de facteurs individuels qui influence la prise de décision sur le mode de transport. Les résultats de ce modèle ne doivent donc pas être pris avec un grand sérieux; il est uniquement construit à des fins pédagogiques, sans cadre conceptuel solide.</p>
<table>
<caption>
<span id="tab:binomdata">Tableau 8.7: </span>Variables indépendantes utilisées pour prédire le mode de transport le plus utilisé
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nom de la variable
</th>
<th style="text-align:left;">
Signification
</th>
<th style="text-align:left;">
Type de variable
</th>
<th style="text-align:left;">
Mesure
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Pays
</td>
<td style="text-align:left;">
Pays de résidence
</td>
<td style="text-align:left;">
Variable multinomiale
</td>
<td style="text-align:left;">
Le nom d’un des 26 pays membres de l’UE
</td>
</tr>
<tr>
<td style="text-align:left;">
Sexe
</td>
<td style="text-align:left;">
Sexe biologique
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Homme ou femme
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:left;">
Âge biologique
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
L’âge en nombre d’années variant de 16 à 84 ans dans le jeu de données
</td>
</tr>
<tr>
<td style="text-align:left;">
Education
</td>
<td style="text-align:left;">
Niveau d’éducation maximum atteint
</td>
<td style="text-align:left;">
Variable multinomiale
</td>
<td style="text-align:left;">
Premier cycle, secondaire inférieur (classes supérieures de l’école élémentaire), secondaire, troisième cycle
</td>
</tr>
<tr>
<td style="text-align:left;">
StatutEmploi
</td>
<td style="text-align:left;">
Employé ou non
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Employé ou non
</td>
</tr>
<tr>
<td style="text-align:left;">
Revenu
</td>
<td style="text-align:left;">
Niveau de revenu autodéclaré
</td>
<td style="text-align:left;">
Variable multinomiale
</td>
<td style="text-align:left;">
Très faible revenu, faible revenu, revenu moyen, revenu élevé, revenu très élevé, sans reponse
</td>
</tr>
<tr>
<td style="text-align:left;">
Residence
</td>
<td style="text-align:left;">
Lieu de résidence
</td>
<td style="text-align:left;">
Variable multinomiale
</td>
<td style="text-align:left;">
Zone rurale, petite ou moyenne ville (moins de 250 000 habitants), grande ville (entre 250 000 et 1 million d’habitants) , aire métropolitaine (plus d’un million d’habitants)
</td>
</tr>
<tr>
<td style="text-align:left;">
Duree
</td>
<td style="text-align:left;">
Durée du voyage le plus fréquent autodéclarée (en minutes)
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Nombre de minutes
</td>
</tr>
<tr>
<td style="text-align:left;">
ConsEnv
</td>
<td style="text-align:left;">
Préoccupation environnementale
</td>
<td style="text-align:left;">
Variable ordinale
</td>
<td style="text-align:left;">
Échelle de Likert de 1 à 10
</td>
</tr>
</tbody>
</table>
<p><strong>Vérification des conditions d’application</strong></p>
<p>La première étape de la vérification des conditions d’application est de calculer les valeurs du facteur d’inflation de variance (VIF) pour s’assurer de l’absence de multicolinéarité trop forte entre les variables indépendantes. L’ensemble des valeurs de VIF sont inférieures à 5, indiquant l’absence de multicolinéarité excessive dans le modèle.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="sect082.html#cb760-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb760-2"><a href="sect082.html#cb760-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb760-3"><a href="sect082.html#cb760-3" aria-hidden="true" tabindex="-1"></a>dfenquete <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/glm/enquete_transport_UE.csv&quot;</span>, <span class="at">encoding =</span> <span class="st">&#39;UTF-8&#39;</span>)</span>
<span id="cb760-4"><a href="sect082.html#cb760-4" aria-hidden="true" tabindex="-1"></a>dfenquete<span class="sc">$</span>Pays <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(dfenquete<span class="sc">$</span>Pays), <span class="at">ref =</span> <span class="st">&quot;Allemagne&quot;</span>)</span>
<span id="cb760-5"><a href="sect082.html#cb760-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification du VIF</span></span>
<span id="cb760-6"><a href="sect082.html#cb760-6" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span></span>
<span id="cb760-7"><a href="sect082.html#cb760-7" aria-hidden="true" tabindex="-1"></a>              Pays <span class="sc">+</span> Sexe <span class="sc">+</span> Age <span class="sc">+</span> Education <span class="sc">+</span> StatutEmploi <span class="sc">+</span> Revenu <span class="sc">+</span></span>
<span id="cb760-8"><a href="sect082.html#cb760-8" aria-hidden="true" tabindex="-1"></a>              Residence <span class="sc">+</span> Duree <span class="sc">+</span> ConsEnv,</span>
<span id="cb760-9"><a href="sect082.html#cb760-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb760-10"><a href="sect082.html#cb760-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dfenquete</span>
<span id="cb760-11"><a href="sect082.html#cb760-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb760-12"><a href="sect082.html#cb760-12" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model1)</span></code></pre></div>
<pre><code>##                  GVIF Df GVIF^(1/(2*Df))
## Pays         1.794797 27        1.010890
## Sexe         1.028618  1        1.014208
## Age          1.060256  1        1.029687
## Education    1.428872  3        1.061285
## StatutEmploi 1.151879  1        1.073256
## Revenu       1.220934  5        1.020162
## Residence    1.130526  3        1.020658
## Duree        1.042638  1        1.021096
## ConsEnv      1.090987  1        1.044503</code></pre>
<p>La seconde étape de vérification est le calcul des distances de Cook et l’identification d’éventuelles valeurs aberrantes (figure <a href="sect082.html#fig:cookdistGLMbinom">8.4</a>).</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="sect082.html#cb762-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul et représentation des distances de Cook</span></span>
<span id="cb762-2"><a href="sect082.html#cb762-2" aria-hidden="true" tabindex="-1"></a>cookd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb762-3"><a href="sect082.html#cb762-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist =</span> <span class="fu">cooks.distance</span>(model1),</span>
<span id="cb762-4"><a href="sect082.html#cb762-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">oid =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dfenquete)</span>
<span id="cb762-5"><a href="sect082.html#cb762-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb762-6"><a href="sect082.html#cb762-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cookd) <span class="sc">+</span> </span>
<span id="cb762-7"><a href="sect082.html#cb762-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> oid, <span class="at">y =</span> dist ), <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>), <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb762-8"><a href="sect082.html#cb762-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.002</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb762-9"><a href="sect082.html#cb762-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;observations&quot;</span>, <span class="at">y =</span> <span class="st">&quot;distance de Cook&quot;</span>) <span class="sc">+</span> </span>
<span id="cb762-10"><a href="sect082.html#cb762-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb762-11"><a href="sect082.html#cb762-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cookdistGLMbinom"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookdistGLMbinom-1.png" alt="Distances de Cook pour le modèle binomial avec toutes les observations" width="60%" />
<p class="caption">
Figure 8.4: Distances de Cook pour le modèle binomial avec toutes les observations
</p>
</div>
<p>Le calcul de la distance de Cook révèle un ensemble d’observations se démarquant nettement des autres (délimitées dans la figure <a href="sect082.html#fig:cookdistGLMbinom">8.4</a> par la ligne rouge). Nous les isolons dans un premier temps pour les analyser.</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="sect082.html#cb763-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Isoler les observations avec de très fortes valeurs de Cook</span></span>
<span id="cb763-2"><a href="sect082.html#cb763-2" aria-hidden="true" tabindex="-1"></a><span class="co"># valeur seuil choisie : 0,002</span></span>
<span id="cb763-3"><a href="sect082.html#cb763-3" aria-hidden="true" tabindex="-1"></a>cas_etranges <span class="ot">&lt;-</span> <span class="fu">subset</span>(dfenquete, cookd<span class="sc">$</span>dist<span class="sc">&gt;=</span><span class="fl">0.002</span>)</span>
<span id="cb763-4"><a href="sect082.html#cb763-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">nrow</span>(cas_etranges),<span class="st">&#39;observations se démarquant dans le modèle&#39;</span>)</span></code></pre></div>
<pre><code>## 19 observations se démarquant dans le modèle</code></pre>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="sect082.html#cb765-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cas_etranges)</span></code></pre></div>
<pre><code>##           X y       Pays  Sexe Age            Education Statut_emploi       Revenu
## 7660   7660 1  Slovaquie homme  50           universite      Employed        moyen
## 25150 25150 1      Malte homme  16           secondaire  Not Employed        moyen
## 25227 25227 1      Malte femme  53 secondaire inferieur  Not Employed        moyen
## 25309 25309 1      Malte femme  32           secondaire      Employed        moyen
## 25322 25322 1      Malte homme  38           universite      Employed        eleve
## 25536 25536 1      Malte homme  27           universite      Employed   tres eleve
## 25541 25541 1      Malte homme  38 secondaire inferieur      Employed        moyen
## 25549 25549 1      Malte homme  31           universite      Employed sans reponse
## 25690 25690 1 Luxembourg homme  32           universite      Employed   tres eleve
## 26190 26190 1     Chypre homme  24           secondaire  Not Employed        moyen
## 26201 26201 1     Chypre homme  25           secondaire      Employed       faible
## 26244 26244 1     Chypre homme  32           secondaire      Employed  tres faible
## 26269 26269 1     Chypre homme  60           secondaire  Not Employed        moyen
## 26303 26303 1     Chypre homme  59           secondaire  Not Employed        moyen
## 26393 26393 1     Chypre homme  30        premier cycle      Employed   tres eleve
## 26444 26444 1     Chypre femme  52           universite      Employed        eleve
## 26516 26516 1     Chypre homme  21           universite  Not Employed        moyen
## 26549 26549 1     Chypre homme  28           universite      Employed  tres faible
## 26600 26600 1     Chypre homme  36           secondaire      Employed        moyen
##                  Residence Duree mode_pref StatutEmploi ConsEnv
## 7660           zone rurale   775      velo      employe       7
## 25150          zone rurale    15      velo  sans emploi       3
## 25227          zone rurale    45    marche  sans emploi       5
## 25309 petite-moyenne ville    25    marche      employe       4
## 25322          zone rurale    30    marche      employe      10
## 25536 petite-moyenne ville    14      velo      employe      10
## 25541          zone rurale     5    marche      employe       8
## 25549 petite-moyenne ville    60      velo      employe      10
## 25690 petite-moyenne ville   720      velo      employe       6
## 26190         grande ville    20      velo  sans emploi       5
## 26201          zone rurale    20      velo      employe       5
## 26244 petite-moyenne ville    18      velo      employe       4
## 26269 petite-moyenne ville     5      velo  sans emploi       7
## 26303          zone rurale     7      velo  sans emploi       8
## 26393 petite-moyenne ville    61      velo      employe       5
## 26444 petite-moyenne ville   120      velo      employe       3
## 26516 petite-moyenne ville    25      velo  sans emploi       8
## 26549 petite-moyenne ville    15      velo      employe       2
## 26600 petite-moyenne ville     8      velo      employe       1</code></pre>
<p>À la lecture des valeurs pour ces 19 cas étranges, nous remarquons que la plupart des observations proviennent de Malte et de Chypre. Ces deux petites îles constituent des cas particuliers en Europe et devraient vraisemblablement faire l’objet d’une analyse séparée. Nous décidons donc de les retirer du jeu de données. Deux autres observations étranges sont observables en Slovaquie et au Luxembourg. Dans les deux cas, les répondants ont renseigné des temps de trajet fantaisistes de respectivement 775 et 720 minutes. Nous les retirons donc également de l’analyse.</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="sect082.html#cb767-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Retirer les observations aberrantes</span></span>
<span id="cb767-2"><a href="sect082.html#cb767-2" aria-hidden="true" tabindex="-1"></a>dfenquete2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(dfenquete, (dfenquete<span class="sc">$</span>Pays <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Malte&quot;</span>, <span class="st">&quot;Chypre&quot;</span>)) <span class="sc">==</span> F <span class="sc">&amp;</span> </span>
<span id="cb767-3"><a href="sect082.html#cb767-3" aria-hidden="true" tabindex="-1"></a>                  dfenquete<span class="sc">$</span>Duree <span class="sc">&lt;</span> <span class="dv">400</span>)</span>
<span id="cb767-4"><a href="sect082.html#cb767-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Réajuster le modèle</span></span>
<span id="cb767-5"><a href="sect082.html#cb767-5" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span></span>
<span id="cb767-6"><a href="sect082.html#cb767-6" aria-hidden="true" tabindex="-1"></a>              Pays <span class="sc">+</span> Sexe <span class="sc">+</span> Age <span class="sc">+</span> Education <span class="sc">+</span> StatutEmploi <span class="sc">+</span> Revenu <span class="sc">+</span></span>
<span id="cb767-7"><a href="sect082.html#cb767-7" aria-hidden="true" tabindex="-1"></a>              Residence <span class="sc">+</span> Duree <span class="sc">+</span> ConsEnv,</span>
<span id="cb767-8"><a href="sect082.html#cb767-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb767-9"><a href="sect082.html#cb767-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dfenquete2)</span>
<span id="cb767-10"><a href="sect082.html#cb767-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalculer la distance de Cook</span></span>
<span id="cb767-11"><a href="sect082.html#cb767-11" aria-hidden="true" tabindex="-1"></a>cookd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb767-12"><a href="sect082.html#cb767-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist =</span> <span class="fu">cooks.distance</span>(model2),</span>
<span id="cb767-13"><a href="sect082.html#cb767-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">oid =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dfenquete2)</span>
<span id="cb767-14"><a href="sect082.html#cb767-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb767-15"><a href="sect082.html#cb767-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cookd) <span class="sc">+</span> </span>
<span id="cb767-16"><a href="sect082.html#cb767-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> oid, <span class="at">y =</span> dist ), <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>), <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb767-17"><a href="sect082.html#cb767-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;observations&quot;</span>, <span class="at">y =</span> <span class="st">&quot;distance de Cook&quot;</span>) <span class="sc">+</span> </span>
<span id="cb767-18"><a href="sect082.html#cb767-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb767-19"><a href="sect082.html#cb767-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cookdistGLMbinom2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookdistGLMbinom2-1.png" alt="Distances de Cook pour le modèle binomial sans les valeurs aberrantes" width="60%" />
<p class="caption">
Figure 8.5: Distances de Cook pour le modèle binomial sans les valeurs aberrantes
</p>
</div>
<p>Après avoir retiré ces valeurs aberrantes, nous n’observons plus de nouveaux cas singuliers avec les distances de Cook (figure <a href="sect082.html#fig:cookdistGLMbinom2">8.5</a>).</p>
<p>La prochaine étape de vérification des conditions d’application est l’analyse des résidus simulés. Nous commençons donc par calculer ces résidus et afficher leur histogramme (figure <a href="sect082.html#fig:figresidsimbinomHistoUnif">8.6</a>).</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="sect082.html#cb768-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb768-2"><a href="sect082.html#cb768-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les probabilités prédites par le modèle</span></span>
<span id="cb768-3"><a href="sect082.html#cb768-3" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb768-4"><a href="sect082.html#cb768-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer 1000 simulations a partir du modele ajuste</span></span>
<span id="cb768-5"><a href="sect082.html#cb768-5" aria-hidden="true" tabindex="-1"></a>sims <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(probs), <span class="cf">function</span>(i){</span>
<span id="cb768-6"><a href="sect082.html#cb768-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> probs[[i]]</span>
<span id="cb768-7"><a href="sect082.html#cb768-7" aria-hidden="true" tabindex="-1"></a>  vals <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">1</span>,<span class="at">prob =</span> p)</span>
<span id="cb768-8"><a href="sect082.html#cb768-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb768-9"><a href="sect082.html#cb768-9" aria-hidden="true" tabindex="-1"></a>matsim <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,sims)</span>
<span id="cb768-10"><a href="sect082.html#cb768-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Utiliser le package DHARMa pour calculer les résidus simulés</span></span>
<span id="cb768-11"><a href="sect082.html#cb768-11" aria-hidden="true" tabindex="-1"></a>sim_res <span class="ot">&lt;-</span> <span class="fu">createDHARMa</span>(<span class="at">simulatedResponse =</span> matsim, </span>
<span id="cb768-12"><a href="sect082.html#cb768-12" aria-hidden="true" tabindex="-1"></a>                            <span class="at">observedResponse =</span> dfenquete2<span class="sc">$</span>y,</span>
<span id="cb768-13"><a href="sect082.html#cb768-13" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fittedPredictedResponse =</span> probs,</span>
<span id="cb768-14"><a href="sect082.html#cb768-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">integerResponse =</span> T)</span>
<span id="cb768-15"><a href="sect082.html#cb768-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb768-16"><a href="sect082.html#cb768-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">residuals</span>(sim_res)),</span>
<span id="cb768-17"><a href="sect082.html#cb768-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb768-18"><a href="sect082.html#cb768-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;résidus simulés&quot;</span>, <span class="at">y=</span><span class="st">&quot;fréquence&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figresidsimbinomHistoUnif"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/figresidsimbinomHistoUnif-1.png" alt="Distribution des résidus simulés pour le modèle binomial" width="60%" />
<p class="caption">
Figure 8.6: Distribution des résidus simulés pour le modèle binomial
</p>
</div>
<p>L’histogramme indique clairement que les résidus simulés suivent une distribution uniforme (figure <a href="sect082.html#fig:figresidsimbinomHistoUnif">8.6</a>). Il est possible d’aller plus loin dans le diagnostic en utilisant la fonction <code>plot</code> sur l’objet <code>sim_res</code>. La partie de droite de la figure ainsi obtenue (figure <a href="sect082.html#fig:figresidsimbinom">8.7</a>) est un diagramme de quantiles-quantiles (ou Q-Q plot). Les points du graphique sont supposés suivre une ligne droite matérialisée par la ligne rouge. Une déviation de cette ligne indique un éloignement des résidus de leur distribution attendue. Trois tests sont également réalisés par la fonction :</p>
<ul>
<li>Le premier (Test de Kolmogorov-Smirnov, <em>KS test</em>) permet de tester si les points dévient significativement de la ligne droite. Dans notre cas, la valeur de <em>p</em> n’est pas significative, indiquant que les résidus ne dévient pas de la distribution uniforme.</li>
<li>Le second test permet de vérifier la présence de sur ou sous-dispersion. Dans notre cas, ce test n’est pas significatif, n’indiquant aucun problème de sur-dispersion ou de sous-dispersion.</li>
<li>Le dernier test permet de vérifier si des valeurs aberrantes sont présentes dans les résidus. Une valeur non significative indique une absence de valeurs aberrantes.</li>
</ul>
<p>Le second graphique permet de comparer les résidus et les valeurs prédites. L’idéal est donc d’observer une ligne droite horizontale au milieu du graphique qui indiquerait une absence de relation entre les valeurs prédites et les résidus (ce que nous observons bien ici).</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="sect082.html#cb769-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figresidsimbinom"></span>
<img src="images/glm/figresidsimbinom.png" alt="Diagnostic des résidus simulés par le package DHARMa" width="80%" />
<p class="caption">
Figure 8.7: Diagnostic des résidus simulés par le package DHARMa
</p>
</div>
<p>L’analyse approfondie des résidus nous permet donc de conclure que le modèle respecte les conditions d’application et que nous pouvons passer à la vérification de la qualité d’ajustement du modèle.</p>
<p><strong>Vérification de la qualité d’ajustement</strong></p>
<p>Pour calculer les différents R<sup>2</sup> d’un modèle GLM, nous proposons la fonction suivante :</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="sect082.html#cb770-1" aria-hidden="true" tabindex="-1"></a>rsqs <span class="ot">&lt;-</span> <span class="cf">function</span>(loglike.full, loglike.null,full.deviance, null.deviance, nb.params, n){</span>
<span id="cb770-2"><a href="sect082.html#cb770-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calcul de la déviance expliquée</span></span>
<span id="cb770-3"><a href="sect082.html#cb770-3" aria-hidden="true" tabindex="-1"></a>  explained_dev <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(full.deviance <span class="sc">/</span> null.deviance)</span>
<span id="cb770-4"><a href="sect082.html#cb770-4" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">&lt;-</span> nb.params</span>
<span id="cb770-5"><a href="sect082.html#cb770-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># R2 de McFadden ajusté</span></span>
<span id="cb770-6"><a href="sect082.html#cb770-6" aria-hidden="true" tabindex="-1"></a>  r2_faddenadj <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span> (loglike.full <span class="sc">-</span> K) <span class="sc">/</span> loglike.null</span>
<span id="cb770-7"><a href="sect082.html#cb770-7" aria-hidden="true" tabindex="-1"></a>  Lm <span class="ot">&lt;-</span> loglike.full</span>
<span id="cb770-8"><a href="sect082.html#cb770-8" aria-hidden="true" tabindex="-1"></a>  Ln <span class="ot">&lt;-</span> loglike.null</span>
<span id="cb770-9"><a href="sect082.html#cb770-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># R2 de Cox and Snell</span></span>
<span id="cb770-10"><a href="sect082.html#cb770-10" aria-hidden="true" tabindex="-1"></a>  Rcs <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>((<span class="sc">-</span><span class="dv">2</span><span class="sc">/</span>n) <span class="sc">*</span> (Lm<span class="sc">-</span>Ln))</span>
<span id="cb770-11"><a href="sect082.html#cb770-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># R2 de Nagelkerke</span></span>
<span id="cb770-12"><a href="sect082.html#cb770-12" aria-hidden="true" tabindex="-1"></a>  Rn <span class="ot">&lt;-</span> Rcs <span class="sc">/</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>Ln<span class="sc">/</span>n))</span>
<span id="cb770-13"><a href="sect082.html#cb770-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb770-14"><a href="sect082.html#cb770-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="st">&quot;deviance expliquee&quot;</span> <span class="ot">=</span> explained_dev,</span>
<span id="cb770-15"><a href="sect082.html#cb770-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;McFadden ajuste&quot;</span> <span class="ot">=</span> r2_faddenadj,</span>
<span id="cb770-16"><a href="sect082.html#cb770-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Cox and Snell&quot;</span> <span class="ot">=</span> Rcs,</span>
<span id="cb770-17"><a href="sect082.html#cb770-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Nagelkerke&quot;</span> <span class="ot">=</span> Rn</span>
<span id="cb770-18"><a href="sect082.html#cb770-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb770-19"><a href="sect082.html#cb770-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb770-20"><a href="sect082.html#cb770-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Nous l’utilisons pour l’ensemble des modèles GLM de ce chapitre. Dans le cas du modèle binomial, nous obtenons :</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="sect082.html#cb771-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajuster un modele null avec seulement une constante</span></span>
<span id="cb771-2"><a href="sect082.html#cb771-2" aria-hidden="true" tabindex="-1"></a>model2.null <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span><span class="dv">1</span>,</span>
<span id="cb771-3"><a href="sect082.html#cb771-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb771-4"><a href="sect082.html#cb771-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dfenquete2)</span>
<span id="cb771-5"><a href="sect082.html#cb771-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les R2</span></span>
<span id="cb771-6"><a href="sect082.html#cb771-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rsqs</span>(<span class="at">loglike.full =</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(model2)), <span class="co"># loglikelihood du modèle complet</span></span>
<span id="cb771-7"><a href="sect082.html#cb771-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">loglike.null =</span> <span class="fu">as.numeric</span>(<span class="fu">logLik</span>(model2.null)), <span class="co"># loglikelihood du modèle nul</span></span>
<span id="cb771-8"><a href="sect082.html#cb771-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">full.deviance =</span> <span class="fu">deviance</span>(model2), <span class="co"># déviance du modèle complet</span></span>
<span id="cb771-9"><a href="sect082.html#cb771-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">null.deviance =</span> <span class="fu">deviance</span>(model2.null), <span class="co"># déviance du modèle nul</span></span>
<span id="cb771-10"><a href="sect082.html#cb771-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">nb.params =</span> model2<span class="sc">$</span>rank, <span class="co"># nombre de paramètres dans le modèle</span></span>
<span id="cb771-11"><a href="sect082.html#cb771-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">n =</span> <span class="fu">nrow</span>(dfenquete2) <span class="co"># nombre d&#39;observations</span></span>
<span id="cb771-12"><a href="sect082.html#cb771-12" aria-hidden="true" tabindex="-1"></a>     )</span></code></pre></div>
<pre><code>## $`deviance expliquee`
## [1] 0.0876057
## 
## $`McFadden ajuste`
## [1] 0.08357379
## 
## $`Cox and Snell`
## [1] 0.0689509
## 
## $Nagelkerke
## [1] 0.1236597</code></pre>
<p>La déviance expliquée par le modèle est de 8,8 %, les pseudos R<sup>2</sup> de McFadden (ajusté), d’Efron et de Nagelkerke sont respectivement 0,084, 0,069 et 0,124. Toutes ces valeurs sont relativement faibles et indiquent qu’une large partie de la variabilité de <em>Y</em> reste inexpliquée.</p>
<p>Pour vérifier la qualité de prédiction du modèle, nous devons comparer les catégories prédites et les catégories réelles de notre variable dépendante et construire une matrice de confusion. Cependant, un modèle GLM binomial prédit <strong>la probabilité d’appartenance au groupe 1</strong> (ici les personnes utilisant le vélo pour effectuer leur déplacement le plus fréquent). Pour convertir ces probabilités prédites en catégories prédites, il faut choisir un seuil de probabilité au-delà duquel nous considérons que la valeur attendue est 1 (cycliste) plutôt que 0 (autre). Un exemple naïf serait de prendre le seuil 0,5, ce qui signifierait que si le modèle prédit qu’une observation a au moins 50 % de chance d’être une personne à vélo, alors nous l’attribuons à cette catégorie. Cependant, cette méthode est rarement optimale; il est donc plus judicieux de fixer le seuil de probabilité en trouvant le point d’équilibre entre la sensibilité (proportion de 1 correctement identifiés) et la spécificité (proportion de 0 correctement identifiés). Ce point d’équilibre est identifiable graphiquement en calculant la spécificité et la sensibilité de la prédiction selon toutes les valeurs possibles du seuil.</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="sect082.html#cb773-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb773-2"><a href="sect082.html#cb773-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtention des prédictions du modèle</span></span>
<span id="cb773-3"><a href="sect082.html#cb773-3" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb773-4"><a href="sect082.html#cb773-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la sensibilité et de la spécificité (package ROCR)</span></span>
<span id="cb773-5"><a href="sect082.html#cb773-5" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">prediction</span>(prob, dfenquete2<span class="sc">$</span>y)</span>
<span id="cb773-6"><a href="sect082.html#cb773-6" aria-hidden="true" tabindex="-1"></a>sens <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">unlist</span>(ROCR<span class="sc">::</span><span class="fu">performance</span>(predictions, <span class="st">&quot;sens&quot;</span>)<span class="sc">@</span>x.values),</span>
<span id="cb773-7"><a href="sect082.html#cb773-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y=</span><span class="fu">unlist</span>(ROCR<span class="sc">::</span><span class="fu">performance</span>(predictions, <span class="st">&quot;sens&quot;</span>)<span class="sc">@</span>y.values))</span>
<span id="cb773-8"><a href="sect082.html#cb773-8" aria-hidden="true" tabindex="-1"></a>spec <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">unlist</span>(ROCR<span class="sc">::</span><span class="fu">performance</span>(predictions, <span class="st">&quot;spec&quot;</span>)<span class="sc">@</span>x.values),</span>
<span id="cb773-9"><a href="sect082.html#cb773-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y=</span><span class="fu">unlist</span>(ROCR<span class="sc">::</span><span class="fu">performance</span>(predictions, <span class="st">&quot;spec&quot;</span>)<span class="sc">@</span>y.values))</span>
<span id="cb773-10"><a href="sect082.html#cb773-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Trouver numériquement la valeur seuil (minimiser la différence absolue</span></span>
<span id="cb773-11"><a href="sect082.html#cb773-11" aria-hidden="true" tabindex="-1"></a><span class="co"># entre sensibilité et spécificité)</span></span>
<span id="cb773-12"><a href="sect082.html#cb773-12" aria-hidden="true" tabindex="-1"></a>real <span class="ot">&lt;-</span> dfenquete2<span class="sc">$</span>y</span>
<span id="cb773-13"><a href="sect082.html#cb773-13" aria-hidden="true" tabindex="-1"></a>find_cutoff <span class="ot">&lt;-</span> <span class="cf">function</span>(seuil){</span>
<span id="cb773-14"><a href="sect082.html#cb773-14" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(prob<span class="sc">&gt;</span>seuil,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb773-15"><a href="sect082.html#cb773-15" aria-hidden="true" tabindex="-1"></a>  sensi <span class="ot">&lt;-</span> <span class="fu">sum</span>(real<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> pred<span class="sc">==</span><span class="dv">1</span>) <span class="sc">/</span> <span class="fu">sum</span>(real<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb773-16"><a href="sect082.html#cb773-16" aria-hidden="true" tabindex="-1"></a>  spec <span class="ot">&lt;-</span> <span class="fu">sum</span>(real<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> pred<span class="sc">==</span><span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sum</span>(real<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb773-17"><a href="sect082.html#cb773-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">abs</span>(sensi<span class="sc">-</span>spec))</span>
<span id="cb773-18"><a href="sect082.html#cb773-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb773-19"><a href="sect082.html#cb773-19" aria-hidden="true" tabindex="-1"></a>prob_seuil <span class="ot">&lt;-</span> <span class="fu">optimize</span>(find_cutoff,<span class="at">interval =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">maximum =</span> F)<span class="sc">$</span>minimum</span>
<span id="cb773-20"><a href="sect082.html#cb773-20" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Le seuil de probabilité à retenir équilibrant&quot;</span>,</span>
<span id="cb773-21"><a href="sect082.html#cb773-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;la sensibilité et la spécificité est de&quot;</span>,prob_seuil)</span></code></pre></div>
<pre><code>## Le seuil de probabilité à retenir équilibrant la sensibilité et la spécificité est de 0.14785</code></pre>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="sect082.html#cb775-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage du graphique</span></span>
<span id="cb775-2"><a href="sect082.html#cb775-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb775-3"><a href="sect082.html#cb775-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> sens, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb775-4"><a href="sect082.html#cb775-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> spec, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x,<span class="at">y =</span> y,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb775-5"><a href="sect082.html#cb775-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">sec.axis =</span> <span class="fu">sec_axis</span>(<span class="sc">~</span>., <span class="at">name =</span> <span class="st">&quot;Spécificité&quot;</span>)) <span class="sc">+</span></span>
<span id="cb775-6"><a href="sect082.html#cb775-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Seuil de probabilité&#39;</span>, <span class="at">y=</span><span class="st">&quot;Sensibilité&quot;</span>) <span class="sc">+</span></span>
<span id="cb775-7"><a href="sect082.html#cb775-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> prob_seuil, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb775-8"><a href="sect082.html#cb775-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> prob_seuil, <span class="at">y =</span> <span class="fl">0.01</span>, <span class="at">label =</span> <span class="fu">round</span>(prob_seuil,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb775-9"><a href="sect082.html#cb775-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y.right =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>), <span class="at">legend.position=</span><span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:equlibresensispeci"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/equlibresensispeci-1.png" alt="Point d'équilibre entre sensibilité et spécificité" width="80%" />
<p class="caption">
Figure 8.8: Point d’équilibre entre sensibilité et spécificité
</p>
</div>
<p>Nous constatons à la figure <a href="sect082.html#fig:equlibresensispeci">8.8</a> que si la valeur du seuil est 0 %, alors la prédiction a une sensibilité parfaite (le modèle prédit toujours 1, donc tous les 1 sont détectés); à l’inverse, si le seuil choisi est 100 %, alors la prédiction à une spécificité parfaite (le modèle prédit toujours 0, donc tous les 0 sont détectés). Dans notre cas, la valeur d’équilibre est d’environ 0,148, donc si le modèle prédit une probabilité au moins égale à 14,8 % qu’un individu utilise le vélo pour son déplacement le plus fréquent, nous devons l’attribuer à la catégorie <em>cycliste</em>. Avec ce seuil, nous pouvons convertir les probabilités prédites en classes prédites et construire notre matrice de confusion.</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="sect082.html#cb776-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># pour la matrice de confusion</span></span>
<span id="cb776-2"><a href="sect082.html#cb776-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des catégories prédites</span></span>
<span id="cb776-3"><a href="sect082.html#cb776-3" aria-hidden="true" tabindex="-1"></a>ypred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">predict</span>(model2,<span class="at">type=</span><span class="st">&quot;response&quot;</span>)<span class="sc">&gt;</span><span class="fl">0.148</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb776-4"><a href="sect082.html#cb776-4" aria-hidden="true" tabindex="-1"></a>info <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(<span class="fu">as.factor</span>(dfenquete2<span class="sc">$</span>y), <span class="fu">as.factor</span>(ypred))</span>
<span id="cb776-5"><a href="sect082.html#cb776-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des valeurs brutes de la matrice de confusion</span></span>
<span id="cb776-6"><a href="sect082.html#cb776-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(info)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction     0     1
##          0 14355  7576
##          1  1251  2365
##                                           
##                Accuracy : 0.6545          
##                  95% CI : (0.6486, 0.6603)
##     No Information Rate : 0.6109          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.1783          
##                                           
##  Mcnemar&#39;s Test P-Value : &lt; 2.2e-16       
##                                           
##             Sensitivity : 0.9198          
##             Specificity : 0.2379          
##          Pos Pred Value : 0.6546          
##          Neg Pred Value : 0.6540          
##              Prevalence : 0.6109          
##          Detection Rate : 0.5619          
##    Detection Prevalence : 0.8585          
##       Balanced Accuracy : 0.5789          
##                                           
##        &#39;Positive&#39; Class : 0               
## </code></pre>
<p>Les résultats proposés par le <em>package</em> <code>caret</code> sont exhaustifs; nous vous proposons ici une façon de les présenter dans deux tableaux : l’un présente la matrice de confusion (tableau <a href="sect082.html#tab:confusmatbinom">8.8</a>) et l’autre, les indicateurs de qualité de prédiction (tableau <a href="sect082.html#tab:confusmatbinom2">8.9</a>).</p>
<table>
<caption>
<span id="tab:confusmatbinom">Tableau 8.8: </span>Matrice de confusion pour le modèle binomial
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
0 (réel)
</th>
<th style="text-align:right;">
1 (réel)
</th>
<th style="text-align:right;">
Total
</th>
<th style="text-align:right;">
%
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0 (prédit)
</td>
<td style="text-align:right;">
14355
</td>
<td style="text-align:right;">
7576
</td>
<td style="text-align:right;">
21931
</td>
<td style="text-align:right;">
85.8
</td>
</tr>
<tr>
<td style="text-align:left;">
1 (prédit)
</td>
<td style="text-align:right;">
1251
</td>
<td style="text-align:right;">
2365
</td>
<td style="text-align:right;">
3616
</td>
<td style="text-align:right;">
14.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Total
</td>
<td style="text-align:right;">
15606
</td>
<td style="text-align:right;">
9941
</td>
<td style="text-align:right;">
25547
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
%
</td>
<td style="text-align:right;">
61.1
</td>
<td style="text-align:right;">
38.9
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>D’après ces indicateurs, nous constatons que le modèle a une capacité de prédiction relativement faible, mais tout de même significativement supérieure au seuil de non-information. La valeur de rappel pour la catégorie 1 (cycliste) est faible, indiquant que le modèle a manqué un nombre important de cyclistes lors de sa prédiction.</p>
<table>
<caption>
<span id="tab:confusmatbinom2">Tableau 8.9: </span>Matrice de confusion pour le modèle binomial
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Précision
</th>
<th style="text-align:right;">
Rappel
</th>
<th style="text-align:right;">
F1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
0
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.76
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.35
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
macro
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.6
</td>
</tr>
<tr>
<td style="text-align:left;">
Kappa
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Valeur de p (précision &gt; NIR)
</td>
<td style="text-align:right;">
&lt; 0,0001
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p><strong>Interprétation des résultats du modèle</strong></p>
<p>L’interprétation des résultats d’un modèle binomial passe par la lecture des rapports de cotes (exponentiel des coefficients) et de leurs intervalles de confiance. Nous commençons donc par calculer la version robuste des erreurs standards des coefficients :</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="sect082.html#cb778-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich) <span class="co"># pour calculer les erreurs standards robustes</span></span>
<span id="cb778-2"><a href="sect082.html#cb778-2" aria-hidden="true" tabindex="-1"></a>covModel2 <span class="ot">&lt;-</span> <span class="fu">vcovHC</span>(model2, <span class="at">type =</span> <span class="st">&quot;HC0&quot;</span>) <span class="co"># méthode HC0, basée sur les résidus</span></span>
<span id="cb778-3"><a href="sect082.html#cb778-3" aria-hidden="true" tabindex="-1"></a>stdErrRobuste <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(covModel2)) <span class="co"># extraire la diagonale</span></span>
<span id="cb778-4"><a href="sect082.html#cb778-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des coefficients</span></span>
<span id="cb778-5"><a href="sect082.html#cb778-5" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> model2<span class="sc">$</span>coefficients</span>
<span id="cb778-6"><a href="sect082.html#cb778-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalcul des scores Z</span></span>
<span id="cb778-7"><a href="sect082.html#cb778-7" aria-hidden="true" tabindex="-1"></a>zvalRobuste <span class="ot">&lt;-</span> coeffs <span class="sc">/</span> stdErrRobuste</span>
<span id="cb778-8"><a href="sect082.html#cb778-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalcul des valeurs de P</span></span>
<span id="cb778-9"><a href="sect082.html#cb778-9" aria-hidden="true" tabindex="-1"></a>pvalRobuste <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(zvalRobuste), <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb778-10"><a href="sect082.html#cb778-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des rapports de cote</span></span>
<span id="cb778-11"><a href="sect082.html#cb778-11" aria-hidden="true" tabindex="-1"></a>oddRatio <span class="ot">&lt;-</span> <span class="fu">exp</span>(coeffs)</span>
<span id="cb778-12"><a href="sect082.html#cb778-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des intervalles de confiance à 95 % des rapports de cote</span></span>
<span id="cb778-13"><a href="sect082.html#cb778-13" aria-hidden="true" tabindex="-1"></a>lowerBound <span class="ot">&lt;-</span> <span class="fu">exp</span>(coeffs <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> stdErrRobuste)</span>
<span id="cb778-14"><a href="sect082.html#cb778-14" aria-hidden="true" tabindex="-1"></a>upperBound <span class="ot">&lt;-</span> <span class="fu">exp</span>(coeffs <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> stdErrRobuste)</span>
<span id="cb778-15"><a href="sect082.html#cb778-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Étoiles pour les valeurs de p</span></span>
<span id="cb778-16"><a href="sect082.html#cb778-16" aria-hidden="true" tabindex="-1"></a>starsp <span class="ot">&lt;-</span> <span class="fu">case_when</span>(pvalRobuste <span class="sc">&lt;=</span>  <span class="fl">0.001</span>  <span class="sc">~</span> <span class="st">&quot;***&quot;</span>,</span>
<span id="cb778-17"><a href="sect082.html#cb778-17" aria-hidden="true" tabindex="-1"></a>                    pvalRobuste <span class="sc">&gt;</span>  <span class="fl">0.001</span> <span class="sc">&amp;</span> pvalRobuste <span class="sc">&lt;=</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">&quot;**&quot;</span>,</span>
<span id="cb778-18"><a href="sect082.html#cb778-18" aria-hidden="true" tabindex="-1"></a>                    pvalRobuste <span class="sc">&gt;</span>  <span class="fl">0.01</span> <span class="sc">&amp;</span> pvalRobuste <span class="sc">&lt;=</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">&quot;*&quot;</span>,</span>
<span id="cb778-19"><a href="sect082.html#cb778-19" aria-hidden="true" tabindex="-1"></a>                    pvalRobuste <span class="sc">&gt;</span>  <span class="fl">0.05</span> <span class="sc">&amp;</span> pvalRobuste <span class="sc">&lt;=</span> <span class="fl">0.1</span> <span class="sc">~</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb778-20"><a href="sect082.html#cb778-20" aria-hidden="true" tabindex="-1"></a>                    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;&quot;</span></span>
<span id="cb778-21"><a href="sect082.html#cb778-21" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb778-22"><a href="sect082.html#cb778-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Compilation des résultats dans un tableau</span></span>
<span id="cb778-23"><a href="sect082.html#cb778-23" aria-hidden="true" tabindex="-1"></a>tableau_binom <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb778-24"><a href="sect082.html#cb778-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">coefficients =</span> coeffs,</span>
<span id="cb778-25"><a href="sect082.html#cb778-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">rap.cote =</span> oddRatio,</span>
<span id="cb778-26"><a href="sect082.html#cb778-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">err.std =</span> stdErrRobuste,</span>
<span id="cb778-27"><a href="sect082.html#cb778-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">score.z =</span> zvalRobuste,</span>
<span id="cb778-28"><a href="sect082.html#cb778-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.val =</span> pvalRobuste,</span>
<span id="cb778-29"><a href="sect082.html#cb778-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">rap.cote.2.5 =</span> lowerBound,</span>
<span id="cb778-30"><a href="sect082.html#cb778-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">rap.cote.97.5 =</span> upperBound,</span>
<span id="cb778-31"><a href="sect082.html#cb778-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">sign =</span> starsp</span>
<span id="cb778-32"><a href="sect082.html#cb778-32" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Considérant que la variable <em>Pays</em> a 24 modalités, il est plus judicieux de présenter ses 23 rapports de cotes sous forme d’un graphique. Nous avons choisi l’Allemagne comme catégorie de référence puisqu’elle fait partie des pays avec une importante part modale pour le vélo sans pour autant constituer un cas extrême comme le Danemark.</p>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="sect082.html#cb779-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Isoler les ligne du tableau récapitualtif pour les pays</span></span>
<span id="cb779-2"><a href="sect082.html#cb779-2" aria-hidden="true" tabindex="-1"></a>paysdf <span class="ot">&lt;-</span> <span class="fu">subset</span>(tableau_binom, <span class="fu">grepl</span>(<span class="st">&quot;Pays&quot;</span>,<span class="fu">row.names</span>(tableau_binom), <span class="at">fixed =</span> T))</span>
<span id="cb779-3"><a href="sect082.html#cb779-3" aria-hidden="true" tabindex="-1"></a><span class="co">#paysdf$Pays &lt;- gsub(&quot;Pays&quot;,&quot;&quot;,row.names(paysdf),fixed=T)</span></span>
<span id="cb779-4"><a href="sect082.html#cb779-4" aria-hidden="true" tabindex="-1"></a>paysdf<span class="sc">$</span>Pays <span class="ot">&lt;-</span> <span class="fu">substr</span>(<span class="fu">row.names</span>(paysdf), <span class="dv">5</span>, <span class="fu">nchar</span>(<span class="fu">row.names</span>(paysdf)))</span>
<span id="cb779-5"><a href="sect082.html#cb779-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> paysdf) <span class="sc">+</span></span>
<span id="cb779-6"><a href="sect082.html#cb779-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span> <span class="co">#afficher la valeur de référence</span></span>
<span id="cb779-7"><a href="sect082.html#cb779-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> rap.cote.<span class="fl">2.5</span>, <span class="at">xmax =</span> rap.cote.<span class="fl">97.5</span>, </span>
<span id="cb779-8"><a href="sect082.html#cb779-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">reorder</span>(Pays, rap.cote)), <span class="at">height =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb779-9"><a href="sect082.html#cb779-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> rap.cote, <span class="at">y =</span> <span class="fu">reorder</span>(Pays, rap.cote))) <span class="sc">+</span></span>
<span id="cb779-10"><a href="sect082.html#cb779-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> rap.cote.<span class="fl">97.5</span>, <span class="at">y =</span> <span class="fu">reorder</span>(Pays, rap.cote), </span>
<span id="cb779-11"><a href="sect082.html#cb779-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;RC : &quot;</span>,<span class="fu">round</span>(rap.cote,<span class="dv">2</span>),<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb779-12"><a href="sect082.html#cb779-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">3</span>, <span class="at">nudge_x =</span> <span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb779-13"><a href="sect082.html#cb779-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Rapports de cote&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Pays (référence : Allemagne)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figpaysbinom"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/figpaysbinom-1.png" alt="Rapports de cote pour les différents pays de l'UE" width="80%" />
<p class="caption">
Figure 8.9: Rapports de cote pour les différents pays de l’UE
</p>
</div>
<p>Dans la figure <a href="sect082.html#fig:figpaysbinom">8.9</a>, la barre horizontale pour chaque pays représente l’intervalle de confiance de son rapport de cotes (le point); plus cette ligne est longue, plus grande est l’incertitude autour de ce paramètre. Lorsque les lignes de deux pays se chevauchent, cela signifie qu’il n’y a pas de différence significative au seuil 0,05 entre les rapports de cotes des deux pays. La ligne rouge tracée à x = 1, représente le rapport de cotes du pays de référence (ici l’Allemagne). Nous constatons ainsi que comparativement à un individu vivant en Allemagne, ceux vivant au Danemark et aux Pays-Bas ont 2,4 fois plus de chances d’utiliser le vélo pour leur déplacement le plus fréquent. Les Pays de l’Ouest (France, Luxembourg, Royaume-Uni, Irlande) et du Sud (Grèce, Italie, Espagne, Portugal) ont en revanche des rapports de cotes plus faibles. En France, les chances qu’un individu utilise le vélo pour son trajet le plus fréquent sont 3,22 (1/0,31) fois plus faibles que si l’individu vivait en Allemagne.</p>
<p>Pour le reste des coefficients et des rapports de cotes, nous les rapportons dans le tableau <a href="sect082.html#tab:tablcoeffbinom">8.10</a>.</p>
<table>
<caption>
<span id="tab:tablcoeffbinom">Tableau 8.10: </span>Résultats du modèle binomial
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coefficient
</th>
<th style="text-align:right;">
Rapport de cote
</th>
<th style="text-align:right;">
Err.std
</th>
<th style="text-align:right;">
Val.z
</th>
<th style="text-align:right;">
P
</th>
<th style="text-align:right;">
RC 2,5 %
</th>
<th style="text-align:right;">
RC 97,5 %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Constante
</td>
<td style="text-align:right;">
-2,497
</td>
<td style="text-align:right;">
0,082
</td>
<td style="text-align:right;">
0,183
</td>
<td style="text-align:right;">
-13,674
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,058
</td>
<td style="text-align:right;">
0,118
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Sexe</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : femme
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
homme
</td>
<td style="text-align:right;">
0,372
</td>
<td style="text-align:right;">
1,451
</td>
<td style="text-align:right;">
0,038
</td>
<td style="text-align:right;">
9,803
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,347
</td>
<td style="text-align:right;">
1,562
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
-0,009
</td>
<td style="text-align:right;">
0,991
</td>
<td style="text-align:right;">
0,002
</td>
<td style="text-align:right;">
-5,361
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,988
</td>
<td style="text-align:right;">
0,994
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Education</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : premier cycle
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
secondaire
</td>
<td style="text-align:right;">
0,193
</td>
<td style="text-align:right;">
1,213
</td>
<td style="text-align:right;">
0,105
</td>
<td style="text-align:right;">
1,836
</td>
<td style="text-align:right;">
0,066
</td>
<td style="text-align:right;">
0,987
</td>
<td style="text-align:right;">
1,490
</td>
</tr>
<tr>
<td style="text-align:left;">
secondaire inferieur
</td>
<td style="text-align:right;">
0,301
</td>
<td style="text-align:right;">
1,351
</td>
<td style="text-align:right;">
0,114
</td>
<td style="text-align:right;">
2,649
</td>
<td style="text-align:right;">
0,008
</td>
<td style="text-align:right;">
1,081
</td>
<td style="text-align:right;">
1,687
</td>
</tr>
<tr>
<td style="text-align:left;">
universite
</td>
<td style="text-align:right;">
0,146
</td>
<td style="text-align:right;">
1,157
</td>
<td style="text-align:right;">
0,108
</td>
<td style="text-align:right;">
1,349
</td>
<td style="text-align:right;">
0,177
</td>
<td style="text-align:right;">
0,936
</td>
<td style="text-align:right;">
1,432
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>StatutEmploi</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : employe
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
sans emploi
</td>
<td style="text-align:right;">
0,257
</td>
<td style="text-align:right;">
1,293
</td>
<td style="text-align:right;">
0,043
</td>
<td style="text-align:right;">
6,045
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,190
</td>
<td style="text-align:right;">
1,405
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Revenu</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : eleve
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
faible
</td>
<td style="text-align:right;">
0,077
</td>
<td style="text-align:right;">
1,080
</td>
<td style="text-align:right;">
0,072
</td>
<td style="text-align:right;">
1,067
</td>
<td style="text-align:right;">
0,286
</td>
<td style="text-align:right;">
0,938
</td>
<td style="text-align:right;">
1,244
</td>
</tr>
<tr>
<td style="text-align:left;">
moyen
</td>
<td style="text-align:right;">
0,042
</td>
<td style="text-align:right;">
1,043
</td>
<td style="text-align:right;">
0,065
</td>
<td style="text-align:right;">
0,639
</td>
<td style="text-align:right;">
0,523
</td>
<td style="text-align:right;">
0,917
</td>
<td style="text-align:right;">
1,185
</td>
</tr>
<tr>
<td style="text-align:left;">
sans reponse
</td>
<td style="text-align:right;">
0,217
</td>
<td style="text-align:right;">
1,242
</td>
<td style="text-align:right;">
0,102
</td>
<td style="text-align:right;">
2,120
</td>
<td style="text-align:right;">
0,034
</td>
<td style="text-align:right;">
1,016
</td>
<td style="text-align:right;">
1,517
</td>
</tr>
<tr>
<td style="text-align:left;">
tres eleve
</td>
<td style="text-align:right;">
-0,120
</td>
<td style="text-align:right;">
0,887
</td>
<td style="text-align:right;">
0,188
</td>
<td style="text-align:right;">
-0,637
</td>
<td style="text-align:right;">
0,524
</td>
<td style="text-align:right;">
0,613
</td>
<td style="text-align:right;">
1,283
</td>
</tr>
<tr>
<td style="text-align:left;">
tres faible
</td>
<td style="text-align:right;">
0,240
</td>
<td style="text-align:right;">
1,271
</td>
<td style="text-align:right;">
0,086
</td>
<td style="text-align:right;">
2,776
</td>
<td style="text-align:right;">
0,006
</td>
<td style="text-align:right;">
1,073
</td>
<td style="text-align:right;">
1,505
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Residence</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : aire metropolitaine
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
grande ville
</td>
<td style="text-align:right;">
0,273
</td>
<td style="text-align:right;">
1,314
</td>
<td style="text-align:right;">
0,070
</td>
<td style="text-align:right;">
3,911
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,146
</td>
<td style="text-align:right;">
1,507
</td>
</tr>
<tr>
<td style="text-align:left;">
petite-moyenne ville
</td>
<td style="text-align:right;">
0,277
</td>
<td style="text-align:right;">
1,319
</td>
<td style="text-align:right;">
0,061
</td>
<td style="text-align:right;">
4,503
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,169
</td>
<td style="text-align:right;">
1,487
</td>
</tr>
<tr>
<td style="text-align:left;">
zone rurale
</td>
<td style="text-align:right;">
-0,119
</td>
<td style="text-align:right;">
0,888
</td>
<td style="text-align:right;">
0,069
</td>
<td style="text-align:right;">
-1,713
</td>
<td style="text-align:right;">
0,087
</td>
<td style="text-align:right;">
0,775
</td>
<td style="text-align:right;">
1,017
</td>
</tr>
<tr>
<td style="text-align:left;">
Duree
</td>
<td style="text-align:right;">
-0,001
</td>
<td style="text-align:right;">
0,999
</td>
<td style="text-align:right;">
0,001
</td>
<td style="text-align:right;">
-0,981
</td>
<td style="text-align:right;">
0,326
</td>
<td style="text-align:right;">
0,998
</td>
<td style="text-align:right;">
1,001
</td>
</tr>
<tr>
<td style="text-align:left;">
ConsEnv
</td>
<td style="text-align:right;">
0,102
</td>
<td style="text-align:right;">
1,108
</td>
<td style="text-align:right;">
0,010
</td>
<td style="text-align:right;">
10,502
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,087
</td>
<td style="text-align:right;">
1,130
</td>
</tr>
</tbody>
</table>
<p>Les chances pour un individu d’utiliser le vélo pour son trajet le plus fréquent sont augmentées de 45 % s’il s’agit d’un homme plutôt qu’une femme. Pour l’âge, nous constatons un effet relativement faible puisque chaque année supplémentaire réduit les chances qu’un individu utilise le vélo comme mode de transport pour son trajet le plus fréquent de 0,9 % <span class="math inline">\(((\mbox{0,991}-\mbox{1})\times\mbox{100})\)</span>. Le fait d’être sans emploi augmente les chances d’utiliser le vélo de 29 % comparativement au fait d’avoir un emploi. Concernant le niveau d’éducation, seul le coefficient pour le groupe des personnes de la catégorie « secondaire inférieure » est significatif, indiquant que les personnes de ce groupe ont 35 % de chances en plus d’utiliser le vélo comme mode de transport pour leur déplacement le plus fréquent comparativement aux personnes de la catégorie « premier cycle ». Pour le revenu, seul le groupe avec de très faibles revenus se distingue significativement du groupe avec un revenu élevé avec un rapport de cotes de 1,27, soit 27 % de chances en plus d’utiliser le vélo.</p>
<p>Comparativement à ceux vivant dans une aire métropolitaine, les personnes vivant dans de petites, moyennes et grandes villes ont des chances accrues d’utiliser le vélo comme mode de déplacement pour leur trajet le plus fréquent. En revanche, nous n’observons aucune différence entre la probabilité d’utiliser le vélo dans une métropole et en zone rurale. La figure <a href="sect082.html#fig:figvillebinom">8.10</a> permet de clairement visualiser cette situation. Rappelons que la référence est la situation : vivre dans une région métropolitaine, représentée par la ligne verticale rouge. Plusieurs pistes d’interprétation peuvent être envisagées pour ce résultat :</p>
<ul>
<li>En métropole et dans les zones rurales, les distances domicile-travail tendent à être plus grandes que dans les petites, moyennes et grandes villes.</li>
<li>En métropole, le système de transport en commun est davantage développé et entre donc en concurrence avec les modes de transport actifs.</li>
</ul>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="sect082.html#cb780-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Isoler les lignes du tableau récapitualtif pour les lieux de résidence</span></span>
<span id="cb780-2"><a href="sect082.html#cb780-2" aria-hidden="true" tabindex="-1"></a>residdf <span class="ot">&lt;-</span> <span class="fu">subset</span>(tableau_binom, <span class="fu">grepl</span>(<span class="st">&quot;Residence&quot;</span>,<span class="fu">row.names</span>(tableau_binom), <span class="at">fixed =</span> T))</span>
<span id="cb780-3"><a href="sect082.html#cb780-3" aria-hidden="true" tabindex="-1"></a>residdf<span class="sc">$</span>resid <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">&quot;Residence&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="fu">row.names</span>(residdf),<span class="at">fixed=</span>T)</span>
<span id="cb780-4"><a href="sect082.html#cb780-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> residdf) <span class="sc">+</span></span>
<span id="cb780-5"><a href="sect082.html#cb780-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span> <span class="co">#afficher la valeur de référence</span></span>
<span id="cb780-6"><a href="sect082.html#cb780-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> rap.cote.<span class="fl">2.5</span>, <span class="at">xmax =</span> rap.cote.<span class="fl">97.5</span>, <span class="at">y =</span> resid), <span class="at">height =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb780-7"><a href="sect082.html#cb780-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> rap.cote, <span class="at">y =</span> resid)) <span class="sc">+</span></span>
<span id="cb780-8"><a href="sect082.html#cb780-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> rap.cote.<span class="fl">97.5</span>, <span class="at">y =</span> resid, </span>
<span id="cb780-9"><a href="sect082.html#cb780-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;RC : &quot;</span>,<span class="fu">round</span>(rap.cote,<span class="dv">2</span>),<span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb780-10"><a href="sect082.html#cb780-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">3</span>, <span class="at">nudge_x =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb780-11"><a href="sect082.html#cb780-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Rapports de cotes&quot;</span>,</span>
<span id="cb780-12"><a href="sect082.html#cb780-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Lieu de résidence (référence : aire métropolitaine)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figvillebinom"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/figvillebinom-1.png" alt="Rapports de cote pour les différents lieux de résidence" width="85%" />
<p class="caption">
Figure 8.10: Rapports de cote pour les différents lieux de résidence
</p>
</div>
<p>Il est aussi intéressant de noter que la durée des trajets ne semble pas influencer la probabilité d’utiliser le vélo. Enfin, une conscience environnementale plus affirmée semble être associée avec une probabilité supérieure d’utiliser le vélo pour son déplacement le plus fréquent, avec une augmentation des chances de 11 % pour chaque point supplémentaire sur l’échelle de Likert.</p>
<p>Afin de simplifier la présentation de certains résultats, il est possible de calculer exactement les prédictions réalisées par le modèle. Un bon exemple ici est le cas de la variable <em>âge</em>. À quelle différence pouvons-nous nous attendre entre deux individus identiques ayant seulement une différence d’âge de 15 ans?</p>
<p>Prenons comme individu un homme de 30 ans, vivant dans une grande ville allemande, ayant un niveau d’éducation de niveau secondaire, employé, dans la tranche de revenu moyen, déclarant effectuer un trajet de 45 minutes et ayant rapporté un niveau de conscience environnementale de 5 (sur 10). Nous pouvons prédire la probabilité qu’il utilise le vélo pour son trajet le plus fréquent en utilisant la formule suivante :</p>
<p><span class="math inline">\(logit(p) = -\mbox{2,497} + \mbox{1} \times \mbox{0,372} + \mbox{30} \times -\mbox{0,009} + \mbox{1} \times \mbox{0,193} + \mbox{1} \times \mbox{0,042} + \mbox{1} \times \mbox{0,273} + \mbox{45} \times -\mbox{0,001} + \mbox{5} \times \mbox{0,102}\)</span></p>
<p><span class="math inline">\(p = exp(-\mbox{2,497} + \mbox{1} \times \mbox{0,372} + \mbox{30} \times -\mbox{0,009} + \mbox{1} \times \mbox{0,193} + \mbox{1} \times \mbox{0,042} + 1 \times \mbox{0,273} + 45 \times -\mbox{0,001} + \mbox{5} \times \mbox{0,102})/(\mbox{1}+exp(-\mbox{2,497} + 1 \times \mbox{0,372} + \mbox{30} \times-\mbox{0,009} + 1 \times \mbox{0,193} + 1 \times \mbox{0,042} + \mbox{1} \times \mbox{0,273} + \mbox{45} \times -\mbox{0,001} + 5 \times \mbox{0,102})) = \mbox{0,194}\)</span></p>
<p>Il y aurait 19,4 % de chances pour que cette personne soit cycliste. Comme cette probabilité dépasse le seuil que nous avons sélectionné, cette personne serait classée comme cycliste. Si nous augmentons son âge de 15 ans, nous obtenons :</p>
<p><span class="math inline">\(p = exp(-\mbox{2,497} + \mbox{1} \times \mbox{0,372} + \mbox{45} \times \mbox{-0,009} + \mbox{1} \times \mbox{0,193} + \mbox{1} \times \mbox{0,042} + \mbox{1} \times \mbox{0,273} + \mbox{45} \times -\mbox{0,001} + \mbox{5} \times \mbox{0,102}) / (\mbox{1}+exp(-\mbox{2,497} + \mbox{1} \times \mbox{0,372} + \mbox{45} \times -\mbox{0,009} + \mbox{1} \times \mbox{0,193} + \mbox{1} \times \mbox{0,042} + \mbox{1} \times \mbox{0,273} + \mbox{45} \times -\mbox{0,001} + \mbox{5} \times \mbox{0,102})) = \mbox{0,174}\)</span></p>
<p>soit une réduction de 2 points de pourcentages. Il est également possible de représenter cette évolution sur un graphique pour montrer l’effet sur l’étendue des valeurs possibles. Sur ces graphiques des effets marginaux, il est essentiel de représenter l’incertitude quant à la prédiction. En temps normal, la fonction <code>predict</code> calcule directement l’erreur standard de la prédiction et cette dernière peut être utilisée pour calculer l’intervalle de confiance de la prédiction. Cependant, nous voulons ici utiliser nos erreurs standards robustes. Nous devons donc procéder par simulation pour déterminer l’intervalle de confiance à 95 % de nos prédictions. Cette opération nécessite de réaliser plusieurs opérations manuellement dans R.</p>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="sect082.html#cb781-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer un jeu de données fictif pour la prédiction</span></span>
<span id="cb781-2"><a href="sect082.html#cb781-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(model2<span class="sc">$</span>terms, model2<span class="sc">$</span>model)</span>
<span id="cb781-3"><a href="sect082.html#cb781-3" aria-hidden="true" tabindex="-1"></a>age2seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>)</span>
<span id="cb781-4"><a href="sect082.html#cb781-4" aria-hidden="true" tabindex="-1"></a>mat2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(mat[<span class="dv">1</span>,], <span class="at">nrow=</span><span class="fu">length</span>(age2seq), <span class="at">ncol=</span><span class="fu">length</span>(mat[<span class="dv">1</span>,]), <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb781-5"><a href="sect082.html#cb781-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mat2) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(mat)</span>
<span id="cb781-6"><a href="sect082.html#cb781-6" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;Age&quot;</span>] <span class="ot">&lt;-</span> age2seq</span>
<span id="cb781-7"><a href="sect082.html#cb781-7" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;PaysBelgique&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb781-8"><a href="sect082.html#cb781-8" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;Duree&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">45</span></span>
<span id="cb781-9"><a href="sect082.html#cb781-9" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;ConsEnv&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb781-10"><a href="sect082.html#cb781-10" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;StatutEmploisans emploi&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb781-11"><a href="sect082.html#cb781-11" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;Residencegrande ville&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb781-12"><a href="sect082.html#cb781-12" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;Educationsecondaire&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb781-13"><a href="sect082.html#cb781-13" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;Sexehomme&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb781-14"><a href="sect082.html#cb781-14" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;Revenumoyen&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb781-15"><a href="sect082.html#cb781-15" aria-hidden="true" tabindex="-1"></a>mat2[,<span class="st">&quot;Revenufaible&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb781-16"><a href="sect082.html#cb781-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer la prédiction comme un log de rapport de cote (avec les erreurs standards)</span></span>
<span id="cb781-17"><a href="sect082.html#cb781-17" aria-hidden="true" tabindex="-1"></a><span class="co"># en multipliant les coefficient par les valeurs des données fictives</span></span>
<span id="cb781-18"><a href="sect082.html#cb781-18" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> model2<span class="sc">$</span>coefficients</span>
<span id="cb781-19"><a href="sect082.html#cb781-19" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> coeffs <span class="sc">%*%</span> <span class="fu">t</span>(mat2)</span>
<span id="cb781-20"><a href="sect082.html#cb781-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation de prédictions (toujours en log de rapport de cote)</span></span>
<span id="cb781-21"><a href="sect082.html#cb781-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 1 : simuler 1000 valeurs pour chaque coefficient</span></span>
<span id="cb781-22"><a href="sect082.html#cb781-22" aria-hidden="true" tabindex="-1"></a>sim_coeffs <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(coeffs), <span class="cf">function</span>(i){</span>
<span id="cb781-23"><a href="sect082.html#cb781-23" aria-hidden="true" tabindex="-1"></a>  coef <span class="ot">&lt;-</span> coeffs[[i]]</span>
<span id="cb781-24"><a href="sect082.html#cb781-24" aria-hidden="true" tabindex="-1"></a>  std.err <span class="ot">&lt;-</span> stdErrRobuste[[i]]</span>
<span id="cb781-25"><a href="sect082.html#cb781-25" aria-hidden="true" tabindex="-1"></a>  vals <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> coef, <span class="at">sd =</span> std.err)</span>
<span id="cb781-26"><a href="sect082.html#cb781-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(vals)</span>
<span id="cb781-27"><a href="sect082.html#cb781-27" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb781-28"><a href="sect082.html#cb781-28" aria-hidden="true" tabindex="-1"></a>mat_sim_coeffs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind,sim_coeffs)</span>
<span id="cb781-29"><a href="sect082.html#cb781-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 2 : effectuer les prédictions à partir des coefficients simulés</span></span>
<span id="cb781-30"><a href="sect082.html#cb781-30" aria-hidden="true" tabindex="-1"></a>sim_preds <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(mat_sim_coeffs),<span class="cf">function</span>(i){</span>
<span id="cb781-31"><a href="sect082.html#cb781-31" aria-hidden="true" tabindex="-1"></a>  temp_coefs <span class="ot">&lt;-</span> mat_sim_coeffs[,i]</span>
<span id="cb781-32"><a href="sect082.html#cb781-32" aria-hidden="true" tabindex="-1"></a>  temp_pred <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(temp_coefs <span class="sc">%*%</span> <span class="fu">t</span>(mat2))</span>
<span id="cb781-33"><a href="sect082.html#cb781-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(temp_pred)</span>
<span id="cb781-34"><a href="sect082.html#cb781-34" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb781-35"><a href="sect082.html#cb781-35" aria-hidden="true" tabindex="-1"></a>mat_sim_preds <span class="ot">&lt;-</span> <span class="fu">do.call</span>(cbind,sim_preds)</span>
<span id="cb781-36"><a href="sect082.html#cb781-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 3 : extraire les intervalles de confiances pour les simulations</span></span>
<span id="cb781-37"><a href="sect082.html#cb781-37" aria-hidden="true" tabindex="-1"></a>intervals <span class="ot">&lt;-</span> <span class="fu">apply</span>(mat_sim_preds,<span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> <span class="cf">function</span>(vec){</span>
<span id="cb781-38"><a href="sect082.html#cb781-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">quantile</span>(vec,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span>
<span id="cb781-39"><a href="sect082.html#cb781-39" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb781-40"><a href="sect082.html#cb781-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 4 : récupérer tous ces éléments dans un DataFrame</span></span>
<span id="cb781-41"><a href="sect082.html#cb781-41" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb781-42"><a href="sect082.html#cb781-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> <span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">80</span>),</span>
<span id="cb781-43"><a href="sect082.html#cb781-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">pred =</span> <span class="fu">as.vector</span>(pred),</span>
<span id="cb781-44"><a href="sect082.html#cb781-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">as.vector</span>(intervals[<span class="dv">1</span>,]),</span>
<span id="cb781-45"><a href="sect082.html#cb781-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">as.vector</span>(intervals[<span class="dv">2</span>,])</span>
<span id="cb781-46"><a href="sect082.html#cb781-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb781-47"><a href="sect082.html#cb781-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 5 : appliquer l&#39;inverse de la fonction de lien pour</span></span>
<span id="cb781-48"><a href="sect082.html#cb781-48" aria-hidden="true" tabindex="-1"></a><span class="co"># obtenir les prédictions en termes de probabilité</span></span>
<span id="cb781-49"><a href="sect082.html#cb781-49" aria-hidden="true" tabindex="-1"></a>ilink <span class="ot">&lt;-</span> <span class="fu">family</span>(model2)<span class="sc">$</span>linkinv</span>
<span id="cb781-50"><a href="sect082.html#cb781-50" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>prob_pred <span class="ot">&lt;-</span> <span class="fu">ilink</span>(df<span class="sc">$</span>pred)</span>
<span id="cb781-51"><a href="sect082.html#cb781-51" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>prob_lower <span class="ot">&lt;-</span> <span class="fu">ilink</span>(df<span class="sc">$</span>lower)</span>
<span id="cb781-52"><a href="sect082.html#cb781-52" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>prob_upper <span class="ot">&lt;-</span> <span class="fu">ilink</span>(df<span class="sc">$</span>upper)</span>
<span id="cb781-53"><a href="sect082.html#cb781-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 6 : représenter le tout sur un graphique</span></span>
<span id="cb781-54"><a href="sect082.html#cb781-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb781-55"><a href="sect082.html#cb781-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">ymax =</span> prob_upper, <span class="at">ymin =</span> prob_lower), </span>
<span id="cb781-56"><a href="sect082.html#cb781-56" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>)) <span class="sc">+</span> </span>
<span id="cb781-57"><a href="sect082.html#cb781-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> Age, <span class="at">y =</span> prob_pred), <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb781-58"><a href="sect082.html#cb781-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.15</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb781-59"><a href="sect082.html#cb781-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Âge&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Probabilité prédite (intervalle de confiance à 95 %)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figagebinom"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/figagebinom-1.png" alt="Effet de l'âge sur la probabilité d'utiliser le vélo comme moyen de déplacement pour son trajet le plus fréquent" width="65%" />
<p class="caption">
Figure 8.11: Effet de l’âge sur la probabilité d’utiliser le vélo comme moyen de déplacement pour son trajet le plus fréquent
</p>
</div>
<p>La figure <a href="sect082.html#fig:figagebinom">8.11</a> permet de bien constater la diminution de la probabilité d’utiliser le vélo pour son trajet le plus fréquent avec l’âge, mais cette réduction est relativement ténue. Dans le cas utilisé en exemple, l’individu ne serait plus classé cycliste qu’après 67 ans.</p>
</div>
</div>
<div id="sect0822" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Modèle probit binomial<a href="sect082.html#sect0822" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le modèle GLM probit binomial est pour ainsi dire le frère du modèle logistique binomial. La seule différence entre les deux réside dans l’utilisation d’une autre fonction de lien: probit plutôt que logistique. La fonction de lien probit (Φ) correspond à la fonction cumulative de la distribution normale et a également une forme de <em>S</em>. Cette version du modèle est plus souvent utilisée par les économistes. Le principal changement réside dans l’interprétation des coefficients <span class="math inline">\(\beta_0\)</span> et <span class="math inline">\(\beta\)</span>. Du fait de la transformation probit, ces derniers indiquent le changement en termes de scores Z de la probabilité modélisée. Vous conviendrez qu’il ne s’agit pas d’une échelle très intuitive; la plupart du temps, seuls la significativité et le signe (positif ou négatif) des coefficients sont interprétés.</p>
<table>
<caption>
<span id="tab:probitdentity">Tableau 8.11: </span>Carte d’identité du modèle probit binomial
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable binaire (0 ou 1) ou comptage de réussite à une expérience (ex : 3 réussites sur 5 expériences)
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Binomiale
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim Binomial(p)\)</span> <br/> <span class="math inline">\(g(p) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(g(x) = \Phi^-1(x)\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
probit
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
p
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Non-séparation complète, absence de sur-dispersion ou de sous-dispersion
</td>
</tr>
</tbody>
</table>
</div>
<div id="sect0823" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Modèle logistique des cotes proportionnelles<a href="sect082.html#sect0823" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le modèle logistique des cotes proportionnelles (aussi appelé modèle logistique cumulatif) est utilisé pour modéliser une variable qualitative ordinale. Un exemple classique de ce type de variable est une échelle de satisfaction (très insatisfait, insatisfait, mitigé, satisfait, très satisfait) qui peut être recodée avec des valeurs numériques (0, 1, 2, 3, 4; ces échelons étant notés <em>j</em>). Il n’existe pas à proprement parler de distribution pour représenter ces données, mais avec une petite astuce, il est possible de simplement utiliser la distribution binomiale. Cette astuce consiste à poser l’hypothèse de la proportionnalité des cotes, soit que le passage de la catégorie 0 à la catégorie 1 est proportionnel au passage de la catégorie 1 à la catégorie 2 et ainsi de suite. Si cette hypothèse est respectée, alors les coefficients du modèle pourront autant décrire le passage de la catégorie <em>satisfait</em> à celle <em>très satisfait</em> que le passage de <em>insatisfait</em> à <em>mitigé</em>. Si cette hypothèse n’est pas respectée, il faudrait des coefficients différents pour représenter les passages d’une catégorie à l’autre (ce qui est le cas pour le modèle multinomial présenté dans la section <a href="sect082.html#sect0824">8.2.4</a>).</p>
<table>
<caption>
<span id="tab:cumuldentity">Tableau 8.12: </span>Carte d’identité du modèle logistique des cotes proportionnelles
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable qualitative ordinale avec <em>j</em> catégories
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Binomiale
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim Binomial(p)\)</span> <br/> <span class="math inline">\(g(p \leq j) = \beta_{0j} + \beta X\)</span> <br/> <span class="math inline">\(g(x) = log(\frac{x}{1-x})\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
logistique
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
p
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta\)</span> et <em>j</em>-1 constantes <span class="math inline">\(\beta_{0j}\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Non-séparation complète, absence de sur-dispersion ou de sous-dispersion, Proportionnalité des cotes
</td>
</tr>
</tbody>
</table>
<p>Ainsi, dans le modèle logistique binomial vu précédemment, nous modélisons la probabilité d’observer un évènement <span class="math inline">\(P(Y = 1)\)</span>. Dans un modèle logistique ordinal, nous modélisons la probabilité cumulative d’observer l’échelon <em>j</em> de notre variable ordinale <span class="math inline">\(P(Y \leq j)\)</span>. L’intérêt de cette reformulation est que nous conservons la facilité d’interprétation du modèle logistique binomial classique avec les rapports de cotes, à ceci prêt qu’ils représentent maintenant la probabilité de passer à un échelon supérieur de <em>Y</em>. La différence pratique est que notre modèle se retrouve avec autant de constantes qu’il y a de catégories à prédire moins une, chacune de ces constantes contrôlant la probabilité de base de passer de la catégorie <em>j</em> à la catégorie <em>j</em> + 1.</p>
<div id="conditions-dapplication" class="section level4 hasAnchor" number="8.2.3.1">
<h4><span class="header-section-number">8.2.3.1</span> Conditions d’application<a href="sect082.html#conditions-dapplication" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Les conditions d’application sont les mêmes que pour un modèle binomial, avec bien sûr l’ajout de l’hypothèse sur la proportionnalité des cotes. Selon cette hypothèse, l’effet de chaque variable indépendante est identique sur la probabilité de passer d’un échelon de la variable <em>Y</em> au suivant. Afin de tester cette condition, deux approches sont envisageables :</p>
<ol style="list-style-type: decimal">
<li>Utiliser l’approche de Brant <span class="citation">(<a href="#ref-brant1990assessing" role="doc-biblioref">1990</a>)</span>. Il s’agit d’un test statistique comparant les résultats du modèle ordinal avec ceux d’une série de modèles logistiques binomiaux (1 pour chaque catégorie possible de <em>Y</em>).</li>
<li>Ajuster un modèle ordinal sans l’hypothèse de proportionnalité des cotes et effectuer un test de ratio des <em>likelihood</em> pour vérifier si le premier est significativement mieux ajusté.</li>
</ol>
<p>Si certaines variables ne respectent pas cette condition d’application, trois options sont possibles pour y remédier :</p>
<ol style="list-style-type: decimal">
<li>Supprimer la variable du modèle (à éviter si cette variable est importante dans votre cadre théorique).</li>
<li>Autoriser la variable à avoir un effet différent entre chaque palier (possible avec le <em>package</em> <code>VGAM</code>).</li>
<li>Changer de modèle et opter pour un modèle des catégories adjacentes. Il s’agit du cas particulier où toutes les variables sont autorisées à changer à chaque niveau. Ne pas confondre ce dernier modèle et le modèle multinomial (section <a href="sect082.html#sect0824">8.2.4</a>)), puisque le modèle des catégories adjacentes continue à prédire la probabilité de passer à une catégorie supérieure.</li>
</ol>
</div>
<div id="exemple-appliqué-dans-r" class="section level4 hasAnchor" number="8.2.3.2">
<h4><span class="header-section-number">8.2.3.2</span> Exemple appliqué dans R<a href="sect082.html#exemple-appliqué-dans-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour cet exemple, nous analysons un jeu de données proposé par <a href="http://insideairbnb.com/get-the-data.html">Inside Airbnb</a>, une organisation sans but lucratif collectant des données des annonces sur le site d’Airbnb pour alimenter le débat sur l’effet de cette société sur les quartiers. Plus spécifiquement, nous utilisons le jeu de données pour Montréal compilé le 30 juin 2020. Nous modélisons ici le prix par nuit des logements, ce type d’exercice est appelé modélisation hédonique. Il est particulièrement utilisé en économie urbaine pour évaluer les déterminants du marché immobilier et prédire son évolution. Le cas d’Airbnb a déjà été étudié dans plusieurs articles <span class="citation">(<a href="#ref-teubner2017price" role="doc-biblioref">Teubner, Hawlitschek et Dann 2017</a>; <a href="#ref-wang2017price" role="doc-biblioref">Wang et Nicolau 2017</a>; <a href="#ref-zhang2017key" role="doc-biblioref">Zhang et al. 2017</a>)</span>. Il en ressort notamment que le niveau de confiance inspiré par l’hôte, les caractéristiques intrinsèques du logement et sa localisation sont les principales variables indépendantes de son prix. Nous construisons donc notre modèle sur cette base. Notez que nous avons décidé de retirer les logements avec des prix supérieurs à 250 $ par nuit qui constituent des cas particuliers et qui devraient faire l’objet d’une analyse à part entière. Nous avons également retiré les observations pour lesquelles certaines données sont manquantes, et obtenons un nombre final de 9 051 observations.</p>
<p>La distribution originale du prix des logements dans notre jeu de données est présentée à la figure <a href="sect082.html#fig:histopriceairbnb">8.12</a>.</p>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="sect082.html#cb782-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Charger le jeu de données</span></span>
<span id="cb782-2"><a href="sect082.html#cb782-2" aria-hidden="true" tabindex="-1"></a>data_airbnb <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/glm/airbnb_data.csv&quot;</span>)</span>
<span id="cb782-3"><a href="sect082.html#cb782-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher la distribution du prix</span></span>
<span id="cb782-4"><a href="sect082.html#cb782-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_airbnb) <span class="sc">+</span> </span>
<span id="cb782-5"><a href="sect082.html#cb782-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> price), <span class="at">bins =</span> <span class="dv">30</span>, </span>
<span id="cb782-6"><a href="sect082.html#cb782-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#1d3557&quot;</span>, <span class="at">size =</span> <span class="fl">0.02</span>)<span class="sc">+</span></span>
<span id="cb782-7"><a href="sect082.html#cb782-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Prix (en dollars)&quot;</span>, <span class="at">y=</span><span class="st">&quot;Fréquence&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:histopriceairbnb"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/histopriceairbnb-1.png" alt="Distribution des prix des logements Airbnb" width="65%" />
<p class="caption">
Figure 8.12: Distribution des prix des logements Airbnb
</p>
</div>
<p>Nous avons ensuite découpé le prix des logements en trois catégories : inférieur à 50 $, de 50 $ à 99 $ et de 100 $ à 249 $. Ces catégories forment une variable ordinale de trois échelons que nous modélisons à partir de trois catégories de variables :</p>
<ul>
<li>les caractéristiques propres au logement;</li>
<li>les caractéristiques environnementales autour du logement;</li>
<li>les notes obtenues par le logement sur le site d’Airbnb.</li>
</ul>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="sect082.html#cb783-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le nombre de logement par catégories</span></span>
<span id="cb783-2"><a href="sect082.html#cb783-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_airbnb<span class="sc">$</span>fac_price_cat)</span></code></pre></div>
<pre><code>## 
##    1    2    3 
## 2212 3911 2928</code></pre>
<p>Le tableau <a href="sect082.html#tab:variablecumul">8.13</a> présente l’ensemble des variables utilisées dans le modèle.</p>
<table>
<caption>
<span id="tab:variablecumul">Tableau 8.13: </span>Variables indépendantes utilisées pour prédire la catégorie de prix de logements Airbnb
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nom de la variable
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Type de variable
</th>
<th style="text-align:left;">
Mesure
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beds
</td>
<td style="text-align:left;">
Nombre de lits dans le logement
</td>
<td style="text-align:left;">
Variable de comptage
</td>
<td style="text-align:left;">
Nombre de lits dans le logement
</td>
</tr>
<tr>
<td style="text-align:left;">
Garden_or_backyard
</td>
<td style="text-align:left;">
Présence d’un jardin ou d’une arrière-cour
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Oui ou non
</td>
</tr>
<tr>
<td style="text-align:left;">
private
</td>
<td style="text-align:left;">
Le logement est entièrement à disposition du locataire ou seulement une pièce
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Privé ou partagé
</td>
</tr>
<tr>
<td style="text-align:left;">
Free_street_parking
</td>
<td style="text-align:left;">
Une place de stationnement gratuite est disponible sur la rue
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Oui ou non
</td>
</tr>
<tr>
<td style="text-align:left;">
Host_greets_you
</td>
<td style="text-align:left;">
L’hôte accueille personnellement les locataires
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Oui ou non
</td>
</tr>
<tr>
<td style="text-align:left;">
prt_veg_500m
</td>
<td style="text-align:left;">
Végétation dans les environs du logement
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Pourcentage de surface végétale dans un rayon de 500 mètres autour du logement
</td>
</tr>
<tr>
<td style="text-align:left;">
has_metro_500m
</td>
<td style="text-align:left;">
Présence d’une station de métro à proximité du logement
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Présence d’une station de métro dans un rayon de 500 mètres autour du logement
</td>
</tr>
<tr>
<td style="text-align:left;">
commercial_1km
</td>
<td style="text-align:left;">
Commerce dans les environs du logement
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Pourcentage de surface dédiée au commerce (mode d’occupation du sol) dans un rayon d’un kilomètre autour du logement
</td>
</tr>
<tr>
<td style="text-align:left;">
cat_review
</td>
<td style="text-align:left;">
Évaluation de la qualité du logement par les usagers
</td>
<td style="text-align:left;">
Variable ordinale
</td>
<td style="text-align:left;">
Note obtenue par le logement sur une échelle allant de 1 (très mauvais) à 5 (parfait)
</td>
</tr>
<tr>
<td style="text-align:left;">
host_total_listings_count
</td>
<td style="text-align:left;">
Nombre total de logements détenus par l’hôte sur Airbnb
</td>
<td style="text-align:left;">
Variable de comptage
</td>
<td style="text-align:left;">
Nombre total de logements détenus par l’hôte sur Airbnb
</td>
</tr>
</tbody>
</table>
<p><strong>Vérification des conditions d’application</strong></p>
<p>Avant d’ajuster le modèle, il convient de vérifier l’absence de multicolinéarité excessive entre les variables indépendantes.</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="sect082.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Notez que la fonction vif ne s&#39;intéresse qu&#39;aux variables indépendantes.</span></span>
<span id="cb785-2"><a href="sect082.html#cb785-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Vous pouvez ainsi utiliser la fonction glm avec la fonction vif </span></span>
<span id="cb785-3"><a href="sect082.html#cb785-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pour n&#39;importe quel modèle glm</span></span>
<span id="cb785-4"><a href="sect082.html#cb785-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">glm</span>(price <span class="sc">~</span> beds <span class="sc">+</span></span>
<span id="cb785-5"><a href="sect082.html#cb785-5" aria-hidden="true" tabindex="-1"></a>    Garden_or_backyard <span class="sc">+</span> Host_greets_you <span class="sc">+</span> Free_street_parking <span class="sc">+</span> </span>
<span id="cb785-6"><a href="sect082.html#cb785-6" aria-hidden="true" tabindex="-1"></a>      prt_veg_500m <span class="sc">+</span> has_metro_500m <span class="sc">+</span> commercial_1km <span class="sc">+</span>host_total_listings_count <span class="sc">+</span></span>
<span id="cb785-7"><a href="sect082.html#cb785-7" aria-hidden="true" tabindex="-1"></a>      private <span class="sc">+</span> cat_review, <span class="at">data =</span> data_airbnb))</span></code></pre></div>
<pre><code>##                      beds        Garden_or_backyard           Host_greets_you 
##                  1.123595                  1.079324                  1.046884 
##       Free_street_parking              prt_veg_500m            has_metro_500m 
##                  1.142189                  1.532536                  1.239516 
##            commercial_1km host_total_listings_count                   private 
##                  1.225301                  1.058232                  1.143932 
##                cat_review 
##                  1.015778</code></pre>
<p>Toutes les valeurs de VIF sont inférieures à 2, indiquant une absence de multicolinéarité excessive. Nous pouvons alors ajuster le modèle et analyser les distances de Cook afin de vérifier la présence ou non d’observations très influentes. Pour ajuster le modèle, nous utilisons le <em>package</em> <code>VGAM</code> et la fonction <code>vglm</code> qui nous donnent accès à la famille <code>cumulative</code> pour ajuster des modèles logistiques ordinaux. Notez que le fonctionnement de base de cette famille est de modéliser <span class="math inline">\(P(Y\leq1),P(Y\leq2),...,P(Y\leq J)\)</span> avec <em>J</em> le nombre de catégories. Cependant, nous voulons ici modéliser la probabilité de passer à une catégorie supérieure de prix. Pour cela, il est nécessaire de spécifier le paramètre <code>reverse = TRUE</code> pour la famille <code>cumulative</code> (voir <code>help(cumulative)</code> pour plus de détails).</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="sect082.html#cb787-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb787-2"><a href="sect082.html#cb787-2" aria-hidden="true" tabindex="-1"></a>modele <span class="ot">&lt;-</span> <span class="fu">vglm</span>(fac_price_cat <span class="sc">~</span> beds <span class="sc">+</span></span>
<span id="cb787-3"><a href="sect082.html#cb787-3" aria-hidden="true" tabindex="-1"></a>                Garden_or_backyard <span class="sc">+</span> Free_street_parking <span class="sc">+</span> </span>
<span id="cb787-4"><a href="sect082.html#cb787-4" aria-hidden="true" tabindex="-1"></a>                prt_veg_500m <span class="sc">+</span> has_metro_500m <span class="sc">+</span> commercial_1km <span class="sc">+</span></span>
<span id="cb787-5"><a href="sect082.html#cb787-5" aria-hidden="true" tabindex="-1"></a>                private <span class="sc">+</span> cat_review <span class="sc">+</span> host_total_listings_count ,</span>
<span id="cb787-6"><a href="sect082.html#cb787-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">link=</span><span class="st">&quot;logitlink&quot;</span>, <span class="co"># fonction de lien </span></span>
<span id="cb787-7"><a href="sect082.html#cb787-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">parallel =</span> <span class="cn">TRUE</span>, <span class="co"># cote proportionelle</span></span>
<span id="cb787-8"><a href="sect082.html#cb787-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">reverse =</span> <span class="cn">TRUE</span>),</span>
<span id="cb787-9"><a href="sect082.html#cb787-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> data_airbnb, <span class="at">model =</span> T)</span></code></pre></div>
<p>Notez que, puisque la variable <em>Y</em> a trois catégories différentes et que nous modélisons la probabilité de passer à une catégorie supérieure, chaque observation a alors deux (3-1) valeurs de résidus différentes. Par conséquent, nous calculons deux distances de Cook différentes que nous devons analyser conjointement. Malheureusement, la fonction <code>cook.distance</code> ne fonctionne pas avec les objets <code>vglm</code>, nous devons donc les calculer manuellement.</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="sect082.html#cb788-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des résidus</span></span>
<span id="cb788-2"><a href="sect082.html#cb788-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modele, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb788-3"><a href="sect082.html#cb788-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction de la hat matrix (nécessaire pour calculer la distance de Cook)</span></span>
<span id="cb788-4"><a href="sect082.html#cb788-4" aria-hidden="true" tabindex="-1"></a>hat <span class="ot">&lt;-</span> <span class="fu">hatvaluesvlm</span>(modele)</span>
<span id="cb788-5"><a href="sect082.html#cb788-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb788-6"><a href="sect082.html#cb788-6" aria-hidden="true" tabindex="-1"></a>cooks <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(res),<span class="cf">function</span>(i){</span>
<span id="cb788-7"><a href="sect082.html#cb788-7" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> res[,i]</span>
<span id="cb788-8"><a href="sect082.html#cb788-8" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> hat[,i]</span>
<span id="cb788-9"><a href="sect082.html#cb788-9" aria-hidden="true" tabindex="-1"></a>  cook <span class="ot">&lt;-</span> (r<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> h))<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> h<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">*</span> modele<span class="sc">@</span>rank)</span>
<span id="cb788-10"><a href="sect082.html#cb788-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb788-11"><a href="sect082.html#cb788-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Structuration dans un DataFrame</span></span>
<span id="cb788-12"><a href="sect082.html#cb788-12" aria-hidden="true" tabindex="-1"></a>matcook <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">do.call</span>(cbind, cooks))</span>
<span id="cb788-13"><a href="sect082.html#cb788-13" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(matcook) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;dist1&quot;</span>,<span class="st">&quot;dist2&quot;</span>)</span>
<span id="cb788-14"><a href="sect082.html#cb788-14" aria-hidden="true" tabindex="-1"></a>matcook<span class="sc">$</span>oid <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(matcook)</span>
<span id="cb788-15"><a href="sect082.html#cb788-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les distances de Cook</span></span>
<span id="cb788-16"><a href="sect082.html#cb788-16" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> matcook) <span class="sc">+</span> </span>
<span id="cb788-17"><a href="sect082.html#cb788-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> oid, <span class="at">y =</span> dist1), <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>)) <span class="sc">+</span> </span>
<span id="cb788-18"><a href="sect082.html#cb788-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;distance de Cook P(Y&gt;=2)&quot;</span>)<span class="sc">+</span></span>
<span id="cb788-19"><a href="sect082.html#cb788-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb788-20"><a href="sect082.html#cb788-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb788-21"><a href="sect082.html#cb788-21" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> matcook) <span class="sc">+</span> </span>
<span id="cb788-22"><a href="sect082.html#cb788-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> oid, <span class="at">y =</span> dist2), <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>)) <span class="sc">+</span> </span>
<span id="cb788-23"><a href="sect082.html#cb788-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;distance de Cook P(Y&gt;=3)&quot;</span>)<span class="sc">+</span></span>
<span id="cb788-24"><a href="sect082.html#cb788-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb788-25"><a href="sect082.html#cb788-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb788-26"><a href="sect082.html#cb788-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb788-27"><a href="sect082.html#cb788-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CookdCotePropor"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/CookdCotePropor-1.png" alt="Distances de Cook pour le modèle logistique des cotes proportionnelles" width="65%" />
<p class="caption">
Figure 8.13: Distances de Cook pour le modèle logistique des cotes proportionnelles
</p>
</div>
<p>Les distances de Cook (figure <a href="sect082.html#fig:CookdCotePropor">8.13</a>) nous permettent d’identifier quelques observations potentiellement trop influentes, mais elles semblent être différentes d’un graphique à l’autre. Nous décidons donc de ne pas retirer d’observations à ce stade et de passer à l’analyse des résidus simulés. Pour effectuer des simulations à partir de ce modèle, nous nous basons sur les probabilités d’appartenance prédites par le modèle.</p>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="sect082.html#cb789-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les probabilités prédites</span></span>
<span id="cb789-2"><a href="sect082.html#cb789-2" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele,<span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb789-3"><a href="sect082.html#cb789-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">head</span>(predicted,<span class="at">n =</span> <span class="dv">4</span>),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##       1     2     3
## 1 0.706 0.267 0.028
## 2 0.073 0.461 0.466
## 3 0.687 0.283 0.030
## 4 0.049 0.383 0.568</code></pre>
<p>Nous constatons ainsi que, pour la première observation, la probabilité prédite d’appartenir au groupe 1 est de 69,4 %, de 27,7 % pour le groupe 2 et de 2,9 % pour le groupe 3. Si nous effectuons 1 000 simulations, nous pouvons nous attendre à ce qu’en moyenne, sur ces 1 000 simulations, 694 indiqueront 1 comme catégorie prédite, 277 indiqueront 2 et seulement 29 indiqueront 3.</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="sect082.html#cb791-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nous effectuerons 1000 simulations</span></span>
<span id="cb791-2"><a href="sect082.html#cb791-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb791-3"><a href="sect082.html#cb791-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Lancement des simulations pour chaque observation (lignes dans predicted)</span></span>
<span id="cb791-4"><a href="sect082.html#cb791-4" aria-hidden="true" tabindex="-1"></a>simulations <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predicted), <span class="cf">function</span>(i){</span>
<span id="cb791-5"><a href="sect082.html#cb791-5" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> predicted[i,]</span>
<span id="cb791-6"><a href="sect082.html#cb791-6" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">size =</span> nsim, <span class="at">replace =</span> T, <span class="at">prob =</span> probs)</span>
<span id="cb791-7"><a href="sect082.html#cb791-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb791-8"><a href="sect082.html#cb791-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb791-9"><a href="sect082.html#cb791-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combiner les prédictions dans un tableau</span></span>
<span id="cb791-10"><a href="sect082.html#cb791-10" aria-hidden="true" tabindex="-1"></a>matsim <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, simulations)</span>
<span id="cb791-11"><a href="sect082.html#cb791-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Observons si nos simulations sont proches de ce que nous attendions</span></span>
<span id="cb791-12"><a href="sect082.html#cb791-12" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(matsim[<span class="dv">1</span>,])</span></code></pre></div>
<pre><code>## 
##   1   2   3 
## 740 235  25</code></pre>
<p>À partir de ces simulations de prédiction, nous pouvons réaliser un diagnostic des résidus simulés grâce au <em>package</em> <code>DHARMa</code>.</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="sect082.html#cb793-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb793-2"><a href="sect082.html#cb793-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction de la prédiction moyenne du modèle</span></span>
<span id="cb793-3"><a href="sect082.html#cb793-3" aria-hidden="true" tabindex="-1"></a>pred_cat <span class="ot">&lt;-</span> <span class="fu">unique</span>(data_airbnb<span class="sc">$</span>fac_price_cat)[<span class="fu">max.col</span>(predicted)]</span>
<span id="cb793-4"><a href="sect082.html#cb793-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparer les données avec le package DHARMa</span></span>
<span id="cb793-5"><a href="sect082.html#cb793-5" aria-hidden="true" tabindex="-1"></a>sim_res <span class="ot">&lt;-</span> <span class="fu">createDHARMa</span>(<span class="at">simulatedResponse =</span> matsim, </span>
<span id="cb793-6"><a href="sect082.html#cb793-6" aria-hidden="true" tabindex="-1"></a>                            <span class="at">observedResponse =</span> <span class="fu">as.numeric</span>(data_airbnb<span class="sc">$</span>fac_price_cat),</span>
<span id="cb793-7"><a href="sect082.html#cb793-7" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fittedPredictedResponse =</span> <span class="fu">as.numeric</span>(pred_cat),</span>
<span id="cb793-8"><a href="sect082.html#cb793-8" aria-hidden="true" tabindex="-1"></a>                            <span class="at">integerResponse =</span> T)</span>
<span id="cb793-9"><a href="sect082.html#cb793-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher le graphique de diagnostic général</span></span>
<span id="cb793-10"><a href="sect082.html#cb793-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diagressimcumul"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/diagressimcumul-1.png" alt="Diagnostic général des résidus simulés du modèle des cotes proportionnelles" width="65%" />
<p class="caption">
Figure 8.14: Diagnostic général des résidus simulés du modèle des cotes proportionnelles
</p>
</div>
<p>La figure <a href="sect082.html#fig:diagressimcumul">8.14</a> nous indique que les résidus simulés suivent bien une distribution uniforme et qu’aucune valeur aberrante n’est observable. Pour affiner notre diagnostic, nous vérifions également si aucune relation ne semble exister entre chaque variable indépendante et les résidus.</p>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="sect082.html#cb794-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparons un plot multiple</span></span>
<span id="cb794-2"><a href="sect082.html#cb794-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb794-3"><a href="sect082.html#cb794-3" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;nombre de lits&quot;</span> <span class="ot">=</span> <span class="st">&quot;beds&quot;</span>,</span>
<span id="cb794-4"><a href="sect082.html#cb794-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;couvert végétal&quot;</span> <span class="ot">=</span> <span class="st">&quot;prt_veg_500m&quot;</span>, </span>
<span id="cb794-5"><a href="sect082.html#cb794-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;commercial&quot;</span> <span class="ot">=</span> <span class="st">&quot;commercial_1km&quot;</span>,</span>
<span id="cb794-6"><a href="sect082.html#cb794-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;nb logements hôte&quot;</span> <span class="ot">=</span> <span class="st">&quot;host_total_listings_count&quot;</span>,</span>
<span id="cb794-7"><a href="sect082.html#cb794-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;jardin&quot;</span> <span class="ot">=</span> <span class="st">&quot;Garden_or_backyard&quot;</span>,</span>
<span id="cb794-8"><a href="sect082.html#cb794-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;accueil&quot;</span> <span class="ot">=</span> <span class="st">&quot;Host_greets_you&quot;</span>,</span>
<span id="cb794-9"><a href="sect082.html#cb794-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;stationnement gratuit&quot;</span> <span class="ot">=</span> <span class="st">&quot;Free_street_parking&quot;</span>, </span>
<span id="cb794-10"><a href="sect082.html#cb794-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;métro&quot;</span> <span class="ot">=</span> <span class="st">&quot;has_metro_500m&quot;</span>, </span>
<span id="cb794-11"><a href="sect082.html#cb794-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;logement privé&quot;</span> <span class="ot">=</span> <span class="st">&quot;private&quot;</span>,</span>
<span id="cb794-12"><a href="sect082.html#cb794-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;évaluation&quot;</span> <span class="ot">=</span> <span class="st">&quot;cat_review&quot;</span>)</span>
<span id="cb794-13"><a href="sect082.html#cb794-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb794-14"><a href="sect082.html#cb794-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(name <span class="cf">in</span>  <span class="fu">names</span>(vars)){</span>
<span id="cb794-15"><a href="sect082.html#cb794-15" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> vars[[name]]</span>
<span id="cb794-16"><a href="sect082.html#cb794-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotResiduals</span>(sim_res, data_airbnb[[v]], <span class="at">rank =</span> F, <span class="at">quantreg =</span> F, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb794-17"><a href="sect082.html#cb794-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> name, <span class="at">ylab =</span> <span class="st">&quot;résidus&quot;</span>)</span>
<span id="cb794-18"><a href="sect082.html#cb794-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diagressimcumul2"></span>
<img src="images/glm/diagressimcumul2.png" alt="Diagnostic des variables indépendantes et des résidus simulés du modèle des cotes proportionnelles" width="100%" />
<p class="caption">
Figure 8.15: Diagnostic des variables indépendantes et des résidus simulés du modèle des cotes proportionnelles
</p>
</div>
<p>La fonction <code>plotResiduals</code> du <em>package</em> <code>DHARMa</code> produit des graphiques peu esthétiques, mais pratiques pour effectuer ce type de diagnostic.</p>
<p>La figure <a href="sect082.html#fig:diagressimcumul2">8.15</a> indique qu’aucune relation marquée n’existe entre nos variables indépendantes et nos résidus simulés, sauf pour la variable <em>nombre de lits</em>. En effet, nous pouvons constater que les résidus ont tendance à être toujours plus faibles quand le nombre de lits augmente. Cet effet est sûrement lié au fait qu’au-delà de cinq lits, le logement en question est vraisemblablement un dortoir. Il pourrait être judicieux de retirer ces observations de l’analyse, considérant qu’elles sont peu nombreuses et constituent un type de logement particulier.</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="sect082.html#cb795-1" aria-hidden="true" tabindex="-1"></a>data_airbnb2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_airbnb, data_airbnb<span class="sc">$</span>beds <span class="sc">&lt;=</span><span class="dv">5</span>)</span>
<span id="cb795-2"><a href="sect082.html#cb795-2" aria-hidden="true" tabindex="-1"></a>modele2 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(fac_price_cat <span class="sc">~</span> beds  <span class="sc">+</span> </span>
<span id="cb795-3"><a href="sect082.html#cb795-3" aria-hidden="true" tabindex="-1"></a>                Garden_or_backyard <span class="sc">+</span> Free_street_parking <span class="sc">+</span> </span>
<span id="cb795-4"><a href="sect082.html#cb795-4" aria-hidden="true" tabindex="-1"></a>                prt_veg_500m <span class="sc">+</span> has_metro_500m <span class="sc">+</span> commercial_1km <span class="sc">+</span></span>
<span id="cb795-5"><a href="sect082.html#cb795-5" aria-hidden="true" tabindex="-1"></a>                private <span class="sc">+</span> cat_review <span class="sc">+</span> host_total_listings_count ,</span>
<span id="cb795-6"><a href="sect082.html#cb795-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">link=</span><span class="st">&quot;logitlink&quot;</span>, <span class="co"># fonction de lien </span></span>
<span id="cb795-7"><a href="sect082.html#cb795-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">parallel =</span> <span class="cn">TRUE</span>, <span class="co"># cote proportionelle</span></span>
<span id="cb795-8"><a href="sect082.html#cb795-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">reverse =</span> <span class="cn">TRUE</span>),</span>
<span id="cb795-9"><a href="sect082.html#cb795-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> data_airbnb2, <span class="at">model =</span> T)</span></code></pre></div>
<p>Nous pouvons ensuite recalculer les résidus simulés pour observer si cette tendance a été corrigée. La figure <a href="sect082.html#fig:diagressimcumul3">8.16</a> montre qu’une bonne partie du problème a été corrigée; cependant, il semble tout de même que les résidus soient plus forts pour les logements avec un seul lit.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="sect082.html#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nous effectuerons 1000 simulations</span></span>
<span id="cb796-2"><a href="sect082.html#cb796-2" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb796-3"><a href="sect082.html#cb796-3" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele2, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb796-4"><a href="sect082.html#cb796-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lancement des simulations pour chaque observation (lignes dans predicted)</span></span>
<span id="cb796-5"><a href="sect082.html#cb796-5" aria-hidden="true" tabindex="-1"></a>simulations <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predicted), <span class="cf">function</span>(i){</span>
<span id="cb796-6"><a href="sect082.html#cb796-6" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> predicted[i,]</span>
<span id="cb796-7"><a href="sect082.html#cb796-7" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">size =</span> nsim, <span class="at">replace =</span> T, <span class="at">prob =</span> probs)</span>
<span id="cb796-8"><a href="sect082.html#cb796-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb796-9"><a href="sect082.html#cb796-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb796-10"><a href="sect082.html#cb796-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combiner les prédictions dans un tableau</span></span>
<span id="cb796-11"><a href="sect082.html#cb796-11" aria-hidden="true" tabindex="-1"></a>matsim <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, simulations)</span>
<span id="cb796-12"><a href="sect082.html#cb796-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction de la prédiction moyenne du modèle</span></span>
<span id="cb796-13"><a href="sect082.html#cb796-13" aria-hidden="true" tabindex="-1"></a>pred_cat <span class="ot">&lt;-</span> <span class="fu">unique</span>(data_airbnb2<span class="sc">$</span>fac_price_cat)[<span class="fu">max.col</span>(predicted)]</span>
<span id="cb796-14"><a href="sect082.html#cb796-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparer les donnees avec le package DHARMa</span></span>
<span id="cb796-15"><a href="sect082.html#cb796-15" aria-hidden="true" tabindex="-1"></a>sim_res <span class="ot">&lt;-</span> <span class="fu">createDHARMa</span>(<span class="at">simulatedResponse =</span> matsim, </span>
<span id="cb796-16"><a href="sect082.html#cb796-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">observedResponse =</span> <span class="fu">as.numeric</span>(data_airbnb2<span class="sc">$</span>fac_price_cat),</span>
<span id="cb796-17"><a href="sect082.html#cb796-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fittedPredictedResponse =</span> <span class="fu">as.numeric</span>(pred_cat),</span>
<span id="cb796-18"><a href="sect082.html#cb796-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">integerResponse =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="sect082.html#cb797-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb797-2"><a href="sect082.html#cb797-2" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;nombre de lits&quot;</span> <span class="ot">=</span> <span class="st">&quot;beds&quot;</span>,</span>
<span id="cb797-3"><a href="sect082.html#cb797-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;couvert végétal&quot;</span> <span class="ot">=</span> <span class="st">&quot;prt_veg_500m&quot;</span>, </span>
<span id="cb797-4"><a href="sect082.html#cb797-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;commercial&quot;</span> <span class="ot">=</span> <span class="st">&quot;commercial_1km&quot;</span>,</span>
<span id="cb797-5"><a href="sect082.html#cb797-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;nb logements hôte&quot;</span> <span class="ot">=</span> <span class="st">&quot;host_total_listings_count&quot;</span>,</span>
<span id="cb797-6"><a href="sect082.html#cb797-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;jardin&quot;</span> <span class="ot">=</span> <span class="st">&quot;Garden_or_backyard&quot;</span>,</span>
<span id="cb797-7"><a href="sect082.html#cb797-7" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;accueil&quot;</span> <span class="ot">=</span> <span class="st">&quot;Host_greets_you&quot;</span>,</span>
<span id="cb797-8"><a href="sect082.html#cb797-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;stationnement gratuit&quot;</span> <span class="ot">=</span> <span class="st">&quot;Free_street_parking&quot;</span>, </span>
<span id="cb797-9"><a href="sect082.html#cb797-9" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;métro&quot;</span> <span class="ot">=</span> <span class="st">&quot;has_metro_500m&quot;</span>, </span>
<span id="cb797-10"><a href="sect082.html#cb797-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;logement privé&quot;</span> <span class="ot">=</span> <span class="st">&quot;private&quot;</span>,</span>
<span id="cb797-11"><a href="sect082.html#cb797-11" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;évaluation&quot;</span> <span class="ot">=</span> <span class="st">&quot;cat_review&quot;</span>)</span>
<span id="cb797-12"><a href="sect082.html#cb797-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb797-13"><a href="sect082.html#cb797-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(name <span class="cf">in</span>  <span class="fu">names</span>(vars)){</span>
<span id="cb797-14"><a href="sect082.html#cb797-14" aria-hidden="true" tabindex="-1"></a>  v <span class="ot">&lt;-</span> vars[[name]]</span>
<span id="cb797-15"><a href="sect082.html#cb797-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotResiduals</span>(sim_res, data_airbnb2[[v]], <span class="at">rank =</span> F, <span class="at">quantreg =</span> F, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb797-16"><a href="sect082.html#cb797-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> name, <span class="at">ylab =</span> <span class="st">&quot;résidus&quot;</span>)</span>
<span id="cb797-17"><a href="sect082.html#cb797-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diagressimcumul3"></span>
<img src="images/glm/diagressimcumul3.png" alt="Diagnostic des variables indépendantes et des résidus simulés du modèle des cotes proportionnelles (après correction)" width="100%" />
<p class="caption">
Figure 8.16: Diagnostic des variables indépendantes et des résidus simulés du modèle des cotes proportionnelles (après correction)
</p>
</div>
<p>La prochaine étape du diagnostic est de vérifier l’absence de séparation parfaite provoquée par une de nos variables indépendantes. Le <em>package</em> <code>VGAM</code> propose pour cela la fonction <code>hdeff</code>.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="sect082.html#cb798-1" aria-hidden="true" tabindex="-1"></a>tests <span class="ot">&lt;-</span> <span class="fu">hdeff</span>(modele2)</span>
<span id="cb798-2"><a href="sect082.html#cb798-2" aria-hidden="true" tabindex="-1"></a>problem <span class="ot">&lt;-</span> <span class="fu">table</span>(tests)</span>
<span id="cb798-3"><a href="sect082.html#cb798-3" aria-hidden="true" tabindex="-1"></a>problem</span></code></pre></div>
<pre><code>## tests
## FALSE 
##    11</code></pre>
<p>La fonction nous informe qu’aucune de nos variables indépendantes ne provoque de séparation parfaite : toutes les valeurs renvoyées par la fonction <code>hdeff</code> sont égales à <code>FALSE.</code></p>
<p>Il ne nous reste donc plus qu’à vérifier que l’hypothèse de proportionnalité des cotes est respectée, soit que l’effet de chacune des variables indépendantes est bien le même pour passer de la catégorie 1 à 2 que pour passer de la catégorie 2 à 3. Pour cela, deux approches sont possibles : le test de Brant ou la réalisation d’une séquence de tests de rapport de vraisemblance.</p>
<p>Le <em>package</em> <code>brant</code> propose une implémentation du test de Brant, mais celle-ci ne peut être appliquée qu’à des modèles construits avec la fonction <code>polr</code> du <em>package</em> <code>MASS</code>. Nous avons donc récupéré le code source de la fonction <code>brant</code> du <em>package</em> <code>brant</code> et apporté quelques modifications pour qu’elle soit utilisable sur un objet <code>vglm</code>. Cette nouvelle fonction, appelée <code>brant.vglm</code>, est disponible dans le code source de ce livre.</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="sect082.html#cb800-1" aria-hidden="true" tabindex="-1"></a>tableau_brant <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">brant.vglm</span>(modele2),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## ------------------------------------------------------------ 
## Test for         X2  df  probability 
## ------------------------------------------------------------ 
## Omnibus              113.72  9   0
## beds             0.63    1   0.43
## Garden_or_backyardYES        0.16    1   0.69
## Free_street_parkingYES   0.84    1   0.36
## prt_veg_500m         6.49    1   0.01
## has_metro_500mYES        0.02    1   0.89
## commercial_1km           0.01    1   0.92
## privateEntier            93.56   1   0
## cat_review           0.63    1   0.43
## host_total_listings_count    1.51    1   0.22
## ------------------------------------------------------------ 
## 
## H0: Parallel Regression Assumption holds</code></pre>
<p>Ce premier tableau nous indique que seule la variable indiquant si le logement est disponible en entier ou partagé contrevient à l’hypothèse de proportionnalité des cotes (la seule valeur <em>p</em> significative). Pour confirmer cette observation, nous pouvons réaliser un ensemble de tests de rapport de vraisemblance. Pour chaque variable du modèle, nous créons un second modèle dans lequel cette variable est autorisée à varier pour chaque catégorie et nous comparons les niveaux d’ajustement des modèles. Nous avons implémenté cette procédure dans la fonction <code>parallel.likelihoodtest.vglm</code> disponible dans le code source de ce livre.</p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="sect082.html#cb802-1" aria-hidden="true" tabindex="-1"></a>tableau_likelihood <span class="ot">&lt;-</span> <span class="fu">parallel.likelihoodtest.vglm</span>(modele2, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb802-2"><a href="sect082.html#cb802-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tableau_likelihood)</span></code></pre></div>
<pre><code>##      variable non parallele   AIC loglikelihood p.val loglikelihood ratio test
## 1                      beds 15304         -7640                          0.271
## 2        Garden_or_backyard 15305         -7641                          0.417
## 3       Free_street_parking 15301         -7639                          0.079
## 4              prt_veg_500m 15296         -7636                          0.007
## 5            has_metro_500m 15303         -7640                          0.191
## 6            commercial_1km 15305         -7640                          0.271
## 7                   private 15215         -7595                          0.000
## 8                cat_review 15306         -7641                          0.430
## 9 host_total_listings_count 15304         -7640                          0.257</code></pre>
<p>Les résultats de cette seconde série de tests confirment les précédents, la variable concernant le type de logement doit être autorisée à varier en fonction de la catégorie. Ce second tableau nous indique que la variable concernant la densité de végétation pourrait aussi être amenée à varier en fonction du groupe, mais ce changement a un effet très marginal (différence entre les valeurs d’AIC de seulement 8 points). Nous ajustons donc un nouveau modèle autorisant la variable <code>private</code> à changer en fonction de la catégorie prédite.</p>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="sect082.html#cb804-1" aria-hidden="true" tabindex="-1"></a>modele3 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(fac_price_cat <span class="sc">~</span> beds <span class="sc">+</span> </span>
<span id="cb804-2"><a href="sect082.html#cb804-2" aria-hidden="true" tabindex="-1"></a>                  Garden_or_backyard <span class="sc">+</span> Host_greets_you <span class="sc">+</span> Free_street_parking <span class="sc">+</span> </span>
<span id="cb804-3"><a href="sect082.html#cb804-3" aria-hidden="true" tabindex="-1"></a>                  prt_veg_500m <span class="sc">+</span> has_metro_500m <span class="sc">+</span> commercial_1km <span class="sc">+</span></span>
<span id="cb804-4"><a href="sect082.html#cb804-4" aria-hidden="true" tabindex="-1"></a>                  private <span class="sc">+</span> cat_review <span class="sc">+</span> host_total_listings_count,</span>
<span id="cb804-5"><a href="sect082.html#cb804-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">link=</span><span class="st">&quot;logitlink&quot;</span>,</span>
<span id="cb804-6"><a href="sect082.html#cb804-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">parallel =</span> <span class="cn">FALSE</span> <span class="sc">~</span> private ,</span>
<span id="cb804-7"><a href="sect082.html#cb804-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">reverse =</span> <span class="cn">TRUE</span>),</span>
<span id="cb804-8"><a href="sect082.html#cb804-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data_airbnb2, <span class="at">model =</span> T)</span></code></pre></div>
<p><strong>Vérification l’ajustement du modèle</strong></p>
<p>Maintenant que toutes les conditions d’application ont été passées en revue, nous pouvons passer à la vérification de l’ajustement du modèle.</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="sect082.html#cb805-1" aria-hidden="true" tabindex="-1"></a>modelenull <span class="ot">&lt;-</span> <span class="fu">vglm</span>(fac_price_cat <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb805-2"><a href="sect082.html#cb805-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">cumulative</span>(<span class="at">link=</span><span class="st">&quot;logitlink&quot;</span>,</span>
<span id="cb805-3"><a href="sect082.html#cb805-3" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb805-4"><a href="sect082.html#cb805-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">reverse =</span> <span class="cn">TRUE</span>),</span>
<span id="cb805-5"><a href="sect082.html#cb805-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data_airbnb2, <span class="at">model =</span> T)</span>
<span id="cb805-6"><a href="sect082.html#cb805-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rsqs</span>(<span class="at">loglike.full =</span> <span class="fu">logLik</span>(modele3),</span>
<span id="cb805-7"><a href="sect082.html#cb805-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">loglike.null =</span> <span class="fu">logLik</span>(modelenull),</span>
<span id="cb805-8"><a href="sect082.html#cb805-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">full.deviance =</span> <span class="fu">deviance</span>(modele3),</span>
<span id="cb805-9"><a href="sect082.html#cb805-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">null.deviance =</span> <span class="fu">deviance</span>(modelenull),</span>
<span id="cb805-10"><a href="sect082.html#cb805-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">nb.params =</span> modele3<span class="sc">@</span>rank,</span>
<span id="cb805-11"><a href="sect082.html#cb805-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">n =</span> <span class="fu">nrow</span>(data_airbnb2)</span>
<span id="cb805-12"><a href="sect082.html#cb805-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## $`deviance expliquee`
## [1] 0.2087098
## 
## $`McFadden ajuste`
## [1] 0.2073552
## 
## $`Cox and Snell`
## [1] 0.3606848
## 
## $Nagelkerke
## [1] 0.4085924</code></pre>
<p>Le modèle final parvient à expliquer 21 % de la déviance originale. Il obtient un R<sup>2</sup> ajusté de McFadden de 0,21, et des R<sup>2</sup> de Cox et Snell et de Nagelkerke de respectivement 0,36 et 0,41. Construisons à présent la matrice de confusion de la prédiction du modèle (nous utilisons ici la fonction <code>nice_confusion_matrix</code> également disponible dans le code source de ce livre).</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="sect082.html#cb807-1" aria-hidden="true" tabindex="-1"></a>preds_probs <span class="ot">&lt;-</span> <span class="fu">fitted</span>(modele3)</span>
<span id="cb807-2"><a href="sect082.html#cb807-2" aria-hidden="true" tabindex="-1"></a>pred_cat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)[<span class="fu">max.col</span>(preds_probs)]</span>
<span id="cb807-3"><a href="sect082.html#cb807-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb807-4"><a href="sect082.html#cb807-4" aria-hidden="true" tabindex="-1"></a>matrices <span class="ot">&lt;-</span> <span class="fu">nice_confusion_matrix</span>(data_airbnb2<span class="sc">$</span>fac_price_cat,pred_cat)</span>
<span id="cb807-5"><a href="sect082.html#cb807-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher la matrice de confusion</span></span>
<span id="cb807-6"><a href="sect082.html#cb807-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matrices<span class="sc">$</span>confusion_matrix)</span></code></pre></div>
<pre><code>##           rowsnames    1          2          3          rs      rp    
## colsnames &quot;&quot;           &quot;1 (reel)&quot; &quot;2 (reel)&quot; &quot;3 (reel)&quot; &quot;Total&quot; &quot;%&quot;   
## 1         &quot;1 (predit)&quot; &quot;1576&quot;     &quot;736&quot;      &quot;168&quot;      &quot;2480&quot;  &quot;27.7&quot;
## 2         &quot;2 (predit)&quot; &quot;579&quot;      &quot;2385&quot;     &quot;1331&quot;     &quot;4295&quot;  &quot;48&quot;  
## 3         &quot;3 (predit)&quot; &quot;49&quot;       &quot;771&quot;      &quot;1360&quot;     &quot;2180&quot;  &quot;24.3&quot;
##           &quot;Total&quot;      &quot;2204&quot;     &quot;3892&quot;     &quot;2859&quot;     &quot;8955&quot;  NA    
##           &quot;%&quot;          &quot;24.6&quot;     &quot;43.5&quot;     &quot;31.9&quot;     NA      NA</code></pre>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="sect082.html#cb809-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les indicateurs de qualité de prédiction</span></span>
<span id="cb809-2"><a href="sect082.html#cb809-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matrices<span class="sc">$</span>indicators)</span></code></pre></div>
<pre><code>##              rnames                           precision rappel F1    
## 1            &quot;1&quot;                              &quot;0.64&quot;    &quot;0.72&quot; &quot;0.67&quot;
## 2            &quot;2&quot;                              &quot;0.56&quot;    &quot;0.61&quot; &quot;0.58&quot;
## 3            &quot;3&quot;                              &quot;0.62&quot;    &quot;0.48&quot; &quot;0.54&quot;
## macro_scores &quot;macro&quot;                          &quot;0.6&quot;     &quot;0.59&quot; &quot;0.59&quot;
##              &quot;Kappa&quot;                          &quot;0.37&quot;    NA     NA    
##              &quot;Valeur de p  (precision &gt; NIR)&quot; &quot;0&quot;       NA     NA</code></pre>
<p>Le modèle a une précision totale de 61 % (61 % des observations ont été correctement prédites). La catégorie 1 a de loin la meilleure précision (72 %) et la 3 a la pire (48 %), ce qui indique qu’il manque vraisemblablement des variables indépendantes contribuant à prédire les prix des logements les plus chers. Le coefficient de Kappa () indique un niveau d’accord entre modéré et faible, mais le modèle parvient à une prédiction significativement supérieure au seuil de non-information. Si l’ajustement du modèle est imparfait, il est suffisamment fiable pour nous donner des renseignements pertinents sur le phénomène étudié.</p>
<p><strong>Interprétation des résultats</strong></p>
<p>L’ensemble des coefficients du modèle sont accessibles via la fonction <code>summary</code>. À partir des coefficients et de leurs erreurs standards, il est possible de calculer les rapports de cotes ainsi que leurs intervalles de confiances.</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="sect082.html#cb811-1" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> <span class="fu">summary</span>(modele3)<span class="sc">@</span>coef3</span>
<span id="cb811-2"><a href="sect082.html#cb811-2" aria-hidden="true" tabindex="-1"></a>rappCote <span class="ot">&lt;-</span> <span class="fu">exp</span>(tableau[,<span class="dv">1</span>])</span>
<span id="cb811-3"><a href="sect082.html#cb811-3" aria-hidden="true" tabindex="-1"></a>rappCote2<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(tableau[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> tableau[,<span class="dv">2</span>])</span>
<span id="cb811-4"><a href="sect082.html#cb811-4" aria-hidden="true" tabindex="-1"></a>rappCote97<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">exp</span>(tableau[,<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> tableau[,<span class="dv">2</span>])</span>
<span id="cb811-5"><a href="sect082.html#cb811-5" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tableau, rappCote, rappCote2<span class="fl">.5</span>, rappCote97<span class="fl">.5</span>)</span>
<span id="cb811-6"><a href="sect082.html#cb811-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(tableau,<span class="dv">3</span>))</span></code></pre></div>
<pre><code>##                           Estimate Std. Error z value Pr(&gt;|z|) rappCote rappCote2.5 rappCote97.5
## (Intercept):1               -1.203      0.137  -8.768    0.000    0.300       0.230        0.393
## (Intercept):2               -3.240      0.151 -21.516    0.000    0.039       0.029        0.053
## beds                         0.748      0.027  28.143    0.000    2.113       2.006        2.226
## Garden_or_backyardYES        0.120      0.067   1.795    0.073    1.128       0.989        1.287
## Host_greets_youYES           0.094      0.060   1.548    0.122    1.098       0.975        1.236
## Free_street_parkingYES      -0.015      0.046  -0.320    0.749    0.985       0.900        1.078
## prt_veg_500m                -0.026      0.003 -10.182    0.000    0.975       0.970        0.980
## has_metro_500mYES            0.063      0.048   1.326    0.185    1.065       0.970        1.170
## commercial_1km               0.008      0.008   0.955    0.340    1.008       0.992        1.024
## privateEntier:1              2.445      0.062  39.241    0.000   11.533      10.207       13.031
## privateEntier:2              1.576      0.081  19.573    0.000    4.834       4.128        5.660
## cat_review                   0.200      0.021   9.563    0.000    1.222       1.173        1.273
## host_total_listings_count   -0.002      0.001  -2.094    0.036    0.998       0.996        1.000</code></pre>
<p>Pour faciliter la lecture des résultats, nous proposons le tableau <a href="sect082.html#tab:TabFinalOrdinale">8.14</a>.</p>
<table>
<caption>
<span id="tab:TabFinalOrdinale">Tableau 8.14: </span>Coefficients du modèle logistique des cotes proportionnelles
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coefficient
</th>
<th style="text-align:right;">
RC
</th>
<th style="text-align:right;">
P
</th>
<th style="text-align:right;">
RC 2,5 %
</th>
<th style="text-align:right;">
RC 97,5 %
</th>
<th style="text-align:right;">
sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept):1
</td>
<td style="text-align:right;">
-1,200
</td>
<td style="text-align:right;">
0,300
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,230
</td>
<td style="text-align:right;">
0,395
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept):2
</td>
<td style="text-align:right;">
-3,240
</td>
<td style="text-align:right;">
0,039
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,029
</td>
<td style="text-align:right;">
0,052
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
beds
</td>
<td style="text-align:right;">
0,750
</td>
<td style="text-align:right;">
2,113
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
2,014
</td>
<td style="text-align:right;">
2,226
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Garden_or_backyard</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : NO
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
YES
</td>
<td style="text-align:right;">
0,120
</td>
<td style="text-align:right;">
1,128
</td>
<td style="text-align:right;">
0,073
</td>
<td style="text-align:right;">
0,990
</td>
<td style="text-align:right;">
1,284
</td>
<td style="text-align:right;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Host_greets_you</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : NO
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
YES
</td>
<td style="text-align:right;">
0,090
</td>
<td style="text-align:right;">
1,098
</td>
<td style="text-align:right;">
0,122
</td>
<td style="text-align:right;">
0,980
</td>
<td style="text-align:right;">
1,234
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Free_street_parking</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : NO
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
YES
</td>
<td style="text-align:right;">
-0,010
</td>
<td style="text-align:right;">
0,985
</td>
<td style="text-align:right;">
0,749
</td>
<td style="text-align:right;">
0,896
</td>
<td style="text-align:right;">
1,083
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
prt_veg_500m
</td>
<td style="text-align:right;">
-0,030
</td>
<td style="text-align:right;">
0,975
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,970
</td>
<td style="text-align:right;">
0,980
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>has_metro_500m</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : NO
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
YES
</td>
<td style="text-align:right;">
0,060
</td>
<td style="text-align:right;">
1,065
</td>
<td style="text-align:right;">
0,185
</td>
<td style="text-align:right;">
0,970
</td>
<td style="text-align:right;">
1,174
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
commercial_1km
</td>
<td style="text-align:right;">
0,010
</td>
<td style="text-align:right;">
1,008
</td>
<td style="text-align:right;">
0,340
</td>
<td style="text-align:right;">
0,990
</td>
<td style="text-align:right;">
1,020
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
cat_review
</td>
<td style="text-align:right;">
0,200
</td>
<td style="text-align:right;">
1,222
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,174
</td>
<td style="text-align:right;">
1,271
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
host_total_listings_count
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,998
</td>
<td style="text-align:right;">
0,036
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
<strong>Effets par niveau</strong>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>private</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : Chambre
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
Entier:1
</td>
<td style="text-align:right;">
2,450
</td>
<td style="text-align:right;">
11,533
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
10,176
</td>
<td style="text-align:right;">
13,066
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Entier:2
</td>
<td style="text-align:right;">
1,580
</td>
<td style="text-align:right;">
4,834
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
4,137
</td>
<td style="text-align:right;">
5,641
</td>
<td style="text-align:right;">
***
</td>
</tr>
</tbody>
</table></li>
</ul>
<p>Sans surprise, chaque lit supplémentaire contribue à augmenter les chances que le logement soit dans une catégorie de prix supérieure (multiplication par deux à chaque lit supplémentaire). En revanche, la présence d’un stationnement gratuit, d’un jardin et l’accueil en personne par l’hôte n’ont pas d’effets significatifs. Comme l’indiquent les articles mentionnés en début de section, les revues positives augmentent la probabilité d’appartenir à une catégorie supérieure de prix. Pour chaque point supplémentaire sur l’échelle de 1 à 5, la probabilité d’appartenir à une catégorie de prix supérieure augmente de 22,2 %. Il est intéressant de noter que le fait de disposer du logement entier plutôt que d’une simple chambre augmente davantage les chances de passer du groupe de prix 1 à 2 (multiplication par 2,45) que du groupe 2 à 3 (multiplication par 1,58). Il semble également que si l’hôte possède plusieurs logements, la probabilité d’avoir une classe de prix supérieure diminue légèrement. Cependant, l’effet est trop petit pour pouvoir se livrer à des interprétations.</p>
<p>Les variables environnementales ont peu d’effet : le pourcentage de surface commerciale dans un rayon d’un kilomètre et la présence d’une station de métro ne sont pas significatifs. En revanche, une augmentation de la surface végétale dans un rayon de 500 mètres tend à réduire la probabilité d’appartenir à une classe supérieure. Notre hypothèse concernant ce résultat est que cette variable représente un effet associé à la localisation des Airbnb, les plus centraux ayant tendance à être plus dispendieux, mais avec un environnement moins vert et inversement. Pour l’illustrer, prédisons les probabilités d’appartenance aux différents niveaux de prix d’un logement avec les caractéristiques suivantes : entièrement privé, 2 lits, un jardin, une place de stationnement gratuite, l’hôte ne dispose que d’un logement sur Airbnb et accueille les arrivants en personne, 10 % de surface commerciale dans un rayon d’un kilomètre, noté 2 comme catégorie de revue, absence de métro dans un rayon de 500 mètres.</p>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="sect082.html#cb813-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Créer un jeu de données pour effectuer des prédictions</span></span>
<span id="cb813-2"><a href="sect082.html#cb813-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb813-3"><a href="sect082.html#cb813-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prt_veg_500m =</span> <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">90</span>),</span>
<span id="cb813-4"><a href="sect082.html#cb813-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">beds =</span> <span class="dv">2</span>, </span>
<span id="cb813-5"><a href="sect082.html#cb813-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Garden_or_backyard =</span> <span class="st">&quot;YES&quot;</span>,</span>
<span id="cb813-6"><a href="sect082.html#cb813-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Host_greets_you =</span> <span class="st">&quot;YES&quot;</span>,</span>
<span id="cb813-7"><a href="sect082.html#cb813-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Free_street_parking =</span> <span class="st">&quot;YES&quot;</span>,</span>
<span id="cb813-8"><a href="sect082.html#cb813-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">has_metro_500m =</span> <span class="st">&quot;NO&quot;</span>,</span>
<span id="cb813-9"><a href="sect082.html#cb813-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">commercial_1km =</span> <span class="dv">10</span>,</span>
<span id="cb813-10"><a href="sect082.html#cb813-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">private =</span> <span class="st">&quot;Entier&quot;</span>,</span>
<span id="cb813-11"><a href="sect082.html#cb813-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cat_review =</span> <span class="dv">2</span>,</span>
<span id="cb813-12"><a href="sect082.html#cb813-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">host_total_listings_count =</span> <span class="dv">1</span></span>
<span id="cb813-13"><a href="sect082.html#cb813-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb813-14"><a href="sect082.html#cb813-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Effectuer les prédictions (dans l&#39;échelle log)</span></span>
<span id="cb813-15"><a href="sect082.html#cb813-15" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele3, <span class="at">newdata =</span> df, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>, <span class="at">se.fit=</span>T)</span>
<span id="cb813-16"><a href="sect082.html#cb813-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Définir l&#39;inverse de la fonction de lien</span></span>
<span id="cb813-17"><a href="sect082.html#cb813-17" aria-hidden="true" tabindex="-1"></a>ilink <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">exp</span>(x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(x))}</span>
<span id="cb813-18"><a href="sect082.html#cb813-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les probabilités et leurs intervalles de confiance</span></span>
<span id="cb813-19"><a href="sect082.html#cb813-19" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;P[Y&gt;=2]&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">ilink</span>(preds<span class="sc">$</span>fitted.values[,<span class="dv">1</span>])</span>
<span id="cb813-20"><a href="sect082.html#cb813-20" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;P[Y&gt;=2] 2,5&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">ilink</span>(preds<span class="sc">$</span>fitted.values[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> preds<span class="sc">$</span>se.fit[,<span class="dv">1</span>])</span>
<span id="cb813-21"><a href="sect082.html#cb813-21" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;P[Y&gt;=2] 97,5&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">ilink</span>(preds<span class="sc">$</span>fitted.values[,<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> preds<span class="sc">$</span>se.fit[,<span class="dv">1</span>])</span>
<span id="cb813-22"><a href="sect082.html#cb813-22" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;P[Y&gt;=3]&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">ilink</span>(preds<span class="sc">$</span>fitted.values[,<span class="dv">2</span>])</span>
<span id="cb813-23"><a href="sect082.html#cb813-23" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;P[Y&gt;=3] 2,5&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">ilink</span>(preds<span class="sc">$</span>fitted.values[,<span class="dv">2</span>] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> preds<span class="sc">$</span>se.fit[,<span class="dv">2</span>])</span>
<span id="cb813-24"><a href="sect082.html#cb813-24" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;P[Y&gt;=3] 97,5&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">ilink</span>(preds<span class="sc">$</span>fitted.values[,<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> preds<span class="sc">$</span>se.fit[,<span class="dv">2</span>])</span>
<span id="cb813-25"><a href="sect082.html#cb813-25" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;P[Y=1]&quot;</span>]] <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>df[[<span class="st">&quot;P[Y&gt;=2]&quot;</span>]]</span>
<span id="cb813-26"><a href="sect082.html#cb813-26" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;P[Y=1] 2,5&quot;</span> ]] <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>df[[<span class="st">&quot;P[Y&gt;=2] 2,5&quot;</span>]]</span>
<span id="cb813-27"><a href="sect082.html#cb813-27" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;P[Y=1] 97,5&quot;</span>]] <span class="ot">=</span> <span class="dv">1</span><span class="sc">-</span>df[[<span class="st">&quot;P[Y&gt;=2] 97,5&quot;</span>]]</span>
<span id="cb813-28"><a href="sect082.html#cb813-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les résultats</span></span>
<span id="cb813-29"><a href="sect082.html#cb813-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> df) <span class="sc">+</span> </span>
<span id="cb813-30"><a href="sect082.html#cb813-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> prt_veg_500m, </span>
<span id="cb813-31"><a href="sect082.html#cb813-31" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ymin =</span> <span class="st">`</span><span class="at">P[Y&gt;=2] 2,5</span><span class="st">`</span>,</span>
<span id="cb813-32"><a href="sect082.html#cb813-32" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ymax =</span> <span class="st">`</span><span class="at">P[Y&gt;=2] 97,5</span><span class="st">`</span>),<span class="at">fill =</span><span class="st">&quot;#f94144&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb813-33"><a href="sect082.html#cb813-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> prt_veg_500m, <span class="at">y =</span> <span class="st">`</span><span class="at">P[Y&gt;=2]</span><span class="st">`</span>,<span class="at">color=</span><span class="st">&quot;Y2&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb813-34"><a href="sect082.html#cb813-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> prt_veg_500m, </span>
<span id="cb813-35"><a href="sect082.html#cb813-35" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ymin =</span> <span class="st">`</span><span class="at">P[Y&gt;=3] 2,5</span><span class="st">`</span>,</span>
<span id="cb813-36"><a href="sect082.html#cb813-36" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ymax =</span> <span class="st">`</span><span class="at">P[Y&gt;=3] 97,5</span><span class="st">`</span>), <span class="at">fill =</span><span class="st">&quot;#90be6d&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb813-37"><a href="sect082.html#cb813-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> prt_veg_500m, <span class="at">y =</span> <span class="st">`</span><span class="at">P[Y&gt;=3]</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;Y3&quot;</span> )) <span class="sc">+</span> </span>
<span id="cb813-38"><a href="sect082.html#cb813-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">x =</span> prt_veg_500m, </span>
<span id="cb813-39"><a href="sect082.html#cb813-39" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ymin =</span> <span class="st">`</span><span class="at">P[Y=1] 2,5</span><span class="st">`</span>,</span>
<span id="cb813-40"><a href="sect082.html#cb813-40" aria-hidden="true" tabindex="-1"></a>                         <span class="at">ymax =</span> <span class="st">`</span><span class="at">P[Y=1] 97,5</span><span class="st">`</span>),<span class="at">fill =</span><span class="st">&quot;#277da1&quot;</span> , <span class="at">alpha =</span> <span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb813-41"><a href="sect082.html#cb813-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">x =</span> prt_veg_500m, <span class="at">y =</span> <span class="st">`</span><span class="at">P[Y=1]</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">&quot;Y1&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb813-42"><a href="sect082.html#cb813-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">&quot;Probabilités prédites&quot;</span>,</span>
<span id="cb813-43"><a href="sect082.html#cb813-43" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>, <span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>),</span>
<span id="cb813-44"><a href="sect082.html#cb813-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;P[Y=1]&quot;</span>, <span class="st">&quot;P[Y&gt;=2]&quot;</span>, <span class="st">&quot;P[Y&gt;=3]&quot;</span>),</span>
<span id="cb813-45"><a href="sect082.html#cb813-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Y2&quot;</span> <span class="ot">=</span> <span class="st">&quot;#f94144&quot;</span>, <span class="st">&quot;Y3&quot;</span> <span class="ot">=</span> <span class="st">&quot;#90be6d&quot;</span>,</span>
<span id="cb813-46"><a href="sect082.html#cb813-46" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Y1&quot;</span> <span class="ot">=</span> <span class="st">&quot;#277da1&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb813-47"><a href="sect082.html#cb813-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Densité de végétation (%)&quot;</span>,</span>
<span id="cb813-48"><a href="sect082.html#cb813-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Probabilité&quot;</span>,</span>
<span id="cb813-49"><a href="sect082.html#cb813-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Y1 : moins de 50 $; Y2 : 50 à 99 $; Y3 : 100 à 249 $&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:predpricecatveg"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/predpricecatveg-1.png" alt="Prédiction de la probabilité d'appartenance aux trois catégories de prix en fonction de la densité de végétation" width="65%" />
<p class="caption">
Figure 8.17: Prédiction de la probabilité d’appartenance aux trois catégories de prix en fonction de la densité de végétation
</p>
</div>
<p>Nous constatons, à la figure <a href="sect082.html#fig:predpricecatveg">8.17</a>, que les probabilités d’appartenir aux niveaux 2 et 3 diminuent à mesure qu’augmente le pourcentage de végétation. La probabilité d’appartenir à la classe 2 et plus (en rouge) passe de plus de 95 % en cas d’absence de végétation et à environ 75 % avec 80 % de végétation dans un rayon de 500 mètres. Comme vous pouvez le constater, la probabilité <span class="math inline">\(P[Y=1]\)</span> est la symétrie de <span class="math inline">\(P[Y&gt;=2]\)</span> puisque <span class="math inline">\(P[Y=1]+P[Y&gt;=2] = 1\)</span>.</p>
</div>
</div>
<div id="sect0824" class="section level3 hasAnchor" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> Modèle logistique multinomial<a href="sect082.html#sect0824" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La régression logistique multinomiale est utilisée pour modéliser une variable <em>Y</em> qualitative multinomiale, c’est-à-dire une variable dont les modalités ne peuvent pas être ordonnées. Dans le modèle précédent, nous avons vu qu’il était possible de modéliser une variable ordinale avec une distribution binomiale en formulant l’hypothèse de la proportionnalité des cotes. Avec une variable multinomiale, cette hypothèse ne tient plus, car les catégories ne sont plus ordonnées. Il faut donc formuler le modèle différemment.</p>
<p>L’idée derrière un modèle multinomial est de choisir une catégorie de référence, puis de modéliser les probabilités d’appartenir à chaque autre catégorie plutôt qu’à cette catégorie de référence (tableau <a href="sect082.html#tab:multinomdentity">8.15</a>). Si nous avons <em>K</em> catégories possibles dans notre variable <em>Y</em>, nous obtenons <em>K</em>-1 comparaisons. Chaque comparaison est modélisée avec sa propre équation, ce qui génère de nombreux paramètres. Par exemple, admettons que notre variable <em>Y</em> a cinq catégories et que nous disposons de six variables <em>X</em> prédictives. Nous avons ainsi 4 (5-1) équations de régression avec 7 paramètres (6 coefficients et une constante), soit 28 coefficients à analyser.</p>
<p>Considérant cette tendance à la multiplication des coefficients, il est fréquent de recourir à une méthode appelée <em>Analyse de type 3</em> pour limiter au maximum le nombre de variables indépendantes (VI) dans le modèle. L’idée de cette méthode est de recalculer plusieurs versions du modèle dans lesquelles une variable indépendante est retirée, puis de réaliser un test de rapport de vraisemblance en comparant ce nouveau modèle (complet moins une VI) au modèle complet (toutes les VI) pour vérifier si la variable en question améliore significativement le modèle. Il est alors possible de retirer toutes les variables dont l’apport est négligeable si elles sont également peu intéressantes du point de vue théorique.</p>
<table>
<caption>
<span id="tab:multinomdentity">Tableau 8.15: </span>Carte d’identité du modèle logistique multinomial
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable qualitative multinomiale avec <em>K</em> catégories
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Binomiale
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim Binomial(p)\)</span> <br/> <span class="math inline">\(g(p = k\text{ avec }ref = a) = \beta_{0k} + \beta X_{k}\)</span> <br/> <span class="math inline">\(g(x) = \frac{log(x)}{1-x}\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
Logistique
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
p
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_{0k}\)</span>, <span class="math inline">\(\beta\)</span>k pour <span class="math inline">\(k \in [2,...,K]\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Non-séparation complète, absence de sur-dispersion ou de sous-dispersion, Indépendance des alternatives non pertinentes
</td>
</tr>
</tbody>
</table>
<div id="conditions-dapplication-1" class="section level4 hasAnchor" number="8.2.4.1">
<h4><span class="header-section-number">8.2.4.1</span> Conditions d’application<a href="sect082.html#conditions-dapplication-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Les conditions d’application sont les mêmes que pour un modèle binomial, avec l’ajout de l’hypothèse sur <strong>l’indépendance des alternatives non pertinentes</strong>. Cette dernière suppose que le choix entre deux catégories est indépendant des catégories proposées. Voici un exemple simple pour illustrer cette hypothèse: admettons que nous disposons d’une trentaine de personnes et que nous leur demandons la couleur de leurs yeux. Cette variable ne serait pas affectée par la présence de nouvelles couleurs en dehors de notre échantillon. En revanche, si nous leur demandons de choisir un mode de transport parmi une liste pour se rendre à leur lieu de travail, leur réponse serait nécessairement affectée par la liste des modes de transport disponibles. Les tests développés pour vérifier cette hypothèse sont connus pour leur <a href="https://statisticalhorizons.com/iia">faible fiabilité</a>. Il est plus pertinent de décider théoriquement si cette hypothèse est valide ou non. Dans le cas contraire, il est possible d’utiliser une classe de modèle logistique plus rare: le modèle logistique imbriqué.</p>
<p>Notez également que le grand nombre de paramètres dans ce type de modèle implique de disposer d’un plus grand nombre d’observations afin d’avoir suffisamment d’information dans chaque catégorie pour ajuster tous les paramètres.</p>
<p>Pour vérifier la présence de sur-dispersion, il est possible, dans le cas du modèle multinomial, de calculer le rapport entre le khi-deux de Pearson et le nombre de degrés de liberté du modèle. Si ce rapport est supérieur à 1 (des valeurs jusqu’à 1,15 ne sont pas problématiques), alors le modèle souffre de sur-dispersion <span class="citation">(<a href="#ref-Sasmultinom" role="doc-biblioref">SAS Institute Inc 2020a</a>)</span>. Le khi-deux de Pearson est simplement la somme des résidus de Pearson au carré dans le cas d’un modèle GLM.</p>
<p><span class="math display" id="eq:glm15">\[\begin{equation}
\chi^2 = \sum_{i=1}^N\sum_{c=1}^K{\frac{(y_{ic} - p_{ic})^2}{p_{ic}}}
\tag{8.18}
\end{equation}\]</span>
</p>
<p>Avec <span class="math inline">\(y_{ic}\)</span> 1 si l’observation <em>i</em> appartient à la catégorie <em>c</em>, 0 autrement, <span class="math inline">\(p_{ic}\)</span> la probabilité prédite pour l’observation <em>i</em> d’appartenir à la catégorie <em>c</em>, <em>N</em> le nombre d’observations et <em>K</em> le nombre de catégories.</p>
<p>Le ratio est ensuite calculé comme suit: <span class="math inline">\(\frac{\chi^2}{(N - p)(K-1)}\)</span>, avec <em>N</em> le nombre d’observations et <em>K</em> le nombre de modalités dans la variable <em>Y</em>. Si ce ratio est égal ou supérieur à 1, alors le modèle souffre de sur-dispersion, si le ratio est inférieur à 1, le modèle souffre de sous-dispersion. Un léger écart (&gt; 0,15) n’est pas considéré comme problématique.</p>
<div class="bloc_aller_loin">
<p><strong>Le modèle logistique imbriqué</strong></p>
<p>Du fait de sa proximité avec les modèles à effets mixtes que nous abordons au chapitre <a href="chap09.html#chap09">9</a>, nous ne détaillons pas ici le modèle logistique imbriqué, mais présentons plutôt son principe général. Il s’agit d’une généralisation du modèle logistique multinomial basé sur l’idée que certaines catégories pourraient être regroupées dans des « nids » (<em>nest</em> en anglais). Dans ces groupes, les erreurs peuvent être corrélées, indiquant ainsi que si une catégorie est manquante, une autre catégorie du même groupe sera préférée. Un paramètre <span class="math inline">\(\lambda\)</span> contrôle spécifiquement cette corrélation et permet de mesurer sa force une fois le modèle ajusté. Il peut être pertinent de comparer un modèle imbriqué à un modèle multinomial pour déterminer lequel des deux est le mieux ajusté aux données.</p>
</div>
</div>
<div id="exemple-appliqué-dans-r-1" class="section level4 hasAnchor" number="8.2.4.2">
<h4><span class="header-section-number">8.2.4.2</span> Exemple appliqué dans R<a href="sect082.html#exemple-appliqué-dans-r-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour cet exemple, nous reproduisons une partie de l’analyse effectuée dans l’étude de <span class="citation">McFadden (<a href="#ref-mcfadden2016examining" role="doc-biblioref">2016</a>)</span>. Cet article s’intéresse aux écarts entre les croyances des individus et les connaissances scientifiques sur les sujets des OGM et du réchauffement climatique. Les auteurs utilisent pour cela des données issues d’une enquête auprès de 961 individus formant un échantillon représentatif de la population des États-Unis. Les données issues de cette enquête sont téléchargeables sur le <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0166140">site de l’éditeur</a>, ce qui nous permet ici de reproduire l’analyse effectuée par les auteurs. Deux questions sont centrales dans l’enquête :</p>
<ul>
<li>Dans quelle mesure êtes-vous en accord ou en désaccord avec la phrase suivante : les plantations génétiquement modifiées sont sans danger pour la consommation ?</li>
<li>Dans quelle mesure êtes-vous en accord ou en désaccord avec la phrase suivante : la Terre se réchauffe du fait des activités humaines ?</li>
</ul>
<p>Pour ces deux questions, les répondants devaient sélectionner leur degré d’accord sur une échelle de Likert allant de 1 (fortement en désaccord) à 5 (fortement en accord). Les réponses à ces deux questions ont été utilisées pour former une variable multinomiale à quatre modalités :</p>
<ul>
<li>A. Les individus sont en accord avec les deux propositions.</li>
<li>B. Les individus sont en désaccord sur les OGM, mais en accord sur le réchauffement climatique.</li>
<li>C. Les individus sont en accord sur les OGM, mais en désaccord sur le réchauffement climatique.</li>
<li>D. Les individus sont en désaccord avec les deux propositions.</li>
</ul>
<p>Un modèle logistique multinomial a été utilisé pour déterminer quels facteurs contribuent à la probabilité d’appartenir à ces différentes catégories. Les variables indépendantes présentes dans le modèle sont détaillées dans le tableau <a href="sect082.html#tab:variablemultinom">8.16</a>. Les auteurs avaient notamment conclu que :</p>
<ul>
<li>Les effets des connaissances (réelles ou perçues) sur l’appartenance aux différentes catégories n’étaient pas uniformes et pouvaient varier en fonction du sujet.</li>
<li>L’orientation politique avait une influence significative sur les croyances.</li>
<li>Les répondants avec de plus hauts résultats au test de cognition CRT avaient plus souvent des opinions divergentes de la communauté scientifique.</li>
</ul>
<table>
<caption>
<span id="tab:variablemultinom">Tableau 8.16: </span>Variables indépendantes utilisées dans le modèle logistique multinomial
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nom de la variable
</th>
<th style="text-align:left;">
signification
</th>
<th style="text-align:left;">
Type de variable
</th>
<th style="text-align:left;">
Mesure
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PercepOGM
</td>
<td style="text-align:left;">
La recherche scientifique supporte ma vision sur la sécurité des plantes OGM
</td>
<td style="text-align:left;">
Variable ordinale
</td>
<td style="text-align:left;">
Échelle de Likert de 1 (fortement en désaccord) à 5 (fortement en accord)
</td>
</tr>
<tr>
<td style="text-align:left;">
PercepRechClim
</td>
<td style="text-align:left;">
La recherche scientifique supporte ma vision sur le réchauffement climatique
</td>
<td style="text-align:left;">
Variable ordinale
</td>
<td style="text-align:left;">
Échelle de Likert de 1 (fortement en désaccord) à 5 (fortement en accord)
</td>
</tr>
<tr>
<td style="text-align:left;">
ConnaisOGM
</td>
<td style="text-align:left;">
Niveau de connaissance sur les OGM
</td>
<td style="text-align:left;">
Variable ordinale
</td>
<td style="text-align:left;">
Nombre de réponses sur trois questions portant sur les OGM
</td>
</tr>
<tr>
<td style="text-align:left;">
ConnaisRechClim
</td>
<td style="text-align:left;">
Niveau de connaissance sur le réchauffement climatique
</td>
<td style="text-align:left;">
Variable ordinale
</td>
<td style="text-align:left;">
Nombre de réponses sur trois questions portant sur le réchauffement climatique
</td>
</tr>
<tr>
<td style="text-align:left;">
CRT
</td>
<td style="text-align:left;">
Score obtenu au Cognitive Reflection Test, utilisé pour déterminer la propension à faire preuve d’esprit d’analyse plutôt que choisir des réponses intuitives
</td>
<td style="text-align:left;">
Variable ordinale
</td>
<td style="text-align:left;">
Nombre de réponses sur trois questions pièges
</td>
</tr>
<tr>
<td style="text-align:left;">
Parti
</td>
<td style="text-align:left;">
Orientation politique du répondant
</td>
<td style="text-align:left;">
Variable multinomiale
</td>
<td style="text-align:left;">
Républicain, démocrate et autre
</td>
</tr>
<tr>
<td style="text-align:left;">
Sexe
</td>
<td style="text-align:left;">
Sexe du répondant
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Femme ou homme
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:left;">
Âge du répondant
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Âge du répondant
</td>
</tr>
<tr>
<td style="text-align:left;">
Revenu
</td>
<td style="text-align:left;">
Niveau de revenu du répondant
</td>
<td style="text-align:left;">
Variable ordinale
</td>
<td style="text-align:left;">
Échelle de 1 (moins de 20 000 $) à (140 000 $ et plus)
</td>
</tr>
</tbody>
</table>
<p><strong>Vérification des conditions d’application</strong></p>
<p>Avant d’ajuster le modèle, nous commençons par vérifier l’absence de multicolinéarité excessive entre les variables indépendantes. Toutes les valeurs de VIF sont inférieures à 2, indiquant bien une absence de multicolinéarité.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="sect082.html#cb814-1" aria-hidden="true" tabindex="-1"></a>data_quest <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/glm/enquete_PublicOpinion_vs_Science.csv&quot;</span>)</span>
<span id="cb814-2"><a href="sect082.html#cb814-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Choix des valeurs de références dans les facteurs</span></span>
<span id="cb814-3"><a href="sect082.html#cb814-3" aria-hidden="true" tabindex="-1"></a>data_quest<span class="sc">$</span>Parti <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(data_quest<span class="sc">$</span>Parti), <span class="at">ref =</span> <span class="st">&quot;Democrate&quot;</span>)</span>
<span id="cb814-4"><a href="sect082.html#cb814-4" aria-hidden="true" tabindex="-1"></a>data_quest<span class="sc">$</span>Sexe <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(data_quest<span class="sc">$</span>Sexe), <span class="at">ref =</span> <span class="st">&quot;homme&quot;</span>)</span>
<span id="cb814-5"><a href="sect082.html#cb814-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">glm</span>(SCIGM <span class="sc">~</span> PercepOGM <span class="sc">+</span> PercepRechClim <span class="sc">+</span> ConnaisOGM <span class="sc">+</span> ConnaisRechClim <span class="sc">+</span></span>
<span id="cb814-6"><a href="sect082.html#cb814-6" aria-hidden="true" tabindex="-1"></a>          CRT <span class="sc">+</span> Parti <span class="sc">+</span> AGE <span class="sc">+</span> Sexe <span class="sc">+</span> Revenu, <span class="at">data =</span> data_quest))</span></code></pre></div>
<pre><code>##                     GVIF Df GVIF^(1/(2*Df))
## PercepOGM       1.092693  1        1.045320
## PercepRechClim  1.177495  1        1.085125
## ConnaisOGM      1.150662  1        1.072689
## ConnaisRechClim 1.158438  1        1.076307
## CRT             1.155371  1        1.074882
## Parti           1.130817  2        1.031212
## AGE             1.071655  1        1.035208
## Sexe            1.064918  1        1.031949
## Revenu          1.049499  1        1.024451</code></pre>
<p>La seconde étape est d’ajuster le modèle et de vérifier l’absence de sur ou sous-dispersion. Pour ajuster le modèle, nous utilisons à nouveau la fonction <code>vglm</code> du <em>package</em> <code>VGAM</code>, avec le paramètre <code>family = multinomial()</code>. Le ratio entre la statistique de Pearson et le nombre de degrés de liberté du modèle indique une absence de sur ou sous-dispersion (1,04).</p>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="sect082.html#cb816-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle</span></span>
<span id="cb816-2"><a href="sect082.html#cb816-2" aria-hidden="true" tabindex="-1"></a>modele <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Y <span class="sc">~</span> PercepOGM <span class="sc">+</span> PercepRechClim <span class="sc">+</span> ConnaisOGM <span class="sc">+</span> ConnaisRechClim <span class="sc">+</span> </span>
<span id="cb816-3"><a href="sect082.html#cb816-3" aria-hidden="true" tabindex="-1"></a>                 CRT <span class="sc">+</span> Parti <span class="sc">+</span> AGE <span class="sc">+</span> Sexe <span class="sc">+</span> Revenu,</span>
<span id="cb816-4"><a href="sect082.html#cb816-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_quest, </span>
<span id="cb816-5"><a href="sect082.html#cb816-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="st">&quot;A&quot;</span>), <span class="at">model =</span> T)</span>
<span id="cb816-6"><a href="sect082.html#cb816-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du Khi2 de Pearson</span></span>
<span id="cb816-7"><a href="sect082.html#cb816-7" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele, <span class="at">type=</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb816-8"><a href="sect082.html#cb816-8" aria-hidden="true" tabindex="-1"></a>cat_predict <span class="ot">&lt;-</span> <span class="fu">colnames</span>(pred)[<span class="fu">max.col</span>(pred)]</span>
<span id="cb816-9"><a href="sect082.html#cb816-9" aria-hidden="true" tabindex="-1"></a>freq_real <span class="ot">&lt;-</span> <span class="fu">table</span>(data_quest<span class="sc">$</span>Y)</span>
<span id="cb816-10"><a href="sect082.html#cb816-10" aria-hidden="true" tabindex="-1"></a>freq_pred <span class="ot">&lt;-</span> <span class="fu">table</span>(cat_predict)</span>
<span id="cb816-11"><a href="sect082.html#cb816-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb816-12"><a href="sect082.html#cb816-12" aria-hidden="true" tabindex="-1"></a>khi2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(modele, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb816-13"><a href="sect082.html#cb816-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb816-14"><a href="sect082.html#cb816-14" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_quest)</span>
<span id="cb816-15"><a href="sect082.html#cb816-15" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> modele<span class="sc">@</span>rank</span>
<span id="cb816-16"><a href="sect082.html#cb816-16" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">length</span>(freq_real)</span>
<span id="cb816-17"><a href="sect082.html#cb816-17" aria-hidden="true" tabindex="-1"></a>ratio <span class="ot">&lt;-</span> khi2 <span class="sc">/</span> ((N<span class="sc">-</span>p)<span class="sc">*</span>(r<span class="dv">-1</span>))</span>
<span id="cb816-18"><a href="sect082.html#cb816-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ratio)</span></code></pre></div>
<pre><code>## [1] 1.045889</code></pre>
<p>La troisième étape de la vérification des conditions d’application est l’analyse des distances de Cook. À nouveau, puisque le modèle évalue la probabilité d’appartenir à <span class="math inline">\(K-1\)</span> catégorie, nous pouvons calculer <span class="math inline">\(K-1\)</span> résidus par observation et par extension <span class="math inline">\(K-1\)</span> distances de Cook. Aucune observation ne semble se détacher nettement dans la figure <a href="sect082.html#fig:cookmultinom">8.18</a>. Nous décidons donc pour le moment de conserver toutes les observations.</p>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="sect082.html#cb818-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des résidus</span></span>
<span id="cb818-2"><a href="sect082.html#cb818-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">residuals</span>(modele, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb818-3"><a href="sect082.html#cb818-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction de la hat matrix (nécessaire pour calculer la distance de Cook)</span></span>
<span id="cb818-4"><a href="sect082.html#cb818-4" aria-hidden="true" tabindex="-1"></a>hat <span class="ot">&lt;-</span> <span class="fu">hatvaluesvlm</span>(modele)</span>
<span id="cb818-5"><a href="sect082.html#cb818-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb818-6"><a href="sect082.html#cb818-6" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>)</span>
<span id="cb818-7"><a href="sect082.html#cb818-7" aria-hidden="true" tabindex="-1"></a>cooks <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(res),<span class="cf">function</span>(i){</span>
<span id="cb818-8"><a href="sect082.html#cb818-8" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> res[,i]</span>
<span id="cb818-9"><a href="sect082.html#cb818-9" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span> hat[,i]</span>
<span id="cb818-10"><a href="sect082.html#cb818-10" aria-hidden="true" tabindex="-1"></a>  cook <span class="ot">&lt;-</span> (r<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> h))<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> h<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">*</span> modele<span class="sc">@</span>rank)</span>
<span id="cb818-11"><a href="sect082.html#cb818-11" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb818-12"><a href="sect082.html#cb818-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">oid =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cook),</span>
<span id="cb818-13"><a href="sect082.html#cb818-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">cook =</span> cook</span>
<span id="cb818-14"><a href="sect082.html#cb818-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb818-15"><a href="sect082.html#cb818-15" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> df)<span class="sc">+</span></span>
<span id="cb818-16"><a href="sect082.html#cb818-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> oid, <span class="at">y =</span> cook), <span class="at">size =</span> <span class="fl">0.2</span>, <span class="at">color =</span> <span class="fu">rgb</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.4</span>)) <span class="sc">+</span> </span>
<span id="cb818-17"><a href="sect082.html#cb818-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>, <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;distance de Cook P(&quot;</span>,vals[[<span class="dv">1</span>]],<span class="st">&quot; VS &quot;</span>,vals[[i<span class="sc">+</span><span class="dv">1</span>]],<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))<span class="sc">+</span></span>
<span id="cb818-18"><a href="sect082.html#cb818-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb818-19"><a href="sect082.html#cb818-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>())</span>
<span id="cb818-20"><a href="sect082.html#cb818-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plot)</span>
<span id="cb818-21"><a href="sect082.html#cb818-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb818-22"><a href="sect082.html#cb818-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="at">plotlist =</span> cooks, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cookmultinom"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookmultinom-1.png" alt="Distances de Cook pour le modèle logistique multinomial" width="90%" />
<p class="caption">
Figure 8.18: Distances de Cook pour le modèle logistique multinomial
</p>
</div>
<p>Avant de passer à l’analyse de résidus simulés, il est pertinent de réaliser une analyse de type 3 afin de retirer les variables indépendantes dont l’apport au modèle est négligeable. La fonction <code>AnalyseType3</code> (disponible dans le code source de ce livre) permet d’effectuer cette opération automatiquement pour un objet de type <code>vglm</code>.</p>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="sect082.html#cb819-1" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> <span class="fu">AnalyseType3</span>(modele, data_quest, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## ************************************* 
## Type 3 Analysis of Effects 
## ************************************* 
## AIC model complet :  1855 
## loglikelihood model complet :  1789 
##   variable retiree  AIC loglikelihood  p.val
## 1        PercepOGM 1879          1819      0
## 2   PercepRechClim 1941          1881      0
## 3       ConnaisOGM 1910          1850      0
## 4  ConnaisRechClim 1862          1802 0.0059
## 5              CRT 1860          1800 0.0125
## 6            Parti 1879          1825      0
## 7              AGE 1852          1792 0.4469
## 8             Sexe 1875          1815      0
## 9           Revenu 1850          1790 0.7718</code></pre>
<p>L’analyse de type 3 nous permet de déterminer que l’âge et le revenu sont deux variables dont la contribution au modèle est marginale. À titre de rappel, l’analyse de type 3 permet de comparer si le modèle complet (avec l’ensemble des variables indépendantes) est statistiquement mieux ajusté que le modèle avec l’ensemble des variables, sauf une. Or, dans notre cas, le modèle complet n’est pas statistiquement mieux ajusté que le modèle complet sans la variable <em>Age</em> (<em>p</em> = 0,44) et que le modèle complet sans la variable Revenu (<em>p</em> = 0,77). Cela signifie donc que ces deux variables n’ont pas un apport significatif au modèle et peuvent par conséquent être ôtées par parcimonie. Nous décidons donc de les retirer afin d’alléger les tableaux de coefficients que nous présentons plus loin. Nous pouvons également en conclure que ces deux variables ne jouent aucun rôle dans la propension à être en désaccord avec la recherche scientifique. Nous réajustons le modèle en conséquence.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="sect082.html#cb821-1" aria-hidden="true" tabindex="-1"></a>modele2 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Y <span class="sc">~</span> PercepOGM <span class="sc">+</span> PercepRechClim <span class="sc">+</span> ConnaisOGM <span class="sc">+</span> ConnaisRechClim <span class="sc">+</span> </span>
<span id="cb821-2"><a href="sect082.html#cb821-2" aria-hidden="true" tabindex="-1"></a>                 CRT <span class="sc">+</span> Parti <span class="sc">+</span> Sexe,</span>
<span id="cb821-3"><a href="sect082.html#cb821-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_quest, </span>
<span id="cb821-4"><a href="sect082.html#cb821-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="st">&quot;A&quot;</span>), <span class="at">model =</span> T)</span></code></pre></div>
<p>Nous pouvons à présent passer à l’analyse des résidus simulés. Le problème avec ce modèle est que sa variable <em>Y</em> est qualitative alors que la méthode d’analyse des résidus du <em>package</em> <code>DHARMa</code> ne peut traiter que des variables quantitatives, binaires ou ordinales. Pour rappel, il est possible d’envisager la prédiction d’un modèle logistique multinomial comme la prédiction d’une série de modèles logistiques binomiaux. En représentant nos prédictions de cette façon, nous pouvons à nouveau utiliser le <em>package</em> <code>DHARMa</code> pour analyser nos résidus. Veuillez noter que cette approche n’est pas optimale et que cette section du livre peut être amenée à changer.</p>
<p>La figure <a href="sect082.html#fig:residusmultinom">8.19</a> indique que les résidus suivent bien une distribution uniforme et qu’aucune valeur aberrante n’est observable.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="sect082.html#cb822-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les prédictions du modèle</span></span>
<span id="cb822-2"><a href="sect082.html#cb822-2" aria-hidden="true" tabindex="-1"></a>categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>)</span>
<span id="cb822-3"><a href="sect082.html#cb822-3" aria-hidden="true" tabindex="-1"></a>predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele2, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>)</span>
<span id="cb822-4"><a href="sect082.html#cb822-4" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb822-5"><a href="sect082.html#cb822-5" aria-hidden="true" tabindex="-1"></a>ilink <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">exp</span>(x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(x))}</span>
<span id="cb822-6"><a href="sect082.html#cb822-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Boucler sur chacune des catégories en dehors de la référence</span></span>
<span id="cb822-7"><a href="sect082.html#cb822-7" aria-hidden="true" tabindex="-1"></a>data_sims <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(predicted),<span class="cf">function</span>(i){</span>
<span id="cb822-8"><a href="sect082.html#cb822-8" aria-hidden="true" tabindex="-1"></a>  categorie <span class="ot">&lt;-</span> categories[[i]]</span>
<span id="cb822-9"><a href="sect082.html#cb822-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extraire les observation de la catégorie i et de la référence</span></span>
<span id="cb822-10"><a href="sect082.html#cb822-10" aria-hidden="true" tabindex="-1"></a>  test <span class="ot">&lt;-</span> data_quest<span class="sc">$</span>Y <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,categorie)</span>
<span id="cb822-11"><a href="sect082.html#cb822-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculer les probabilité d&#39;appartenance à i</span></span>
<span id="cb822-12"><a href="sect082.html#cb822-12" aria-hidden="true" tabindex="-1"></a>  values <span class="ot">&lt;-</span> predicted[test,i]</span>
<span id="cb822-13"><a href="sect082.html#cb822-13" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">ilink</span>(values)</span>
<span id="cb822-14"><a href="sect082.html#cb822-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extraire les valeurs réelles et les convertir en 0 / 1</span></span>
<span id="cb822-15"><a href="sect082.html#cb822-15" aria-hidden="true" tabindex="-1"></a>  real <span class="ot">&lt;-</span> data_quest[test,]<span class="sc">$</span>Y</span>
<span id="cb822-16"><a href="sect082.html#cb822-16" aria-hidden="true" tabindex="-1"></a>  real <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(real<span class="sc">==</span><span class="st">&quot;A&quot;</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb822-17"><a href="sect082.html#cb822-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Enregistrer ces différents éléments</span></span>
<span id="cb822-18"><a href="sect082.html#cb822-18" aria-hidden="true" tabindex="-1"></a>  all_probs <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span><span class="sc">-</span>probs,probs)</span>
<span id="cb822-19"><a href="sect082.html#cb822-19" aria-hidden="true" tabindex="-1"></a>  sub_data <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_quest,test)</span>
<span id="cb822-20"><a href="sect082.html#cb822-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="st">&quot;real&quot;</span> <span class="ot">=</span> real, <span class="st">&quot;probs&quot;</span> <span class="ot">=</span> all_probs, <span class="st">&quot;data&quot;</span> <span class="ot">=</span> sub_data))</span>
<span id="cb822-21"><a href="sect082.html#cb822-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb822-22"><a href="sect082.html#cb822-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les probabilités prédites</span></span>
<span id="cb822-23"><a href="sect082.html#cb822-23" aria-hidden="true" tabindex="-1"></a>all_probs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(data_sims, <span class="cf">function</span>(i){i<span class="sc">$</span>probs}))</span>
<span id="cb822-24"><a href="sect082.html#cb822-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les vrais catégories</span></span>
<span id="cb822-25"><a href="sect082.html#cb822-25" aria-hidden="true" tabindex="-1"></a>all_real <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(data_sims, <span class="cf">function</span>(i){i<span class="sc">$</span>real}))</span>
<span id="cb822-26"><a href="sect082.html#cb822-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Effectuer les simulations</span></span>
<span id="cb822-27"><a href="sect082.html#cb822-27" aria-hidden="true" tabindex="-1"></a>simulations <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(all_probs), <span class="cf">function</span>(i){</span>
<span id="cb822-28"><a href="sect082.html#cb822-28" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> all_probs[i,]</span>
<span id="cb822-29"><a href="sect082.html#cb822-29" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size =</span> nsim, <span class="at">replace =</span> T, <span class="at">prob =</span> probs)</span>
<span id="cb822-30"><a href="sect082.html#cb822-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sims)</span>
<span id="cb822-31"><a href="sect082.html#cb822-31" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb822-32"><a href="sect082.html#cb822-32" aria-hidden="true" tabindex="-1"></a>matsim <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, simulations)</span>
<span id="cb822-33"><a href="sect082.html#cb822-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculer les résidus simulés</span></span>
<span id="cb822-34"><a href="sect082.html#cb822-34" aria-hidden="true" tabindex="-1"></a>sim_res <span class="ot">&lt;-</span> <span class="fu">createDHARMa</span>(<span class="at">simulatedResponse =</span> matsim, </span>
<span id="cb822-35"><a href="sect082.html#cb822-35" aria-hidden="true" tabindex="-1"></a>                            <span class="at">observedResponse =</span> all_real,</span>
<span id="cb822-36"><a href="sect082.html#cb822-36" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fittedPredictedResponse =</span> all_probs[,<span class="dv">2</span>],</span>
<span id="cb822-37"><a href="sect082.html#cb822-37" aria-hidden="true" tabindex="-1"></a>                            <span class="at">integerResponse =</span> T)</span>
<span id="cb822-38"><a href="sect082.html#cb822-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les résultats</span></span>
<span id="cb822-39"><a href="sect082.html#cb822-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:residusmultinom"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/residusmultinom-1.png" alt="Diagnostic général des résidus simulés pour le modèle multinomial" width="65%" />
<p class="caption">
Figure 8.19: Diagnostic général des résidus simulés pour le modèle multinomial
</p>
</div>
<p>La figure <a href="sect082.html#fig:residusmultinom2">8.20</a> permet d’affiner le diagnostic en s’assurant de l’absence de relation entre les variables indépendantes et les résidus. Il est possible de remarquer des irrégularités pour les variables de perception (premier et second panneaux). Dans les deux cas, la catégorie 1 (fort désaccord) se démarque nettement des autres catégories. Nous proposons donc de les recoder comme des variables binaires : en désaccord / pas en désaccord pour minimiser cet effet.</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="sect082.html#cb823-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recomposer les données pour coller au format</span></span>
<span id="cb823-2"><a href="sect082.html#cb823-2" aria-hidden="true" tabindex="-1"></a><span class="co"># étendu de la prediction</span></span>
<span id="cb823-3"><a href="sect082.html#cb823-3" aria-hidden="true" tabindex="-1"></a>etend_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(data_sims, <span class="cf">function</span>(i){i<span class="sc">$</span>data}))</span>
<span id="cb823-4"><a href="sect082.html#cb823-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb823-5"><a href="sect082.html#cb823-5" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PercepOGM&quot;</span>, <span class="st">&quot;PercepRechClim&quot;</span>, <span class="st">&quot;ConnaisOGM&quot;</span>, </span>
<span id="cb823-6"><a href="sect082.html#cb823-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;ConnaisRechClim&quot;</span>, <span class="st">&quot;CRT&quot;</span>, <span class="st">&quot;Parti&quot;</span>, <span class="st">&quot;Sexe&quot;</span>)</span>
<span id="cb823-7"><a href="sect082.html#cb823-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(v <span class="cf">in</span>  vars){</span>
<span id="cb823-8"><a href="sect082.html#cb823-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plotResiduals</span>(sim_res, etend_data[[v]], <span class="at">xlab=</span> v, <span class="at">ylab =</span> <span class="st">&quot;résidus&quot;</span>)</span>
<span id="cb823-9"><a href="sect082.html#cb823-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:residusmultinom2"></span>
<img src="images/glm/residusmultinom2.png" alt="Diagnostic des variables indépendantes et des résidus simulés pour le modèle multinomial" width="100%" />
<p class="caption">
Figure 8.20: Diagnostic des variables indépendantes et des résidus simulés pour le modèle multinomial
</p>
</div>
<p>Nous réajustons donc le modèle et recalculons nos résidus ajustés (masqué ici pour alléger le document). La figure <a href="sect082.html#fig:residusmultinom3">8.21</a> nous confirme que le problème a été corrigé.</p>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="sect082.html#cb824-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir les variables ordinales et variables binaires</span></span>
<span id="cb824-2"><a href="sect082.html#cb824-2" aria-hidden="true" tabindex="-1"></a>data_quest<span class="sc">$</span>PercepOGMDes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_quest<span class="sc">$</span>PercepOGM <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb824-3"><a href="sect082.html#cb824-3" aria-hidden="true" tabindex="-1"></a>data_quest<span class="sc">$</span>PercepRechClimDes <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data_quest<span class="sc">$</span>PercepRechClim <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb824-4"><a href="sect082.html#cb824-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Réajuster le modèle</span></span>
<span id="cb824-5"><a href="sect082.html#cb824-5" aria-hidden="true" tabindex="-1"></a>modele3 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Y <span class="sc">~</span> PercepOGMDes <span class="sc">+</span> PercepRechClimDes <span class="sc">+</span> </span>
<span id="cb824-6"><a href="sect082.html#cb824-6" aria-hidden="true" tabindex="-1"></a>                  ConnaisOGM <span class="sc">+</span> ConnaisRechClim <span class="sc">+</span> </span>
<span id="cb824-7"><a href="sect082.html#cb824-7" aria-hidden="true" tabindex="-1"></a>                  CRT <span class="sc">+</span> Parti <span class="sc">+</span> Sexe,</span>
<span id="cb824-8"><a href="sect082.html#cb824-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_quest, </span>
<span id="cb824-9"><a href="sect082.html#cb824-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="st">&quot;A&quot;</span>), <span class="at">model =</span> T)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:residusmultinom3"></span>
<img src="images/glm/residusmultinom3.png" alt="Diagnostic général des résidus simulés pour le modèle multinomial (version 3)" width="65%" />
<p class="caption">
Figure 8.21: Diagnostic général des résidus simulés pour le modèle multinomial (version 3)
</p>
</div>
<p>Profitons du fait que nous utilisons le <em>package</em> <code>VGAM</code> pour vérifier l’absence d’effet de Hauck-Donner qui indiquerait que des variables indépendantes provoquent des séparations parfaites.</p>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="sect082.html#cb825-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">hdeff</span>(modele3)</span>
<span id="cb825-2"><a href="sect082.html#cb825-2" aria-hidden="true" tabindex="-1"></a>test[test<span class="sc">==</span><span class="cn">TRUE</span>]</span></code></pre></div>
<pre><code>## (Intercept):2 (Intercept):3 
##          TRUE          TRUE</code></pre>
<p>La fonction nous informe que les constantes permettant de comparer le groupe C au groupe A, et le groupe D au groupe A provoquent des séparations parfaites. Cela s’explique notamment par le faible nombre d’observations tombant dans ces catégories. Considérant que comparativement à la catégorie A, être dans les catégories B, C, ou D signifie remettre en cause au moins un consensus scientifique, il peut être raisonnable de fixer la constante pour qu’elle soit la même pour les trois comparaisons. Ainsi, les chances de passer de A à un autre groupe ne dépenderaient pas du groupe en question, mais uniquement des variables indépendantes. Pour cela, nous pouvons forcer le modèle à n’ajuster qu’une seule constante avec la syntaxe suivante :</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="sect082.html#cb827-1" aria-hidden="true" tabindex="-1"></a>modele4 <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Y <span class="sc">~</span> PercepOGMDes <span class="sc">+</span> PercepRechClimDes <span class="sc">+</span> </span>
<span id="cb827-2"><a href="sect082.html#cb827-2" aria-hidden="true" tabindex="-1"></a>                  ConnaisOGM <span class="sc">+</span> ConnaisRechClim <span class="sc">+</span> </span>
<span id="cb827-3"><a href="sect082.html#cb827-3" aria-hidden="true" tabindex="-1"></a>                  CRT <span class="sc">+</span> Parti <span class="sc">+</span> Sexe,</span>
<span id="cb827-4"><a href="sect082.html#cb827-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> data_quest, </span>
<span id="cb827-5"><a href="sect082.html#cb827-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="st">&quot;A&quot;</span>,</span>
<span id="cb827-6"><a href="sect082.html#cb827-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">parallel =</span> <span class="cn">TRUE</span> <span class="sc">~</span><span class="dv">1</span>), <span class="at">model =</span> T)</span>
<span id="cb827-7"><a href="sect082.html#cb827-7" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">hdeff</span>(modele4)</span>
<span id="cb827-8"><a href="sect082.html#cb827-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(test))</span></code></pre></div>
<pre><code>## test
## FALSE 
##    25</code></pre>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="sect082.html#cb829-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du khi2 de Pearson</span></span>
<span id="cb829-2"><a href="sect082.html#cb829-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele4, <span class="at">type=</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb829-3"><a href="sect082.html#cb829-3" aria-hidden="true" tabindex="-1"></a>cat_predict <span class="ot">&lt;-</span> <span class="fu">colnames</span>(pred)[<span class="fu">max.col</span>(pred)]</span>
<span id="cb829-4"><a href="sect082.html#cb829-4" aria-hidden="true" tabindex="-1"></a>freq_real <span class="ot">&lt;-</span> <span class="fu">table</span>(data_quest<span class="sc">$</span>Y)</span>
<span id="cb829-5"><a href="sect082.html#cb829-5" aria-hidden="true" tabindex="-1"></a>freq_pred <span class="ot">&lt;-</span> <span class="fu">table</span>(cat_predict)</span>
<span id="cb829-6"><a href="sect082.html#cb829-6" aria-hidden="true" tabindex="-1"></a>khi2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">residuals</span>(modele4, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb829-7"><a href="sect082.html#cb829-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_quest)</span>
<span id="cb829-8"><a href="sect082.html#cb829-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> modele4<span class="sc">@</span>rank</span>
<span id="cb829-9"><a href="sect082.html#cb829-9" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">length</span>(freq_real)</span>
<span id="cb829-10"><a href="sect082.html#cb829-10" aria-hidden="true" tabindex="-1"></a>ratio <span class="ot">&lt;-</span> khi2 <span class="sc">/</span> ((N)<span class="sc">*</span>(r<span class="dv">-1</span>)<span class="sc">-</span>p)</span>
<span id="cb829-11"><a href="sect082.html#cb829-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(ratio)</span></code></pre></div>
<pre><code>## [1] 1.010319</code></pre>
<p>Nous n’avons donc plus de séparation complète ni de sur ou sous-dispersion et les résidus simulés de la quatrième version du modèle sont toujours acceptables (figure <a href="sect082.html#fig:residusmultinom4">8.22</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:residusmultinom4"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/residusmultinom4-1.png" alt="Diagnostic général des résidus simulés pour le modèle multinomial (version 4)" width="65%" />
<p class="caption">
Figure 8.22: Diagnostic général des résidus simulés pour le modèle multinomial (version 4)
</p>
</div>
<p><strong>Vérification l’ajustement du modèle</strong></p>
<p>Puisque les conditions d’application du modèle sont respectées, nous pouvons à présent vérifier sa qualité d’ajustement.</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="sect082.html#cb831-1" aria-hidden="true" tabindex="-1"></a>modelenull <span class="ot">&lt;-</span> <span class="fu">vglm</span>(Y <span class="sc">~</span> <span class="dv">1</span> ,</span>
<span id="cb831-2"><a href="sect082.html#cb831-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> data_quest, </span>
<span id="cb831-3"><a href="sect082.html#cb831-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">multinomial</span>(<span class="at">refLevel=</span><span class="st">&quot;A&quot;</span>,</span>
<span id="cb831-4"><a href="sect082.html#cb831-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">parallel =</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> CRT)</span>
<span id="cb831-5"><a href="sect082.html#cb831-5" aria-hidden="true" tabindex="-1"></a>                   , <span class="at">model =</span> T)</span>
<span id="cb831-6"><a href="sect082.html#cb831-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rsqs</span>(<span class="at">loglike.full =</span> <span class="fu">logLik</span>(modele4),</span>
<span id="cb831-7"><a href="sect082.html#cb831-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">loglike.null =</span> <span class="fu">logLik</span>(modelenull),</span>
<span id="cb831-8"><a href="sect082.html#cb831-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">full.deviance =</span> <span class="fu">deviance</span>(modele4),</span>
<span id="cb831-9"><a href="sect082.html#cb831-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">null.deviance =</span> <span class="fu">deviance</span>(modelenull),</span>
<span id="cb831-10"><a href="sect082.html#cb831-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">nb.params =</span> modele4<span class="sc">@</span>rank,</span>
<span id="cb831-11"><a href="sect082.html#cb831-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">n =</span> <span class="fu">nrow</span>(data_quest)</span>
<span id="cb831-12"><a href="sect082.html#cb831-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## $`deviance expliquee`
## [1] 0.1750071
## 
## $`McFadden ajuste`
## [1] 0.1530715
## 
## $`Cox and Snell`
## [1] 0.3397248
## 
## $Nagelkerke
## [1] 0.3746843</code></pre>
<p>Le modèle parvient à expliquer 17,5 % de la déviance totale. Il obtient un R<sup>2</sup> ajusté de McFadden de 0,15, et des R<sup>2</sup> de Cox et Snell et de Nagelkerke de respectivement 0,34 et 0,37. Passons à la construction de la matrice de confusion pour analyser la capacité de prédiction du modèle.</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="sect082.html#cb833-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(modele4, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb833-2"><a href="sect082.html#cb833-2" aria-hidden="true" tabindex="-1"></a>pred_cats <span class="ot">&lt;-</span> <span class="fu">colnames</span>(preds)[<span class="fu">max.col</span>(preds)]</span>
<span id="cb833-3"><a href="sect082.html#cb833-3" aria-hidden="true" tabindex="-1"></a>real <span class="ot">&lt;-</span> data_quest<span class="sc">$</span>Y</span>
<span id="cb833-4"><a href="sect082.html#cb833-4" aria-hidden="true" tabindex="-1"></a>matrices <span class="ot">&lt;-</span> <span class="fu">nice_confusion_matrix</span>(real, pred_cats)</span>
<span id="cb833-5"><a href="sect082.html#cb833-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-6"><a href="sect082.html#cb833-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher la matrice de confusion</span></span>
<span id="cb833-7"><a href="sect082.html#cb833-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matrices<span class="sc">$</span>confusion_matrix)</span></code></pre></div>
<pre><code>##           rowsnames    A          B          C          D          rs      rp    
## colsnames &quot;&quot;           &quot;A (reel)&quot; &quot;B (reel)&quot; &quot;C (reel)&quot; &quot;D (reel)&quot; &quot;Total&quot; &quot;%&quot;   
## A         &quot;A (predit)&quot; &quot;482&quot;      &quot;168&quot;      &quot;75&quot;       &quot;29&quot;       &quot;754&quot;   &quot;78.5&quot;
## B         &quot;B (predit)&quot; &quot;31&quot;       &quot;88&quot;       &quot;9&quot;        &quot;20&quot;       &quot;148&quot;   &quot;15.4&quot;
## C         &quot;C (predit)&quot; &quot;10&quot;       &quot;6&quot;        &quot;18&quot;       &quot;6&quot;        &quot;40&quot;    &quot;4.2&quot; 
## D         &quot;D (predit)&quot; &quot;3&quot;        &quot;4&quot;        &quot;3&quot;        &quot;9&quot;        &quot;19&quot;    &quot;2&quot;   
##           &quot;Total&quot;      &quot;526&quot;      &quot;266&quot;      &quot;105&quot;      &quot;64&quot;       &quot;961&quot;   NA    
##           &quot;%&quot;          &quot;54.7&quot;     &quot;27.7&quot;     &quot;10.9&quot;     &quot;6.7&quot;      NA      NA</code></pre>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="sect082.html#cb835-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Afficher les indicateurs de qualité de prédiction</span></span>
<span id="cb835-2"><a href="sect082.html#cb835-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(matrices<span class="sc">$</span>indicators)</span></code></pre></div>
<pre><code>##              rnames                           precision rappel F1    
## A            &quot;A&quot;                              &quot;0.64&quot;    &quot;0.92&quot; &quot;0.75&quot;
## B            &quot;B&quot;                              &quot;0.59&quot;    &quot;0.33&quot; &quot;0.43&quot;
## C            &quot;C&quot;                              &quot;0.45&quot;    &quot;0.17&quot; &quot;0.25&quot;
## D            &quot;D&quot;                              &quot;0.47&quot;    &quot;0.14&quot; &quot;0.22&quot;
## macro_scores &quot;macro&quot;                          &quot;0.6&quot;     &quot;0.62&quot; &quot;0.57&quot;
##              &quot;Kappa&quot;                          &quot;0.27&quot;    NA     NA    
##              &quot;Valeur de p  (precision &gt; NIR)&quot; &quot;0&quot;       NA     NA</code></pre>
<p>La précision globale (macro) du modèle est de 60 % et dépasse significativement le seuil de non-information. L’indicateur de Kappa indique un accord modéré entre la prédiction et les valeurs réelles. Les catégories C et D sont les catégories avec la plus faible précision, indiquant ainsi que le modèle a tendance à manquer les prédictions pour les individus en désaccord avec le consensus scientifique sur le réchauffement climatique. Les indices de rappel sont également très faibles pour les catégories B, C et D, indiquant que très peu d’observations appartenant originalement à ces groupes ont bien été classées dans ces groupes. La capacité de prédiction du modèle est donc relativement faible.</p>
<p><strong>Interprétation des résultats</strong></p>
<p>Puisque nous disposons de quatre catégories dans notre variable <em>Y</em>, nous obtenons au final trois tableaux de coefficients. Il est possible de visualiser l’ensemble des coefficients du modèle avec la fonction <code>summary</code>, nous proposons les tableaux <a href="sect082.html#tab:coeffsmultinom1">8.17</a>, <a href="sect082.html#tab:coeffsmultinom2">8.18</a> et <a href="sect082.html#tab:coeffsmultinom3">8.19</a> pour présenter l’ensemble des résultats.</p>
<table>
<caption>
<span id="tab:coeffsmultinom1">Tableau 8.17: </span>Coefficients du modèle multinomial A versus B
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coefficient
</th>
<th style="text-align:right;">
RC
</th>
<th style="text-align:right;">
val.p
</th>
<th style="text-align:right;">
RC 2,5 %
</th>
<th style="text-align:right;">
RC 97,5 %
</th>
<th style="text-align:right;">
sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PercepOGMDes
</td>
<td style="text-align:right;">
1,940
</td>
<td style="text-align:right;">
6,989
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
4,221
</td>
<td style="text-align:right;">
11,588
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
PercepRechClimDes
</td>
<td style="text-align:right;">
0,430
</td>
<td style="text-align:right;">
1,532
</td>
<td style="text-align:right;">
0,305
</td>
<td style="text-align:right;">
0,677
</td>
<td style="text-align:right;">
3,456
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ConnaisOGM
</td>
<td style="text-align:right;">
-0,330
</td>
<td style="text-align:right;">
0,718
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,607
</td>
<td style="text-align:right;">
0,852
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
ConnaisRechClim
</td>
<td style="text-align:right;">
0,180
</td>
<td style="text-align:right;">
1,197
</td>
<td style="text-align:right;">
0,084
</td>
<td style="text-align:right;">
0,980
</td>
<td style="text-align:right;">
1,462
</td>
<td style="text-align:right;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
CRT
</td>
<td style="text-align:right;">
0,350
</td>
<td style="text-align:right;">
1,417
</td>
<td style="text-align:right;">
0,016
</td>
<td style="text-align:right;">
1,073
</td>
<td style="text-align:right;">
1,878
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
<em>Parti</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : Democrate
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
autre
</td>
<td style="text-align:right;">
0,660
</td>
<td style="text-align:right;">
1,934
</td>
<td style="text-align:right;">
0,001
</td>
<td style="text-align:right;">
1,310
</td>
<td style="text-align:right;">
2,858
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Republicain
</td>
<td style="text-align:right;">
0,650
</td>
<td style="text-align:right;">
1,910
</td>
<td style="text-align:right;">
0,003
</td>
<td style="text-align:right;">
1,259
</td>
<td style="text-align:right;">
2,915
</td>
<td style="text-align:right;">
**
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Sexe</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : homme
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
femme
</td>
<td style="text-align:right;">
1,280
</td>
<td style="text-align:right;">
3,581
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
2,535
</td>
<td style="text-align:right;">
5,053
</td>
<td style="text-align:right;">
***
</td>
</tr>
</tbody>
</table></li>
</ul>
<p>Le tableau <a href="sect082.html#tab:coeffsmultinom1">8.17</a> compare donc le groupe A (en accord avec la recherche scientifique sur les deux sujets) et le groupe B (en désaccord sur la question des OGM). Les résultats indiquent que le fait de se percevoir en désaccord avec le consensus scientifique sur la question des OGM multiplie par sept les chances d’appartenir au groupe B comparativement au groupe A. Cependant, pour chaque bonne réponse supplémentaire sur les questions testant les connaissances sur les OGM, les chances d’appartenir au groupe B comparativement au groupe A diminue de 28 %. Ainsi, un individu ayant répondu correctement aux trois questions verrait ses chances réduites de 63 % d’appartenir au groupe B (<span class="math inline">\(exp(-\text{0,33}\times\text{3})\)</span>). Il est intéressant de noter que les variables concernant le réchauffement climatique n’ont pas d’effet significatif ici. La variable CRT indique qu’à chaque bonne réponse supplémentaire au test de cognition, les chances d’appartenir au groupe B augmentent de 42 %. Un individu qui aurait répondu aux trois questions du test aurait donc 2,9 fois plus de chances d’appartenir au groupe B qu’au groupe A. Concernant le parti politique, comparativement à une personne se déclarant plus proche du parti démocrate, les personnes proches du parti républicain ou d’un autre parti ont près de deux fois plus de chances d’appartenir au groupe B. Enfin, une femme, comparativement à un homme, a 3,6 fois plus de chance d’appartenir au groupe B.</p>
<table>
<caption>
<span id="tab:coeffsmultinom2">Tableau 8.18: </span>Coefficients du modèle multinomial A versus C
</caption>
<thead>
<tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
Coefficient
</th>
<th style="text-align:right;">
RC
</th>
<th style="text-align:right;">
val.p
</th>
<th style="text-align:right;">
RC 2,5 %
</th>
<th style="text-align:right;">
RC 97,5 %
</th>
<th style="text-align:right;">
sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PercepOGMDes
</td>
<td style="text-align:right;">
-0,180
</td>
<td style="text-align:right;">
0,834
</td>
<td style="text-align:right;">
0,705
</td>
<td style="text-align:right;">
0,326
</td>
<td style="text-align:right;">
2,138
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
PercepRechClimDes
</td>
<td style="text-align:right;">
2,060
</td>
<td style="text-align:right;">
7,821
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
3,819
</td>
<td style="text-align:right;">
16,119
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
ConnaisOGM
</td>
<td style="text-align:right;">
-0,110
</td>
<td style="text-align:right;">
0,896
</td>
<td style="text-align:right;">
0,287
</td>
<td style="text-align:right;">
0,733
</td>
<td style="text-align:right;">
1,094
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ConnaisRechClim
</td>
<td style="text-align:right;">
0,280
</td>
<td style="text-align:right;">
1,323
</td>
<td style="text-align:right;">
0,024
</td>
<td style="text-align:right;">
1,041
</td>
<td style="text-align:right;">
1,682
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
CRT
</td>
<td style="text-align:right;">
0,240
</td>
<td style="text-align:right;">
1,275
</td>
<td style="text-align:right;">
0,149
</td>
<td style="text-align:right;">
0,914
</td>
<td style="text-align:right;">
1,768
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Parti</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : Democrate
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
autre
</td>
<td style="text-align:right;">
-0,190
</td>
<td style="text-align:right;">
0,828
</td>
<td style="text-align:right;">
0,496
</td>
<td style="text-align:right;">
0,482
</td>
<td style="text-align:right;">
1,433
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Republicain
</td>
<td style="text-align:right;">
0,920
</td>
<td style="text-align:right;">
2,512
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,584
</td>
<td style="text-align:right;">
4,015
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Sexe</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : homme
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
femme:1
</td>
<td style="text-align:right;">
-0,450
</td>
<td style="text-align:right;">
0,640
</td>
<td style="text-align:right;">
0,040
</td>
<td style="text-align:right;">
0,419
</td>
<td style="text-align:right;">
0,980
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul>
<p>Le tableau <a href="sect082.html#tab:coeffsmultinom2">8.18</a> compare les groupes A et C (en désaccord sur le réchauffement climatique). Il est intéressant de noter ici que se percevoir en désaccord avec la recherche scientifique est associé avec une forte augmentation des chances d’appartenir au groupe C. Cependant, un plus grand nombre de bonnes réponses aux questions sur le réchauffement climatique est également associé avec une augmentation des chances (30 % à chaque bonne réponse supplémentaire) d’appartenir au groupe C. Le CRT n’a cette fois-ci pas d’effet. Se déclarer proche du parti républicain, comparativement au parti démocrate, multiplie les chances par 2,5 d’appartenir au groupe C. Comparativement au tableau précédent, le fait d’être une femme diminue les chances de 36 % d’appartenir au groupe C.</p>
<table>
<caption>
<span id="tab:coeffsmultinom3">Tableau 8.19: </span>Coefficients du modèle multinomial A versus D
</caption>
<thead>
<tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
Coefficient
</th>
<th style="text-align:right;">
RC
</th>
<th style="text-align:right;">
val.p
</th>
<th style="text-align:right;">
RC 2,5 %
</th>
<th style="text-align:right;">
RC 97,5 %
</th>
<th style="text-align:right;">
sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PercepOGMDes
</td>
<td style="text-align:right;">
1,500
</td>
<td style="text-align:right;">
4,488
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
2,270
</td>
<td style="text-align:right;">
8,935
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
PercepRechClimDes
</td>
<td style="text-align:right;">
2,440
</td>
<td style="text-align:right;">
11,501
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
5,312
</td>
<td style="text-align:right;">
25,028
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
ConnaisOGM
</td>
<td style="text-align:right;">
-0,480
</td>
<td style="text-align:right;">
0,621
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,492
</td>
<td style="text-align:right;">
0,787
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
ConnaisRechClim
</td>
<td style="text-align:right;">
0,130
</td>
<td style="text-align:right;">
1,140
</td>
<td style="text-align:right;">
0,399
</td>
<td style="text-align:right;">
0,844
</td>
<td style="text-align:right;">
1,553
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
CRT
</td>
<td style="text-align:right;">
0,340
</td>
<td style="text-align:right;">
1,409
</td>
<td style="text-align:right;">
0,119
</td>
<td style="text-align:right;">
0,914
</td>
<td style="text-align:right;">
2,160
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Parti</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : Democrate
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
autre
</td>
<td style="text-align:right;">
0,190
</td>
<td style="text-align:right;">
1,211
</td>
<td style="text-align:right;">
0,531
</td>
<td style="text-align:right;">
0,664
</td>
<td style="text-align:right;">
2,203
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Republicain
</td>
<td style="text-align:right;">
0,630
</td>
<td style="text-align:right;">
1,872
</td>
<td style="text-align:right;">
0,038
</td>
<td style="text-align:right;">
1,041
</td>
<td style="text-align:right;">
3,387
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
<em>Sexe</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : homme
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
femme:1
</td>
<td style="text-align:right;">
-0,110
</td>
<td style="text-align:right;">
0,896
</td>
<td style="text-align:right;">
0,664
</td>
<td style="text-align:right;">
0,543
</td>
<td style="text-align:right;">
1,477
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table></li>
</ul>
<p>Le dernier tableau <a href="sect082.html#tab:coeffsmultinom3">8.19</a> compare le groupe A au groupe D (en désaccord sur les deux sujets). Les variables les plus importantes sont une fois encore le fait de se sentir en désaccord avec la recherche scientifique et le degré de connaissance sur les OGM. La variable concernant le parti politique est significative au seuil 0,05 et exprime toujours une tendance accrue pour les individus du parti républicain à appartenir au groupe D.</p>
<p>Nos propres conclusions corroborent celles de l’article original. Une des conclusions intéressantes est que le rejet du consensus scientifique ne semble pas nécessairement être associé à un déficit d’information ni à une plus faible capacité analytique, mais relèverait davantage d’une polarisation politique. Notez que cette littérature sur les croyances et la confiance dans la recherche est complexe, si le sujet vous intéresse, la discussion de l’article de <span class="citation">McFadden (<a href="#ref-mcfadden2016examining" role="doc-biblioref">2016</a>)</span> est un bon point de départ.</p>
</div>
</div>
<div id="conclusion-sur-les-modèles-pour-des-variables-qualitatives" class="section level3 hasAnchor" number="8.2.5">
<h3><span class="header-section-number">8.2.5</span> Conclusion sur les modèles pour des variables qualitatives<a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nous avons vu dans cette section, les trois principales formes de modèles GLM pour modéliser une variable binaire (modèle binomial), une variable ordinale (modèle de cotes proportionnel) et une variable multinomiale (modèle multinomial). Pour ces trois modèles, nous avons vu que la distribution utilisée est toujours la distribution binomiale et la fonction de lien logistique. Les coefficients obtenus s’interprètent comme des rapports de cotes, une fois qu’ils sont transformés avec la fonction exponentielle.</p>
</div>
</div>
<h3>R&eacute;f&eacute;rences</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-brant1990assessing" class="csl-entry">
Brant, Rollin. 1990. <span>« Assessing proportionality in the proportional odds model for ordinal logistic regression. »</span> <em>Biometrics</em>: 1171‑1178. <a href="https://www.jstor.org/stable/2532457">https://www.jstor.org/stable/2532457</a>.
</div>
<div id="ref-hilbe2009logistic" class="csl-entry">
Hilbe, Joseph M. 2009. <em>Logistic regression models</em>. CRC press.
</div>
<div id="ref-mcfadden2016examining" class="csl-entry">
McFadden, Brandon R. 2016. <span>« Examining the gap between science and public opinion about genetically modified food and global warming. »</span> <em>PloS one</em> 11 (11): e0166140. <a href="https://doi.org/10.1371/journal.pone.0166140">https://doi.org/10.1371/journal.pone.0166140</a>.
</div>
<div id="ref-Sasmultinom" class="csl-entry">
SAS Institute Inc. 2020a. <span>« <span>SAS/STAT 15.2 User’s Guide</span> Modeling Multinomial Overdispersion. »</span> <a href="https://documentation.sas.com/?docsetId=statug&amp;docsetTarget=statug_fmm_examples04.htm&amp;docsetVersion=15.2&amp;locale=en" class="uri">https://documentation.sas.com/?docsetId=statug&amp;docsetTarget=statug_fmm_examples04.htm&amp;docsetVersion=15.2&amp;locale=en</a>.
</div>
<div id="ref-teubner2017price" class="csl-entry">
Teubner, Timm, Florian Hawlitschek et David Dann. 2017. <span>« Price determinants on AirBnB: How reputation pays off in the sharing economy. »</span> <em>Journal of Self-Governance &amp; Management Economics</em> 5 (4). <a href="http://dx.doi.org/10.22381/JSME5420173">http://dx.doi.org/10.22381/JSME5420173</a>.
</div>
<div id="ref-wang2017price" class="csl-entry">
Wang, Dan et Juan L Nicolau. 2017. <span>« Price determinants of sharing economy based accommodation rental: A study of listings from 33 cities on Airbnb.com. »</span> <em>International Journal of Hospitality Management</em> 62: 120‑131. <a href="https://doi.org/10.1016/j.ijhm.2016.12.007">https://doi.org/10.1016/j.ijhm.2016.12.007</a>.
</div>
<div id="ref-zeileis2004econometric" class="csl-entry">
Zeileis, Achim. 2004. <em>Econometric computing with HC and HAC covariance matrix estimators</em>. Institut f<span>ü</span>r Statistik und Mathematik.
</div>
<div id="ref-zhang2017key" class="csl-entry">
Zhang, Zhihua, Rachel JC Chen, Lee D Han et Lu Yang. 2017. <span>« Key factors affecting the price of Airbnb listings: A geographically weighted approach. »</span> <em>Sustainability</em> 9 (9): 1635. <a href="http://dx.doi.org/10.3390/su9091635">http://dx.doi.org/10.3390/su9091635</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect081.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect084.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MethodesQuantitScSocialesBolR.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
