<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.6 Mise en œuvre des GLMM dans R | Méthodes quantitatives en sciences sociales : un grand bol d’R</title>
  <meta name="description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="9.6 Mise en œuvre des GLMM dans R | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="github-repo" content="LAEQ/livre_statistique_Phil_Jere" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.6 Mise en œuvre des GLMM dans R | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  
  <meta name="twitter:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="twitter:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio et Jérémy Gelb" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect095.html"/>
<link rel="next" href="sect097.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d'R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Un manuel conçu comme un projet collaboratif</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment lire ce livre?</a></li>
<li class="chapter" data-level="" data-path="sect003B.html"><a href="sect003B.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en sciences sociales?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="sect007.html"><a href="sect007.html"><i class="fa fa-check"></i>Dédicace toute spéciale à Cargo et Ambrée</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auteurs.html"><a href="auteurs.html"><i class="fa fa-check"></i>À propos des auteurs</a></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Prise en main de R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Histoire et philosophie de R</a></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Environnement de travail</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Installation de R</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Environnement RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect0123"><i class="fa fa-check"></i><b>1.2.3</b> Installation et chargement un <em>package</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#aide-disponible"><i class="fa fa-check"></i><b>1.2.4</b> Aide disponible</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Bases du langage R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> <em>Hello World</em>!</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Objets et expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="sect013.html"><a href="sect013.html#sect0_133"><i class="fa fa-check"></i><b>1.3.3</b> Fonctions et arguments</a></li>
<li class="chapter" data-level="1.3.4" data-path="sect013.html"><a href="sect013.html#sect0134"><i class="fa fa-check"></i><b>1.3.4</b> Principaux types de données</a></li>
<li class="chapter" data-level="1.3.5" data-path="sect013.html"><a href="sect013.html#sect0135"><i class="fa fa-check"></i><b>1.3.5</b> Opérateurs</a></li>
<li class="chapter" data-level="1.3.6" data-path="sect013.html"><a href="sect013.html#sect0136"><i class="fa fa-check"></i><b>1.3.6</b> Structures de données</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Manipulation de données</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Manipulation d’un <em>DataFrame</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.5</b> Code R bien structuré</a></li>
<li class="chapter" data-level="1.6" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.6</b> Enregistrement des résultats</a></li>
<li class="chapter" data-level="1.7" data-path="sect018.html"><a href="sect018.html"><i class="fa fa-check"></i><b>1.7</b> Session de travail</a></li>
<li class="chapter" data-level="1.8" data-path="sect019.html"><a href="sect019.html"><i class="fa fa-check"></i><b>1.8</b> Conclusion et ressources pertinentes</a></li>
<li class="chapter" data-level="1.9" data-path="sect0110.html"><a href="sect0110.html"><i class="fa fa-check"></i><b>1.9</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>II Analyses univariées et graphiques dans R</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Statistiques descriptives univariées</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion et types de variable</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="sect021.html"><a href="sect021.html#sect0211"><i class="fa fa-check"></i><b>2.1.1</b> Notion de variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="sect021.html"><a href="sect021.html#sect0212"><i class="fa fa-check"></i><b>2.1.2</b> Types de variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Types de données</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Données secondaires <em>versus</em> données primaires</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Données transversales <em>versus</em> données longitudinales</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Données spatiales versus données aspatiales</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Données individuelles <em>versus</em> données agrégées</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Statistique descriptive et statistique inférentielle</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Population, échantillon et inférence</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Deux grandes familles de méthodes statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Notion de distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#définition-générale"><i class="fa fa-check"></i><b>2.4.1</b> Définition générale</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#anatomie-dune-distribution"><i class="fa fa-check"></i><b>2.4.2</b> Anatomie d’une distribution</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#principales-distributions"><i class="fa fa-check"></i><b>2.4.3</b> Principales distributions</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#conclusion-sur-les-distributions"><i class="fa fa-check"></i><b>2.4.4</b> Conclusion sur les distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Statistiques descriptives sur des variables quantitatives</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="sect025.html"><a href="sect025.html#sect0251"><i class="fa fa-check"></i><b>2.5.1</b> Paramètres de tendance centrale</a></li>
<li class="chapter" data-level="2.5.2" data-path="sect025.html"><a href="sect025.html#sect0252"><i class="fa fa-check"></i><b>2.5.2</b> Paramètres de position</a></li>
<li class="chapter" data-level="2.5.3" data-path="sect025.html"><a href="sect025.html#sect0253"><i class="fa fa-check"></i><b>2.5.3</b> Paramètres de dispersion</a></li>
<li class="chapter" data-level="2.5.4" data-path="sect025.html"><a href="sect025.html#sect0254"><i class="fa fa-check"></i><b>2.5.4</b> Paramètres de forme</a></li>
<li class="chapter" data-level="2.5.5" data-path="sect025.html"><a href="sect025.html#sect0255"><i class="fa fa-check"></i><b>2.5.5</b> Transformation des variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="sect025.html"><a href="sect025.html#sect0256"><i class="fa fa-check"></i><b>2.5.6</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="sect026.html"><a href="sect026.html#sect0261"><i class="fa fa-check"></i><b>2.6.1</b> Fréquences</a></li>
<li class="chapter" data-level="2.6.2" data-path="sect026.html"><a href="sect026.html#sect0262"><i class="fa fa-check"></i><b>2.6.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sect027.html"><a href="sect027.html"><i class="fa fa-check"></i><b>2.7</b> Statistiques descriptives pondérées : pour aller plus loin</a></li>
<li class="chapter" data-level="2.8" data-path="sect028.html"><a href="sect028.html"><i class="fa fa-check"></i><b>2.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Magie des graphiques</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Philosophie du ggplot2</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="sect031.html"><a href="sect031.html#sect0311"><i class="fa fa-check"></i><b>3.1.1</b> Grammaire</a></li>
<li class="chapter" data-level="3.1.2" data-path="sect031.html"><a href="sect031.html#sect0312"><i class="fa fa-check"></i><b>3.1.2</b> Types de géométries</a></li>
<li class="chapter" data-level="3.1.3" data-path="sect031.html"><a href="sect031.html#sect0313"><i class="fa fa-check"></i><b>3.1.3</b> Habillage</a></li>
<li class="chapter" data-level="3.1.4" data-path="sect031.html"><a href="sect031.html#utilisation-des-thèmes"><i class="fa fa-check"></i><b>3.1.4</b> Utilisation des thèmes</a></li>
<li class="chapter" data-level="3.1.5" data-path="sect031.html"><a href="sect031.html#sect0314"><i class="fa fa-check"></i><b>3.1.5</b> Composition d’une figure avec plusieurs graphiques</a></li>
<li class="chapter" data-level="3.1.6" data-path="sect031.html"><a href="sect031.html#sect0315"><i class="fa fa-check"></i><b>3.1.6</b> Couleur</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Principaux graphiques</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0321"><i class="fa fa-check"></i><b>3.2.1</b> Histogramme</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0322"><i class="fa fa-check"></i><b>3.2.2</b> Graphique de densité</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0323"><i class="fa fa-check"></i><b>3.2.3</b> Nuage de points</a></li>
<li class="chapter" data-level="3.2.4" data-path="sect032.html"><a href="sect032.html#sect0324"><i class="fa fa-check"></i><b>3.2.4</b> Graphique en ligne</a></li>
<li class="chapter" data-level="3.2.5" data-path="sect032.html"><a href="sect032.html#sect0325"><i class="fa fa-check"></i><b>3.2.5</b> Boîte à moustaches</a></li>
<li class="chapter" data-level="3.2.6" data-path="sect032.html"><a href="sect032.html#sect0326"><i class="fa fa-check"></i><b>3.2.6</b> Graphique en violon</a></li>
<li class="chapter" data-level="3.2.7" data-path="sect032.html"><a href="sect032.html#sect0327"><i class="fa fa-check"></i><b>3.2.7</b> Graphique en barre</a></li>
<li class="chapter" data-level="3.2.8" data-path="sect032.html"><a href="sect032.html#sect0328"><i class="fa fa-check"></i><b>3.2.8</b> Graphique circulaire</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Graphiques spéciaux</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Graphique en radar</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Diagramme d’accord</a></li>
<li class="chapter" data-level="3.3.3" data-path="sect033.html"><a href="sect033.html#sect0333"><i class="fa fa-check"></i><b>3.3.3</b> Nuage de mots</a></li>
<li class="chapter" data-level="3.3.4" data-path="sect033.html"><a href="sect033.html#sect0334"><i class="fa fa-check"></i><b>3.3.4</b> Carte proportionnelle</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Cartes</a></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Exportation des graphiques</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Conclusion sur les graphiques</a></li>
</ul></li>
<li class="part"><span><b>III Analyses bivariées</b></span></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Relation linéaire entre deux variables quantitatives</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Bref retour sur le postulat de la relation linéaire</a></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Covariance</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Formulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect043.html"><a href="sect043.html"><i class="fa fa-check"></i><b>4.3</b> Corrélation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="sect043.html"><a href="sect043.html#sect0431"><i class="fa fa-check"></i><b>4.3.1</b> Formulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="sect043.html"><a href="sect043.html#sect0432"><i class="fa fa-check"></i><b>4.3.2</b> Interprétation</a></li>
<li class="chapter" data-level="4.3.3" data-path="sect043.html"><a href="sect043.html#sect0433"><i class="fa fa-check"></i><b>4.3.3</b> Corrélations pour des variables anormalement distribuées (coefficient de Spearman, tau de Kendall)</a></li>
<li class="chapter" data-level="4.3.4" data-path="sect043.html"><a href="sect043.html#sect0434"><i class="fa fa-check"></i><b>4.3.4</b> Corrélations robustes (<em>Biweight midcorrelation</em>, <em>Percentage bend correlation</em> et la corrélation <em>pi</em> de Shepherd)</a></li>
<li class="chapter" data-level="4.3.5" data-path="sect043.html"><a href="sect043.html#sect0435"><i class="fa fa-check"></i><b>4.3.5</b> Significativité des coefficients de corrélation</a></li>
<li class="chapter" data-level="4.3.6" data-path="sect043.html"><a href="sect043.html#sect0436"><i class="fa fa-check"></i><b>4.3.6</b> Corrélation partielle</a></li>
<li class="chapter" data-level="4.3.7" data-path="sect043.html"><a href="sect043.html#sect0437"><i class="fa fa-check"></i><b>4.3.7</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.3.8" data-path="sect043.html"><a href="sect043.html#sect0438"><i class="fa fa-check"></i><b>4.3.8</b> Comment rapporter des valeurs de corrélations?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.4</b> Régression linéaire simple</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sect044.html"><a href="sect044.html#sect0441"><i class="fa fa-check"></i><b>4.4.1</b> Principe de base de la régression linéaire simple</a></li>
<li class="chapter" data-level="4.4.2" data-path="sect044.html"><a href="sect044.html#sect0442"><i class="fa fa-check"></i><b>4.4.2</b> Formulation de la droite de régression des moindres carrés ordinaires</a></li>
<li class="chapter" data-level="4.4.3" data-path="sect044.html"><a href="sect044.html#sect0443"><i class="fa fa-check"></i><b>4.4.3</b> Mesure de la qualité d’ajustement du modèle</a></li>
<li class="chapter" data-level="4.4.4" data-path="sect044.html"><a href="sect044.html#sect0444"><i class="fa fa-check"></i><b>4.4.4</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.4.5" data-path="sect044.html"><a href="sect044.html#sect0445"><i class="fa fa-check"></i><b>4.4.5</b> Comment rapporter une régression linéaire simple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Relation entre deux variables qualitatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Construction de tableau de contingence</a></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Test du khi-deux</a></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Interprétation d’un tableau de contingence</a></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Relation entre une variable qualitative et une variable quantitative</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Relation entre une variable quantitative et une variable qualitative à deux modalités</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Test <em>t</em> et ses différentes variantes</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Test non paramétrique de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Analyse de variance</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Test non paramétrique de Kruskal-Wallis</a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="6.2.4" data-path="sect062.html"><a href="sect062.html#sect0624"><i class="fa fa-check"></i><b>6.2.4</b> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Conclusion sur la troisième partie</a></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>IV Modèles de régression</b></span></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Principes de base de la régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Un peu d’équations…</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Hypothèses de la régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Évaluation de la qualité d’ajustement du modèle</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Mesures de la qualité d’un modèle</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Comparaison des modèles incrémentiels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Différentes mesures pour les coefficients de régression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sect074.html"><a href="sect074.html#sect0741"><i class="fa fa-check"></i><b>7.4.1</b> Coefficients de régression : évaluer l’effet des variables indépendantes</a></li>
<li class="chapter" data-level="7.4.2" data-path="sect074.html"><a href="sect074.html#sect0742"><i class="fa fa-check"></i><b>7.4.2</b> Coefficients de régression standardisés : repérer les variables les plus importantes du modèle</a></li>
<li class="chapter" data-level="7.4.3" data-path="sect074.html"><a href="sect074.html#sect0743"><i class="fa fa-check"></i><b>7.4.3</b> Significativité des coefficients de régression : valeurs de <em>t</em> et de <em>p</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="sect074.html"><a href="sect074.html#sect0744"><i class="fa fa-check"></i><b>7.4.4</b> Intervalle de confiance des coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Introduction de variables explicatives particulières</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sect075.html"><a href="sect075.html#sect0751"><i class="fa fa-check"></i><b>7.5.1</b> Exploration des relations non linéaires</a></li>
<li class="chapter" data-level="7.5.2" data-path="sect075.html"><a href="sect075.html#sect0752"><i class="fa fa-check"></i><b>7.5.2</b> Variable indépendante qualitative dichotomique</a></li>
<li class="chapter" data-level="7.5.3" data-path="sect075.html"><a href="sect075.html#sect0753"><i class="fa fa-check"></i><b>7.5.3</b> Variable indépendante qualitative polytomique</a></li>
<li class="chapter" data-level="7.5.4" data-path="sect075.html"><a href="sect075.html#sect0754"><i class="fa fa-check"></i><b>7.5.4</b> Variables d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sect076.html"><a href="sect076.html"><i class="fa fa-check"></i><b>7.6</b> Diagnostics de la régression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sect076.html"><a href="sect076.html#sect0761"><i class="fa fa-check"></i><b>7.6.1</b> Nombre d’observations</a></li>
<li class="chapter" data-level="7.6.2" data-path="sect076.html"><a href="sect076.html#sect0762"><i class="fa fa-check"></i><b>7.6.2</b> Normalité des résidus</a></li>
<li class="chapter" data-level="7.6.3" data-path="sect076.html"><a href="sect076.html#sect0763"><i class="fa fa-check"></i><b>7.6.3</b> Linéarité et homoscédasticité des résidus</a></li>
<li class="chapter" data-level="7.6.4" data-path="sect076.html"><a href="sect076.html#sect0764"><i class="fa fa-check"></i><b>7.6.4</b> Absence de multicolinéarité excessive</a></li>
<li class="chapter" data-level="7.6.5" data-path="sect076.html"><a href="sect076.html#sect0766"><i class="fa fa-check"></i><b>7.6.5</b> Absence d’observations aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sect077.html"><a href="sect077.html"><i class="fa fa-check"></i><b>7.7</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sect077.html"><a href="sect077.html#sect0771"><i class="fa fa-check"></i><b>7.7.1</b> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
<li class="chapter" data-level="7.7.2" data-path="sect077.html"><a href="sect077.html#sect0772"><i class="fa fa-check"></i><b>7.7.2</b> Comparaison des modèles</a></li>
<li class="chapter" data-level="7.7.3" data-path="sect077.html"><a href="sect077.html#sect0773"><i class="fa fa-check"></i><b>7.7.3</b> Diagnostic sur un modèle</a></li>
<li class="chapter" data-level="7.7.4" data-path="sect077.html"><a href="sect077.html#sect0774"><i class="fa fa-check"></i><b>7.7.4</b> Graphiques pour les effets marginaux</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sect078.html"><a href="sect078.html"><i class="fa fa-check"></i><b>7.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Régressions linéaires généralisées (GLM)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Qu’est qu’un modèle GLM?</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Formulation d’un GLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Autres distributions et rôle de la fonction de lien</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Conditions d’application</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Résidus et déviance</a></li>
<li class="chapter" data-level="8.1.5" data-path="sect081.html"><a href="sect081.html#sect0815"><i class="fa fa-check"></i><b>8.1.5</b> Vérification l’ajustement</a></li>
<li class="chapter" data-level="8.1.6" data-path="sect081.html"><a href="sect081.html#sect0816"><i class="fa fa-check"></i><b>8.1.6</b> Comparaison de deux modèles GLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Modèles GLM pour des variables qualitatives</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Modèle logistique binomial</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Modèle probit binomial</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Modèle logistique des cotes proportionnelles</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Modèle logistique multinomial</a></li>
<li class="chapter" data-level="8.2.5" data-path="sect082.html"><a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives"><i class="fa fa-check"></i><b>8.2.5</b> Conclusion sur les modèles pour des variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.3</b> Modèles GLM pour des variables de comptage</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="sect084.html"><a href="sect084.html#sect0841"><i class="fa fa-check"></i><b>8.3.1</b> Modèle de Poisson</a></li>
<li class="chapter" data-level="8.3.2" data-path="sect084.html"><a href="sect084.html#sect0842"><i class="fa fa-check"></i><b>8.3.2</b> Modèle binomial négatif</a></li>
<li class="chapter" data-level="8.3.3" data-path="sect084.html"><a href="sect084.html#sect0843"><i class="fa fa-check"></i><b>8.3.3</b> Modèle de Poisson avec excès fixe de zéros</a></li>
<li class="chapter" data-level="8.3.4" data-path="sect084.html"><a href="sect084.html#sect0844"><i class="fa fa-check"></i><b>8.3.4</b> Modèle de Poisson avec excès ajusté de zéros</a></li>
<li class="chapter" data-level="8.3.5" data-path="sect084.html"><a href="sect084.html#sect0845"><i class="fa fa-check"></i><b>8.3.5</b> Conclusion sur les modèles destinés à des variables de comptage</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sect085.html"><a href="sect085.html"><i class="fa fa-check"></i><b>8.4</b> Modèles GLM pour des variables continues</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sect085.html"><a href="sect085.html#sect0851"><i class="fa fa-check"></i><b>8.4.1</b> Modèle GLM gaussien</a></li>
<li class="chapter" data-level="8.4.2" data-path="sect085.html"><a href="sect085.html#sect0852"><i class="fa fa-check"></i><b>8.4.2</b> Modèle GLM avec une distribution de Student</a></li>
<li class="chapter" data-level="8.4.3" data-path="sect085.html"><a href="sect085.html#sect0853"><i class="fa fa-check"></i><b>8.4.3</b> Modèle GLM avec distribution Gamma</a></li>
<li class="chapter" data-level="8.4.4" data-path="sect085.html"><a href="sect085.html#sect0854"><i class="fa fa-check"></i><b>8.4.4</b> Modèle GLM avec une distribution bêta</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sect086.html"><a href="sect086.html"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="8.6" data-path="sect087.html"><a href="sect087.html"><i class="fa fa-check"></i><b>8.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Régressions à effets mixtes (GLMM)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Indépendance des observations et effets de groupes</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Terminologie: effets fixes et effets aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Principes de base des GLMM</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> GLMM avec constantes aléatoires</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.2</b> GLMM avec pentes aléatoires</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.3</b> GLMM avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Conditions d’application des GLMM</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Vérification de la distribution des effets aléatoires</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Homogénéité des variances au sein des groupes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Inférence dans les modèles GLMM</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#sect0941"><i class="fa fa-check"></i><b>9.4.1</b> Inférence pour les effets fixes</a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#sect0942"><i class="fa fa-check"></i><b>9.4.2</b> Inférence pour les effets aléatoires, effet global</a></li>
<li class="chapter" data-level="9.4.3" data-path="sect094.html"><a href="sect094.html#sect0943"><i class="fa fa-check"></i><b>9.4.3</b> Inférence pour les effets aléatoires, des constantes et des pentes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Conclusion sur les GLMM</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Mise en œuvre des GLMM dans R</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="sect096.html"><a href="sect096.html#sect0961"><i class="fa fa-check"></i><b>9.6.1</b> Ajustement du modèle avec uniquement une constante aléatoire</a></li>
<li class="chapter" data-level="9.6.2" data-path="sect096.html"><a href="sect096.html#sect0962"><i class="fa fa-check"></i><b>9.6.2</b> Ajustement du modèle avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sect097.html"><a href="sect097.html"><i class="fa fa-check"></i><b>9.7</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Régressions multiniveaux</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect101.html"><a href="sect101.html"><i class="fa fa-check"></i><b>10.1</b> Modèles multiniveaux : deux intérêts majeurs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect101.html"><a href="sect101.html#sect1011"><i class="fa fa-check"></i><b>10.1.1</b> Répartition de la variance entre les différents niveaux</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect101.html"><a href="sect101.html#sect1012"><i class="fa fa-check"></i><b>10.1.2</b> Estimation des coefficients aux différents niveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect102.html"><a href="sect102.html"><i class="fa fa-check"></i><b>10.2</b> Différents types de modèles multiniveaux</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect102.html"><a href="sect102.html#sect1021"><i class="fa fa-check"></i><b>10.2.1</b> Description du jeu de données utilisé</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect102.html"><a href="sect102.html#sect1022"><i class="fa fa-check"></i><b>10.2.2</b> Démarche classique pour les modèles multiniveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect103.html"><a href="sect103.html"><i class="fa fa-check"></i><b>10.3</b> Conditions d’application des régressions multiniveaux</a></li>
<li class="chapter" data-level="10.4" data-path="sect104.html"><a href="sect104.html"><i class="fa fa-check"></i><b>10.4</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect104.html"><a href="sect104.html#sect1041"><i class="fa fa-check"></i><b>10.4.1</b> Le modèle vide</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect104.html"><a href="sect104.html#sect1042"><i class="fa fa-check"></i><b>10.4.2</b> Modèle avec les variables indépendantes du niveau 1</a></li>
<li class="chapter" data-level="10.4.3" data-path="sect104.html"><a href="sect104.html#sect1043"><i class="fa fa-check"></i><b>10.4.3</b> Modèle avec les variables indépendantes aux niveaux 1 et 2</a></li>
<li class="chapter" data-level="10.4.4" data-path="sect104.html"><a href="sect104.html#sect10414"><i class="fa fa-check"></i><b>10.4.4</b> Modèle complet avec une interaction</a></li>
<li class="chapter" data-level="10.4.5" data-path="sect104.html"><a href="sect104.html#sect1045"><i class="fa fa-check"></i><b>10.4.5</b> Comparaison des quatre modèles</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect105.html"><a href="sect105.html"><i class="fa fa-check"></i><b>10.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> Modèles généralisés additifs</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sect111.html"><a href="sect111.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="sect111.html"><a href="sect111.html#sect1111"><i class="fa fa-check"></i><b>11.1.1</b> Non linéarité fonctionnelle</a></li>
<li class="chapter" data-level="11.1.2" data-path="sect111.html"><a href="sect111.html#sect1112"><i class="fa fa-check"></i><b>11.1.2</b> Non linéarité avec des polynomiales</a></li>
<li class="chapter" data-level="11.1.3" data-path="sect111.html"><a href="sect111.html#sect1113"><i class="fa fa-check"></i><b>11.1.3</b> Non linéarité par segments</a></li>
<li class="chapter" data-level="11.1.4" data-path="sect111.html"><a href="sect111.html#sect1114"><i class="fa fa-check"></i><b>11.1.4</b> Non linéarité avec des <em>splines</em></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sect112.html"><a href="sect112.html"><i class="fa fa-check"></i><b>11.2</b> <em>Spline</em> de régression et <em>spline</em> de lissage</a></li>
<li class="chapter" data-level="11.3" data-path="sect113.html"><a href="sect113.html"><i class="fa fa-check"></i><b>11.3</b> Interprétation d’une <em>spline</em></a></li>
<li class="chapter" data-level="11.4" data-path="sect114.html"><a href="sect114.html"><i class="fa fa-check"></i><b>11.4</b> Multicolinéarité non linéaire</a></li>
<li class="chapter" data-level="11.5" data-path="sect115.html"><a href="sect115.html"><i class="fa fa-check"></i><b>11.5</b> <em>Splines</em> avancées</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sect115.html"><a href="sect115.html#sect1151"><i class="fa fa-check"></i><b>11.5.1</b> <em>Splines</em> cycliques</a></li>
<li class="chapter" data-level="11.5.2" data-path="sect115.html"><a href="sect115.html#sect1152"><i class="fa fa-check"></i><b>11.5.2</b> Splines par groupe</a></li>
<li class="chapter" data-level="11.5.3" data-path="sect115.html"><a href="sect115.html#sect1153"><i class="fa fa-check"></i><b>11.5.3</b> <em>Splines</em> multivariées et <em>splines</em> d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="sect116.html"><a href="sect116.html"><i class="fa fa-check"></i><b>11.6</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="11.7" data-path="sect117.html"><a href="sect117.html"><i class="fa fa-check"></i><b>11.7</b> GAMM</a></li>
<li class="chapter" data-level="11.8" data-path="sect118.html"><a href="sect118.html"><i class="fa fa-check"></i><b>11.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>V Analyses exploratoires multivariées</b></span></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> Méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sect121.html"><a href="sect121.html"><i class="fa fa-check"></i><b>12.1</b> Aperçu des méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="sect121.html"><a href="sect121.html#sect1211"><i class="fa fa-check"></i><b>12.1.1</b> Méthodes factorielles et types de données</a></li>
<li class="chapter" data-level="12.1.2" data-path="sect121.html"><a href="sect121.html#sect1212"><i class="fa fa-check"></i><b>12.1.2</b> Bref historique des méthodes factorielles</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sect122.html"><a href="sect122.html"><i class="fa fa-check"></i><b>12.2</b> Analyses en composantes principales (ACP)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="sect122.html"><a href="sect122.html#sect1221"><i class="fa fa-check"></i><b>12.2.1</b> Recherche d’une simplification</a></li>
<li class="chapter" data-level="12.2.2" data-path="sect122.html"><a href="sect122.html#sect1222"><i class="fa fa-check"></i><b>12.2.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.2.3" data-path="sect122.html"><a href="sect122.html#sect1223"><i class="fa fa-check"></i><b>12.2.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sect123.html"><a href="sect123.html"><i class="fa fa-check"></i><b>12.3</b> Analyse factorielle des correspondances (AFC)</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="sect123.html"><a href="sect123.html#sect1231"><i class="fa fa-check"></i><b>12.3.1</b> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
<li class="chapter" data-level="12.3.2" data-path="sect123.html"><a href="sect123.html#sect1232"><i class="fa fa-check"></i><b>12.3.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.3.3" data-path="sect123.html"><a href="sect123.html#sect1233"><i class="fa fa-check"></i><b>12.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="sect124.html"><a href="sect124.html"><i class="fa fa-check"></i><b>12.4</b> Analyse de correspondances multiples (ACM)</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="sect124.html"><a href="sect124.html#sect1241"><i class="fa fa-check"></i><b>12.4.1</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.4.2" data-path="sect124.html"><a href="sect124.html#sect1242"><i class="fa fa-check"></i><b>12.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="sect125.html"><a href="sect125.html"><i class="fa fa-check"></i><b>12.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> Méthodes de classification non supervisée</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sect131.html"><a href="sect131.html"><i class="fa fa-check"></i><b>13.1</b> Méthodes de classification : un aperçu</a></li>
<li class="chapter" data-level="13.2" data-path="sect132.html"><a href="sect132.html"><i class="fa fa-check"></i><b>13.2</b> Notions essentielles en classification</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="sect132.html"><a href="sect132.html#sect1321"><i class="fa fa-check"></i><b>13.2.1</b> Distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="sect132.html"><a href="sect132.html#sect1322"><i class="fa fa-check"></i><b>13.2.2</b> Inertie</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="sect133.html"><a href="sect133.html"><i class="fa fa-check"></i><b>13.3</b> Classification ascendante hiérarchique</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="sect133.html"><a href="sect133.html#sect1331"><i class="fa fa-check"></i><b>13.3.1</b> Fonctionnement de l’algorithme</a></li>
<li class="chapter" data-level="13.3.2" data-path="sect133.html"><a href="sect133.html#sect1332"><i class="fa fa-check"></i><b>13.3.2</b> Choisir le bon nombre de groupes</a></li>
<li class="chapter" data-level="13.3.3" data-path="sect133.html"><a href="sect133.html#sect1333"><i class="fa fa-check"></i><b>13.3.3</b> Limites de la classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="13.3.4" data-path="sect133.html"><a href="sect133.html#sect1334"><i class="fa fa-check"></i><b>13.3.4</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sect134.html"><a href="sect134.html"><i class="fa fa-check"></i><b>13.4</b> Nuées dynamiques</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="sect134.html"><a href="sect134.html#sect1341"><i class="fa fa-check"></i><b>13.4.1</b> <em>K-means</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="sect134.html"><a href="sect134.html#sect1342"><i class="fa fa-check"></i><b>13.4.2</b> K-médianes</a></li>
<li class="chapter" data-level="13.4.3" data-path="sect134.html"><a href="sect134.html#sect1343"><i class="fa fa-check"></i><b>13.4.3</b> K-médoïds</a></li>
<li class="chapter" data-level="13.4.4" data-path="sect134.html"><a href="sect134.html#sect1344"><i class="fa fa-check"></i><b>13.4.4</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="13.4.5" data-path="sect134.html"><a href="sect134.html#sect1346"><i class="fa fa-check"></i><b>13.4.5</b> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sect135.html"><a href="sect135.html"><i class="fa fa-check"></i><b>13.5</b> Conclusion sur la cinquième partie</a></li>
<li class="chapter" data-level="13.6" data-path="sect136.html"><a href="sect136.html"><i class="fa fa-check"></i><b>13.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>VI Annexes</b></span></li>
<li class="chapter" data-level="14" data-path="annexe1.html"><a href="annexe1.html"><i class="fa fa-check"></i><b>14</b> Table des valeurs critiques de khi-deux</a></li>
<li class="chapter" data-level="15" data-path="annexe2.html"><a href="annexe2.html"><i class="fa fa-check"></i><b>15</b> Table des valeurs critiques de Fisher</a></li>
<li class="chapter" data-level="16" data-path="annexe3.html"><a href="annexe3.html"><i class="fa fa-check"></i><b>16</b> Table des valeurs critiques de <em>t</em></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect096" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Mise en œuvre des GLMM dans R<a href="sect096.html#sect096" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pour cet exemple de GLMM, nous proposons d’analyser à nouveau les données présentées dans la section <a href="sect062.html#sect06211">6.2.1.1</a> sur le modèle logistique binomial. Pour rappel, nous modélisions la probabilité qu’un individu utilise le vélo comme mode de transport pour son trajet le plus fréquent en utilisant une enquête réalisée auprès d’environ 26 000 Européens. Initialement, nous avons intégré les pays comme un effet fixe. Or, nous savons à présent qu’il serait plus judicieux de les traiter comme un effet aléatoire. Nous comparons deux modèles, un pour lequel seulement la constante varie par pays et un second dans lequel la pente pour l’âge varie également par pays. L’hypothèse étant que l’effet de l’âge sur l’utilisation du vélo pourrait être réduit dans certains pays où la culture du vélo est plus présente. Cette hypothèse implique également la présence potentielle d’une corrélation inverse entre la constante et la pente de chaque pays : dans un pays où la probabilité de base d’utiliser le vélo est plus élevée, l’effet de l’effet de l’âge est probablement réduit.</p>
<p>Pour ajuster ces modèles, nous utilisons le <em>package</em> <code>lme4</code>, permettant d’ajuster des modèles GLMM avec des distributions gaussienne, Gamma, de Poisson et binomial. Lorsque d’autres distributions sont nécessaires, il est possible de se tourner vers le <em>package</em> <code>gamlss</code>. Notez cependant que les effets aléatoires de <code>gamlss</code> sont estimés avec une méthode appelée PQL très flexible, mais qui peut produire des résultats erronés dans certains cas <span class="citation">(<a href="#ref-bolker2009generalized" role="doc-biblioref">Bolker et al. 2009</a>)</span>.</p>
<p>Afin de limiter les répétitions, nous ne recalculons pas ici le VIF et nous excluons d’emblée les observations aberrantes (provenant de Malte ou de Chypre ou avec des temps de trajets supérieurs à 400 minutes).</p>
<div id="sect0961" class="section level3 hasAnchor" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Ajustement du modèle avec uniquement une constante aléatoire<a href="sect096.html#sect0961" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nous commençons donc par ajuster un premier modèle avec une constante aléatoire en fonction du pays. Dans la plupart des <em>packages</em> intégrant des effets aléatoires, la syntaxe suivante est utilisée pour stipuler une constante aléatoire : <code>+ (1|Pays)</code>. Concrètement, nous tentons d’ajuster le modèle décrit par l’équation <a href="sect096.html#eq:glmmbinom1">(9.11)</a>.</p>
<p><span class="math display" id="eq:glmmbinom1">\[\begin{equation}
\begin{aligned}
&amp;Y \sim Binomial(p)\\
&amp;g(p) = \beta_0 + \beta_1 x_1 + \upsilon \\
&amp;\upsilon \sim Normal(0, \sigma_{\upsilon}) \\
&amp;g(x) = log(\frac{x}{1-x})
\end{aligned}
\tag{9.11}
\end{equation}\]</span>
</p>
<p>Il s’agit simplement d’un modèle logistique binomial dans lequel nous avons ajouté une constante aléatoire : <span class="math inline">\(\upsilon\)</span>. Dans notre cas, elle varie avec la variable <code>Pays</code>. La syntaxe dans R pour produire ce modèle est la suivante.</p>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="sect096.html#cb956-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb956-2"><a href="sect096.html#cb956-2" aria-hidden="true" tabindex="-1"></a>dfenquete <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/glm/enquete_transport_UE.csv&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>)</span>
<span id="cb956-3"><a href="sect096.html#cb956-3" aria-hidden="true" tabindex="-1"></a>dfenquete<span class="sc">$</span>Pays <span class="ot">&lt;-</span> <span class="fu">relevel</span>(<span class="fu">as.factor</span>(dfenquete<span class="sc">$</span>Pays), <span class="at">ref =</span> <span class="st">&quot;Allemagne&quot;</span>)</span>
<span id="cb956-4"><a href="sect096.html#cb956-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Retirer les observations aberrantes</span></span>
<span id="cb956-5"><a href="sect096.html#cb956-5" aria-hidden="true" tabindex="-1"></a>dfenquete2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(dfenquete, (dfenquete<span class="sc">$</span>Pays <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Malte&quot;</span>, <span class="st">&quot;Chypre&quot;</span>)) <span class="sc">==</span> F <span class="sc">&amp;</span> </span>
<span id="cb956-6"><a href="sect096.html#cb956-6" aria-hidden="true" tabindex="-1"></a>                  dfenquete<span class="sc">$</span>Duree <span class="sc">&lt;</span> <span class="dv">400</span>)</span>
<span id="cb956-7"><a href="sect096.html#cb956-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb956-8"><a href="sect096.html#cb956-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement du modèle</span></span>
<span id="cb956-9"><a href="sect096.html#cb956-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb956-10"><a href="sect096.html#cb956-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Nécessité ici de centrer et réduire ces variables pour permettre au modèle de converger</span></span>
<span id="cb956-11"><a href="sect096.html#cb956-11" aria-hidden="true" tabindex="-1"></a>dfenquete2<span class="sc">$</span>Age2 <span class="ot">&lt;-</span> <span class="fu">scale</span>(dfenquete2<span class="sc">$</span>Age,<span class="at">center =</span> T, <span class="at">scale =</span> T)</span>
<span id="cb956-12"><a href="sect096.html#cb956-12" aria-hidden="true" tabindex="-1"></a>dfenquete2<span class="sc">$</span>Duree2 <span class="ot">&lt;-</span> <span class="fu">scale</span>(dfenquete2<span class="sc">$</span>Duree,<span class="at">center =</span> T, <span class="at">scale =</span> T)</span>
<span id="cb956-13"><a href="sect096.html#cb956-13" aria-hidden="true" tabindex="-1"></a>modele1 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(y <span class="sc">~</span>Sexe <span class="sc">+</span> Age2 <span class="sc">+</span> Education <span class="sc">+</span> StatutEmploi <span class="sc">+</span> Revenu <span class="sc">+</span></span>
<span id="cb956-14"><a href="sect096.html#cb956-14" aria-hidden="true" tabindex="-1"></a>              Residence <span class="sc">+</span> Duree2 <span class="sc">+</span> ConsEnv <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>Pays),</span>
<span id="cb956-15"><a href="sect096.html#cb956-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb956-16"><a href="sect096.html#cb956-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>),</span>
<span id="cb956-17"><a href="sect096.html#cb956-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dfenquete2)</span></code></pre></div>
<p>Nous nous concentrons ici sur l’interprétation des résultats du modèle et nous réalisons l’ensemble des diagnostics dans une section dédiée en fin de chapitre. Notez cependant que le diagnostic <strong>devrait précéder l’interprétation</strong> comme nous l’avons vu dans le chapitre sur les modèles GLM.</p>
<p>Vous constaterez que nous avons centré-réduit les variables <code>Age</code> et <code>Duree</code>. Il est souvent nécessaire de réaliser cette étape en amont pour s’assurer que le modèle converge sans trop de difficulté. Dans notre cas, si ces deux variables sont laissées dans leur échelle d’origine, la fonction <code>glmer</code> ne parvient pas à ajuster le modèle. Notez que cette transformation nous permet d’obtenir les coefficients standardisés, s’exprimant alors en écarts-types. La fonction <code>summary</code> nous donne accès à un premier ensemble d’informations.</p>
<div class="sourceCode" id="cb957"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb957-1"><a href="sect096.html#cb957-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele1)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( logit )
## Formula: y ~ Sexe + Age2 + Education + StatutEmploi + Revenu + Residence +  
##     Duree2 + ConsEnv + (1 | Pays)
##    Data: dfenquete2
## Control: glmerControl(optimizer = &quot;bobyqa&quot;)
## 
##      AIC      BIC   logLik deviance df.resid 
##  19176.1  19322.8  -9570.1  19140.1    25529 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.1989 -0.4418 -0.3212 -0.2134  7.2461 
## 
## Random effects:
##  Groups Name        Variance Std.Dev.
##  Pays   (Intercept) 0.5949   0.7713  
## Number of obs: 25547, groups:  Pays, 26
## 
## Fixed effects:
##                                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                   -3.368954   0.212505 -15.854  &lt; 2e-16 ***
## Sexehomme                      0.370865   0.037921   9.780  &lt; 2e-16 ***
## Age2                          -0.102387   0.018776  -5.453 4.95e-08 ***
## Educationsecondaire            0.188093   0.103183   1.823  0.06832 .  
## Educationsecondaire inferieur  0.297587   0.111334   2.673  0.00752 ** 
## Educationuniversite            0.138666   0.106495   1.302  0.19289    
## StatutEmploisans emploi        0.256478   0.042282   6.066 1.31e-09 ***
## Revenufaible                   0.073834   0.071648   1.031  0.30277    
## Revenumoyen                    0.039403   0.065237   0.604  0.54585    
## Revenusans reponse             0.215704   0.102298   2.109  0.03498 *  
## Revenutres eleve              -0.121254   0.185292  -0.654  0.51286    
## Revenutres faible              0.237385   0.085705   2.770  0.00561 ** 
## Residencegrande ville          0.272281   0.069277   3.930 8.48e-05 ***
## Residencepetite-moyenne ville  0.276286   0.061493   4.493 7.02e-06 ***
## Residencezone rurale          -0.118963   0.069093  -1.722  0.08511 .  
## Duree2                        -0.018718   0.019241  -0.973  0.33065    
## ConsEnv                        0.101757   0.009277  10.969  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>La première partie de ce résumé nous rappelle la formule utilisée pour le modèle et nous indique différents indicateurs de qualité d’ajustement comme l’AIC, le BIC et la déviance. Nous avons ensuite une partie dédiée aux effets aléatoires (<code>Random Effects</code>) et une partie dédiée aux effets fixes (<code>Fixed effects</code>). Cette dernière s’interprète de la même manière que pour un modèle à effets fixes, n’oubliez cependant pas d’utiliser la fonction exponentielle pour obtenir les rapports de cotes (fonction de lien logistique).</p>
<div id="sect09611" class="section level4 hasAnchor" number="9.6.1.1">
<h4><span class="header-section-number">9.6.1.1</span> Rôle joué par l’effet aléatoire<a href="sect096.html#sect09611" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Comme vous pouvez le constater, la section <code>Random Effects</code> ne comprend qu’un seul paramètre : la variance de l’effet pays. Nous pouvons ainsi écrire que l’effet du pays suit une distribution normale avec une moyenne de 0 et une variance <span class="math inline">\(\sigma^2\)</span> de 0,595. Pour aller plus loin dans cette analyse, nous pouvons calculer le coefficient de corrélation intraclasse (ICC). Cependant, puisque notre modèle est binomial et non gaussien, nous ne disposons pas d’un paramètre de variance au niveau des individus, il est donc possible, à la place, d’utiliser la variance théorique du modèle : <span class="math inline">\(\frac{\pi^2}{3}\)</span>. Nous calculons ainsi notre ICC :</p>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="sect096.html#cb959-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction de la variance des Pays</span></span>
<span id="cb959-2"><a href="sect096.html#cb959-2" aria-hidden="true" tabindex="-1"></a>var_pays <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(modele1)[[<span class="dv">1</span>]][[<span class="dv">1</span>]]</span>
<span id="cb959-3"><a href="sect096.html#cb959-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de l&#39;ICC</span></span>
<span id="cb959-4"><a href="sect096.html#cb959-4" aria-hidden="true" tabindex="-1"></a>var_pays <span class="sc">/</span> (((pi<span class="sc">**</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span> var_pays)</span></code></pre></div>
<pre><code>## [1] 0.1531373</code></pre>
<p>Nous pouvons parvenir au même résultat en utilisant la fonction <code>icc</code> du <em>package</em> <code>performance</code>.</p>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb961-1"><a href="sect096.html#cb961-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb961-2"><a href="sect096.html#cb961-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de l&#39;ICC</span></span>
<span id="cb961-3"><a href="sect096.html#cb961-3" aria-hidden="true" tabindex="-1"></a><span class="fu">icc</span>(modele1)</span></code></pre></div>
<pre><code>## # Intraclass Correlation Coefficient
## 
##     Adjusted ICC: 0.153
##   Unadjusted ICC: 0.148</code></pre>
<p>Notez que cette fonction distingue un ICC ajusté et un ICC conditionnel. Le premier correspond à l’ICC que nous avons présenté jusqu’ici et que nous avons calculé à la main. L’ICC conditionnel inclut dans son estimation la variance présente dans les effets fixes. Un fort écart entre ces deux ICC indique que les effets fixes sont capables de capturer une très forte variance dans les données, ce qui pourrait remettre en cause la pertinence de l’effet aléatoire. Dans notre cas, la différence entre les deux est très faible.</p>
<p>En plus du ICC, nous pouvons calculer les R<sup>2</sup> marginal et conditionnel. Pour cela, nous utilisons la fonction <code>r.squaredGLMM</code> du <em>package</em> <code>MuMIn</code>.</p>
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb963-1"><a href="sect096.html#cb963-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb963-2"><a href="sect096.html#cb963-2" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(modele1)</span></code></pre></div>
<pre><code>##                    R2m       R2c
## theoretical 0.03492163 0.1827111
## delta       0.01554532 0.0813336</code></pre>
<p>Cette fonction nous renvoie à la fois les R<sup>2</sup> obtenus en utilisant la variance théorique du modèle (<span class="math inline">\(\frac{\pi^2}{3}\)</span> dans notre cas) et la variance estimée par la méthode delta. La seconde est plus conservative, mais les deux résultats indiquent que les effets aléatoires expliquent une part importante de la variance comparativement aux effets fixes. Notez également que la fonction <code>r2</code> du <em>package</em> <code>performance</code> peut calculer ces deux R<sup>2</sup>, mais seulement en utilisant la variance théorique.</p>
</div>
<div id="sect09612" class="section level4 hasAnchor" number="9.6.1.2">
<h4><span class="header-section-number">9.6.1.2</span> Significativité de l’effet aléatoire<a href="sect096.html#sect09612" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous souhaitons déterminer ici si notre effet aléatoire contribue à significativement améliorer le modèle. Pour cela, nous effectuons un test de rapport de vraisemblance entre le modèle sans l’effet aléatoire (un simple GLM ici) et le modèle complet. Nous utilisons pour cela la fonction <code>anova</code> :</p>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="sect096.html#cb965-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustement d&#39;un modèle sans l&#39;effet aléatoire</span></span>
<span id="cb965-2"><a href="sect096.html#cb965-2" aria-hidden="true" tabindex="-1"></a>model_simple <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span>Sexe <span class="sc">+</span> Age2 <span class="sc">+</span> Education <span class="sc">+</span> StatutEmploi <span class="sc">+</span> Revenu <span class="sc">+</span></span>
<span id="cb965-3"><a href="sect096.html#cb965-3" aria-hidden="true" tabindex="-1"></a>              Residence <span class="sc">+</span> Duree2 <span class="sc">+</span> ConsEnv,</span>
<span id="cb965-4"><a href="sect096.html#cb965-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb965-5"><a href="sect096.html#cb965-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dfenquete2)</span>
<span id="cb965-6"><a href="sect096.html#cb965-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparaison des deux modèles</span></span>
<span id="cb965-7"><a href="sect096.html#cb965-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modele1,model_simple)</span></code></pre></div>
<pre><code>## Data: dfenquete2
## Models:
## model_simple: y ~ Sexe + Age2 + Education + StatutEmploi + Revenu + Residence + Duree2 + ConsEnv
## modele1: y ~ Sexe + Age2 + Education + StatutEmploi + Revenu + Residence + Duree2 + ConsEnv + (1 | Pays)
##              npar   AIC   BIC   logLik deviance Chisq Df Pr(&gt;Chisq)    
## model_simple   17 20521 20660 -10243.6    20487                        
## modele1        18 19176 19323  -9570.1    19140  1347  1  &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Le test indique clairement que le modèle complet est mieux ajusté : les valeurs de l’AIC, du BIC et de la déviance sont toutes grandement réduites et le test est largement significatif.</p>
<p>Pour aller plus loin, nous pouvons utiliser une approche par <em>bootstrap</em> pour calculer un intervalle de confiance pour la variance de l’effet aléatoire, l’ICC et le R<sup>2</sup> conditionnel. Nous utilisons pour cela la fonction <code>bootMer</code>. Si vous essayez de lancer cette syntaxe, vous constaterez qu’elle prend énormément de temps, ce qui s’explique par le grand nombre de fois où le modèle doit être réajusté. Nous vous recommandons donc de bien enregistrer vos résultats après l’exécution de la fonction avec la fonction <code>save.</code> Notez que pour réduire significativement le temps de calcul, il est possible d’utiliser simultanément plusieurs cœurs de votre processeur, ce que nous faisons ici avec le <em>package</em> <code>snow</code>.</p>
<div class="sourceCode" id="cb967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb967-1"><a href="sect096.html#cb967-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition d&#39;une fonction pour extraire les valeurs qui nous intéressent</span></span>
<span id="cb967-2"><a href="sect096.html#cb967-2" aria-hidden="true" tabindex="-1"></a>extractor <span class="ot">&lt;-</span> <span class="cf">function</span>(mod){</span>
<span id="cb967-3"><a href="sect096.html#cb967-3" aria-hidden="true" tabindex="-1"></a>  vari <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(mod)[[<span class="dv">1</span>]][[<span class="dv">1</span>]]</span>
<span id="cb967-4"><a href="sect096.html#cb967-4" aria-hidden="true" tabindex="-1"></a>  ICC <span class="ot">&lt;-</span> vari <span class="sc">/</span> (vari <span class="sc">+</span> (pi<span class="sc">**</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>))</span>
<span id="cb967-5"><a href="sect096.html#cb967-5" aria-hidden="true" tabindex="-1"></a>  r2cond <span class="ot">&lt;-</span> performance<span class="sc">::</span><span class="fu">r2</span>(mod)[[<span class="dv">1</span>]]</span>
<span id="cb967-6"><a href="sect096.html#cb967-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">&quot;vari&quot;</span><span class="ot">=</span>vari,<span class="st">&quot;icc&quot;</span><span class="ot">=</span>ICC,<span class="st">&quot;r2cond&quot;</span><span class="ot">=</span>r2cond))</span>
<span id="cb967-7"><a href="sect096.html#cb967-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb967-8"><a href="sect096.html#cb967-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation d&#39;un environnement multitraitement pour accélérer le calcul</span></span>
<span id="cb967-9"><a href="sect096.html#cb967-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(snow)</span>
<span id="cb967-10"><a href="sect096.html#cb967-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation de huit coeurs (attention si votre machine en a moins!)</span></span>
<span id="cb967-11"><a href="sect096.html#cb967-11" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">8</span>)</span>
<span id="cb967-12"><a href="sect096.html#cb967-12" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl,<span class="fu">library</span>(<span class="st">&quot;lme4&quot;</span>))</span>
<span id="cb967-13"><a href="sect096.html#cb967-13" aria-hidden="true" tabindex="-1"></a>valeurs <span class="ot">&lt;-</span> <span class="fu">bootMer</span>(modele1,<span class="at">FUN =</span> extractor,<span class="at">nsim =</span> <span class="dv">1000</span>,</span>
<span id="cb967-14"><a href="sect096.html#cb967-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">use.u =</span> F, <span class="at">type=</span><span class="st">&quot;parametric&quot;</span>, <span class="at">ncpus =</span> <span class="dv">8</span>,</span>
<span id="cb967-15"><a href="sect096.html#cb967-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">parallel=</span><span class="st">&quot;snow&quot;</span>,</span>
<span id="cb967-16"><a href="sect096.html#cb967-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cl =</span> cl)</span>
<span id="cb967-17"><a href="sect096.html#cb967-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sauvegarde des résultats</span></span>
<span id="cb967-18"><a href="sect096.html#cb967-18" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(valeurs,<span class="at">file =</span> <span class="st">&#39;data/glmm/boot_binom.rda&#39;</span>)</span></code></pre></div>
<p>Nous pouvons à présent analyser l’incertitude de ces différents paramètres. Pour cela, nous devons commencer par observer graphiquement leurs distributions obtenues par <em>bootstrap</em> avec la figure <a href="sect096.html#fig:bottdistrib">9.17</a>.</p>
<div class="sourceCode" id="cb968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb968-1"><a href="sect096.html#cb968-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement de nos valeurs préalablement enregistrées</span></span>
<span id="cb968-2"><a href="sect096.html#cb968-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;data/glmm/boot_binom.rda&#39;</span>)</span>
<span id="cb968-3"><a href="sect096.html#cb968-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Construction de trois graphiques de distribution</span></span>
<span id="cb968-4"><a href="sect096.html#cb968-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(valeurs<span class="sc">$</span>t)</span>
<span id="cb968-5"><a href="sect096.html#cb968-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;variance&quot;</span>,<span class="st">&quot;icc&quot;</span>,<span class="st">&quot;R2cond&quot;</span>)</span>
<span id="cb968-6"><a href="sect096.html#cb968-6" aria-hidden="true" tabindex="-1"></a>breaks1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">quantile</span>(df<span class="sc">$</span>variance, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fl">0.15</span>,<span class="fl">0.5</span>,<span class="fl">0.85</span>, <span class="fl">0.999</span>)))</span>
<span id="cb968-7"><a href="sect096.html#cb968-7" aria-hidden="true" tabindex="-1"></a>labs1 <span class="ot">&lt;-</span> <span class="fu">round</span>(breaks1,<span class="dv">2</span>)</span>
<span id="cb968-8"><a href="sect096.html#cb968-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb968-9"><a href="sect096.html#cb968-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> variance), <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb968-10"><a href="sect096.html#cb968-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(df<span class="sc">$</span>variance),</span>
<span id="cb968-11"><a href="sect096.html#cb968-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb968-12"><a href="sect096.html#cb968-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks1, <span class="at">labels =</span> labs1)<span class="sc">+</span></span>
<span id="cb968-13"><a href="sect096.html#cb968-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb968-14"><a href="sect096.html#cb968-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb968-15"><a href="sect096.html#cb968-15" aria-hidden="true" tabindex="-1"></a>breaks2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">quantile</span>(df<span class="sc">$</span>icc, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fl">0.15</span>,<span class="fl">0.5</span>,<span class="fl">0.85</span>, <span class="fl">0.999</span>)))</span>
<span id="cb968-16"><a href="sect096.html#cb968-16" aria-hidden="true" tabindex="-1"></a>labs2 <span class="ot">&lt;-</span> <span class="fu">round</span>(breaks2,<span class="dv">2</span>)</span>
<span id="cb968-17"><a href="sect096.html#cb968-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb968-18"><a href="sect096.html#cb968-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> icc), <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb968-19"><a href="sect096.html#cb968-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(df<span class="sc">$</span>icc),</span>
<span id="cb968-20"><a href="sect096.html#cb968-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb968-21"><a href="sect096.html#cb968-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks2, <span class="at">labels =</span> labs2)<span class="sc">+</span></span>
<span id="cb968-22"><a href="sect096.html#cb968-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb968-23"><a href="sect096.html#cb968-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb968-24"><a href="sect096.html#cb968-24" aria-hidden="true" tabindex="-1"></a>breaks3 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">quantile</span>(df<span class="sc">$</span>R2cond, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.001</span>,<span class="fl">0.15</span>,<span class="fl">0.5</span>,<span class="fl">0.85</span>, <span class="fl">0.999</span>)))</span>
<span id="cb968-25"><a href="sect096.html#cb968-25" aria-hidden="true" tabindex="-1"></a>labs3 <span class="ot">&lt;-</span> <span class="fu">round</span>(breaks3,<span class="dv">3</span>)</span>
<span id="cb968-26"><a href="sect096.html#cb968-26" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb968-27"><a href="sect096.html#cb968-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> R2cond), <span class="at">bins =</span> <span class="dv">50</span>, <span class="at">fill =</span> <span class="st">&quot;#1d3557&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb968-28"><a href="sect096.html#cb968-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(df<span class="sc">$</span>R2cond),</span>
<span id="cb968-29"><a href="sect096.html#cb968-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb968-30"><a href="sect096.html#cb968-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks3, <span class="at">labels =</span> labs3)<span class="sc">+</span></span>
<span id="cb968-31"><a href="sect096.html#cb968-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb968-32"><a href="sect096.html#cb968-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>())</span>
<span id="cb968-33"><a href="sect096.html#cb968-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1,p2,p3, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:bottdistrib"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/bottdistrib-1.png" alt="Distributions obtenues par bootstrap de la variance de l'effet aléatoire, de l'ICC et du R carré conditionnel" width="80%" />
<p class="caption">
Figure 9.17: Distributions obtenues par bootstrap de la variance de l’effet aléatoire, de l’ICC et du R carré conditionnel
</p>
</div>
<p>Les trois distributions sont toutes suffisamment éloignées de zéro pour que nous puissions en conclure que ces différentes valeurs sont toutes différentes de zéro. Notez également que les distributions sont relativement symétriques, indiquant que nous disposons de probablement suffisamment d’information dans nos données pour inclure notre effet aléatoire. Des distributions fortement asymétriques indiqueraient, au contraire, une forte difficulté du modèle à estimer le paramètre de variance à partir des données. Dans un article, il n’est pas nécessaire de reporter ces graphiques, mais plus simplement les intervalles de confiance à 95 % et les médianes.</p>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb969-1"><a href="sect096.html#cb969-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalle de confiance pour la variance</span></span>
<span id="cb969-2"><a href="sect096.html#cb969-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(df<span class="sc">$</span>variance,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.0275</span>,<span class="fl">0.5</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##     2.75%       50%     97.5% 
## 0.3059400 0.5578986 0.9200472</code></pre>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="sect096.html#cb971-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalle de confiance pour l&#39;ICC</span></span>
<span id="cb971-2"><a href="sect096.html#cb971-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(df<span class="sc">$</span>icc,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.0275</span>,<span class="fl">0.5</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##     2.75%       50%     97.5% 
## 0.0850824 0.1449928 0.2185428</code></pre>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb973-1"><a href="sect096.html#cb973-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Intervalle de confiance pour le R2 conditionnel</span></span>
<span id="cb973-2"><a href="sect096.html#cb973-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(df<span class="sc">$</span>R2cond,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.0275</span>,<span class="fl">0.5</span>,<span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##     2.75%       50%     97.5% 
## 0.1208577 0.1772778 0.2462622</code></pre>
</div>
<div id="sect09613" class="section level4 hasAnchor" number="9.6.1.3">
<h4><span class="header-section-number">9.6.1.3</span> Significativité des différentes constantes<a href="sect096.html#sect09613" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Puisque nous avons conclu que l’effet aléatoire contribue significativement au modèle, nous pouvons à présent vérifier si les constantes ajustées pour chaque pays varient significativement les unes des autres. Pour rappel, les pentes et les constantes aléatoires ne sont pas directement estimées par le modèle, mais à posteriori. Il en résulte qu’il n’y a pas de moyen direct de mesurer l’incertitude de ces paramètres, et donc de construire des intervalles de confiance. Une première option pour contourner ce problème est d’effectuer des simulations à partir de la distribution postérieure du modèle. Notez que cette approche s’inspire largement de l’approche statistique bayésienne. Nous utilisons ici le <em>package</em> <code>merTools</code> pour effectuer 1000 simulations et obtenir une erreur standard pour chaque constante aléatoire de chaque pays.</p>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="sect096.html#cb975-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulations et extraction des effets aléatoires</span></span>
<span id="cb975-2"><a href="sect096.html#cb975-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools)</span>
<span id="cb975-3"><a href="sect096.html#cb975-3" aria-hidden="true" tabindex="-1"></a>simsRE <span class="ot">&lt;-</span> <span class="fu">REsim</span>(modele1,<span class="at">n.sims =</span> <span class="dv">1000</span>, <span class="at">oddsRatio =</span> F)</span>
<span id="cb975-4"><a href="sect096.html#cb975-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des intervalles de confiance</span></span>
<span id="cb975-5"><a href="sect096.html#cb975-5" aria-hidden="true" tabindex="-1"></a>simsRE<span class="sc">$</span>lower <span class="ot">&lt;-</span> simsRE<span class="sc">$</span>mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> simsRE<span class="sc">$</span>sd</span>
<span id="cb975-6"><a href="sect096.html#cb975-6" aria-hidden="true" tabindex="-1"></a>simsRE<span class="sc">$</span>upper <span class="ot">&lt;-</span> simsRE<span class="sc">$</span>mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> simsRE<span class="sc">$</span>sd</span>
<span id="cb975-7"><a href="sect096.html#cb975-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable binaire pour la significativité</span></span>
<span id="cb975-8"><a href="sect096.html#cb975-8" aria-hidden="true" tabindex="-1"></a>simsRE<span class="sc">$</span>sign <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb975-9"><a href="sect096.html#cb975-9" aria-hidden="true" tabindex="-1"></a>  simsRE<span class="sc">$</span>lower<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> simsRE<span class="sc">$</span>upper<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;inf&quot;</span>,</span>
<span id="cb975-10"><a href="sect096.html#cb975-10" aria-hidden="true" tabindex="-1"></a>  simsRE<span class="sc">$</span>lower<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> simsRE<span class="sc">$</span>upper<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;sup&quot;</span>,</span>
<span id="cb975-11"><a href="sect096.html#cb975-11" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;not&quot;</span></span>
<span id="cb975-12"><a href="sect096.html#cb975-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb975-13"><a href="sect096.html#cb975-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Représentation des intervalles de confiance</span></span>
<span id="cb975-14"><a href="sect096.html#cb975-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(simsRE) <span class="sc">+</span> </span>
<span id="cb975-15"><a href="sect096.html#cb975-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> lower, <span class="at">xmax =</span> upper,</span>
<span id="cb975-16"><a href="sect096.html#cb975-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">reorder</span>(groupID,mean)), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">height =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb975-17"><a href="sect096.html#cb975-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean, <span class="at">y =</span> <span class="fu">reorder</span>(groupID,mean),</span>
<span id="cb975-18"><a href="sect096.html#cb975-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> sign)) <span class="sc">+</span> </span>
<span id="cb975-19"><a href="sect096.html#cb975-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;inf&quot;</span> <span class="ot">=</span> <span class="st">&quot;#0077b6&quot;</span>, <span class="st">&quot;sup&quot;</span> <span class="ot">=</span> <span class="st">&quot;#e63946&quot;</span>, <span class="st">&quot;not&quot;</span><span class="ot">=</span><span class="st">&quot;#000000&quot;</span>), </span>
<span id="cb975-20"><a href="sect096.html#cb975-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;sign. &lt; 0&quot;</span>, <span class="st">&quot;sign. &gt; 0&quot;</span>, <span class="st">&quot;non sign.&quot;</span>)) <span class="sc">+</span></span>
<span id="cb975-21"><a href="sect096.html#cb975-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Constante aléatoire&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Pays&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:randomconstantes1"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/randomconstantes1-1.png" alt="Constantes aléatoires estimées par Pays (IC par simulations)" width="70%" />
<p class="caption">
Figure 9.18: Constantes aléatoires estimées par Pays (IC par simulations)
</p>
</div>
<p>La figure <a href="sect096.html#fig:randomconstantes1">9.18</a> permet de repérer en un coup d’oeil les pays pour lesquels la probabilité d’utiliser le vélo comme moyen de transport pour le trajet le plus fréquent est la plus élevée ou la plus faible. Notez cependant que les valeurs représentées sont pour l’instant des logarithmes de rapport de cotes. Nous devons donc les convertir en rapports de cotes avec la fonction exponentielle pour faciliter leur interprétation.</p>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="sect096.html#cb976-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion en rapports de cote (et arrondissement à trois décimales)</span></span>
<span id="cb976-2"><a href="sect096.html#cb976-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(simsRE[<span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;lower&quot;</span>,<span class="st">&quot;upper&quot;</span>)]),<span class="dv">3</span>)</span>
<span id="cb976-3"><a href="sect096.html#cb976-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mat) <span class="ot">&lt;-</span> simsRE<span class="sc">$</span>groupID</span>
<span id="cb976-4"><a href="sect096.html#cb976-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;RC&quot;</span>,<span class="st">&quot;RC.025&quot;</span>,<span class="st">&quot;RC.975&quot;</span>)</span>
<span id="cb976-5"><a href="sect096.html#cb976-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mat)</span></code></pre></div>
<pre><code>##                    RC RC.025 RC.975
## Allemagne       1.667  1.191  2.333
## Autriche        1.311  0.927  1.853
## Belgique        1.428  1.022  1.997
## Bulgarie        0.541  0.374  0.784
## Croatie         1.880  1.354  2.610
## Danemark        4.043  2.926  5.587
## Espagne         0.292  0.194  0.439
## Estonie         1.121  0.787  1.598
## Finlande        2.242  1.621  3.102
## France          0.523  0.357  0.766
## Grande Bretagne 0.396  0.269  0.583
## Grèce           0.615  0.422  0.897
## Hongrie         2.359  1.700  3.273
## Ireland         0.377  0.254  0.558
## Italie          0.805  0.575  1.126
## Lettonie        1.270  0.901  1.790
## Lituanie        0.902  0.632  1.287
## Luxembourg      0.419  0.262  0.670
## Pays-Bas        3.939  2.873  5.400
## Pologne         1.658  1.189  2.311
## Portugal        0.218  0.139  0.340
## Roumanie        0.542  0.376  0.781
## Slovaquie       1.029  0.727  1.455
## Slovénie        1.363  0.969  1.916
## Suède           2.166  1.555  3.018
## Tchéquie        1.172  0.837  1.641</code></pre>
<p>Nous observons ainsi qu’une personne vivant en Finlande voit ses chances multipliées par 2,25 d’utiliser le vélo comme mode de transport pour son trajet le plus fréquent comparativement à la moyenne des pays européens. À l’inverse, une personne résidant en France a 47 % de chances de moins d’utiliser le vélo.</p>
<p>Notez cependant que cette approche basée sur des simulations peut poser des problèmes, car elle ne renvoie qu’une erreur standard pour mesurer l’incertitude de nos constantes. Dans les cas où nous ne disposons pas de beaucoup d’observations par groupe, la distribution à posteriori des constantes peut être asymétrique, rendant l’estimation des intervalles de confiance par les erreurs standards inutiles. Il est possible de détecter ce cas de figure quand les médianes et les moyennes renvoyées par la fonction <code>simsRE</code> diffèrent nettement. Une alternative plus robuste est à nouveau d’estimer la variabilité des effets aléatoires par <em>bootstrap</em>. Cette méthode requiert bien plus de temps de calcul que la précédente, nous vous recommandons donc de commencer par la méthode par simulations pour disposer d’un premier aperçu des résultats et d’utiliser ensuite la méthode <em>bootstrap</em> quand votre modèle est dans sa forme finale.</p>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="sect096.html#cb978-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Création de la fonction d&#39;extraction</span></span>
<span id="cb978-2"><a href="sect096.html#cb978-2" aria-hidden="true" tabindex="-1"></a>extractor2 <span class="ot">&lt;-</span> <span class="cf">function</span>(mod){</span>
<span id="cb978-3"><a href="sect096.html#cb978-3" aria-hidden="true" tabindex="-1"></a>  elements <span class="ot">&lt;-</span> <span class="fu">ranef</span>(mod)<span class="sc">$</span>Pays</span>
<span id="cb978-4"><a href="sect096.html#cb978-4" aria-hidden="true" tabindex="-1"></a>  vec <span class="ot">&lt;-</span> elements[,<span class="dv">1</span>]</span>
<span id="cb978-5"><a href="sect096.html#cb978-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(vec) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(elements)</span>
<span id="cb978-6"><a href="sect096.html#cb978-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(vec)</span>
<span id="cb978-7"><a href="sect096.html#cb978-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb978-8"><a href="sect096.html#cb978-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Préparation de l&#39;opération en multitraitement</span></span>
<span id="cb978-9"><a href="sect096.html#cb978-9" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">8</span>)</span>
<span id="cb978-10"><a href="sect096.html#cb978-10" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cl,<span class="fu">library</span>(<span class="st">&quot;lme4&quot;</span>))</span>
<span id="cb978-11"><a href="sect096.html#cb978-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des effets aléatoires en bootstrap</span></span>
<span id="cb978-12"><a href="sect096.html#cb978-12" aria-hidden="true" tabindex="-1"></a>valeurs <span class="ot">&lt;-</span> <span class="fu">bootMer</span>(modele1,<span class="at">FUN =</span> extractor2,<span class="at">nsim =</span> <span class="dv">1000</span>,</span>
<span id="cb978-13"><a href="sect096.html#cb978-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">use.u =</span> T, <span class="at">type=</span><span class="st">&quot;parametric&quot;</span>, <span class="at">ncpus =</span> <span class="dv">8</span>,</span>
<span id="cb978-14"><a href="sect096.html#cb978-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">parallel=</span><span class="st">&quot;snow&quot;</span>,</span>
<span id="cb978-15"><a href="sect096.html#cb978-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cl =</span> cl)</span>
<span id="cb978-16"><a href="sect096.html#cb978-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Sauvegarder des résultats!</span></span>
<span id="cb978-17"><a href="sect096.html#cb978-17" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(valeurs,<span class="at">file =</span> <span class="st">&#39;data/glmm/boot_binom2.rda&#39;</span>)</span></code></pre></div>
<p>Puisque nous disposons des distributions <em>bootstrapées</em> des différents effets aléatoires, nous pouvons directement les représenter dans un graphique (figure <a href="sect096.html#fig:randomconstantes2">9.19</a>). Les résultats sont très similaires à ceux de la figure <a href="sect096.html#fig:randomconstantes1">9.18</a>, ce qui s’explique par le grand nombre d’observations et de groupes. Avec moins d’observations, il est recommandé de privilégier l’approche par <em>bootstrap</em>.</p>
<div class="sourceCode" id="cb979"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb979-1"><a href="sect096.html#cb979-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement de nos valeurs bootstrapées</span></span>
<span id="cb979-2"><a href="sect096.html#cb979-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;data/glmm/boot_binom2.rda&#39;</span>)</span>
<span id="cb979-3"><a href="sect096.html#cb979-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion des bootstraps en intervalle de confiance</span></span>
<span id="cb979-4"><a href="sect096.html#cb979-4" aria-hidden="true" tabindex="-1"></a>q025 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="fu">quantile</span>(x,<span class="at">probs =</span> <span class="fl">0.025</span>))}</span>
<span id="cb979-5"><a href="sect096.html#cb979-5" aria-hidden="true" tabindex="-1"></a>q975 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">return</span>(<span class="fu">quantile</span>(x,<span class="at">probs =</span> <span class="fl">0.975</span>))}</span>
<span id="cb979-6"><a href="sect096.html#cb979-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(valeurs<span class="sc">$</span>t)</span>
<span id="cb979-7"><a href="sect096.html#cb979-7" aria-hidden="true" tabindex="-1"></a>df_med <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Var2) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(</span>
<span id="cb979-8"><a href="sect096.html#cb979-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">med =</span> <span class="fu">median</span>(value),</span>
<span id="cb979-9"><a href="sect096.html#cb979-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">q025</span>(value),</span>
<span id="cb979-10"><a href="sect096.html#cb979-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">q975</span>(value))</span>
<span id="cb979-11"><a href="sect096.html#cb979-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout d&#39;une variable pour la couleur si significatif</span></span>
<span id="cb979-12"><a href="sect096.html#cb979-12" aria-hidden="true" tabindex="-1"></a>df_med<span class="sc">$</span>sign <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb979-13"><a href="sect096.html#cb979-13" aria-hidden="true" tabindex="-1"></a>  df_med<span class="sc">$</span>lower<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> df_med<span class="sc">$</span>upper<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;inf&quot;</span>,</span>
<span id="cb979-14"><a href="sect096.html#cb979-14" aria-hidden="true" tabindex="-1"></a>  df_med<span class="sc">$</span>lower<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> df_med<span class="sc">$</span>upper<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;sup&quot;</span>,</span>
<span id="cb979-15"><a href="sect096.html#cb979-15" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;not&quot;</span></span>
<span id="cb979-16"><a href="sect096.html#cb979-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb979-17"><a href="sect096.html#cb979-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb979-18"><a href="sect096.html#cb979-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_med) <span class="sc">+</span> </span>
<span id="cb979-19"><a href="sect096.html#cb979-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> lower, <span class="at">xmax =</span> upper, <span class="at">y =</span> <span class="fu">reorder</span>(Var2,med)), <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb979-20"><a href="sect096.html#cb979-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> med, <span class="at">y =</span> <span class="fu">reorder</span>(Var2,med), <span class="at">color =</span> sign)) <span class="sc">+</span> </span>
<span id="cb979-21"><a href="sect096.html#cb979-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;inf&quot;</span> <span class="ot">=</span> <span class="st">&quot;#0077b6&quot;</span>, <span class="st">&quot;sup&quot;</span> <span class="ot">=</span> <span class="st">&quot;#e63946&quot;</span>, <span class="st">&quot;not&quot;</span><span class="ot">=</span><span class="st">&quot;#000000&quot;</span>), </span>
<span id="cb979-22"><a href="sect096.html#cb979-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;sign. &lt; 0&quot;</span>, <span class="st">&quot;sign. &gt; 0&quot;</span>, <span class="st">&quot;non sign.&quot;</span>)) <span class="sc">+</span></span>
<span id="cb979-23"><a href="sect096.html#cb979-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Constante aléatoire&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Pays&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:randomconstantes2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/randomconstantes2-1.png" alt="Constantes aléatoires estimées par Pays (IC par bootstrap)" width="70%" />
<p class="caption">
Figure 9.19: Constantes aléatoires estimées par Pays (IC par bootstrap)
</p>
</div>
</div>
</div>
<div id="sect0962" class="section level3 hasAnchor" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> Ajustement du modèle avec constantes et pentes aléatoires<a href="sect096.html#sect0962" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans le modèle précédent, nous avons ajusté, pour chaque pays, une constante aléatoire afin de vérifier si la probabilité d’utiliser le vélo comme mode de transport principal changeait d’un pays d’Europe à l’autre. Nous souhaitons à présent tester l’hypothèse que l’effet de l’âge sur la probabilité d’utiliser le vélo varie d’un pays à l’autre. Pour cela, nous ajustons des constantes aléatoires par pays. Nous comparons trois modèles, triés ici selon leur niveau de complexité (nombre de paramètres) :</p>
<ul>
<li>le modèle avec uniquement des constantes aléatoires;</li>
<li>le modèle avec des constantes et des pentes aléatoires indépendantes;</li>
<li>le modèle avec des constantes et des pentes aléatoires corrélées.</li>
</ul>
<p>Dans le <em>package</em> <code>lme4</code>, les syntaxes pour ajuster ces trois modèles sont les suivantes :</p>
<ul>
<li>constantes aléatoires : <code>+(1|Pays)</code>;</li>
<li>constantes et pentes aléatoires indépendantes : <code>+(1 + Age||Pays)</code>;</li>
<li>constantes et pentes aléatoires corrélées : <code>+(1 + Age|Pays)</code>.</li>
</ul>
<p>Notez qu’il est aussi possible d’ajuster un modèle avec uniquement des pentes aléatoires avec la syntaxe : <code>+(-1 + Age|Pays)</code>. Le paramètre <code>-1</code> sert à retirer explicitement la constante aléatoire du modèle. Ajustons donc nos deux modèles avec pentes et constantes aléatoires.</p>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb980-1"><a href="sect096.html#cb980-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constantes et pentes aléatoires indépendantes</span></span>
<span id="cb980-2"><a href="sect096.html#cb980-2" aria-hidden="true" tabindex="-1"></a>modele2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(y <span class="sc">~</span> Sexe <span class="sc">+</span> Age2 <span class="sc">+</span> Education <span class="sc">+</span> StatutEmploi <span class="sc">+</span> Revenu <span class="sc">+</span></span>
<span id="cb980-3"><a href="sect096.html#cb980-3" aria-hidden="true" tabindex="-1"></a>              Residence <span class="sc">+</span> Duree2 <span class="sc">+</span> ConsEnv <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Age2<span class="sc">||</span>Pays),</span>
<span id="cb980-4"><a href="sect096.html#cb980-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb980-5"><a href="sect096.html#cb980-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>),</span>
<span id="cb980-6"><a href="sect096.html#cb980-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dfenquete2)</span>
<span id="cb980-7"><a href="sect096.html#cb980-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Constantes et pentes aléatoires corrélées</span></span>
<span id="cb980-8"><a href="sect096.html#cb980-8" aria-hidden="true" tabindex="-1"></a>modele3 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(y <span class="sc">~</span> Sexe <span class="sc">+</span> Age2 <span class="sc">+</span> Education <span class="sc">+</span> StatutEmploi <span class="sc">+</span> Revenu <span class="sc">+</span></span>
<span id="cb980-9"><a href="sect096.html#cb980-9" aria-hidden="true" tabindex="-1"></a>              Residence <span class="sc">+</span> Duree2 <span class="sc">+</span> ConsEnv <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Age2<span class="sc">|</span>Pays),</span>
<span id="cb980-10"><a href="sect096.html#cb980-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>),</span>
<span id="cb980-11"><a href="sect096.html#cb980-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">control =</span> <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>),</span>
<span id="cb980-12"><a href="sect096.html#cb980-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> dfenquete2)</span></code></pre></div>
<div id="sect09621" class="section level4 hasAnchor" number="9.6.2.1">
<h4><span class="header-section-number">9.6.2.1</span> Significativité de l’effet aléatoire<a href="sect096.html#sect09621" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Puisque les trois modèles sont imbriqués, la première étape est de vérifier si les ajouts successifs au modèle de base sont significatifs, ce que nous pouvons tester avec un rapport de vraisemblance.</p>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb981-1"><a href="sect096.html#cb981-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modele1,modele2,modele3)</span></code></pre></div>
<pre><code>## Data: dfenquete2
## Models:
## modele1: y ~ Sexe + Age2 + Education + StatutEmploi + Revenu + Residence + Duree2 + ConsEnv + (1 | Pays)
## modele2: y ~ Sexe + Age2 + Education + StatutEmploi + Revenu + Residence + Duree2 + ConsEnv + (1 + Age2 || Pays)
## modele3: y ~ Sexe + Age2 + Education + StatutEmploi + Revenu + Residence + Duree2 + ConsEnv + (1 + Age2 | Pays)
##         npar   AIC   BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)   
## modele1   18 19176 19323 -9570.1    19140                        
## modele2   19 19171 19325 -9566.3    19133 7.5754  1   0.005917 **
## modele3   20 19172 19335 -9566.1    19132 0.4033  1   0.525385   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Nous constatons ainsi que l’ajout des pentes aléatoires permet d’améliorer significativement le modèle, mais que l’ajout de la corrélation entre les pentes et les constantes aléatoires a un apport très marginal. Nous décidons tout de même de le garder dans un premier temps, car ce paramètre a un intérêt théorique. Affichons le résumé du modèle 3.</p>
<div class="sourceCode" id="cb983"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb983-1"><a href="sect096.html#cb983-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modele3)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [&#39;glmerMod&#39;]
##  Family: binomial  ( logit )
## Formula: y ~ Sexe + Age2 + Education + StatutEmploi + Revenu + Residence +  
##     Duree2 + ConsEnv + (1 + Age2 | Pays)
##    Data: dfenquete2
## Control: glmerControl(optimizer = &quot;bobyqa&quot;)
## 
##      AIC      BIC   logLik deviance df.resid 
##  19172.2  19335.1  -9566.1  19132.2    25527 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.2087 -0.4392 -0.3218 -0.2137  7.1677 
## 
## Random effects:
##  Groups Name        Variance Std.Dev. Corr 
##  Pays   (Intercept) 0.594981 0.77135       
##         Age2        0.007326 0.08559  -0.22
## Number of obs: 25547, groups:  Pays, 26
## 
## Fixed effects:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                   -3.35794    0.21285 -15.776  &lt; 2e-16 ***
## Sexehomme                      0.37289    0.03796   9.824  &lt; 2e-16 ***
## Age2                          -0.08775    0.02780  -3.157 0.001594 ** 
## Educationsecondaire            0.17963    0.10376   1.731 0.083420 .  
## Educationsecondaire inferieur  0.28700    0.11183   2.566 0.010274 *  
## Educationuniversite            0.13012    0.10707   1.215 0.224240    
## StatutEmploisans emploi        0.25625    0.04251   6.029 1.65e-09 ***
## Revenufaible                   0.07058    0.07179   0.983 0.325574    
## Revenumoyen                    0.03841    0.06532   0.588 0.556476    
## Revenusans reponse             0.20362    0.10262   1.984 0.047245 *  
## Revenutres eleve              -0.12420    0.18550  -0.670 0.503170    
## Revenutres faible              0.23562    0.08592   2.742 0.006103 ** 
## Residencegrande ville          0.26958    0.06935   3.887 0.000101 ***
## Residencepetite-moyenne ville  0.27570    0.06156   4.479 7.52e-06 ***
## Residencezone rurale          -0.11898    0.06916  -1.720 0.085383 .  
## Duree2                        -0.01889    0.01927  -0.980 0.327063    
## ConsEnv                        0.10189    0.00929  10.968  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>À nouveau, nous nous intéressons ici principalement à la section <code>Random Effect</code>, puisque les effets fixes s’interprètent exactement comme dans les modèles présentés dans le chapitre <a href="chap06.html#chap06">6</a>. Les constantes ont une variance de 0,595 et les pentes de 0,007. La corrélation entre les deux effets est de -0,22. Cette corrélation est négative et relativement faible, ce qui signifie que les pays dans lesquels la constante est forte tendent à avoir un coefficient plus petit pour l’âge, et donc une réduction accrue de la probabilité d’utiliser le vélo avec l’âge. Nous devons cependant encore nous assurer qu’elle est significativement différente de 0. Pour cela, nous devons calculer l’intervalle de confiance des trois paramètres de variance du modèle. Nous utilisons à nouveau une approche par <em>bootstrap</em> et nous enregistrons les résultats.</p>
<div class="sourceCode" id="cb985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb985-1"><a href="sect096.html#cb985-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fonction d&#39;extraction des trois paramètres de variance</span></span>
<span id="cb985-2"><a href="sect096.html#cb985-2" aria-hidden="true" tabindex="-1"></a>extractor3 <span class="ot">&lt;-</span> <span class="cf">function</span>(mod){</span>
<span id="cb985-3"><a href="sect096.html#cb985-3" aria-hidden="true" tabindex="-1"></a>  vari1 <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(mod)[[<span class="dv">1</span>]][[<span class="dv">1</span>]]</span>
<span id="cb985-4"><a href="sect096.html#cb985-4" aria-hidden="true" tabindex="-1"></a>  vari2 <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(mod)[[<span class="dv">1</span>]][[<span class="dv">4</span>]]</span>
<span id="cb985-5"><a href="sect096.html#cb985-5" aria-hidden="true" tabindex="-1"></a>  covari <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(mod)[[<span class="dv">1</span>]][[<span class="dv">2</span>]]</span>
<span id="cb985-6"><a href="sect096.html#cb985-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="st">&quot;vari1&quot;</span><span class="ot">=</span>vari1,<span class="st">&quot;vari2&quot;</span><span class="ot">=</span>vari2,<span class="st">&quot;covari&quot;</span><span class="ot">=</span>covari))</span>
<span id="cb985-7"><a href="sect096.html#cb985-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb985-8"><a href="sect096.html#cb985-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lancement du bootstrap</span></span>
<span id="cb985-9"><a href="sect096.html#cb985-9" aria-hidden="true" tabindex="-1"></a>valeurs <span class="ot">&lt;-</span> <span class="fu">bootMer</span>(modele3,<span class="at">FUN =</span> extractor3,<span class="at">nsim =</span> <span class="dv">1000</span>,</span>
<span id="cb985-10"><a href="sect096.html#cb985-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">use.u =</span> F, <span class="at">type=</span><span class="st">&quot;parametric&quot;</span>, <span class="at">ncpus =</span> <span class="dv">8</span>,</span>
<span id="cb985-11"><a href="sect096.html#cb985-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">parallel=</span><span class="st">&quot;snow&quot;</span>,</span>
<span id="cb985-12"><a href="sect096.html#cb985-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cl =</span> cl,</span>
<span id="cb985-13"><a href="sect096.html#cb985-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">.progress=</span><span class="st">&quot;txt&quot;</span>,<span class="at">PBarg=</span><span class="fu">list</span>(<span class="at">style=</span><span class="dv">3</span>))</span>
<span id="cb985-14"><a href="sect096.html#cb985-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Enregistrement des résultats</span></span>
<span id="cb985-15"><a href="sect096.html#cb985-15" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(valeurs,<span class="at">file =</span> <span class="st">&#39;data/glmm/boot_binom3.rda&#39;</span>)</span></code></pre></div>
<p>À partir des valeurs <em>bootstrapées</em>, nous pouvons représenter les distributions de ces trois paramètres (variance des constantes, variance des pentes et corrélation entre les deux).</p>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="sect096.html#cb986-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement des résultats</span></span>
<span id="cb986-2"><a href="sect096.html#cb986-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;data/glmm/boot_binom3.rda&#39;</span>)</span>
<span id="cb986-3"><a href="sect096.html#cb986-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion des valeurs de covariance en corrélation</span></span>
<span id="cb986-4"><a href="sect096.html#cb986-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb986-5"><a href="sect096.html#cb986-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">corr_values =</span> valeurs<span class="sc">$</span>t[,<span class="dv">3</span>] <span class="sc">/</span> (<span class="fu">sqrt</span>(valeurs<span class="sc">$</span>t[,<span class="dv">1</span>]) <span class="sc">*</span> <span class="fu">sqrt</span>(valeurs<span class="sc">$</span>t[,<span class="dv">2</span>])),</span>
<span id="cb986-6"><a href="sect096.html#cb986-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">vari_const =</span> valeurs<span class="sc">$</span>t[,<span class="dv">1</span>],</span>
<span id="cb986-7"><a href="sect096.html#cb986-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">vari_pente =</span> valeurs<span class="sc">$</span>t[,<span class="dv">2</span>]</span>
<span id="cb986-8"><a href="sect096.html#cb986-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb986-9"><a href="sect096.html#cb986-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogramme pour la variance des constantes</span></span>
<span id="cb986-10"><a href="sect096.html#cb986-10" aria-hidden="true" tabindex="-1"></a>breaks1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>vari_const,<span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.5</span>,<span class="fl">0.975</span>,<span class="fl">0.999</span>))</span>
<span id="cb986-11"><a href="sect096.html#cb986-11" aria-hidden="true" tabindex="-1"></a>label1 <span class="ot">&lt;-</span> <span class="fu">round</span>(breaks1,<span class="dv">3</span>)</span>
<span id="cb986-12"><a href="sect096.html#cb986-12" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb986-13"><a href="sect096.html#cb986-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> vari_const), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb986-14"><a href="sect096.html#cb986-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(df<span class="sc">$</span>vari_const), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-15"><a href="sect096.html#cb986-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(df<span class="sc">$</span>vari_const, <span class="at">probs =</span> <span class="fl">0.025</span>), </span>
<span id="cb986-16"><a href="sect096.html#cb986-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-17"><a href="sect096.html#cb986-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(df<span class="sc">$</span>vari_const, <span class="at">probs =</span> <span class="fl">0.975</span>), </span>
<span id="cb986-18"><a href="sect096.html#cb986-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-19"><a href="sect096.html#cb986-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Variance des constantes&quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>)<span class="sc">+</span> </span>
<span id="cb986-20"><a href="sect096.html#cb986-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks1, <span class="at">labels =</span> label1)</span>
<span id="cb986-21"><a href="sect096.html#cb986-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogramme pour la variance des pentes</span></span>
<span id="cb986-22"><a href="sect096.html#cb986-22" aria-hidden="true" tabindex="-1"></a>breaks2 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df<span class="sc">$</span>vari_pente,<span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.5</span>,<span class="fl">0.975</span>,<span class="fl">0.999</span>))</span>
<span id="cb986-23"><a href="sect096.html#cb986-23" aria-hidden="true" tabindex="-1"></a>label2 <span class="ot">&lt;-</span> <span class="fu">round</span>(breaks2,<span class="dv">3</span>)</span>
<span id="cb986-24"><a href="sect096.html#cb986-24" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb986-25"><a href="sect096.html#cb986-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> vari_pente), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb986-26"><a href="sect096.html#cb986-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(df<span class="sc">$</span>vari_pente), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-27"><a href="sect096.html#cb986-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(df<span class="sc">$</span>vari_pente, <span class="at">probs =</span> <span class="fl">0.025</span>), </span>
<span id="cb986-28"><a href="sect096.html#cb986-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-29"><a href="sect096.html#cb986-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(df<span class="sc">$</span>vari_pente, <span class="at">probs =</span> <span class="fl">0.975</span>), </span>
<span id="cb986-30"><a href="sect096.html#cb986-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-31"><a href="sect096.html#cb986-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Variance des pentes&quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb986-32"><a href="sect096.html#cb986-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks2, <span class="at">labels =</span> label2)</span>
<span id="cb986-33"><a href="sect096.html#cb986-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogramme pour la corrélation</span></span>
<span id="cb986-34"><a href="sect096.html#cb986-34" aria-hidden="true" tabindex="-1"></a>breaks3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fu">median</span>(df<span class="sc">$</span>corr_values))</span>
<span id="cb986-35"><a href="sect096.html#cb986-35" aria-hidden="true" tabindex="-1"></a>label3 <span class="ot">&lt;-</span> <span class="fu">round</span>(breaks3,<span class="dv">3</span>)</span>
<span id="cb986-36"><a href="sect096.html#cb986-36" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb986-37"><a href="sect096.html#cb986-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> corr_values), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb986-38"><a href="sect096.html#cb986-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(df<span class="sc">$</span>corr_values), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-39"><a href="sect096.html#cb986-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(df<span class="sc">$</span>corr_values, <span class="at">probs =</span> <span class="fl">0.025</span>), </span>
<span id="cb986-40"><a href="sect096.html#cb986-40" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-41"><a href="sect096.html#cb986-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(df<span class="sc">$</span>corr_values, <span class="at">probs =</span> <span class="fl">0.975</span>), </span>
<span id="cb986-42"><a href="sect096.html#cb986-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-43"><a href="sect096.html#cb986-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Corrélation pentes/constantes&quot;</span>, <span class="at">y=</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span> </span>
<span id="cb986-44"><a href="sect096.html#cb986-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> breaks3, <span class="at">labels =</span> label3)</span>
<span id="cb986-45"><a href="sect096.html#cb986-45" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1,p2, p3, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:glmmvarboot"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/glmmvarboot-1.png" alt="Incertitude autour des paramètres de variance obtenue par bootstrap" width="95%" />
<p class="caption">
Figure 9.20: Incertitude autour des paramètres de variance obtenue par bootstrap
</p>
</div>
<p>Nous constatons ainsi, à la figure <a href="sect096.html#fig:glmmvarboot">9.20</a>, que la variance des constantes aléatoires est significativement différente de zéro (cette valeur n’est pas dans l’intervalle de confiance à 95 % représenté par les lignes verticales bleues) et une médiane de 0,56 (ligne verticale rouge). Pour les pentes, zéro est également à la limite de l’intervalle de confiance, et la distribution asymétrique et étalée nous indique que ce paramètre est fortement incertain dans le modèle. Enfin, la corrélation entre les pentes et les constantes est de loin le paramètre le plus incertain et son intervalle de confiance est franchement à cheval sur zéro, ce qui devrait nous amener à privilégier un modèle sans ce paramètre.</p>
<p>Pour terminer, nous pouvons calculer les R<sup>2</sup> marginal et conditionnel du modèle afin de mieux cerner le rôle joué par les effets fixes et les effets aléatoires.</p>
<div class="sourceCode" id="cb987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb987-1"><a href="sect096.html#cb987-1" aria-hidden="true" tabindex="-1"></a><span class="fu">r.squaredGLMM</span>(modele3)</span></code></pre></div>
<pre><code>##                    R2m        R2c
## theoretical 0.03413720 0.18360270
## delta       0.01419943 0.07636989</code></pre>
<p>Les valeurs des R<sup>2</sup> marginal et conditionnel du modèle sont similaires à celles que nous avons obtenus avec seulement des constantes aléatoires dans la section précédente, signalant l’apport relativement faible des pentes aléatoires.</p>
</div>
<div id="sect09622" class="section level4 hasAnchor" number="9.6.2.2">
<h4><span class="header-section-number">9.6.2.2</span> Analyse des effets aléatoires<a href="sect096.html#sect09622" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour analyser facilement les constantes et les pentes aléatoires de chaque pays, nous pouvons représenter graphiquement leurs intervalles de confiance construits à partir des simulations tirées de la distribution a posteriori du modèle.</p>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb989-1"><a href="sect096.html#cb989-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulations et extraction des effets aléatoires</span></span>
<span id="cb989-2"><a href="sect096.html#cb989-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(merTools)</span>
<span id="cb989-3"><a href="sect096.html#cb989-3" aria-hidden="true" tabindex="-1"></a>simsRE <span class="ot">&lt;-</span> <span class="fu">REsim</span>(modele3,<span class="at">n.sims =</span> <span class="dv">1000</span>, <span class="at">oddsRatio =</span> F)</span>
<span id="cb989-4"><a href="sect096.html#cb989-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul des intervalles de confiance</span></span>
<span id="cb989-5"><a href="sect096.html#cb989-5" aria-hidden="true" tabindex="-1"></a>simsRE<span class="sc">$</span>lower <span class="ot">&lt;-</span> simsRE<span class="sc">$</span>mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> simsRE<span class="sc">$</span>sd</span>
<span id="cb989-6"><a href="sect096.html#cb989-6" aria-hidden="true" tabindex="-1"></a>simsRE<span class="sc">$</span>upper <span class="ot">&lt;-</span> simsRE<span class="sc">$</span>mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> simsRE<span class="sc">$</span>sd</span>
<span id="cb989-7"><a href="sect096.html#cb989-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable binaire pour la significativité</span></span>
<span id="cb989-8"><a href="sect096.html#cb989-8" aria-hidden="true" tabindex="-1"></a>simsRE<span class="sc">$</span>sign <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb989-9"><a href="sect096.html#cb989-9" aria-hidden="true" tabindex="-1"></a>  simsRE<span class="sc">$</span>lower<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> simsRE<span class="sc">$</span>upper<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;inf&quot;</span>,</span>
<span id="cb989-10"><a href="sect096.html#cb989-10" aria-hidden="true" tabindex="-1"></a>  simsRE<span class="sc">$</span>lower<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> simsRE<span class="sc">$</span>upper<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">~</span> <span class="st">&quot;sup&quot;</span>,</span>
<span id="cb989-11"><a href="sect096.html#cb989-11" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;not&quot;</span></span>
<span id="cb989-12"><a href="sect096.html#cb989-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb989-13"><a href="sect096.html#cb989-13" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(simsRE, <span class="fu">grepl</span>(<span class="st">&quot;Intercept&quot;</span>,simsRE<span class="sc">$</span>term,<span class="at">fixed =</span> T))</span>
<span id="cb989-14"><a href="sect096.html#cb989-14" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(simsRE, <span class="fu">grepl</span>(<span class="st">&quot;Age2&quot;</span>,simsRE<span class="sc">$</span>term,<span class="at">fixed =</span> T))</span>
<span id="cb989-15"><a href="sect096.html#cb989-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Représentation des intervalles de confiance</span></span>
<span id="cb989-16"><a href="sect096.html#cb989-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df1) <span class="sc">+</span> </span>
<span id="cb989-17"><a href="sect096.html#cb989-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> lower, <span class="at">xmax =</span> upper,</span>
<span id="cb989-18"><a href="sect096.html#cb989-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">reorder</span>(groupID,mean)), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">height =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb989-19"><a href="sect096.html#cb989-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean, <span class="at">y =</span> <span class="fu">reorder</span>(groupID,mean),</span>
<span id="cb989-20"><a href="sect096.html#cb989-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> sign)) <span class="sc">+</span> </span>
<span id="cb989-21"><a href="sect096.html#cb989-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;inf&quot;</span> <span class="ot">=</span> <span class="st">&quot;#0077b6&quot;</span>, <span class="st">&quot;sup&quot;</span> <span class="ot">=</span> <span class="st">&quot;#e63946&quot;</span>, <span class="st">&quot;not&quot;</span><span class="ot">=</span><span class="st">&quot;#000000&quot;</span>), </span>
<span id="cb989-22"><a href="sect096.html#cb989-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;sign. &lt; 0&quot;</span>, <span class="st">&quot;non sign.&quot;</span>, <span class="st">&quot;sign. &gt; 0&quot;</span>)) <span class="sc">+</span></span>
<span id="cb989-23"><a href="sect096.html#cb989-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Constante aléatoire&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Pays&quot;</span>)</span>
<span id="cb989-24"><a href="sect096.html#cb989-24" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df2) <span class="sc">+</span> </span>
<span id="cb989-25"><a href="sect096.html#cb989-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> lower, <span class="at">xmax =</span> upper,</span>
<span id="cb989-26"><a href="sect096.html#cb989-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> <span class="fu">reorder</span>(groupID,mean)), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">height =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb989-27"><a href="sect096.html#cb989-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean, <span class="at">y =</span> <span class="fu">reorder</span>(groupID,mean),</span>
<span id="cb989-28"><a href="sect096.html#cb989-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> sign)) <span class="sc">+</span> </span>
<span id="cb989-29"><a href="sect096.html#cb989-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;inf&quot;</span> <span class="ot">=</span> <span class="st">&quot;#0077b6&quot;</span>, <span class="st">&quot;sup&quot;</span> <span class="ot">=</span> <span class="st">&quot;#e63946&quot;</span>, <span class="st">&quot;not&quot;</span><span class="ot">=</span><span class="st">&quot;#000000&quot;</span>), </span>
<span id="cb989-30"><a href="sect096.html#cb989-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;sign. &lt; 0&quot;</span>, <span class="st">&quot;non sign.&quot;</span>, <span class="st">&quot;sign. &gt; 0&quot;</span>)) <span class="sc">+</span></span>
<span id="cb989-31"><a href="sect096.html#cb989-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Pente aléatoire (âge)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Pays&quot;</span>)</span>
<span id="cb989-32"><a href="sect096.html#cb989-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1,p2, <span class="at">common.legend =</span> T, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:randomconstantes2b"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/randomconstantes2b-1.png" alt="Constantes aléatoires estimées par pays (intervalles de confiance obtenus par simulations)" width="70%" />
<p class="caption">
Figure 9.21: Constantes aléatoires estimées par pays (intervalles de confiance obtenus par simulations)
</p>
</div>
<p>La figure <a href="sect096.html#fig:randomconstantes2b">9.21</a> nous permet ainsi de constater que l’effet des pays sur les pentes est presque toujours non significatif, sauf pour le Danemark. Son effet négatif (-0,136) indique un renforcement de l’effet général, lui-même négatif (-0,088). Une interprétation possible est qu’au Danemark, l’utilisation du vélo est proportionnellement plus courante par les jeunes que dans le reste des pays de l’Europe.</p>
<p>Pour l’interprétation finale, il est nécessaire d’afficher les valeurs exactes de ces différents paramètres et, dans notre cas, de les convertir en rapports de cotes avec la fonction exponentielle. Pour les pentes aléatoires, il peut être plus facile d’interpréter la somme de l’effet fixe et de l’effet aléatoire.</p>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb990-1"><a href="sect096.html#cb990-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraction des effets aléatoires obtenus par simulation</span></span>
<span id="cb990-2"><a href="sect096.html#cb990-2" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> simsRE[<span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;lower&quot;</span>,<span class="st">&quot;upper&quot;</span>)]</span>
<span id="cb990-3"><a href="sect096.html#cb990-3" aria-hidden="true" tabindex="-1"></a>mat<span class="sc">$</span>Pays <span class="ot">&lt;-</span> simsRE<span class="sc">$</span>groupID</span>
<span id="cb990-4"><a href="sect096.html#cb990-4" aria-hidden="true" tabindex="-1"></a>mat<span class="sc">$</span>effet <span class="ot">&lt;-</span> simsRE<span class="sc">$</span>term</span>
<span id="cb990-5"><a href="sect096.html#cb990-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Séparation des pentes et des constantes</span></span>
<span id="cb990-6"><a href="sect096.html#cb990-6" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(mat, <span class="fu">grepl</span>(<span class="st">&quot;Intercept&quot;</span>,mat<span class="sc">$</span>effet, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb990-7"><a href="sect096.html#cb990-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(mat, <span class="fu">grepl</span>(<span class="st">&quot;Age2&quot;</span>,mat<span class="sc">$</span>effet, <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb990-8"><a href="sect096.html#cb990-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion en rapports de cotes pour les pentes (+ effet fixe)</span></span>
<span id="cb990-9"><a href="sect096.html#cb990-9" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>RC <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(df2<span class="sc">$</span>mean <span class="sc">+</span> <span class="fu">fixef</span>(modele3)[[<span class="dv">3</span>]]),<span class="dv">3</span>)</span>
<span id="cb990-10"><a href="sect096.html#cb990-10" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>RC025 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(df2<span class="sc">$</span>lower <span class="sc">+</span> <span class="fu">fixef</span>(modele3)[[<span class="dv">3</span>]]),<span class="dv">3</span>)</span>
<span id="cb990-11"><a href="sect096.html#cb990-11" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>RC975 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(df2<span class="sc">$</span>upper <span class="sc">+</span> <span class="fu">fixef</span>(modele3)[[<span class="dv">3</span>]]),<span class="dv">3</span>)</span>
<span id="cb990-12"><a href="sect096.html#cb990-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(df2[<span class="fu">c</span>(<span class="st">&quot;Pays&quot;</span>,<span class="st">&quot;RC&quot;</span>,<span class="st">&quot;RC025&quot;</span>,<span class="st">&quot;RC975&quot;</span>)],<span class="dv">10</span>))</span></code></pre></div>
<pre><code>##         Pays    RC RC025 RC975
## 27 Allemagne 0.835 0.744 0.937
## 28  Autriche 0.986 0.875 1.112
## 29  Belgique 0.895 0.797 1.005
## 30  Bulgarie 0.946 0.824 1.086
## 31   Croatie 0.905 0.802 1.020
## 32  Danemark 0.799 0.720 0.886
## 33   Espagne 0.920 0.796 1.063
## 34   Estonie 0.950 0.835 1.080
## 35  Finlande 0.865 0.774 0.967
## 36    France 0.897 0.783 1.029</code></pre>
<p>Nous constatons ainsi qu’au Danemark, les chances pour un individu d’utiliser le vélo sont réduites de 20 % à chaque augmentation de l’âge d’un écart-type, contre seulement 1,5 % en Autriche (non significatif pour ce dernier). Notons ici que l’écart-type de la variable <code>Age</code> est de 11 ans. Nous pouvons à présent analyser les constantes.</p>
<div class="sourceCode" id="cb992"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb992-1"><a href="sect096.html#cb992-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion en rapports de cotes pour les constantes</span></span>
<span id="cb992-2"><a href="sect096.html#cb992-2" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>RC <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(df1<span class="sc">$</span>mean),<span class="dv">3</span>)</span>
<span id="cb992-3"><a href="sect096.html#cb992-3" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>RC025 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(df1<span class="sc">$</span>lower),<span class="dv">3</span>)</span>
<span id="cb992-4"><a href="sect096.html#cb992-4" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>RC975 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">exp</span>(df1<span class="sc">$</span>upper),<span class="dv">3</span>)</span>
<span id="cb992-5"><a href="sect096.html#cb992-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(df1[<span class="fu">c</span>(<span class="st">&quot;Pays&quot;</span>,<span class="st">&quot;RC&quot;</span>,<span class="st">&quot;RC025&quot;</span>,<span class="st">&quot;RC975&quot;</span>)],<span class="dv">10</span>))</span></code></pre></div>
<pre><code>##         Pays    RC RC025 RC975
## 1  Allemagne 1.691 1.207 2.369
## 2   Autriche 1.312 0.925 1.860
## 3   Belgique 1.435 1.015 2.029
## 4   Bulgarie 0.547 0.375 0.799
## 5    Croatie 1.885 1.350 2.630
## 6   Danemark 4.087 2.937 5.686
## 7    Espagne 0.291 0.192 0.440
## 8    Estonie 1.131 0.798 1.602
## 9   Finlande 2.243 1.609 3.125
## 10    France 0.527 0.359 0.774</code></pre>
<p>En revanche, les chances pour un individu d’utiliser le vélo comme mode de transport pour son trajet le plus fréquent sont 4 fois supérieures à la moyenne européenne, contre seulement 1,3 fois en Autriche. Notez à nouveau que les intervalles de confiance pour ces pentes et ces constantes pourraient être estimés plus fiablement par <em>bootstrap</em>.</p>
</div>
<div id="sect09623" class="section level4 hasAnchor" number="9.6.2.3">
<h4><span class="header-section-number">9.6.2.3</span> Diagnostic des effets aléatoires<a href="sect096.html#sect09623" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour rappel, dans un modèle GLMM, les effets aléatoires sont modélisés comme provenant de distributions normales. Nous devons donc vérifier qu’ils respectent cette condition d’application. La figure <a href="sect096.html#fig:diagbinomglmm1">9.22</a> (graphique quantile-quantile) nous permet de constater que les constantes suivent bien une distribution normale, ce qui ne semble pas vraiment être le cas pour les pentes. Considérant que leurs effets sont petits, il serait plus pertinent ici de les retirer du modèle.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diagbinomglmm1"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/diagbinomglmm1-1.png" alt="Distribution normale univariée des constantes et des pentes aléatoires" width="90%" />
<p class="caption">
Figure 9.22: Distribution normale univariée des constantes et des pentes aléatoires
</p>
</div>
<p>Considérant que ce modèle inclut une corrélation entre les constantes et les pentes aléatoires, il est également nécessaire de vérifier si elles suivent conjointement une distribution normale bivariée. La figure <a href="sect096.html#fig:diagbinomglmm2">9.23</a> semble indiquer que c’est le cas.</p>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb994-1"><a href="sect096.html#cb994-1" aria-hidden="true" tabindex="-1"></a>cor_mat <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(modele3)[[<span class="dv">1</span>]]</span>
<span id="cb994-2"><a href="sect096.html#cb994-2" aria-hidden="true" tabindex="-1"></a>re_effects <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">ranef</span>(modele3)<span class="sc">$</span>Pays)</span>
<span id="cb994-3"><a href="sect096.html#cb994-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(re_effects) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;constante&quot;</span>,<span class="st">&quot;pente&quot;</span>)</span>
<span id="cb994-4"><a href="sect096.html#cb994-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)</span>
<span id="cb994-5"><a href="sect096.html#cb994-5" aria-hidden="true" tabindex="-1"></a>levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.25</span>,<span class="fl">0.75</span>,<span class="fl">0.95</span>)</span>
<span id="cb994-6"><a href="sect096.html#cb994-6" aria-hidden="true" tabindex="-1"></a>els <span class="ot">&lt;-</span> <span class="fu">lapply</span>(levels, <span class="cf">function</span>(i){</span>
<span id="cb994-7"><a href="sect096.html#cb994-7" aria-hidden="true" tabindex="-1"></a>  el <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">ellipse</span>(cor_mat,<span class="at">center =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">level =</span> i))</span>
<span id="cb994-8"><a href="sect096.html#cb994-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(el) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>)</span>
<span id="cb994-9"><a href="sect096.html#cb994-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(el)</span>
<span id="cb994-10"><a href="sect096.html#cb994-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb994-11"><a href="sect096.html#cb994-11" aria-hidden="true" tabindex="-1"></a>ref_points <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">data.frame</span>(MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">Sigma =</span> cor_mat)))</span>
<span id="cb994-12"><a href="sect096.html#cb994-12" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ref_points) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>)</span>
<span id="cb994-13"><a href="sect096.html#cb994-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb994-14"><a href="sect096.html#cb994-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), <span class="at">data =</span> ref_points, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb994-15"><a href="sect096.html#cb994-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> els[[<span class="dv">1</span>]], <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">&quot;a&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb994-16"><a href="sect096.html#cb994-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> els[[<span class="dv">2</span>]], <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">&quot;b&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb994-17"><a href="sect096.html#cb994-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> els[[<span class="dv">3</span>]], <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">&quot;c&quot;</span>)) <span class="sc">+</span></span>
<span id="cb994-18"><a href="sect096.html#cb994-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="at">data =</span> els[[<span class="dv">4</span>]], <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> <span class="st">&quot;d&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb994-19"><a href="sect096.html#cb994-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> re_effects, <span class="fu">aes</span>(<span class="at">x =</span> constante, <span class="at">y =</span> pente))<span class="sc">+</span></span>
<span id="cb994-20"><a href="sect096.html#cb994-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span><span class="ot">=</span><span class="st">&quot;#90e0ef&quot;</span>,</span>
<span id="cb994-21"><a href="sect096.html#cb994-21" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;b&quot;</span><span class="ot">=</span><span class="st">&quot;#00b4d8&quot;</span>,</span>
<span id="cb994-22"><a href="sect096.html#cb994-22" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;c&quot;</span><span class="ot">=</span><span class="st">&quot;#0077b6&quot;</span>,</span>
<span id="cb994-23"><a href="sect096.html#cb994-23" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;d&quot;</span><span class="ot">=</span><span class="st">&quot;#03045e&quot;</span>),</span>
<span id="cb994-24"><a href="sect096.html#cb994-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;5 %&quot;</span>,<span class="st">&quot;25 %&quot;</span>,<span class="st">&quot;75 %&quot;</span>,<span class="st">&quot;95 %&quot;</span>))<span class="sc">+</span></span>
<span id="cb994-25"><a href="sect096.html#cb994-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Constantes&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Pentes&quot;</span>, <span class="at">color =</span> <span class="st">&quot;quantiles&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:diagbinomglmm2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/diagbinomglmm2-1.png" alt="Distribution normale bivariée des constantes et des pentes aléatoires" width="70%" />
<p class="caption">
Figure 9.23: Distribution normale bivariée des constantes et des pentes aléatoires
</p>
</div>
</div>
<div id="sect09624" class="section level4 hasAnchor" number="9.6.2.4">
<h4><span class="header-section-number">9.6.2.4</span> Inférence pour les effets fixes<a href="sect096.html#sect09624" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous avons mentionné, dans les sections précédentes, que le calcul de valeurs de <em>p</em> pour les effets fixes fait l’objet de controverses pour les modèles GLMM. La méthode offrant le meilleur compromis entre rapidité de calcul et fiabilité est la méthode Satterthwaite implémentée dans le <em>package</em> <code>lmerTest</code>. Pour l’utiliser, il suffit de charger le <em>package</em> <code>lmerTest</code> après <code>lme4</code>, ce qui modifie la fonction <code>summary</code> pour qu’elle utilise directement cette approche.</p>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb995-1"><a href="sect096.html#cb995-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb995-2"><a href="sect096.html#cb995-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">summary</span>(modele3)<span class="sc">$</span>coefficients,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##                               Estimate Std. Error z value Pr(&gt;|z|)
## (Intercept)                     -3.358      0.213 -15.776    0.000
## Sexehomme                        0.373      0.038   9.824    0.000
## Age2                            -0.088      0.028  -3.157    0.002
## Educationsecondaire              0.180      0.104   1.731    0.083
## Educationsecondaire inferieur    0.287      0.112   2.566    0.010
## Educationuniversite              0.130      0.107   1.215    0.224
## StatutEmploisans emploi          0.256      0.043   6.029    0.000
## Revenufaible                     0.071      0.072   0.983    0.326
## Revenumoyen                      0.038      0.065   0.588    0.556
## Revenusans reponse               0.204      0.103   1.984    0.047
## Revenutres eleve                -0.124      0.186  -0.670    0.503
## Revenutres faible                0.236      0.086   2.742    0.006
## Residencegrande ville            0.270      0.069   3.887    0.000
## Residencepetite-moyenne ville    0.276      0.062   4.479    0.000
## Residencezone rurale            -0.119      0.069  -1.720    0.085
## Duree2                          -0.019      0.019  -0.980    0.327
## ConsEnv                          0.102      0.009  10.968    0.000</code></pre>
<p>Les deux autres options envisageables sont : effectuer une analyse de type 3 ou calculer les intervalles de confiance par <em>bootstrap</em>. Cependant, elles requièrent beaucoup plus de temps de calcul. Par conséquent, elles ne sont pas présentées ici.</p>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<h3>R&eacute;f&eacute;rences</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bolker2009generalized" class="csl-entry">
Bolker, Benjamin M, Mollie E Brooks, Connie J Clark, Shane W Geange, John R Poulsen, M Henry H Stevens et Jada-Simone S White. 2009. <span>« Generalized linear mixed models: a practical guide for ecology and evolution. »</span> <em>Trends in ecology &amp; evolution</em> 24 (3): 127‑135. <a href="https://doi.org/10.1016/j.tree.2008.10.008">https://doi.org/10.1016/j.tree.2008.10.008</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect095.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect097.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MethodesQuantitScSocialesBolR.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
