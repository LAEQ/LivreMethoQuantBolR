<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13.4 Nuées dynamiques | Méthodes quantitatives en sciences sociales : un grand bol d’R</title>
  <meta name="description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="13.4 Nuées dynamiques | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="github-repo" content="LAEQ/livre_statistique_Phil_Jere" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13.4 Nuées dynamiques | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  
  <meta name="twitter:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="twitter:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio et Jérémy Gelb" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect133.html"/>
<link rel="next" href="sect135.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d'R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Un manuel conçu comme un projet collaboratif</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment lire ce livre?</a></li>
<li class="chapter" data-level="" data-path="sect003B.html"><a href="sect003B.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en sciences sociales?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="sect007.html"><a href="sect007.html"><i class="fa fa-check"></i>Dédicace toute spéciale à Cargo et Ambrée</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auteurs.html"><a href="auteurs.html"><i class="fa fa-check"></i>À propos des auteurs</a></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Prise en main de R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Histoire et philosophie de R</a></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Environnement de travail</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Installation de R</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Environnement RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect0123"><i class="fa fa-check"></i><b>1.2.3</b> Installation et chargement un <em>package</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#aide-disponible"><i class="fa fa-check"></i><b>1.2.4</b> Aide disponible</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Bases du langage R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> <em>Hello World</em>!</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Objets et expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="sect013.html"><a href="sect013.html#sect0_133"><i class="fa fa-check"></i><b>1.3.3</b> Fonctions et arguments</a></li>
<li class="chapter" data-level="1.3.4" data-path="sect013.html"><a href="sect013.html#sect0134"><i class="fa fa-check"></i><b>1.3.4</b> Principaux types de données</a></li>
<li class="chapter" data-level="1.3.5" data-path="sect013.html"><a href="sect013.html#sect0135"><i class="fa fa-check"></i><b>1.3.5</b> Opérateurs</a></li>
<li class="chapter" data-level="1.3.6" data-path="sect013.html"><a href="sect013.html#sect0136"><i class="fa fa-check"></i><b>1.3.6</b> Structures de données</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Manipulation de données</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Manipulation d’un <em>DataFrame</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.5</b> Code R bien structuré</a></li>
<li class="chapter" data-level="1.6" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.6</b> Enregistrement des résultats</a></li>
<li class="chapter" data-level="1.7" data-path="sect018.html"><a href="sect018.html"><i class="fa fa-check"></i><b>1.7</b> Session de travail</a></li>
<li class="chapter" data-level="1.8" data-path="sect019.html"><a href="sect019.html"><i class="fa fa-check"></i><b>1.8</b> Conclusion et ressources pertinentes</a></li>
<li class="chapter" data-level="1.9" data-path="sect0110.html"><a href="sect0110.html"><i class="fa fa-check"></i><b>1.9</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>II Analyses univariées et graphiques dans R</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Statistiques descriptives univariées</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion et types de variable</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="sect021.html"><a href="sect021.html#sect0211"><i class="fa fa-check"></i><b>2.1.1</b> Notion de variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="sect021.html"><a href="sect021.html#sect0212"><i class="fa fa-check"></i><b>2.1.2</b> Types de variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Types de données</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Données secondaires <em>versus</em> données primaires</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Données transversales <em>versus</em> données longitudinales</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Données spatiales versus données aspatiales</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Données individuelles <em>versus</em> données agrégées</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Statistique descriptive et statistique inférentielle</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Population, échantillon et inférence</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Deux grandes familles de méthodes statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Notion de distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#définition-générale"><i class="fa fa-check"></i><b>2.4.1</b> Définition générale</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#anatomie-dune-distribution"><i class="fa fa-check"></i><b>2.4.2</b> Anatomie d’une distribution</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#principales-distributions"><i class="fa fa-check"></i><b>2.4.3</b> Principales distributions</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#conclusion-sur-les-distributions"><i class="fa fa-check"></i><b>2.4.4</b> Conclusion sur les distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Statistiques descriptives sur des variables quantitatives</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="sect025.html"><a href="sect025.html#sect0251"><i class="fa fa-check"></i><b>2.5.1</b> Paramètres de tendance centrale</a></li>
<li class="chapter" data-level="2.5.2" data-path="sect025.html"><a href="sect025.html#sect0252"><i class="fa fa-check"></i><b>2.5.2</b> Paramètres de position</a></li>
<li class="chapter" data-level="2.5.3" data-path="sect025.html"><a href="sect025.html#sect0253"><i class="fa fa-check"></i><b>2.5.3</b> Paramètres de dispersion</a></li>
<li class="chapter" data-level="2.5.4" data-path="sect025.html"><a href="sect025.html#sect0254"><i class="fa fa-check"></i><b>2.5.4</b> Paramètres de forme</a></li>
<li class="chapter" data-level="2.5.5" data-path="sect025.html"><a href="sect025.html#sect0255"><i class="fa fa-check"></i><b>2.5.5</b> Transformation des variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="sect025.html"><a href="sect025.html#sect0256"><i class="fa fa-check"></i><b>2.5.6</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="sect026.html"><a href="sect026.html#sect0261"><i class="fa fa-check"></i><b>2.6.1</b> Fréquences</a></li>
<li class="chapter" data-level="2.6.2" data-path="sect026.html"><a href="sect026.html#sect0262"><i class="fa fa-check"></i><b>2.6.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sect027.html"><a href="sect027.html"><i class="fa fa-check"></i><b>2.7</b> Statistiques descriptives pondérées : pour aller plus loin</a></li>
<li class="chapter" data-level="2.8" data-path="sect028.html"><a href="sect028.html"><i class="fa fa-check"></i><b>2.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Magie des graphiques</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Philosophie du ggplot2</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="sect031.html"><a href="sect031.html#sect0311"><i class="fa fa-check"></i><b>3.1.1</b> Grammaire</a></li>
<li class="chapter" data-level="3.1.2" data-path="sect031.html"><a href="sect031.html#sect0312"><i class="fa fa-check"></i><b>3.1.2</b> Types de géométries</a></li>
<li class="chapter" data-level="3.1.3" data-path="sect031.html"><a href="sect031.html#sect0313"><i class="fa fa-check"></i><b>3.1.3</b> Habillage</a></li>
<li class="chapter" data-level="3.1.4" data-path="sect031.html"><a href="sect031.html#utilisation-des-thèmes"><i class="fa fa-check"></i><b>3.1.4</b> Utilisation des thèmes</a></li>
<li class="chapter" data-level="3.1.5" data-path="sect031.html"><a href="sect031.html#sect0314"><i class="fa fa-check"></i><b>3.1.5</b> Composition d’une figure avec plusieurs graphiques</a></li>
<li class="chapter" data-level="3.1.6" data-path="sect031.html"><a href="sect031.html#sect0315"><i class="fa fa-check"></i><b>3.1.6</b> Couleur</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Principaux graphiques</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0321"><i class="fa fa-check"></i><b>3.2.1</b> Histogramme</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0322"><i class="fa fa-check"></i><b>3.2.2</b> Graphique de densité</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0323"><i class="fa fa-check"></i><b>3.2.3</b> Nuage de points</a></li>
<li class="chapter" data-level="3.2.4" data-path="sect032.html"><a href="sect032.html#sect0324"><i class="fa fa-check"></i><b>3.2.4</b> Graphique en ligne</a></li>
<li class="chapter" data-level="3.2.5" data-path="sect032.html"><a href="sect032.html#sect0325"><i class="fa fa-check"></i><b>3.2.5</b> Boîte à moustaches</a></li>
<li class="chapter" data-level="3.2.6" data-path="sect032.html"><a href="sect032.html#sect0326"><i class="fa fa-check"></i><b>3.2.6</b> Graphique en violon</a></li>
<li class="chapter" data-level="3.2.7" data-path="sect032.html"><a href="sect032.html#sect0327"><i class="fa fa-check"></i><b>3.2.7</b> Graphique en barre</a></li>
<li class="chapter" data-level="3.2.8" data-path="sect032.html"><a href="sect032.html#sect0328"><i class="fa fa-check"></i><b>3.2.8</b> Graphique circulaire</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Graphiques spéciaux</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Graphique en radar</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Diagramme d’accord</a></li>
<li class="chapter" data-level="3.3.3" data-path="sect033.html"><a href="sect033.html#sect0333"><i class="fa fa-check"></i><b>3.3.3</b> Nuage de mots</a></li>
<li class="chapter" data-level="3.3.4" data-path="sect033.html"><a href="sect033.html#sect0334"><i class="fa fa-check"></i><b>3.3.4</b> Carte proportionnelle</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Cartes</a></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Exportation des graphiques</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Conclusion sur les graphiques</a></li>
</ul></li>
<li class="part"><span><b>III Analyses bivariées</b></span></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Relation linéaire entre deux variables quantitatives</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Bref retour sur le postulat de la relation linéaire</a></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Covariance</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Formulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect043.html"><a href="sect043.html"><i class="fa fa-check"></i><b>4.3</b> Corrélation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="sect043.html"><a href="sect043.html#sect0431"><i class="fa fa-check"></i><b>4.3.1</b> Formulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="sect043.html"><a href="sect043.html#sect0432"><i class="fa fa-check"></i><b>4.3.2</b> Interprétation</a></li>
<li class="chapter" data-level="4.3.3" data-path="sect043.html"><a href="sect043.html#sect0433"><i class="fa fa-check"></i><b>4.3.3</b> Corrélations pour des variables anormalement distribuées (coefficient de Spearman, tau de Kendall)</a></li>
<li class="chapter" data-level="4.3.4" data-path="sect043.html"><a href="sect043.html#sect0434"><i class="fa fa-check"></i><b>4.3.4</b> Corrélations robustes (<em>Biweight midcorrelation</em>, <em>Percentage bend correlation</em> et la corrélation <em>pi</em> de Shepherd)</a></li>
<li class="chapter" data-level="4.3.5" data-path="sect043.html"><a href="sect043.html#sect0435"><i class="fa fa-check"></i><b>4.3.5</b> Significativité des coefficients de corrélation</a></li>
<li class="chapter" data-level="4.3.6" data-path="sect043.html"><a href="sect043.html#sect0436"><i class="fa fa-check"></i><b>4.3.6</b> Corrélation partielle</a></li>
<li class="chapter" data-level="4.3.7" data-path="sect043.html"><a href="sect043.html#sect0437"><i class="fa fa-check"></i><b>4.3.7</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.3.8" data-path="sect043.html"><a href="sect043.html#sect0438"><i class="fa fa-check"></i><b>4.3.8</b> Comment rapporter des valeurs de corrélations?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.4</b> Régression linéaire simple</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sect044.html"><a href="sect044.html#sect0441"><i class="fa fa-check"></i><b>4.4.1</b> Principe de base de la régression linéaire simple</a></li>
<li class="chapter" data-level="4.4.2" data-path="sect044.html"><a href="sect044.html#sect0442"><i class="fa fa-check"></i><b>4.4.2</b> Formulation de la droite de régression des moindres carrés ordinaires</a></li>
<li class="chapter" data-level="4.4.3" data-path="sect044.html"><a href="sect044.html#sect0443"><i class="fa fa-check"></i><b>4.4.3</b> Mesure de la qualité d’ajustement du modèle</a></li>
<li class="chapter" data-level="4.4.4" data-path="sect044.html"><a href="sect044.html#sect0444"><i class="fa fa-check"></i><b>4.4.4</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.4.5" data-path="sect044.html"><a href="sect044.html#sect0445"><i class="fa fa-check"></i><b>4.4.5</b> Comment rapporter une régression linéaire simple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Relation entre deux variables qualitatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Construction de tableau de contingence</a></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Test du khi-deux</a></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Interprétation d’un tableau de contingence</a></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Relation entre une variable qualitative et une variable quantitative</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Relation entre une variable quantitative et une variable qualitative à deux modalités</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Test <em>t</em> et ses différentes variantes</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Test non paramétrique de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Analyse de variance</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Test non paramétrique de Kruskal-Wallis</a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="6.2.4" data-path="sect062.html"><a href="sect062.html#sect0624"><i class="fa fa-check"></i><b>6.2.4</b> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Conclusion sur la troisième partie</a></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>IV Modèles de régression</b></span></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Principes de base de la régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Un peu d’équations…</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Hypothèses de la régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Évaluation de la qualité d’ajustement du modèle</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Mesures de la qualité d’un modèle</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Comparaison des modèles incrémentiels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Différentes mesures pour les coefficients de régression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sect074.html"><a href="sect074.html#sect0741"><i class="fa fa-check"></i><b>7.4.1</b> Coefficients de régression : évaluer l’effet des variables indépendantes</a></li>
<li class="chapter" data-level="7.4.2" data-path="sect074.html"><a href="sect074.html#sect0742"><i class="fa fa-check"></i><b>7.4.2</b> Coefficients de régression standardisés : repérer les variables les plus importantes du modèle</a></li>
<li class="chapter" data-level="7.4.3" data-path="sect074.html"><a href="sect074.html#sect0743"><i class="fa fa-check"></i><b>7.4.3</b> Significativité des coefficients de régression : valeurs de <em>t</em> et de <em>p</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="sect074.html"><a href="sect074.html#sect0744"><i class="fa fa-check"></i><b>7.4.4</b> Intervalle de confiance des coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Introduction de variables explicatives particulières</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sect075.html"><a href="sect075.html#sect0751"><i class="fa fa-check"></i><b>7.5.1</b> Exploration des relations non linéaires</a></li>
<li class="chapter" data-level="7.5.2" data-path="sect075.html"><a href="sect075.html#sect0752"><i class="fa fa-check"></i><b>7.5.2</b> Variable indépendante qualitative dichotomique</a></li>
<li class="chapter" data-level="7.5.3" data-path="sect075.html"><a href="sect075.html#sect0753"><i class="fa fa-check"></i><b>7.5.3</b> Variable indépendante qualitative polytomique</a></li>
<li class="chapter" data-level="7.5.4" data-path="sect075.html"><a href="sect075.html#sect0754"><i class="fa fa-check"></i><b>7.5.4</b> Variables d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sect076.html"><a href="sect076.html"><i class="fa fa-check"></i><b>7.6</b> Diagnostics de la régression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sect076.html"><a href="sect076.html#sect0761"><i class="fa fa-check"></i><b>7.6.1</b> Nombre d’observations</a></li>
<li class="chapter" data-level="7.6.2" data-path="sect076.html"><a href="sect076.html#sect0762"><i class="fa fa-check"></i><b>7.6.2</b> Normalité des résidus</a></li>
<li class="chapter" data-level="7.6.3" data-path="sect076.html"><a href="sect076.html#sect0763"><i class="fa fa-check"></i><b>7.6.3</b> Linéarité et homoscédasticité des résidus</a></li>
<li class="chapter" data-level="7.6.4" data-path="sect076.html"><a href="sect076.html#sect0764"><i class="fa fa-check"></i><b>7.6.4</b> Absence de multicolinéarité excessive</a></li>
<li class="chapter" data-level="7.6.5" data-path="sect076.html"><a href="sect076.html#sect0766"><i class="fa fa-check"></i><b>7.6.5</b> Absence d’observations aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sect077.html"><a href="sect077.html"><i class="fa fa-check"></i><b>7.7</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sect077.html"><a href="sect077.html#sect0771"><i class="fa fa-check"></i><b>7.7.1</b> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
<li class="chapter" data-level="7.7.2" data-path="sect077.html"><a href="sect077.html#sect0772"><i class="fa fa-check"></i><b>7.7.2</b> Comparaison des modèles</a></li>
<li class="chapter" data-level="7.7.3" data-path="sect077.html"><a href="sect077.html#sect0773"><i class="fa fa-check"></i><b>7.7.3</b> Diagnostic sur un modèle</a></li>
<li class="chapter" data-level="7.7.4" data-path="sect077.html"><a href="sect077.html#sect0774"><i class="fa fa-check"></i><b>7.7.4</b> Graphiques pour les effets marginaux</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sect078.html"><a href="sect078.html"><i class="fa fa-check"></i><b>7.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Régressions linéaires généralisées (GLM)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Qu’est qu’un modèle GLM?</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Formulation d’un GLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Autres distributions et rôle de la fonction de lien</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Conditions d’application</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Résidus et déviance</a></li>
<li class="chapter" data-level="8.1.5" data-path="sect081.html"><a href="sect081.html#sect0815"><i class="fa fa-check"></i><b>8.1.5</b> Vérification l’ajustement</a></li>
<li class="chapter" data-level="8.1.6" data-path="sect081.html"><a href="sect081.html#sect0816"><i class="fa fa-check"></i><b>8.1.6</b> Comparaison de deux modèles GLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Modèles GLM pour des variables qualitatives</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Modèle logistique binomial</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Modèle probit binomial</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Modèle logistique des cotes proportionnelles</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Modèle logistique multinomial</a></li>
<li class="chapter" data-level="8.2.5" data-path="sect082.html"><a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives"><i class="fa fa-check"></i><b>8.2.5</b> Conclusion sur les modèles pour des variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.3</b> Modèles GLM pour des variables de comptage</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="sect084.html"><a href="sect084.html#sect0841"><i class="fa fa-check"></i><b>8.3.1</b> Modèle de Poisson</a></li>
<li class="chapter" data-level="8.3.2" data-path="sect084.html"><a href="sect084.html#sect0842"><i class="fa fa-check"></i><b>8.3.2</b> Modèle binomial négatif</a></li>
<li class="chapter" data-level="8.3.3" data-path="sect084.html"><a href="sect084.html#sect0843"><i class="fa fa-check"></i><b>8.3.3</b> Modèle de Poisson avec excès fixe de zéros</a></li>
<li class="chapter" data-level="8.3.4" data-path="sect084.html"><a href="sect084.html#sect0844"><i class="fa fa-check"></i><b>8.3.4</b> Modèle de Poisson avec excès ajusté de zéros</a></li>
<li class="chapter" data-level="8.3.5" data-path="sect084.html"><a href="sect084.html#sect0845"><i class="fa fa-check"></i><b>8.3.5</b> Conclusion sur les modèles destinés à des variables de comptage</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sect085.html"><a href="sect085.html"><i class="fa fa-check"></i><b>8.4</b> Modèles GLM pour des variables continues</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sect085.html"><a href="sect085.html#sect0851"><i class="fa fa-check"></i><b>8.4.1</b> Modèle GLM gaussien</a></li>
<li class="chapter" data-level="8.4.2" data-path="sect085.html"><a href="sect085.html#sect0852"><i class="fa fa-check"></i><b>8.4.2</b> Modèle GLM avec une distribution de Student</a></li>
<li class="chapter" data-level="8.4.3" data-path="sect085.html"><a href="sect085.html#sect0853"><i class="fa fa-check"></i><b>8.4.3</b> Modèle GLM avec distribution Gamma</a></li>
<li class="chapter" data-level="8.4.4" data-path="sect085.html"><a href="sect085.html#sect0854"><i class="fa fa-check"></i><b>8.4.4</b> Modèle GLM avec une distribution bêta</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sect086.html"><a href="sect086.html"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="8.6" data-path="sect087.html"><a href="sect087.html"><i class="fa fa-check"></i><b>8.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Régressions à effets mixtes (GLMM)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Indépendance des observations et effets de groupes</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Terminologie: effets fixes et effets aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Principes de base des GLMM</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> GLMM avec constantes aléatoires</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.2</b> GLMM avec pentes aléatoires</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.3</b> GLMM avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Conditions d’application des GLMM</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Vérification de la distribution des effets aléatoires</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Homogénéité des variances au sein des groupes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Inférence dans les modèles GLMM</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#sect0941"><i class="fa fa-check"></i><b>9.4.1</b> Inférence pour les effets fixes</a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#sect0942"><i class="fa fa-check"></i><b>9.4.2</b> Inférence pour les effets aléatoires, effet global</a></li>
<li class="chapter" data-level="9.4.3" data-path="sect094.html"><a href="sect094.html#sect0943"><i class="fa fa-check"></i><b>9.4.3</b> Inférence pour les effets aléatoires, des constantes et des pentes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Conclusion sur les GLMM</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Mise en œuvre des GLMM dans R</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="sect096.html"><a href="sect096.html#sect0961"><i class="fa fa-check"></i><b>9.6.1</b> Ajustement du modèle avec uniquement une constante aléatoire</a></li>
<li class="chapter" data-level="9.6.2" data-path="sect096.html"><a href="sect096.html#sect0962"><i class="fa fa-check"></i><b>9.6.2</b> Ajustement du modèle avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sect097.html"><a href="sect097.html"><i class="fa fa-check"></i><b>9.7</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Régressions multiniveaux</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect101.html"><a href="sect101.html"><i class="fa fa-check"></i><b>10.1</b> Modèles multiniveaux : deux intérêts majeurs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect101.html"><a href="sect101.html#sect1011"><i class="fa fa-check"></i><b>10.1.1</b> Répartition de la variance entre les différents niveaux</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect101.html"><a href="sect101.html#sect1012"><i class="fa fa-check"></i><b>10.1.2</b> Estimation des coefficients aux différents niveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect102.html"><a href="sect102.html"><i class="fa fa-check"></i><b>10.2</b> Différents types de modèles multiniveaux</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect102.html"><a href="sect102.html#sect1021"><i class="fa fa-check"></i><b>10.2.1</b> Description du jeu de données utilisé</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect102.html"><a href="sect102.html#sect1022"><i class="fa fa-check"></i><b>10.2.2</b> Démarche classique pour les modèles multiniveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect103.html"><a href="sect103.html"><i class="fa fa-check"></i><b>10.3</b> Conditions d’application des régressions multiniveaux</a></li>
<li class="chapter" data-level="10.4" data-path="sect104.html"><a href="sect104.html"><i class="fa fa-check"></i><b>10.4</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect104.html"><a href="sect104.html#sect1041"><i class="fa fa-check"></i><b>10.4.1</b> Le modèle vide</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect104.html"><a href="sect104.html#sect1042"><i class="fa fa-check"></i><b>10.4.2</b> Modèle avec les variables indépendantes du niveau 1</a></li>
<li class="chapter" data-level="10.4.3" data-path="sect104.html"><a href="sect104.html#sect1043"><i class="fa fa-check"></i><b>10.4.3</b> Modèle avec les variables indépendantes aux niveaux 1 et 2</a></li>
<li class="chapter" data-level="10.4.4" data-path="sect104.html"><a href="sect104.html#sect10414"><i class="fa fa-check"></i><b>10.4.4</b> Modèle complet avec une interaction</a></li>
<li class="chapter" data-level="10.4.5" data-path="sect104.html"><a href="sect104.html#sect1045"><i class="fa fa-check"></i><b>10.4.5</b> Comparaison des quatre modèles</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect105.html"><a href="sect105.html"><i class="fa fa-check"></i><b>10.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> Modèles généralisés additifs</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sect111.html"><a href="sect111.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="sect111.html"><a href="sect111.html#sect1111"><i class="fa fa-check"></i><b>11.1.1</b> Non linéarité fonctionnelle</a></li>
<li class="chapter" data-level="11.1.2" data-path="sect111.html"><a href="sect111.html#sect1112"><i class="fa fa-check"></i><b>11.1.2</b> Non linéarité avec des polynomiales</a></li>
<li class="chapter" data-level="11.1.3" data-path="sect111.html"><a href="sect111.html#sect1113"><i class="fa fa-check"></i><b>11.1.3</b> Non linéarité par segments</a></li>
<li class="chapter" data-level="11.1.4" data-path="sect111.html"><a href="sect111.html#sect1114"><i class="fa fa-check"></i><b>11.1.4</b> Non linéarité avec des <em>splines</em></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sect112.html"><a href="sect112.html"><i class="fa fa-check"></i><b>11.2</b> <em>Spline</em> de régression et <em>spline</em> de lissage</a></li>
<li class="chapter" data-level="11.3" data-path="sect113.html"><a href="sect113.html"><i class="fa fa-check"></i><b>11.3</b> Interprétation d’une <em>spline</em></a></li>
<li class="chapter" data-level="11.4" data-path="sect114.html"><a href="sect114.html"><i class="fa fa-check"></i><b>11.4</b> Multicolinéarité non linéaire</a></li>
<li class="chapter" data-level="11.5" data-path="sect115.html"><a href="sect115.html"><i class="fa fa-check"></i><b>11.5</b> <em>Splines</em> avancées</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sect115.html"><a href="sect115.html#sect1151"><i class="fa fa-check"></i><b>11.5.1</b> <em>Splines</em> cycliques</a></li>
<li class="chapter" data-level="11.5.2" data-path="sect115.html"><a href="sect115.html#sect1152"><i class="fa fa-check"></i><b>11.5.2</b> Splines par groupe</a></li>
<li class="chapter" data-level="11.5.3" data-path="sect115.html"><a href="sect115.html#sect1153"><i class="fa fa-check"></i><b>11.5.3</b> <em>Splines</em> multivariées et <em>splines</em> d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="sect116.html"><a href="sect116.html"><i class="fa fa-check"></i><b>11.6</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="11.7" data-path="sect117.html"><a href="sect117.html"><i class="fa fa-check"></i><b>11.7</b> GAMM</a></li>
<li class="chapter" data-level="11.8" data-path="sect118.html"><a href="sect118.html"><i class="fa fa-check"></i><b>11.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>V Analyses exploratoires multivariées</b></span></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> Méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sect121.html"><a href="sect121.html"><i class="fa fa-check"></i><b>12.1</b> Aperçu des méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="sect121.html"><a href="sect121.html#sect1211"><i class="fa fa-check"></i><b>12.1.1</b> Méthodes factorielles et types de données</a></li>
<li class="chapter" data-level="12.1.2" data-path="sect121.html"><a href="sect121.html#sect1212"><i class="fa fa-check"></i><b>12.1.2</b> Bref historique des méthodes factorielles</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sect122.html"><a href="sect122.html"><i class="fa fa-check"></i><b>12.2</b> Analyses en composantes principales (ACP)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="sect122.html"><a href="sect122.html#sect1221"><i class="fa fa-check"></i><b>12.2.1</b> Recherche d’une simplification</a></li>
<li class="chapter" data-level="12.2.2" data-path="sect122.html"><a href="sect122.html#sect1222"><i class="fa fa-check"></i><b>12.2.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.2.3" data-path="sect122.html"><a href="sect122.html#sect1223"><i class="fa fa-check"></i><b>12.2.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sect123.html"><a href="sect123.html"><i class="fa fa-check"></i><b>12.3</b> Analyse factorielle des correspondances (AFC)</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="sect123.html"><a href="sect123.html#sect1231"><i class="fa fa-check"></i><b>12.3.1</b> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
<li class="chapter" data-level="12.3.2" data-path="sect123.html"><a href="sect123.html#sect1232"><i class="fa fa-check"></i><b>12.3.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.3.3" data-path="sect123.html"><a href="sect123.html#sect1233"><i class="fa fa-check"></i><b>12.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="sect124.html"><a href="sect124.html"><i class="fa fa-check"></i><b>12.4</b> Analyse de correspondances multiples (ACM)</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="sect124.html"><a href="sect124.html#sect1241"><i class="fa fa-check"></i><b>12.4.1</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.4.2" data-path="sect124.html"><a href="sect124.html#sect1242"><i class="fa fa-check"></i><b>12.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="sect125.html"><a href="sect125.html"><i class="fa fa-check"></i><b>12.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> Méthodes de classification non supervisée</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sect131.html"><a href="sect131.html"><i class="fa fa-check"></i><b>13.1</b> Méthodes de classification : un aperçu</a></li>
<li class="chapter" data-level="13.2" data-path="sect132.html"><a href="sect132.html"><i class="fa fa-check"></i><b>13.2</b> Notions essentielles en classification</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="sect132.html"><a href="sect132.html#sect1321"><i class="fa fa-check"></i><b>13.2.1</b> Distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="sect132.html"><a href="sect132.html#sect1322"><i class="fa fa-check"></i><b>13.2.2</b> Inertie</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="sect133.html"><a href="sect133.html"><i class="fa fa-check"></i><b>13.3</b> Classification ascendante hiérarchique</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="sect133.html"><a href="sect133.html#sect1331"><i class="fa fa-check"></i><b>13.3.1</b> Fonctionnement de l’algorithme</a></li>
<li class="chapter" data-level="13.3.2" data-path="sect133.html"><a href="sect133.html#sect1332"><i class="fa fa-check"></i><b>13.3.2</b> Choisir le bon nombre de groupes</a></li>
<li class="chapter" data-level="13.3.3" data-path="sect133.html"><a href="sect133.html#sect1333"><i class="fa fa-check"></i><b>13.3.3</b> Limites de la classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="13.3.4" data-path="sect133.html"><a href="sect133.html#sect1334"><i class="fa fa-check"></i><b>13.3.4</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sect134.html"><a href="sect134.html"><i class="fa fa-check"></i><b>13.4</b> Nuées dynamiques</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="sect134.html"><a href="sect134.html#sect1341"><i class="fa fa-check"></i><b>13.4.1</b> <em>K-means</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="sect134.html"><a href="sect134.html#sect1342"><i class="fa fa-check"></i><b>13.4.2</b> K-médianes</a></li>
<li class="chapter" data-level="13.4.3" data-path="sect134.html"><a href="sect134.html#sect1343"><i class="fa fa-check"></i><b>13.4.3</b> K-médoïds</a></li>
<li class="chapter" data-level="13.4.4" data-path="sect134.html"><a href="sect134.html#sect1344"><i class="fa fa-check"></i><b>13.4.4</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="13.4.5" data-path="sect134.html"><a href="sect134.html#sect1346"><i class="fa fa-check"></i><b>13.4.5</b> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sect135.html"><a href="sect135.html"><i class="fa fa-check"></i><b>13.5</b> Conclusion sur la cinquième partie</a></li>
<li class="chapter" data-level="13.6" data-path="sect136.html"><a href="sect136.html"><i class="fa fa-check"></i><b>13.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>VI Annexes</b></span></li>
<li class="chapter" data-level="14" data-path="annexe1.html"><a href="annexe1.html"><i class="fa fa-check"></i><b>14</b> Table des valeurs critiques de khi-deux</a></li>
<li class="chapter" data-level="15" data-path="annexe2.html"><a href="annexe2.html"><i class="fa fa-check"></i><b>15</b> Table des valeurs critiques de Fisher</a></li>
<li class="chapter" data-level="16" data-path="annexe3.html"><a href="annexe3.html"><i class="fa fa-check"></i><b>16</b> Table des valeurs critiques de <em>t</em></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect134" class="section level2 hasAnchor" number="13.4">
<h2><span class="header-section-number">13.4</span> Nuées dynamiques<a href="sect134.html#sect134" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Les méthodes des nuées dynamiques regroupent plusieurs algorithmes, tous plus ou moins liés avec l’algorithme le plus connu : <em>k-means</em>, originalement proposé par James MacQueen <span class="citation">(<a href="#ref-macqueen1967" role="doc-biblioref">1967</a>)</span>. Nous présentons également ici plusieurs variantes du <em>k-means</em>, soit le <em>k-medians</em>, le <em>k-medioids</em>, le <em>c-means</em> et le <em>c-medians</em>.</p>
<div id="sect1341" class="section level3 hasAnchor" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> <em>K-means</em><a href="sect134.html#sect1341" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect13411" class="section level4 hasAnchor" number="13.4.1.1">
<h4><span class="header-section-number">13.4.1.1</span> Fonctionnement de l’algorithme<a href="sect134.html#sect13411" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous commençons ici par détailler le fonctionnement de cet algorithme afin de mieux le cerner. D’emblée, cet algorithme nécessite que certains éléments soient définis d’avance :</p>
<ul>
<li>Une matrice de données <em>X</em> comportant <em>n</em> lignes (nombre d’observations) et <em>p</em> colonnes (nombre de variables). Chaque variable de cette matrice doit être quantitative et continue et de préférence dans une échelle standardisée (par exemple des variables centrées réduites).</li>
<li>Le nombre de groupes à identifier <em>k</em> doit être choisi par l’utilisateur ou l’utilisatrice.</li>
<li>La distance <em>d</em> à utiliser entre les observations.</li>
</ul>
<p>Le fonctionnement classique du <em>k-means</em> est le suivant :</p>
<ol style="list-style-type: decimal">
<li>Définir <em>k</em> centres de groupes de façon aléatoire.</li>
<li>Déterminer pour chaque observation le centre de son groupe le plus proche en utilisant la fonction de distance.</li>
<li>Pour chacun des groupes ainsi formés, recalculer le centre du groupe en calculant le centroïde (moyennes le plus souvent) des observations appartenant à ce groupe.</li>
<li>Répéter l’opération 2 avec les nouveaux centres.</li>
<li>Calculer l’inertie expliquée par la nouvelle classification.</li>
<li>Comparer cette inertie expliquée avec celle obtenue lors de l’itération précédente.</li>
<li>Si la variation entre les deux valeurs est supérieure à une certaine limite, reprendre à l’étape 2, sinon, l’algorithme prend fin.</li>
</ol>
<p>Ainsi, l’algorithme <em>k-means</em> part d’une première classification obtenue aléatoirement et la raffine jusqu’au point où l’amélioration de la classification devient négligeable. Du fait de ce point de départ aléatoire, cet algorithme est dit heuristique, car deux exécutions risquent de ne pas donner exactement le même résultat. Par conséquent, en relaçant l’algorithme, vous pourriez obtenir des résultats légèrement différents, avec par exemple des groupes similaires, mais obtenus dans un autre ordre, le groupe 1 étant devenu le groupe 3 et vice-versa. Il est aussi possible d’obtenir des résultats radicalement différents d’une tentative à l’autre, ce qui signifie que les groupes formés sont très instables et ne sont pas représentatifs de la population étudiée.</p>
<div class="bloc_astuce">
<p><strong>Réplicabilité des résultats dans R</strong></p>
<p>Lorsqu’une méthode heuristique ou faisant appel au hasard est utilisée dans R, il est nécessaire de s’assurer que les résultats sont reproductibles. Cela permet notamment de relancer le même code et de réobtenir exactement les mêmes résultats : l’idée étant de figer le hasard.</p>
<p>Ultimement, un programme informatique est incapable de générer un résultat véritablement aléatoire, car il ne fait que suivre une suite d’opérations prédéterminées. Pour générer des résultats qui ressemblent au hasard, des algorithmes ont été proposés, partant d’une configuration initiale et appliquant une série d’opérations complexes permettant de générer des nombres semblant se distribuer aléatoirement. Si nous connaissons le point de départ de la suite d’opérations et que nous réappliquons ces dernières, alors nous sommes certains d’obtenir le même résultat. Il est possible, dans R, de définir un <em>état initial de hasard</em> à l’aide de la fonction <code>set.seed</code>. Avec ce point de départ défini, nous sommes certains d’obtenir les mêmes résultats en relançant les mêmes opérations.</p>
<p>Prenons un exemple concret en sélectionnant aléatoire 3 chiffres dans un vecteur allant de 1 à 10.</p>
<div class="sourceCode" id="cb1141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1141-1"><a href="sect134.html#cb1141-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb1141-2"><a href="sect134.html#cb1141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1141-3"><a href="sect134.html#cb1141-3" aria-hidden="true" tabindex="-1"></a><span class="co"># prenons un premier échantillon</span></span>
<span id="cb1141-4"><a href="sect134.html#cb1141-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(vec, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 4 9 3</code></pre>
<div class="sourceCode" id="cb1143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1143-1"><a href="sect134.html#cb1143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># et un second échantillon </span></span>
<span id="cb1143-2"><a href="sect134.html#cb1143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(vec, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1]  6 10  8</code></pre>
<p>Nous obtenons bien deux échantillons différents. Recommençons en utilisant la fonction <code>set.seed</code> pour obtenir cette fois-ci des résultats identiques.</p>
<div class="sourceCode" id="cb1145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1145-1"><a href="sect134.html#cb1145-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb1145-2"><a href="sect134.html#cb1145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1145-3"><a href="sect134.html#cb1145-3" aria-hidden="true" tabindex="-1"></a><span class="co"># prenons un premier échantillon</span></span>
<span id="cb1145-4"><a href="sect134.html#cb1145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1145-5"><a href="sect134.html#cb1145-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(vec, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1]  3 10  2</code></pre>
<div class="sourceCode" id="cb1147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1147-1"><a href="sect134.html#cb1147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># et un second échantillon </span></span>
<span id="cb1147-2"><a href="sect134.html#cb1147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1147-3"><a href="sect134.html#cb1147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(vec, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1]  3 10  2</code></pre>
<div class="sourceCode" id="cb1149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1149-1"><a href="sect134.html#cb1149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prenons un troisème échantillon</span></span>
<span id="cb1149-2"><a href="sect134.html#cb1149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4568997</span>)</span>
<span id="cb1149-3"><a href="sect134.html#cb1149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(vec, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 5 6 7</code></pre>
<div class="sourceCode" id="cb1151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1151-1"><a href="sect134.html#cb1151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># et un quatrième échantillon </span></span>
<span id="cb1151-2"><a href="sect134.html#cb1151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4568997</span>)</span>
<span id="cb1151-3"><a href="sect134.html#cb1151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(vec, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 5 6 7</code></pre>
<p>Vous constatez que nous utilisons cette fonction plusieurs fois au cours de cette section. Elle nous permet de nous assurer que les résultats obtenus ne changent pas entre le moment où nous écrivons le livre et le moment où nous le formatons. Sinon, le texte pourrait ne plus être en phase avec les images ou les tableaux.</p>
</div>
<p>Pour mieux comprendre le fonctionnement du <em>k-means</em>, nous proposons ici une visualisation de ses différentes itérations.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansA"></span>
<img src="images/classification/kmeansGif.gif" alt="Classifications stricte et floue" width="80%" />
<p class="caption">
Figure 13.18: Classifications stricte et floue
</p>
</div>
<p>Nous pouvons constater que, pour ce jeu de données relativement simple, l’algorithme converge très rapidement et que sa solution varie peu au-delà de la troisième itération. Si vous utilisez la version HTLM du livre, la figure <a href="sect134.html#fig:kmeansA">13.18</a> devrait être animée et illustrer pourquoi le <em>k-means</em> est aussi appelé algorithme de nuées dynamiques.</p>
<div class="bloc_notes">
<p><strong>Centre de groupe et <em>k-means</em></strong></p>
<p>À nouveau, puisque chaque itération du <em>k-means</em> nécessite de recalculer les centres des groupes formés, des problèmes peuvent être rencontrés avec certains types de distance. C’est pourquoi il est recommandé d’utiliser la distance euclidienne avec le <em>k-means</em> original. Si des distances plus complexes doivent être utilisées, il est préférable d’utiliser la classification ascendante hiérarchique.</p>
</div>
</div>
<div id="sect13412" class="section level4 hasAnchor" number="13.4.1.2">
<h4><span class="header-section-number">13.4.1.2</span> Choix du nombre optimal de groupes<a href="sect134.html#sect13412" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Comme pour la CAH, le principal enjeu avec le <em>k-means</em> est de déterminer le nombre idéal de groupes pour effectuer la classification. Si ce nombre n’est pas connu à l’avance et qu’aucune forte justification théorique n’existe, il est possible d’utiliser les mêmes techniques que pour la CAH, soit la méthode du coude, l’indicateur de silhouette ou la méthode GAP.</p>
</div>
</div>
<div id="sect1342" class="section level3 hasAnchor" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> K-médianes<a href="sect134.html#sect1342" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le <em>k-medians</em> est une variante du <em>k-means</em>. Contrairement au <em>k-means</em> privilégiant la distance euclidienne, le <em>k-medians</em> est à utiliser en priorité avec une distance de Manhattan. En effet, le centre d’un groupe n’est pas déterminé comme la moyenne des variables des observations appartenant à ce groupe (<em>k-means</em>), mais comme la médiane pour chaque variable (<em>k-medians</em>). En dehors de ces deux spécificités, il reprend le fonctionnement décrit plus haut pour le <em>k-means</em>. Il est particulièrement pertinent de l’utiliser quand un jeu de données comprend un très grand nombre de colonnes, car dans ce contexte, la distance euclidienne peine à représenter les différences entre les observations. De plus, l’utilisation de la médiane le rend moins sensible aux valeurs extrêmes.</p>
</div>
<div id="sect1343" class="section level3 hasAnchor" number="13.4.3">
<h3><span class="header-section-number">13.4.3</span> K-médoïds<a href="sect134.html#sect1343" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le <em>k-médoïds</em> est également une variante du <em>k-means</em>. Le <em>k-means</em> crée des groupes en cherchant les centres de ces groupes dans l’espace multidimensionnel des données. Ces centres de groupes peuvent très bien ne pas correspondre à un point du jeu de données, au même titre que la moyenne d’une variable ne coïncide que rarement avec une observation réelle de cette variable. Pour le <em>k-médoïds</em>, les groupes sont formés en cherchant les centres de ces groupes <strong>parmi</strong> les observations du jeu de données. Ainsi, chaque groupe est centré sur une observation réelle, la plus similaire à l’ensemble des observations du groupe.</p>
<p>L’algorithme effectue les opérations suivantes :</p>
<ol style="list-style-type: decimal">
<li>Sélectionner aléatoirement <em>k</em> observations du jeu de données, elles constituent les centres des groupes initiaux.</li>
<li>Attribuer chaque observation au centre du groupe le plus proche.</li>
<li>Tant que la nouvelle solution est plus efficace, effectuer les opérations suivantes :</li>
</ol>
<ul>
<li>pour chaque centre <em>m</em> et pour chaque observation <em>o</em>,
<ul>
<li>considérer l’inversion de <em>m</em> et <em>o</em></li>
<li>si cette permutation est meilleure que les précédentes, la conserver en mémoire</li>
</ul></li>
<li>effectuer la meilleure permutation retenue si elle améliore la classification, sinon l’algorithme prend fin.</li>
</ul>
<p>Le <em>k-médoïds</em> est moins utilisé que le <em>k-means</em>, mais il est plus performant quand des distances autres que la distance euclidienne sont utilisées ou encore que des valeurs aberrantes/extrêmes sont présentes dans les données.</p>
</div>
<div id="sect1344" class="section level3 hasAnchor" number="13.4.4">
<h3><span class="header-section-number">13.4.4</span> Mise en oeuvre dans R<a href="sect134.html#sect1344" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour cet exemple, nous proposons d’utiliser le jeu de données spatiales <code>LyonIris</code> du <em>package</em> <code>geocmeans</code>. Ce jeu de données spatiales pour l’agglomération lyonnaise (France) comprend dix variables, dont quatre environnementales (EN) et six socioéconomiques (SE), pour les îlots regroupés pour l’information statistique (IRIS) de l’agglomération lyonnaise (tableau <a href="sect134.html#tab:datageocmeans">13.7</a> et figure <a href="sect122.html#fig:datacartoacp">12.4</a>). Nous proposons de réaliser une analyse similaire à celle de l’article de <span class="citation">Gelb et Apparicio (<a href="#ref-2021_4" role="doc-biblioref">2021b</a>)</span>, soit de classer les IRIS de Lyon selon ces caractéristiques pour déterminer si certains groupes d’IRIS combinent des situations désavantageuses sur les plans sociaux et environnementaux, dans une perspective d’équité environnementale.</p>
<p>Notez ici que la fonction <code>st_drop_geometry</code> provenant du package <code>sf</code> permet de retirer l’information géographique du jeu de données <code>LyonIris</code> pour obtenir un simple <code>dataframe</code>.</p>
<table>
<caption>
<span id="tab:datageocmeans">Tableau 13.7: </span>Statistiques descriptives du jeu de données LyonIris
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nom
</th>
<th style="text-align:left;">
Intitulé
</th>
<th style="text-align:center;">
Type
</th>
<th style="text-align:right;">
Moy.
</th>
<th style="text-align:right;">
E.-T.
</th>
<th style="text-align:right;">
Min.
</th>
<th style="text-align:right;">
Max.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Lden
</td>
<td style="text-align:left;">
Bruit routier (Lden dB(A))
</td>
<td style="text-align:center;">
EN
</td>
<td style="text-align:right;">
55,6
</td>
<td style="text-align:right;">
4,9
</td>
<td style="text-align:right;">
33,9
</td>
<td style="text-align:right;">
71,7
</td>
</tr>
<tr>
<td style="text-align:left;">
NO2
</td>
<td style="text-align:left;">
Dioxyde d’azote (ug/m<sup>3</sup>)
</td>
<td style="text-align:center;">
EN
</td>
<td style="text-align:right;">
28,7
</td>
<td style="text-align:right;">
7,9
</td>
<td style="text-align:right;">
12,0
</td>
<td style="text-align:right;">
60,2
</td>
</tr>
<tr>
<td style="text-align:left;">
PM25
</td>
<td style="text-align:left;">
Particules fines (PM<span class="math inline">\(_{2,5}\)</span>)
</td>
<td style="text-align:center;">
EN
</td>
<td style="text-align:right;">
16,8
</td>
<td style="text-align:right;">
2,1
</td>
<td style="text-align:right;">
11,3
</td>
<td style="text-align:right;">
21,9
</td>
</tr>
<tr>
<td style="text-align:left;">
VegHautPrt
</td>
<td style="text-align:left;">
Canopée (%)
</td>
<td style="text-align:center;">
EN
</td>
<td style="text-align:right;">
18,7
</td>
<td style="text-align:right;">
10,1
</td>
<td style="text-align:right;">
1,7
</td>
<td style="text-align:right;">
53,8
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct0_14
</td>
<td style="text-align:left;">
Moins de 15 ans (%)
</td>
<td style="text-align:center;">
SE
</td>
<td style="text-align:right;">
18,5
</td>
<td style="text-align:right;">
5,7
</td>
<td style="text-align:right;">
0,0
</td>
<td style="text-align:right;">
54,0
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_65
</td>
<td style="text-align:left;">
65 ans et plus (%)
</td>
<td style="text-align:center;">
SE
</td>
<td style="text-align:right;">
16,2
</td>
<td style="text-align:right;">
5,9
</td>
<td style="text-align:right;">
0,0
</td>
<td style="text-align:right;">
45,1
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_Img
</td>
<td style="text-align:left;">
Immigrants (%)
</td>
<td style="text-align:center;">
SE
</td>
<td style="text-align:right;">
14,5
</td>
<td style="text-align:right;">
9,1
</td>
<td style="text-align:right;">
0,0
</td>
<td style="text-align:right;">
59,8
</td>
</tr>
<tr>
<td style="text-align:left;">
TxChom1564
</td>
<td style="text-align:left;">
Taux de chômage
</td>
<td style="text-align:center;">
SE
</td>
<td style="text-align:right;">
14,8
</td>
<td style="text-align:right;">
8,1
</td>
<td style="text-align:right;">
0,0
</td>
<td style="text-align:right;">
98,8
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_brevet
</td>
<td style="text-align:left;">
Personnes à faible scolarité (%)
</td>
<td style="text-align:center;">
SE
</td>
<td style="text-align:right;">
23,5
</td>
<td style="text-align:right;">
12,6
</td>
<td style="text-align:right;">
0,0
</td>
<td style="text-align:right;">
100,0
</td>
</tr>
<tr>
<td style="text-align:left;">
NivVieMed
</td>
<td style="text-align:left;">
Médiane du niveau de vie (Euros)
</td>
<td style="text-align:center;">
SE
</td>
<td style="text-align:right;">
21 804,5
</td>
<td style="text-align:right;">
4 922,5
</td>
<td style="text-align:right;">
11 324,0
</td>
<td style="text-align:right;">
38 707,0
</td>
</tr>
</tbody>
</table>
<div id="sect13441" class="section level4 hasAnchor" number="13.4.4.1">
<h4><span class="header-section-number">13.4.4.1</span> Préparation des données<a href="sect134.html#sect13441" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La première étape consiste donc à charger les données et à les préparer pour l’analyse. Toutes les variables que nous utilisons sont des variables continues. Cependant, elles ne sont pas exprimées dans la même échelle, nous proposons donc de les standardiser ici en les centrant (moyenne = 0) et en les réduisant (écart-type = 1). Cette opération peut être effectuée simplement dans R en utilisant la fonction <code>scale</code>.</p>
<div class="sourceCode" id="cb1153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1153-1"><a href="sect134.html#cb1153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb1153-2"><a href="sect134.html#cb1153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geocmeans)</span>
<span id="cb1153-3"><a href="sect134.html#cb1153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1153-4"><a href="sect134.html#cb1153-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1153-5"><a href="sect134.html#cb1153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(LyonIris)</span>
<span id="cb1153-6"><a href="sect134.html#cb1153-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1153-7"><a href="sect134.html#cb1153-7" aria-hidden="true" tabindex="-1"></a><span class="co"># NB : LyonIris est un objet spatial, il faut donc extraire uniquement son DataFrame</span></span>
<span id="cb1153-8"><a href="sect134.html#cb1153-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(LyonIris[<span class="fu">c</span>(<span class="st">&quot;Lden&quot;</span>,<span class="st">&quot;NO2&quot;</span>,<span class="st">&quot;PM25&quot;</span>,<span class="st">&quot;VegHautPrt&quot;</span>,<span class="st">&quot;Pct0_14&quot;</span>,<span class="st">&quot;Pct_65&quot;</span>,<span class="st">&quot;Pct_Img&quot;</span>,</span>
<span id="cb1153-9"><a href="sect134.html#cb1153-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;TxChom1564&quot;</span>,<span class="st">&quot;Pct_brevet&quot;</span>,<span class="st">&quot;NivVieMed&quot;</span>)])</span>
<span id="cb1153-10"><a href="sect134.html#cb1153-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1153-11"><a href="sect134.html#cb1153-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Centrage et réduction de chaque colonne du DataFrame</span></span>
<span id="cb1153-12"><a href="sect134.html#cb1153-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(X)){</span>
<span id="cb1153-13"><a href="sect134.html#cb1153-13" aria-hidden="true" tabindex="-1"></a>  X[[col]] <span class="ot">&lt;-</span> <span class="fu">scale</span>(X[[col]], <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1153-14"><a href="sect134.html#cb1153-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="sect13442" class="section level4 hasAnchor" number="13.4.4.2">
<h4><span class="header-section-number">13.4.4.2</span> Choix du nombre de groupes optimal<a href="sect134.html#sect13442" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La seconde étape consiste à déterminer le nombre de groupes optimal. Pour cela, nous comparons les résultats des trois méthodes proposées : la méthode du coude, l’indice de silhouette et la méthode GAP. Pour chaque méthode, nous testons les nombres de groupes de 2 à 10.</p>
<div id="sect134421" class="section level5 hasAnchor" number="13.4.4.2.1">
<h5><span class="header-section-number">13.4.4.2.1</span> Méthode du coude<a href="sect134.html#sect134421" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Commençons par appliquer la méthode du coude. Nous calculons donc l’inertie expliquée par la classification pour différentes valeurs de <em>k</em> (nombre de groupes) avant de construire la figure <a href="sect134.html#fig:kmeansC">13.19</a>.</p>
<div class="sourceCode" id="cb1154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1154-1"><a href="sect134.html#cb1154-1" aria-hidden="true" tabindex="-1"></a>ks <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb1154-2"><a href="sect134.html#cb1154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1154-3"><a href="sect134.html#cb1154-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Méthode du coude ---- ##</span></span>
<span id="cb1154-4"><a href="sect134.html#cb1154-4" aria-hidden="true" tabindex="-1"></a>inertie_exps <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ks, <span class="cf">function</span>(k){</span>
<span id="cb1154-5"><a href="sect134.html#cb1154-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calcul du kmeans avec k</span></span>
<span id="cb1154-6"><a href="sect134.html#cb1154-6" aria-hidden="true" tabindex="-1"></a>  resultat <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(X, <span class="at">centers =</span> k)</span>
<span id="cb1154-7"><a href="sect134.html#cb1154-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calcul de l&#39;inertie expliquée (1 - inertie intragroupe / inertie totale)</span></span>
<span id="cb1154-8"><a href="sect134.html#cb1154-8" aria-hidden="true" tabindex="-1"></a>  inertie_exp <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>(<span class="fu">sum</span>(resultat<span class="sc">$</span>withinss) <span class="sc">/</span> resultat<span class="sc">$</span>totss)</span>
<span id="cb1154-9"><a href="sect134.html#cb1154-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(inertie_exp)</span>
<span id="cb1154-10"><a href="sect134.html#cb1154-10" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1154-11"><a href="sect134.html#cb1154-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1154-12"><a href="sect134.html#cb1154-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1154-13"><a href="sect134.html#cb1154-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> ks,</span>
<span id="cb1154-14"><a href="sect134.html#cb1154-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">inertie_exp =</span> inertie_exps</span>
<span id="cb1154-15"><a href="sect134.html#cb1154-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1154-16"><a href="sect134.html#cb1154-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1154-17"><a href="sect134.html#cb1154-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb1154-18"><a href="sect134.html#cb1154-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> inertie_exp)) <span class="sc">+</span> </span>
<span id="cb1154-19"><a href="sect134.html#cb1154-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> inertie_exp), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1154-20"><a href="sect134.html#cb1154-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;nombre de groupes&quot;</span>, <span class="at">y =</span> <span class="st">&quot;inertie expliquée (%)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:kmeansC"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansC-1.png" alt="Inertie expliquée pour différents nombres de groupes pour le k-means" width="75%" />
<p class="caption">
Figure 13.19: Inertie expliquée pour différents nombres de groupes pour le k-means
</p>
</div>
<p>Dans l’article original, quatre groupes avaient été retenus. Nous pouvons constater ici qu’un coude fort se situe à k = 3 et qu’au-delà de cette limite, l’ajout d’un groupe supplémentaire contribue à expliquer une plus petite partie de l’inertie supplémentaire comparativement au précédent.</p>
</div>
<div id="sect134422" class="section level5 hasAnchor" number="13.4.4.2.2">
<h5><span class="header-section-number">13.4.4.2.2</span> Indice de silhouette<a href="sect134.html#sect134422" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Poursuivons avec l’indice de silhouette calculé de nouveau avec des valeurs de <em>k</em> allant de 2 à 10. Notez que nous devons au préalable créer une matrice de distances entre les observations du jeu de données pour construire notre indice de silhouette. Puisque nous utilisons l’algorithme <em>k-means</em>, nous utilisons la distance euclidienne.</p>
<div class="sourceCode" id="cb1155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1155-1"><a href="sect134.html#cb1155-1" aria-hidden="true" tabindex="-1"></a>ks <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb1155-2"><a href="sect134.html#cb1155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1155-3"><a href="sect134.html#cb1155-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calcul d&#39;une matrice de distance euclidienne entre les observations</span></span>
<span id="cb1155-4"><a href="sect134.html#cb1155-4" aria-hidden="true" tabindex="-1"></a>dist_mat <span class="ot">&lt;-</span> <span class="fu">dist</span>(X, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span>
<span id="cb1155-5"><a href="sect134.html#cb1155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1155-6"><a href="sect134.html#cb1155-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- indice de silhouette ---- ##</span></span>
<span id="cb1155-7"><a href="sect134.html#cb1155-7" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(ks, <span class="cf">function</span>(k){</span>
<span id="cb1155-8"><a href="sect134.html#cb1155-8" aria-hidden="true" tabindex="-1"></a>  resultat <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(X,<span class="at">centers =</span> k)</span>
<span id="cb1155-9"><a href="sect134.html#cb1155-9" aria-hidden="true" tabindex="-1"></a>  groupes <span class="ot">&lt;-</span> resultat<span class="sc">$</span>cluster</span>
<span id="cb1155-10"><a href="sect134.html#cb1155-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calcul des valeurs de silhouette</span></span>
<span id="cb1155-11"><a href="sect134.html#cb1155-11" aria-hidden="true" tabindex="-1"></a>  sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(groupes, <span class="at">dist =</span> dist_mat)</span>
<span id="cb1155-12"><a href="sect134.html#cb1155-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extraction de l&#39;indice global (moyenne des moyennes)</span></span>
<span id="cb1155-13"><a href="sect134.html#cb1155-13" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">summary</span>(sil)<span class="sc">$</span>clus.avg.widths)</span>
<span id="cb1155-14"><a href="sect134.html#cb1155-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(idx)</span>
<span id="cb1155-15"><a href="sect134.html#cb1155-15" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1155-16"><a href="sect134.html#cb1155-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1155-17"><a href="sect134.html#cb1155-17" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1155-18"><a href="sect134.html#cb1155-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> ks,</span>
<span id="cb1155-19"><a href="sect134.html#cb1155-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">silhouette =</span> values</span>
<span id="cb1155-20"><a href="sect134.html#cb1155-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1155-21"><a href="sect134.html#cb1155-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1155-22"><a href="sect134.html#cb1155-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb1155-23"><a href="sect134.html#cb1155-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> silhouette)) <span class="sc">+</span> </span>
<span id="cb1155-24"><a href="sect134.html#cb1155-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> silhouette), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1155-25"><a href="sect134.html#cb1155-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;nombre de groupes&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Indice de silhouette&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:kmeansD"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansD-1.png" alt="Indice de silhouette pour différents nombres de groupes pour le k-means" width="75%" />
<p class="caption">
Figure 13.20: Indice de silhouette pour différents nombres de groupes pour le k-means
</p>
</div>
<p>À nouveau, la figure <a href="sect134.html#fig:kmeansD">13.20</a> indique que le nombre de groupes optimal est trois selon l’indice de silhouette.</p>
</div>
<div id="sect134423" class="section level5 hasAnchor" number="13.4.4.2.3">
<h5><span class="header-section-number">13.4.4.2.3</span> Méthode GAP<a href="sect134.html#sect134423" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Pour appliquer la méthode GAP, nous proposons d’utiliser la fonction <code>clusGap</code> du <em>package</em> <code>NbClust</code>. Pour l’utiliser, il est nécessaire de définir une fonction renvoyant pour le nombre de groupes <em>k</em> et le jeu de données <em>x</em> une liste comprenant un vecteur attribuant chaque observation à chaque groupe. Il est possible de considérer ce type de fonction comme un « adaptateur ».</p>
<div class="sourceCode" id="cb1156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1156-1"><a href="sect134.html#cb1156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NbClust)</span>
<span id="cb1156-2"><a href="sect134.html#cb1156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1156-3"><a href="sect134.html#cb1156-3" aria-hidden="true" tabindex="-1"></a><span class="co"># définition de la fonction adaptateur</span></span>
<span id="cb1156-4"><a href="sect134.html#cb1156-4" aria-hidden="true" tabindex="-1"></a>adaptor <span class="ot">&lt;-</span> <span class="cf">function</span>(x,k){</span>
<span id="cb1156-5"><a href="sect134.html#cb1156-5" aria-hidden="true" tabindex="-1"></a>  clust <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x,k)</span>
<span id="cb1156-6"><a href="sect134.html#cb1156-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb1156-7"><a href="sect134.html#cb1156-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;cluster&quot;</span> <span class="ot">=</span> clust<span class="sc">$</span>cluster</span>
<span id="cb1156-8"><a href="sect134.html#cb1156-8" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb1156-9"><a href="sect134.html#cb1156-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1156-10"><a href="sect134.html#cb1156-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1156-11"><a href="sect134.html#cb1156-11" aria-hidden="true" tabindex="-1"></a><span class="co"># calcul de la méthode GAP</span></span>
<span id="cb1156-12"><a href="sect134.html#cb1156-12" aria-hidden="true" tabindex="-1"></a>vals <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(X, adaptor, <span class="at">K.max =</span> <span class="dv">10</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1156-13"><a href="sect134.html#cb1156-13" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(vals<span class="sc">$</span>Tab)</span>
<span id="cb1156-14"><a href="sect134.html#cb1156-14" aria-hidden="true" tabindex="-1"></a>tab<span class="sc">$</span>k <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tab)</span>
<span id="cb1156-15"><a href="sect134.html#cb1156-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1156-16"><a href="sect134.html#cb1156-16" aria-hidden="true" tabindex="-1"></a><span class="co"># détermination des valeurs de k retenues par la méthode (1ere et 2e)</span></span>
<span id="cb1156-17"><a href="sect134.html#cb1156-17" aria-hidden="true" tabindex="-1"></a>is_valid <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(tab), <span class="cf">function</span>(i){</span>
<span id="cb1156-18"><a href="sect134.html#cb1156-18" aria-hidden="true" tabindex="-1"></a>  tab[i<span class="dv">-1</span>,<span class="st">&quot;gap&quot;</span>] <span class="sc">&gt;=</span> (tab[i,<span class="st">&quot;gap&quot;</span>] <span class="sc">-</span> tab[i,<span class="st">&quot;SE.sim&quot;</span>])</span>
<span id="cb1156-19"><a href="sect134.html#cb1156-19" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1156-20"><a href="sect134.html#cb1156-20" aria-hidden="true" tabindex="-1"></a>valids <span class="ot">&lt;-</span> <span class="fu">subset</span>(tab,is_valid)[<span class="dv">1</span>,]</span>
<span id="cb1156-21"><a href="sect134.html#cb1156-21" aria-hidden="true" tabindex="-1"></a>valids2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(tab,is_valid)[<span class="dv">2</span>,]</span>
<span id="cb1156-22"><a href="sect134.html#cb1156-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1156-23"><a href="sect134.html#cb1156-23" aria-hidden="true" tabindex="-1"></a><span class="co"># réalisation du graphique</span></span>
<span id="cb1156-24"><a href="sect134.html#cb1156-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab) <span class="sc">+</span> </span>
<span id="cb1156-25"><a href="sect134.html#cb1156-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> gap)) <span class="sc">+</span> </span>
<span id="cb1156-26"><a href="sect134.html#cb1156-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> valids<span class="sc">$</span>k, <span class="at">xend =</span> valids<span class="sc">$</span>k, <span class="at">y =</span> <span class="fu">min</span>(tab<span class="sc">$</span>gap), <span class="at">yend =</span> valids<span class="sc">$</span>gap, </span>
<span id="cb1156-27"><a href="sect134.html#cb1156-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb1156-28"><a href="sect134.html#cb1156-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> valids2<span class="sc">$</span>k, <span class="at">xend =</span> valids2<span class="sc">$</span>k, <span class="at">y =</span> <span class="fu">min</span>(tab<span class="sc">$</span>gap), <span class="at">yend =</span> valids2<span class="sc">$</span>gap, </span>
<span id="cb1156-29"><a href="sect134.html#cb1156-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb1156-30"><a href="sect134.html#cb1156-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> gap), <span class="at">color =</span> <span class="st">&#39;red&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1156-31"><a href="sect134.html#cb1156-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb1156-32"><a href="sect134.html#cb1156-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;nombre de groupes&quot;</span>, <span class="at">y =</span> <span class="st">&quot;GAP&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansE"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansE-1.png" alt="Méthode GAP pour différents nombres de groupes pour le k-means" width="75%" />
<p class="caption">
Figure 13.21: Méthode GAP pour différents nombres de groupes pour le k-means
</p>
</div>
<p>La figure <a href="sect134.html#fig:kmeansE">13.21</a> indique également que le nombre de groupes à retenir est trois. Nous retenons cependant quatre groupes pour pouvoir plus facilement comparer nos résultats avec ceux de l’article original.</p>
</div>
</div>
<div id="sect13443" class="section level4 hasAnchor" number="13.4.4.3">
<h4><span class="header-section-number">13.4.4.3</span> Application l’algorithme du <em>k-means</em><a href="sect134.html#sect13443" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Maintenant que nous avons choisi le nombre de groupes à former, nous pouvons simplement appliquer la fonction <code>kmeans</code> présente de base dans R.</p>
<div class="sourceCode" id="cb1157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1157-1"><a href="sect134.html#cb1157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">145</span>)</span>
<span id="cb1157-2"><a href="sect134.html#cb1157-2" aria-hidden="true" tabindex="-1"></a>resultats <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(X, <span class="at">centers =</span> <span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="sect13444" class="section level4 hasAnchor" number="13.4.4.4">
<h4><span class="header-section-number">13.4.4.4</span> Interprétation des résultats<a href="sect134.html#sect13444" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Une fois les groupes obtenus, l’étape la plus importante est de parvenir à interpréter ces groupes. Pour cela, il est nécessaire de les explorer en profondeur au travers des variables utilisées pour les constituer. Dans notre cas, le jeu de données <code>LyonIris</code> est spatialisé, nous pouvons donc commencer par cartographier les groupes.</p>
<div class="sourceCode" id="cb1158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1158-1"><a href="sect134.html#cb1158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb1158-2"><a href="sect134.html#cb1158-2" aria-hidden="true" tabindex="-1"></a>LyonIris<span class="sc">$</span>groupes <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;groupe&quot;</span>, resultats<span class="sc">$</span>cluster, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb1158-3"><a href="sect134.html#cb1158-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1158-4"><a href="sect134.html#cb1158-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(LyonIris) <span class="sc">+</span> </span>
<span id="cb1158-5"><a href="sect134.html#cb1158-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;groupes&quot;</span>, <span class="at">palette =</span></span>
<span id="cb1158-6"><a href="sect134.html#cb1158-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="st">&quot;#EFBE89&quot;</span>, <span class="st">&quot;#4A6A9F&quot;</span>, <span class="st">&quot;#7DB47C&quot;</span>, <span class="st">&quot;#FAF29C&quot;</span>),<span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansG"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansG-1.png" alt="Cartographie des groupes obtenus avec la méthode du k-means" width="75%" />
<p class="caption">
Figure 13.22: Cartographie des groupes obtenus avec la méthode du k-means
</p>
</div>
<p>Il est ainsi possible de constater que le groupe 3 forme un ensemble assez compact d’IRIS au centre de Lyon. Le groupe 4 correspond quant à lui à des IRIS situés en périphérie plutôt éloignée, essentiellement à l’ouest. Le groupe 1 correspond à une périphérie proche du groupe 2 et apparaît comme un ensemble d’enclaves dispersées.</p>
<p>Pour distinguer rapidement les profils des différents groupes, il est possible d’utiliser un graphique en radar. La construction d’un tel graphique peut être un peu fastidieuse dans R, cependant le <em>package</em> <code>geocmeans</code> propose une fonction assez pratique : <code>spiderPlots</code>.</p>
<div class="sourceCode" id="cb1159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1159-1"><a href="sect134.html#cb1159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geocmeans)</span>
<span id="cb1159-2"><a href="sect134.html#cb1159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1159-3"><a href="sect134.html#cb1159-3" aria-hidden="true" tabindex="-1"></a><span class="co"># création d&#39;une matrice d&#39;appartenance binaire des groupes</span></span>
<span id="cb1159-4"><a href="sect134.html#cb1159-4" aria-hidden="true" tabindex="-1"></a>matrice_gp <span class="ot">&lt;-</span> fastDummies<span class="sc">::</span><span class="fu">dummy_cols</span>(resultats<span class="sc">$</span>cluster, <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1159-5"><a href="sect134.html#cb1159-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1159-6"><a href="sect134.html#cb1159-6" aria-hidden="true" tabindex="-1"></a><span class="co"># réalisation du graphique</span></span>
<span id="cb1159-7"><a href="sect134.html#cb1159-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">mai =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>))</span>
<span id="cb1159-8"><a href="sect134.html#cb1159-8" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">spiderPlots</span>(X, matrice_gp, </span>
<span id="cb1159-9"><a href="sect134.html#cb1159-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chartcolors =</span> <span class="fu">c</span>(<span class="st">&quot;#EFBE89&quot;</span>, <span class="st">&quot;#4A6A9F&quot;</span>, <span class="st">&quot;#7DB47C&quot;</span>, <span class="st">&quot;#FAF29C&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansH"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansH-1.png" alt="Graphiques en radar pour les groupes issus du k-means" width="90%" />
<p class="caption">
Figure 13.23: Graphiques en radar pour les groupes issus du k-means
</p>
</div>
<p>Il est ainsi possible de constater, à la figure <a href="sect134.html#fig:kmeansH">13.23</a>, que le groupe 3 est caractérisé par un niveau de vie élevé, mais par des niveaux de concentration de pollution atmosphérique plus élevés également. Le groupe 4 en revanche est caractérisé par un important couvert végétal, un niveau de vie médian élevé et une plus forte proportion de personnes de plus de 65 ans. Le groupe 1 est quant à lui marqué par des niveaux sonores plus élevés. Enfin, le groupe 2 se caractérise par une plus grande proportion de population ayant obtenu comme diplôme le plus élevé le brevet des collèges, d’immigrants, de jeunes de moins de 15 ans et un taux de chômage plus élevé.</p>
<p>Notez que ces graphiques nous permettent rapidement de nous faire une idée des caractéristiques des groupes, mais uniquement sur une échelle relative. En effet, ils ne nous indiquent à aucun moment la taille des écarts entre les groupes. Pour cela, il est nécessaire de réaliser des graphiques en violon pour chaque variable. Pour ce type de graphique, il est préférable d’utiliser les données originales non transformées pour pouvoir mieux appréhender si les différences entre les groupes sont importantes ou négligeables.</p>
<div class="sourceCode" id="cb1160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1160-1"><a href="sect134.html#cb1160-1" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(LyonIris[<span class="fu">c</span>(<span class="st">&quot;Lden&quot;</span>,<span class="st">&quot;NO2&quot;</span>,<span class="st">&quot;PM25&quot;</span>,<span class="st">&quot;VegHautPrt&quot;</span>,<span class="st">&quot;Pct0_14&quot;</span>,</span>
<span id="cb1160-2"><a href="sect134.html#cb1160-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;Pct_65&quot;</span>,<span class="st">&quot;Pct_Img&quot;</span>,<span class="st">&quot;TxChom1564&quot;</span>,<span class="st">&quot;Pct_brevet&quot;</span>,</span>
<span id="cb1160-3"><a href="sect134.html#cb1160-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;NivVieMed&quot;</span>)])</span>
<span id="cb1160-4"><a href="sect134.html#cb1160-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1160-5"><a href="sect134.html#cb1160-5" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> <span class="fu">violinPlots</span>(X2, <span class="fu">as.character</span>(resultats<span class="sc">$</span>cluster))</span>
<span id="cb1160-6"><a href="sect134.html#cb1160-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="at">plotlist =</span> plots, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansI"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansI-1.png" alt="Graphiques en violon pour les groupes issus du k-means" width="100%" />
<p class="caption">
Figure 13.24: Graphiques en violon pour les groupes issus du k-means
</p>
</div>
<p>Il est également recommandé de calculer des statistiques descriptives par groupe et de les rapporter dans un tableau.</p>
<div class="sourceCode" id="cb1161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1161-1"><a href="sect134.html#cb1161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># obtention d&#39;un tableau par groupe</span></span>
<span id="cb1161-2"><a href="sect134.html#cb1161-2" aria-hidden="true" tabindex="-1"></a>tableaux <span class="ot">&lt;-</span> <span class="fu">summarizeClusters</span>(X2, matrice_gp, <span class="at">dec =</span> <span class="dv">1</span>, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1161-3"><a href="sect134.html#cb1161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1161-4"><a href="sect134.html#cb1161-4" aria-hidden="true" tabindex="-1"></a><span class="co"># concaténation des tableaux</span></span>
<span id="cb1161-5"><a href="sect134.html#cb1161-5" aria-hidden="true" tabindex="-1"></a>tableau_tot <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, tableaux)</span></code></pre></div>
<table>
<caption>
<span id="tab:kmeansK">Tableau 13.8: </span>Descriptions des quatre groupes obtenus
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Lden
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
PM25
</th>
<th style="text-align:right;">
VegHautPrt
</th>
<th style="text-align:right;">
Pct014
</th>
<th style="text-align:right;">
Pct65
</th>
<th style="text-align:right;">
PctImg
</th>
<th style="text-align:right;">
TxChom1564
</th>
<th style="text-align:right;">
Pctbrevet
</th>
<th style="text-align:right;">
NivVieMed
</th>
</tr>
</thead>
<tbody>
<tr grouplength="9">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>groupe 1</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q5
</td>
<td style="text-align:right;">
53,8
</td>
<td style="text-align:right;">
25,2
</td>
<td style="text-align:right;">
15,6
</td>
<td style="text-align:right;">
6,6
</td>
<td style="text-align:right;">
12,4
</td>
<td style="text-align:right;">
10,0
</td>
<td style="text-align:right;">
8,1
</td>
<td style="text-align:right;">
7,6
</td>
<td style="text-align:right;">
17,4
</td>
<td style="text-align:right;">
15 822,7
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q10
</td>
<td style="text-align:right;">
54,5
</td>
<td style="text-align:right;">
26,4
</td>
<td style="text-align:right;">
15,9
</td>
<td style="text-align:right;">
8,0
</td>
<td style="text-align:right;">
13,9
</td>
<td style="text-align:right;">
11,4
</td>
<td style="text-align:right;">
9,2
</td>
<td style="text-align:right;">
9,8
</td>
<td style="text-align:right;">
18,1
</td>
<td style="text-align:right;">
16 976,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q25
</td>
<td style="text-align:right;">
56,3
</td>
<td style="text-align:right;">
29,3
</td>
<td style="text-align:right;">
17,0
</td>
<td style="text-align:right;">
11,0
</td>
<td style="text-align:right;">
16,3
</td>
<td style="text-align:right;">
13,6
</td>
<td style="text-align:right;">
11,8
</td>
<td style="text-align:right;">
11,5
</td>
<td style="text-align:right;">
20,8
</td>
<td style="text-align:right;">
18 454,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q50
</td>
<td style="text-align:right;">
58,9
</td>
<td style="text-align:right;">
32,3
</td>
<td style="text-align:right;">
18,2
</td>
<td style="text-align:right;">
15,3
</td>
<td style="text-align:right;">
18,3
</td>
<td style="text-align:right;">
16,6
</td>
<td style="text-align:right;">
15,9
</td>
<td style="text-align:right;">
13,7
</td>
<td style="text-align:right;">
24,1
</td>
<td style="text-align:right;">
19 559,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q75
</td>
<td style="text-align:right;">
62,5
</td>
<td style="text-align:right;">
36,5
</td>
<td style="text-align:right;">
18,7
</td>
<td style="text-align:right;">
22,3
</td>
<td style="text-align:right;">
20,5
</td>
<td style="text-align:right;">
19,5
</td>
<td style="text-align:right;">
18,6
</td>
<td style="text-align:right;">
16,9
</td>
<td style="text-align:right;">
30,0
</td>
<td style="text-align:right;">
21 575,2
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q90
</td>
<td style="text-align:right;">
64,7
</td>
<td style="text-align:right;">
39,3
</td>
<td style="text-align:right;">
19,0
</td>
<td style="text-align:right;">
30,3
</td>
<td style="text-align:right;">
22,7
</td>
<td style="text-align:right;">
22,8
</td>
<td style="text-align:right;">
21,1
</td>
<td style="text-align:right;">
19,8
</td>
<td style="text-align:right;">
33,0
</td>
<td style="text-align:right;">
23 544,7
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q95
</td>
<td style="text-align:right;">
66,7
</td>
<td style="text-align:right;">
40,7
</td>
<td style="text-align:right;">
19,3
</td>
<td style="text-align:right;">
35,6
</td>
<td style="text-align:right;">
24,9
</td>
<td style="text-align:right;">
25,1
</td>
<td style="text-align:right;">
23,0
</td>
<td style="text-align:right;">
21,9
</td>
<td style="text-align:right;">
37,7
</td>
<td style="text-align:right;">
24 765,7
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Mean
</td>
<td style="text-align:right;">
59,6
</td>
<td style="text-align:right;">
32,7
</td>
<td style="text-align:right;">
17,8
</td>
<td style="text-align:right;">
17,2
</td>
<td style="text-align:right;">
18,2
</td>
<td style="text-align:right;">
16,7
</td>
<td style="text-align:right;">
15,7
</td>
<td style="text-align:right;">
14,1
</td>
<td style="text-align:right;">
25,5
</td>
<td style="text-align:right;">
19 948,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Std
</td>
<td style="text-align:right;">
4,2
</td>
<td style="text-align:right;">
5,2
</td>
<td style="text-align:right;">
1,2
</td>
<td style="text-align:right;">
8,5
</td>
<td style="text-align:right;">
4,0
</td>
<td style="text-align:right;">
4,7
</td>
<td style="text-align:right;">
6,5
</td>
<td style="text-align:right;">
4,3
</td>
<td style="text-align:right;">
7,6
</td>
<td style="text-align:right;">
2 637,2
</td>
</tr>
<tr grouplength="9">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>groupe 2</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q5
</td>
<td style="text-align:right;">
50,8
</td>
<td style="text-align:right;">
19,3
</td>
<td style="text-align:right;">
13,9
</td>
<td style="text-align:right;">
6,1
</td>
<td style="text-align:right;">
18,3
</td>
<td style="text-align:right;">
6,4
</td>
<td style="text-align:right;">
17,7
</td>
<td style="text-align:right;">
16,5
</td>
<td style="text-align:right;">
30,5
</td>
<td style="text-align:right;">
12 323,5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q10
</td>
<td style="text-align:right;">
52,0
</td>
<td style="text-align:right;">
20,2
</td>
<td style="text-align:right;">
14,3
</td>
<td style="text-align:right;">
7,8
</td>
<td style="text-align:right;">
20,0
</td>
<td style="text-align:right;">
8,7
</td>
<td style="text-align:right;">
20,2
</td>
<td style="text-align:right;">
16,8
</td>
<td style="text-align:right;">
32,9
</td>
<td style="text-align:right;">
12 747,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q25
</td>
<td style="text-align:right;">
53,9
</td>
<td style="text-align:right;">
23,0
</td>
<td style="text-align:right;">
15,3
</td>
<td style="text-align:right;">
11,2
</td>
<td style="text-align:right;">
22,8
</td>
<td style="text-align:right;">
10,7
</td>
<td style="text-align:right;">
23,5
</td>
<td style="text-align:right;">
19,6
</td>
<td style="text-align:right;">
36,2
</td>
<td style="text-align:right;">
13 530,5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q50
</td>
<td style="text-align:right;">
56,4
</td>
<td style="text-align:right;">
25,1
</td>
<td style="text-align:right;">
16,2
</td>
<td style="text-align:right;">
14,5
</td>
<td style="text-align:right;">
25,2
</td>
<td style="text-align:right;">
13,6
</td>
<td style="text-align:right;">
28,0
</td>
<td style="text-align:right;">
24,5
</td>
<td style="text-align:right;">
39,9
</td>
<td style="text-align:right;">
15 340,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q75
</td>
<td style="text-align:right;">
58,4
</td>
<td style="text-align:right;">
29,4
</td>
<td style="text-align:right;">
17,0
</td>
<td style="text-align:right;">
18,1
</td>
<td style="text-align:right;">
27,8
</td>
<td style="text-align:right;">
16,9
</td>
<td style="text-align:right;">
33,5
</td>
<td style="text-align:right;">
32,5
</td>
<td style="text-align:right;">
46,0
</td>
<td style="text-align:right;">
16 342,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q90
</td>
<td style="text-align:right;">
63,1
</td>
<td style="text-align:right;">
33,7
</td>
<td style="text-align:right;">
18,5
</td>
<td style="text-align:right;">
24,4
</td>
<td style="text-align:right;">
31,3
</td>
<td style="text-align:right;">
20,2
</td>
<td style="text-align:right;">
38,2
</td>
<td style="text-align:right;">
36,3
</td>
<td style="text-align:right;">
50,2
</td>
<td style="text-align:right;">
18 363,9
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q95
</td>
<td style="text-align:right;">
64,9
</td>
<td style="text-align:right;">
39,0
</td>
<td style="text-align:right;">
19,1
</td>
<td style="text-align:right;">
28,1
</td>
<td style="text-align:right;">
32,8
</td>
<td style="text-align:right;">
21,4
</td>
<td style="text-align:right;">
41,1
</td>
<td style="text-align:right;">
38,0
</td>
<td style="text-align:right;">
60,2
</td>
<td style="text-align:right;">
20 128,6
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Mean
</td>
<td style="text-align:right;">
56,8
</td>
<td style="text-align:right;">
26,3
</td>
<td style="text-align:right;">
16,2
</td>
<td style="text-align:right;">
15,4
</td>
<td style="text-align:right;">
25,4
</td>
<td style="text-align:right;">
13,8
</td>
<td style="text-align:right;">
28,5
</td>
<td style="text-align:right;">
26,6
</td>
<td style="text-align:right;">
42,0
</td>
<td style="text-align:right;">
15 401,4
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Std
</td>
<td style="text-align:right;">
4,1
</td>
<td style="text-align:right;">
6,3
</td>
<td style="text-align:right;">
1,5
</td>
<td style="text-align:right;">
6,8
</td>
<td style="text-align:right;">
6,2
</td>
<td style="text-align:right;">
4,8
</td>
<td style="text-align:right;">
8,0
</td>
<td style="text-align:right;">
10,5
</td>
<td style="text-align:right;">
11,3
</td>
<td style="text-align:right;">
2 340,4
</td>
</tr>
<tr grouplength="9">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>groupe 3</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q5
</td>
<td style="text-align:right;">
50,2
</td>
<td style="text-align:right;">
28,3
</td>
<td style="text-align:right;">
17,0
</td>
<td style="text-align:right;">
5,0
</td>
<td style="text-align:right;">
6,8
</td>
<td style="text-align:right;">
5,2
</td>
<td style="text-align:right;">
5,8
</td>
<td style="text-align:right;">
7,7
</td>
<td style="text-align:right;">
6,7
</td>
<td style="text-align:right;">
19 029,9
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q10
</td>
<td style="text-align:right;">
51,2
</td>
<td style="text-align:right;">
29,5
</td>
<td style="text-align:right;">
17,6
</td>
<td style="text-align:right;">
6,6
</td>
<td style="text-align:right;">
9,5
</td>
<td style="text-align:right;">
7,2
</td>
<td style="text-align:right;">
6,7
</td>
<td style="text-align:right;">
8,5
</td>
<td style="text-align:right;">
7,7
</td>
<td style="text-align:right;">
19 546,4
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q25
</td>
<td style="text-align:right;">
53,2
</td>
<td style="text-align:right;">
31,3
</td>
<td style="text-align:right;">
18,6
</td>
<td style="text-align:right;">
9,2
</td>
<td style="text-align:right;">
11,4
</td>
<td style="text-align:right;">
9,5
</td>
<td style="text-align:right;">
7,9
</td>
<td style="text-align:right;">
11,0
</td>
<td style="text-align:right;">
9,5
</td>
<td style="text-align:right;">
21 652,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q50
</td>
<td style="text-align:right;">
55,2
</td>
<td style="text-align:right;">
35,4
</td>
<td style="text-align:right;">
19,3
</td>
<td style="text-align:right;">
12,6
</td>
<td style="text-align:right;">
14,1
</td>
<td style="text-align:right;">
12,4
</td>
<td style="text-align:right;">
11,0
</td>
<td style="text-align:right;">
12,9
</td>
<td style="text-align:right;">
12,0
</td>
<td style="text-align:right;">
23 342,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q75
</td>
<td style="text-align:right;">
58,0
</td>
<td style="text-align:right;">
39,6
</td>
<td style="text-align:right;">
19,8
</td>
<td style="text-align:right;">
16,0
</td>
<td style="text-align:right;">
16,2
</td>
<td style="text-align:right;">
16,0
</td>
<td style="text-align:right;">
13,1
</td>
<td style="text-align:right;">
15,1
</td>
<td style="text-align:right;">
14,8
</td>
<td style="text-align:right;">
25 954,1
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q90
</td>
<td style="text-align:right;">
60,0
</td>
<td style="text-align:right;">
43,0
</td>
<td style="text-align:right;">
20,1
</td>
<td style="text-align:right;">
21,0
</td>
<td style="text-align:right;">
18,2
</td>
<td style="text-align:right;">
18,9
</td>
<td style="text-align:right;">
16,3
</td>
<td style="text-align:right;">
18,0
</td>
<td style="text-align:right;">
16,6
</td>
<td style="text-align:right;">
28 951,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q95
</td>
<td style="text-align:right;">
61,2
</td>
<td style="text-align:right;">
44,4
</td>
<td style="text-align:right;">
20,4
</td>
<td style="text-align:right;">
29,3
</td>
<td style="text-align:right;">
19,5
</td>
<td style="text-align:right;">
20,9
</td>
<td style="text-align:right;">
17,7
</td>
<td style="text-align:right;">
19,3
</td>
<td style="text-align:right;">
19,1
</td>
<td style="text-align:right;">
31 922,5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Mean
</td>
<td style="text-align:right;">
55,6
</td>
<td style="text-align:right;">
35,8
</td>
<td style="text-align:right;">
19,0
</td>
<td style="text-align:right;">
13,6
</td>
<td style="text-align:right;">
13,8
</td>
<td style="text-align:right;">
12,6
</td>
<td style="text-align:right;">
11,1
</td>
<td style="text-align:right;">
13,1
</td>
<td style="text-align:right;">
12,1
</td>
<td style="text-align:right;">
23 999,7
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Std
</td>
<td style="text-align:right;">
3,7
</td>
<td style="text-align:right;">
5,6
</td>
<td style="text-align:right;">
1,0
</td>
<td style="text-align:right;">
6,8
</td>
<td style="text-align:right;">
4,2
</td>
<td style="text-align:right;">
4,7
</td>
<td style="text-align:right;">
4,6
</td>
<td style="text-align:right;">
4,4
</td>
<td style="text-align:right;">
4,0
</td>
<td style="text-align:right;">
3 870,3
</td>
</tr>
<tr grouplength="9">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>groupe 4</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q5
</td>
<td style="text-align:right;">
44,9
</td>
<td style="text-align:right;">
14,7
</td>
<td style="text-align:right;">
12,7
</td>
<td style="text-align:right;">
8,2
</td>
<td style="text-align:right;">
13,1
</td>
<td style="text-align:right;">
12,7
</td>
<td style="text-align:right;">
3,8
</td>
<td style="text-align:right;">
6,7
</td>
<td style="text-align:right;">
10,8
</td>
<td style="text-align:right;">
19 496,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q10
</td>
<td style="text-align:right;">
46,6
</td>
<td style="text-align:right;">
15,7
</td>
<td style="text-align:right;">
13,0
</td>
<td style="text-align:right;">
11,8
</td>
<td style="text-align:right;">
14,9
</td>
<td style="text-align:right;">
13,5
</td>
<td style="text-align:right;">
4,4
</td>
<td style="text-align:right;">
7,0
</td>
<td style="text-align:right;">
12,4
</td>
<td style="text-align:right;">
20 257,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q25
</td>
<td style="text-align:right;">
50,3
</td>
<td style="text-align:right;">
19,0
</td>
<td style="text-align:right;">
13,8
</td>
<td style="text-align:right;">
16,7
</td>
<td style="text-align:right;">
17,1
</td>
<td style="text-align:right;">
16,1
</td>
<td style="text-align:right;">
6,0
</td>
<td style="text-align:right;">
8,0
</td>
<td style="text-align:right;">
15,7
</td>
<td style="text-align:right;">
21 963,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q50
</td>
<td style="text-align:right;">
52,6
</td>
<td style="text-align:right;">
22,0
</td>
<td style="text-align:right;">
14,7
</td>
<td style="text-align:right;">
24,9
</td>
<td style="text-align:right;">
18,9
</td>
<td style="text-align:right;">
19,3
</td>
<td style="text-align:right;">
8,1
</td>
<td style="text-align:right;">
9,8
</td>
<td style="text-align:right;">
20,0
</td>
<td style="text-align:right;">
24 109,8
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q75
</td>
<td style="text-align:right;">
54,9
</td>
<td style="text-align:right;">
25,2
</td>
<td style="text-align:right;">
15,5
</td>
<td style="text-align:right;">
32,6
</td>
<td style="text-align:right;">
20,8
</td>
<td style="text-align:right;">
22,8
</td>
<td style="text-align:right;">
10,9
</td>
<td style="text-align:right;">
12,0
</td>
<td style="text-align:right;">
25,6
</td>
<td style="text-align:right;">
26 698,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q90
</td>
<td style="text-align:right;">
57,7
</td>
<td style="text-align:right;">
27,5
</td>
<td style="text-align:right;">
16,3
</td>
<td style="text-align:right;">
41,2
</td>
<td style="text-align:right;">
22,3
</td>
<td style="text-align:right;">
27,4
</td>
<td style="text-align:right;">
14,5
</td>
<td style="text-align:right;">
14,7
</td>
<td style="text-align:right;">
30,6
</td>
<td style="text-align:right;">
29 947,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Q95
</td>
<td style="text-align:right;">
59,1
</td>
<td style="text-align:right;">
28,7
</td>
<td style="text-align:right;">
16,8
</td>
<td style="text-align:right;">
43,6
</td>
<td style="text-align:right;">
22,7
</td>
<td style="text-align:right;">
29,7
</td>
<td style="text-align:right;">
18,1
</td>
<td style="text-align:right;">
16,6
</td>
<td style="text-align:right;">
33,1
</td>
<td style="text-align:right;">
32 386,5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Mean
</td>
<td style="text-align:right;">
52,3
</td>
<td style="text-align:right;">
21,8
</td>
<td style="text-align:right;">
14,7
</td>
<td style="text-align:right;">
25,5
</td>
<td style="text-align:right;">
18,6
</td>
<td style="text-align:right;">
20,1
</td>
<td style="text-align:right;">
8,8
</td>
<td style="text-align:right;">
10,4
</td>
<td style="text-align:right;">
21,1
</td>
<td style="text-align:right;">
24 761,6
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
Std
</td>
<td style="text-align:right;">
4,3
</td>
<td style="text-align:right;">
4,4
</td>
<td style="text-align:right;">
1,2
</td>
<td style="text-align:right;">
11,0
</td>
<td style="text-align:right;">
3,1
</td>
<td style="text-align:right;">
5,6
</td>
<td style="text-align:right;">
4,2
</td>
<td style="text-align:right;">
3,4
</td>
<td style="text-align:right;">
7,6
</td>
<td style="text-align:right;">
4 008,7
</td>
</tr>
</tbody>
</table>
<p>Les constats que nous avons faits précédemment sont confirmés par la figure <a href="sect134.html#fig:kmeansI">13.24</a> et le tableau <a href="sect134.html#tab:kmeansK">13.8</a>. Nous retrouvons ici les groupes originaux décrits dans l’article de <span class="citation">Gelb et Apparicio (<a href="#ref-2021_4" role="doc-biblioref">2021b</a>)</span> :</p>
<ul>
<li><strong>Groupe 1</strong> : les espaces interstitiels, formant une périphérie proche du centre et relativement hétérogène sur les variables étudiées, mais caractérisée par des niveaux de bruit importants.</li>
<li><strong>Groupe 2</strong> : les banlieues jeunes et défavorisées, avec des niveaux d’exposition aux pollutions atmosphérique et sonore relativement élevés comparativement à l’ensemble de la région.</li>
<li><strong>Groupe 3</strong> : les quartiers centraux aisés, mais marqués par les plus hauts niveaux de pollution atmosphérique.</li>
<li><strong>Groupe 4</strong> : les communes rurales, aisées et vieillissantes.</li>
</ul>
<div class="bloc_astuce">
<p><strong>Interprétation interactive</strong></p>
<p>Si, comme dans notre exemple, vos données comportent une dimension spatiale, le <em>package</em> <code>geocmeans</code> propose une fonction intéressante appelée <code>sp_clust_explorer</code> démarrant une application permettant d’explorer les résultats de votre classification. Le seul enjeu est de créer un objet de la classe <code>FCMres</code>. Voici un court exemple :</p>
<div class="sourceCode" id="cb1162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1162-1"><a href="sect134.html#cb1162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># création d&#39;une matrice binaire d&#39;appartenance</span></span>
<span id="cb1162-2"><a href="sect134.html#cb1162-2" aria-hidden="true" tabindex="-1"></a>kmeans_mat <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(resultats<span class="sc">$</span>cluster, <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1162-3"><a href="sect134.html#cb1162-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1162-4"><a href="sect134.html#cb1162-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extraction des centres de notre classification</span></span>
<span id="cb1162-5"><a href="sect134.html#cb1162-5" aria-hidden="true" tabindex="-1"></a>centres <span class="ot">&lt;-</span> resultats<span class="sc">$</span>centers</span>
<span id="cb1162-6"><a href="sect134.html#cb1162-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1162-7"><a href="sect134.html#cb1162-7" aria-hidden="true" tabindex="-1"></a><span class="co"># création de l&#39;objet FCMres</span></span>
<span id="cb1162-8"><a href="sect134.html#cb1162-8" aria-hidden="true" tabindex="-1"></a>kmeansres <span class="ot">&lt;-</span> <span class="fu">FCMres</span>(<span class="fu">list</span>(</span>
<span id="cb1162-9"><a href="sect134.html#cb1162-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Centers&quot;</span> <span class="ot">=</span> centres,</span>
<span id="cb1162-10"><a href="sect134.html#cb1162-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Belongings&quot;</span> <span class="ot">=</span> kmeans_mat,</span>
<span id="cb1162-11"><a href="sect134.html#cb1162-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Data&quot;</span> <span class="ot">=</span> X2,</span>
<span id="cb1162-12"><a href="sect134.html#cb1162-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;m&quot;</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb1162-13"><a href="sect134.html#cb1162-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;algo&quot;</span> <span class="ot">=</span> <span class="st">&quot;kmeans&quot;</span></span>
<span id="cb1162-14"><a href="sect134.html#cb1162-14" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb1162-15"><a href="sect134.html#cb1162-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1162-16"><a href="sect134.html#cb1162-16" aria-hidden="true" tabindex="-1"></a><span class="co"># démarrage de l&#39;application shiny</span></span>
<span id="cb1162-17"><a href="sect134.html#cb1162-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sp_clust_explorer</span>(<span class="at">object =</span> kmeansres, <span class="at">spatial =</span> LyonIris)</span></code></pre></div>
</div>
</div>
<div id="sect13455" class="section level4 hasAnchor" number="13.4.4.5">
<h4><span class="header-section-number">13.4.4.5</span> K-médianes et K-médoides<a href="sect134.html#sect13455" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous présentons simplement ici comment effectuer la même analyse en utilisant les variantes du <em>k-means</em>, soit le <em>k-medians</em> et le <em>k-mediods</em>.</p>
<p>Il existe relativement peu d’implémentation du <em>k-medians</em> dans R, nous optons donc ici pour la fonction <code>kGmedian</code> du <em>package</em> <code>Gmedian</code>. Pour le <em>k-mediods</em>, nous avons retenu la fonction <code>pam</code> du <em>package</em> <code>cluster</code>.</p>
<div class="sourceCode" id="cb1163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1163-1"><a href="sect134.html#cb1163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Gmedian)</span>
<span id="cb1163-2"><a href="sect134.html#cb1163-2" aria-hidden="true" tabindex="-1"></a>k_median_res <span class="ot">&lt;-</span> <span class="fu">kGmedian</span>(X, <span class="dv">4</span>)</span>
<span id="cb1163-3"><a href="sect134.html#cb1163-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1163-4"><a href="sect134.html#cb1163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb1163-5"><a href="sect134.html#cb1163-5" aria-hidden="true" tabindex="-1"></a>k_mediods_res <span class="ot">&lt;-</span> <span class="fu">pam</span>(X,<span class="dv">4</span>)</span></code></pre></div>
<p>Juste pour le plaisir des yeux, nous pouvons cartographier les trois classifications obtenues en nous assurant au préalable de faire coïncider les groupes les plus similaires de nos trois classifications.</p>
<div class="sourceCode" id="cb1164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1164-1"><a href="sect134.html#cb1164-1" aria-hidden="true" tabindex="-1"></a>matrice_gp_kmeans <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(resultats<span class="sc">$</span>cluster,</span>
<span id="cb1164-2"><a href="sect134.html#cb1164-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1164-3"><a href="sect134.html#cb1164-3" aria-hidden="true" tabindex="-1"></a>matrice_gp_kmedians <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(<span class="fu">as.vector</span>(k_median_res<span class="sc">$</span>cluster),</span>
<span id="cb1164-4"><a href="sect134.html#cb1164-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1164-5"><a href="sect134.html#cb1164-5" aria-hidden="true" tabindex="-1"></a>matrice_gp_kmedioids <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(k_mediods_res<span class="sc">$</span>cluster,</span>
<span id="cb1164-6"><a href="sect134.html#cb1164-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1164-7"><a href="sect134.html#cb1164-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1164-8"><a href="sect134.html#cb1164-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Appariement des groupes du k-medians avec ceux du kmeans</span></span>
<span id="cb1164-9"><a href="sect134.html#cb1164-9" aria-hidden="true" tabindex="-1"></a>matrice_gp_kmedians <span class="ot">&lt;-</span> geocmeans<span class="sc">::</span><span class="fu">groups_matching</span>(<span class="fu">as.matrix</span>(matrice_gp_kmeans),</span>
<span id="cb1164-10"><a href="sect134.html#cb1164-10" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">as.matrix</span>(matrice_gp_kmedians))</span>
<span id="cb1164-11"><a href="sect134.html#cb1164-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1164-12"><a href="sect134.html#cb1164-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Appariement des groupes du k-medioids avec ceux du kmeans</span></span>
<span id="cb1164-13"><a href="sect134.html#cb1164-13" aria-hidden="true" tabindex="-1"></a>matrice_gp_kmedioids <span class="ot">&lt;-</span> geocmeans<span class="sc">::</span><span class="fu">groups_matching</span>(<span class="fu">as.matrix</span>(matrice_gp_kmeans),</span>
<span id="cb1164-14"><a href="sect134.html#cb1164-14" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">as.matrix</span>(matrice_gp_kmedioids))</span>
<span id="cb1164-15"><a href="sect134.html#cb1164-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1164-16"><a href="sect134.html#cb1164-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ajouts des colonnes nécessaires à LyonIris</span></span>
<span id="cb1164-17"><a href="sect134.html#cb1164-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrice_gp_kmeans) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;groupe_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb1164-18"><a href="sect134.html#cb1164-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrice_gp_kmedians) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;groupe_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb1164-19"><a href="sect134.html#cb1164-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(matrice_gp_kmedioids) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;groupe_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb1164-20"><a href="sect134.html#cb1164-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1164-21"><a href="sect134.html#cb1164-21" aria-hidden="true" tabindex="-1"></a>LyonIris<span class="sc">$</span>kmeans <span class="ot">&lt;-</span> <span class="fu">colnames</span>(matrice_gp_kmeans)[<span class="fu">max.col</span>(matrice_gp_kmeans)]</span>
<span id="cb1164-22"><a href="sect134.html#cb1164-22" aria-hidden="true" tabindex="-1"></a>LyonIris<span class="sc">$</span>kmedians <span class="ot">&lt;-</span> <span class="fu">colnames</span>(matrice_gp_kmedians)[<span class="fu">max.col</span>(matrice_gp_kmedians)]</span>
<span id="cb1164-23"><a href="sect134.html#cb1164-23" aria-hidden="true" tabindex="-1"></a>LyonIris<span class="sc">$</span>kmedioids <span class="ot">&lt;-</span> <span class="fu">colnames</span>(matrice_gp_kmedioids)[<span class="fu">max.col</span>(matrice_gp_kmedioids)]</span>
<span id="cb1164-24"><a href="sect134.html#cb1164-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1164-25"><a href="sect134.html#cb1164-25" aria-hidden="true" tabindex="-1"></a><span class="co"># construction de la figure</span></span>
<span id="cb1164-26"><a href="sect134.html#cb1164-26" aria-hidden="true" tabindex="-1"></a>couleurs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#EFBE89&quot;</span>, <span class="st">&quot;#4A6A9F&quot;</span>, <span class="st">&quot;#7DB47C&quot;</span>, <span class="st">&quot;#FAF29C&quot;</span>)</span>
<span id="cb1164-27"><a href="sect134.html#cb1164-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1164-28"><a href="sect134.html#cb1164-28" aria-hidden="true" tabindex="-1"></a>map1 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(LyonIris) <span class="sc">+</span> </span>
<span id="cb1164-29"><a href="sect134.html#cb1164-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;kmeans&quot;</span>,<span class="at">palette =</span> couleurs,<span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">0.1</span>)</span>
<span id="cb1164-30"><a href="sect134.html#cb1164-30" aria-hidden="true" tabindex="-1"></a>map2 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(LyonIris) <span class="sc">+</span> </span>
<span id="cb1164-31"><a href="sect134.html#cb1164-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;kmedians&quot;</span>,<span class="at">palette =</span> couleurs,<span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">0.1</span>)</span>
<span id="cb1164-32"><a href="sect134.html#cb1164-32" aria-hidden="true" tabindex="-1"></a>map3 <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(LyonIris) <span class="sc">+</span> </span>
<span id="cb1164-33"><a href="sect134.html#cb1164-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;kmedioids&quot;</span>,<span class="at">palette =</span> couleurs,<span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="fl">0.1</span>)</span>
<span id="cb1164-34"><a href="sect134.html#cb1164-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1164-35"><a href="sect134.html#cb1164-35" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(map1, map2, map3, </span>
<span id="cb1164-36"><a href="sect134.html#cb1164-36" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansM"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansM-1.png" alt="Comparaison géographique des résultats obtenus pour le k-means, le k-medians et le k-medoids" width="100%" />
<p class="caption">
Figure 13.25: Comparaison géographique des résultats obtenus pour le k-means, le k-medians et le k-medoids
</p>
</div>
<p>Les trois cartes sont très similaires (figure <a href="sect134.html#fig:kmeansM">13.25</a>), ce qui signifie que les trois algorithmes tendent à attribuer les observations aux mêmes groupes. Cependant, nous observons des différences, notamment au nord avec des observations alternant entre les groupes 2 et 3 selon la méthode employée. Cela peut notamment signifier que ces observations sont « indécises », qu’il est difficile de les attribuer définitivement à une catégorie en particulier. Pour prendre en compte cette forme d’incertitude, il est possible d’opter pour des méthodes de classification en logique floue.</p>
</div>
</div>
<div id="sect1346" class="section level3 hasAnchor" number="13.4.5">
<h3><span class="header-section-number">13.4.5</span> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em><a href="sect134.html#sect1346" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comme nous l’avons mentionné en introduction de cette section, les méthodes de classification floues ont pour objectif d’évaluer le degré d’appartenance de chaque observation à chaque groupe plutôt que d’attribuer chaque observation à un seul groupe. Il est ainsi possible de repérer des observations incertaines, à cheval entre plusieurs groupes. Nous présentons ici deux algorithmes appartenant à cette famille : le <em>c-means</em> et le <em>c-medoids</em>. Il s’agit dans les deux cas d’extensions des <em>k-means</em> et <em>k-medoids</em> vus précédemment.</p>
<p>Pour ces deux méthodes, comme pour le <em>k-means</em>, le nombre de groupes <em>k</em> doit être spécifié. Elles comprennent cependant un paramètre supplémentaire : <em>m</em>, appelé paramètre de floutage qui contrôle à quel point le résultat obtenu sera flou ou strict. Une valeur de 1 produit une classification stricte (chaque observation appartient à un seul groupe) et une valeur plus grande conduit à des classifications de plus en plus floues, jusqu’à ce que chaque observation appartienne à un degré identique à chacun des groupes. Il est recommandé de sélectionner <em>m</em> en même temps que <em>k</em>, car ces deux valeurs influencent simultanément la qualité de la classification. La meilleure approche consiste à tester un ensemble de combinaisons de <em>m</em> et de <em>k</em> et à comparer les valeurs obtenues pour différents indicateurs de qualité de classification floue. Parmi ces indicateurs, il est notamment recommandé d’utiliser le pourcentage de l’inertie expliquée, l’indice de silhouette pour classification floue, l’indice de Xie et Beni <span class="citation">(<a href="#ref-xie1991validity" role="doc-biblioref">1991</a>)</span>, et de Fukuyama et Sugeno <span class="citation">(<a href="#ref-fukuyama1989" role="doc-biblioref">Fukuyama 1989</a>)</span>.</p>
<div id="sect13461" class="section level4 hasAnchor" number="13.4.5.1">
<h4><span class="header-section-number">13.4.5.1</span> Mise en oeuvre du <em>c-means</em> dans R<a href="sect134.html#sect13461" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le <em>package</em> <code>fclust</code> comprend un très grand nombre de méthodes pour effectuer des classifications floues, nous l’utilisons donc en priorité ici en combinaison avec des fonctions d’interprétation du <em>package</em> <code>geocmeans</code>.</p>
<div id="préparation-des-données" class="section level5 hasAnchor" number="13.4.5.1.1">
<h5><span class="header-section-number">13.4.5.1.1</span> Préparation des données<a href="sect134.html#préparation-des-données" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Comme pour le <em>k-means</em>, cette méthode nécessite de disposer d’un jeu de données ne comprenant que des variables quantitatives dans la même échelle. Nous commençons donc à nouveau par standardiser nos données. Pour varier les plaisirs, nous optons cette fois-ci pour une transformation des variables dans une échelle allant de 0 à 100.</p>
<div class="sourceCode" id="cb1165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1165-1"><a href="sect134.html#cb1165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fclust)</span>
<span id="cb1165-2"><a href="sect134.html#cb1165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1165-3"><a href="sect134.html#cb1165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(LyonIris)</span>
<span id="cb1165-4"><a href="sect134.html#cb1165-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1165-5"><a href="sect134.html#cb1165-5" aria-hidden="true" tabindex="-1"></a><span class="co"># NB : LyonIris est un objet spatial, il faut donc extraire uniquement son DataFrame</span></span>
<span id="cb1165-6"><a href="sect134.html#cb1165-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(LyonIris[<span class="fu">c</span>(<span class="st">&quot;Lden&quot;</span>,<span class="st">&quot;NO2&quot;</span>,<span class="st">&quot;PM25&quot;</span>,<span class="st">&quot;VegHautPrt&quot;</span>,<span class="st">&quot;Pct0_14&quot;</span>,</span>
<span id="cb1165-7"><a href="sect134.html#cb1165-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Pct_65&quot;</span>,<span class="st">&quot;Pct_Img&quot;</span>,</span>
<span id="cb1165-8"><a href="sect134.html#cb1165-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;TxChom1564&quot;</span>,<span class="st">&quot;Pct_brevet&quot;</span>,<span class="st">&quot;NivVieMed&quot;</span>)])</span>
<span id="cb1165-9"><a href="sect134.html#cb1165-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1165-10"><a href="sect134.html#cb1165-10" aria-hidden="true" tabindex="-1"></a><span class="co"># changement d&#39;échelle des données (0 à 100)</span></span>
<span id="cb1165-11"><a href="sect134.html#cb1165-11" aria-hidden="true" tabindex="-1"></a>to_0_100 <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb1165-12"><a href="sect134.html#cb1165-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x<span class="sc">-</span><span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb1165-13"><a href="sect134.html#cb1165-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1165-14"><a href="sect134.html#cb1165-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1165-15"><a href="sect134.html#cb1165-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(X)){</span>
<span id="cb1165-16"><a href="sect134.html#cb1165-16" aria-hidden="true" tabindex="-1"></a>  X[[col]] <span class="ot">&lt;-</span> <span class="fu">to_0_100</span>(X[[col]])</span>
<span id="cb1165-17"><a href="sect134.html#cb1165-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="sélection-de-k-et-de-m" class="section level5 hasAnchor" number="13.4.5.1.2">
<h5><span class="header-section-number">13.4.5.1.2</span> Sélection de <em>k</em> et de <em>m</em><a href="sect134.html#sélection-de-k-et-de-m" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>La seconde étape consiste à sélectionner les valeurs optimales pour <em>k</em> et <em>m</em>. Nous testons ici toutes les valeurs de k de 2 à 7, et les valeurs de <em>m</em> de 1,5 à 2,5 (avec des écarts de 0,1).</p>
<div class="sourceCode" id="cb1166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1166-1"><a href="sect134.html#cb1166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb1166-2"><a href="sect134.html#cb1166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1166-3"><a href="sect134.html#cb1166-3" aria-hidden="true" tabindex="-1"></a>ms <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb1166-4"><a href="sect134.html#cb1166-4" aria-hidden="true" tabindex="-1"></a>ks <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb1166-5"><a href="sect134.html#cb1166-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-6"><a href="sect134.html#cb1166-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-7"><a href="sect134.html#cb1166-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calcul de toutes les combinaisons</span></span>
<span id="cb1166-8"><a href="sect134.html#cb1166-8" aria-hidden="true" tabindex="-1"></a>combinaisons <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(ms,ks)</span>
<span id="cb1166-9"><a href="sect134.html#cb1166-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-10"><a href="sect134.html#cb1166-10" aria-hidden="true" tabindex="-1"></a>eval_indices <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Explained.inertia&quot;</span>, <span class="st">&quot;Silhouette.index&quot;</span>, <span class="st">&quot;FukuyamaSugeno.index&quot;</span>)</span>
<span id="cb1166-11"><a href="sect134.html#cb1166-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-12"><a href="sect134.html#cb1166-12" aria-hidden="true" tabindex="-1"></a>values <span class="ot">&lt;-</span> <span class="fu">apply</span>(combinaisons, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> <span class="cf">function</span>(row){</span>
<span id="cb1166-13"><a href="sect134.html#cb1166-13" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> row[[<span class="dv">1</span>]]</span>
<span id="cb1166-14"><a href="sect134.html#cb1166-14" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> row[[<span class="dv">2</span>]]</span>
<span id="cb1166-15"><a href="sect134.html#cb1166-15" aria-hidden="true" tabindex="-1"></a>  resultats <span class="ot">&lt;-</span> <span class="fu">FKM</span>(X, k, m)</span>
<span id="cb1166-16"><a href="sect134.html#cb1166-16" aria-hidden="true" tabindex="-1"></a>  idx <span class="ot">&lt;-</span> geocmeans<span class="sc">::</span><span class="fu">calcqualityIndexes</span>(<span class="fu">as.matrix</span>(X),</span>
<span id="cb1166-17"><a href="sect134.html#cb1166-17" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">as.matrix</span>(resultats<span class="sc">$</span>U), </span>
<span id="cb1166-18"><a href="sect134.html#cb1166-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">m =</span> m,</span>
<span id="cb1166-19"><a href="sect134.html#cb1166-19" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">indices =</span> eval_indices)</span>
<span id="cb1166-20"><a href="sect134.html#cb1166-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(k,m,<span class="fu">unlist</span>(idx)))</span>
<span id="cb1166-21"><a href="sect134.html#cb1166-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb1166-22"><a href="sect134.html#cb1166-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-23"><a href="sect134.html#cb1166-23" aria-hidden="true" tabindex="-1"></a>df_scores <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(values))</span>
<span id="cb1166-24"><a href="sect134.html#cb1166-24" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df_scores) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;m&quot;</span>, <span class="st">&quot;inertie&quot;</span>, <span class="st">&quot;silhouette&quot;</span>, <span class="st">&quot;FukuyamaSugeno&quot;</span>)</span>
<span id="cb1166-25"><a href="sect134.html#cb1166-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-26"><a href="sect134.html#cb1166-26" aria-hidden="true" tabindex="-1"></a><span class="co"># changer l&#39;échelle de l&#39;indice pour un graphique plus joli</span></span>
<span id="cb1166-27"><a href="sect134.html#cb1166-27" aria-hidden="true" tabindex="-1"></a>df_scores<span class="sc">$</span>FukuyamaSugeno <span class="ot">&lt;-</span> <span class="fu">round</span>(df_scores<span class="sc">$</span>FukuyamaSugeno<span class="sc">/</span><span class="dv">10000</span>,<span class="dv">2</span>)</span>
<span id="cb1166-28"><a href="sect134.html#cb1166-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-29"><a href="sect134.html#cb1166-29" aria-hidden="true" tabindex="-1"></a><span class="co"># création de trois figures pour représenter les trois indicateurs</span></span>
<span id="cb1166-30"><a href="sect134.html#cb1166-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1166-31"><a href="sect134.html#cb1166-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-32"><a href="sect134.html#cb1166-32" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_scores) <span class="sc">+</span> </span>
<span id="cb1166-33"><a href="sect134.html#cb1166-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> m, <span class="at">fill =</span> inertie)) <span class="sc">+</span> </span>
<span id="cb1166-34"><a href="sect134.html#cb1166-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>() <span class="sc">+</span> </span>
<span id="cb1166-35"><a href="sect134.html#cb1166-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb1166-36"><a href="sect134.html#cb1166-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio=</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb1166-37"><a href="sect134.html#cb1166-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colourbar</span>(<span class="at">barwidth =</span> <span class="dv">5</span>, <span class="at">barheight =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb1166-38"><a href="sect134.html#cb1166-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Inertie expliquée&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1166-39"><a href="sect134.html#cb1166-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb1166-40"><a href="sect134.html#cb1166-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>( <span class="at">size=</span><span class="dv">9</span>), <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb1166-41"><a href="sect134.html#cb1166-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-42"><a href="sect134.html#cb1166-42" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_scores) <span class="sc">+</span> </span>
<span id="cb1166-43"><a href="sect134.html#cb1166-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> m, <span class="at">fill =</span> silhouette)) <span class="sc">+</span> </span>
<span id="cb1166-44"><a href="sect134.html#cb1166-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>() <span class="sc">+</span> </span>
<span id="cb1166-45"><a href="sect134.html#cb1166-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb1166-46"><a href="sect134.html#cb1166-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio=</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb1166-47"><a href="sect134.html#cb1166-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colourbar</span>(<span class="at">barwidth =</span> <span class="dv">5</span>, <span class="at">barheight =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb1166-48"><a href="sect134.html#cb1166-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Indice de silhouette&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1166-49"><a href="sect134.html#cb1166-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb1166-50"><a href="sect134.html#cb1166-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>( <span class="at">size=</span><span class="dv">9</span>), <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb1166-51"><a href="sect134.html#cb1166-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-52"><a href="sect134.html#cb1166-52" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_scores) <span class="sc">+</span> </span>
<span id="cb1166-53"><a href="sect134.html#cb1166-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_raster</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> m, <span class="at">fill =</span> FukuyamaSugeno)) <span class="sc">+</span> </span>
<span id="cb1166-54"><a href="sect134.html#cb1166-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>() <span class="sc">+</span> </span>
<span id="cb1166-55"><a href="sect134.html#cb1166-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)) <span class="sc">+</span></span>
<span id="cb1166-56"><a href="sect134.html#cb1166-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio=</span><span class="dv">4</span>) <span class="sc">+</span> </span>
<span id="cb1166-57"><a href="sect134.html#cb1166-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colourbar</span>(<span class="at">barwidth =</span> <span class="dv">5</span>, <span class="at">barheight =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb1166-58"><a href="sect134.html#cb1166-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">&quot;Indice de Fukuyama et Sugeno&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1166-59"><a href="sect134.html#cb1166-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">legend.box =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb1166-60"><a href="sect134.html#cb1166-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>( <span class="at">size=</span><span class="dv">9</span>), <span class="at">legend.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">8</span>))</span>
<span id="cb1166-61"><a href="sect134.html#cb1166-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1166-62"><a href="sect134.html#cb1166-62" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(plot1, plot2, plot3, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cmeansB"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cmeansB-1.png" alt="Sélection des paramètres k et m pour l'algorithme c-means" width="75%" />
<p class="caption">
Figure 13.26: Sélection des paramètres k et m pour l’algorithme c-means
</p>
</div>
<p>Les trois graphiques à la figure <a href="sect134.html#fig:cmeansB">13.26</a> semblent indiquer des solutions différentes. Sans surprise, augmenter le niveau de flou (<em>m</em>) réduit l’inertie expliquée, alors qu’augmenter le nombre de groupes (<em>k</em>) augmente l’inertie expliquée. L’indice de silhouette indique assez clairement que trois groupes serait le meilleur choix, suivi par deux ou quatre groupes, si <em>m</em> est inférieur à 1,8. Cependant, ne retenir que trois groupes ne permet d’expliquer que 30% de l’inertie. Afin de nous rapprocher des résultats de l’article original <span class="citation">(<a href="#ref-2021_4" role="doc-biblioref">Gelb et Apparicio 2021b</a>)</span>, nous retenons <code>m = 1,5</code> et <code>k = 4</code>.</p>
</div>
<div id="application-lalgorithme-c-means" class="section level5 hasAnchor" number="13.4.5.1.3">
<h5><span class="header-section-number">13.4.5.1.3</span> Application l’algorithme <em>c-means</em><a href="sect134.html#application-lalgorithme-c-means" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Avec <em>k</em> et <em>m</em> définis, il ne reste plus qu’à appliquer l’algorithme à nos observations.</p>
<div class="sourceCode" id="cb1167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1167-1"><a href="sect134.html#cb1167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1167-2"><a href="sect134.html#cb1167-2" aria-hidden="true" tabindex="-1"></a>cmeans_resultats <span class="ot">&lt;-</span> <span class="fu">FKM</span>(X, <span class="dv">4</span>, <span class="fl">1.5</span>)</span></code></pre></div>
<p>L’objet obtenu <code>cmeans_resultats</code> contient les résultats de la classification. Plus spécifiquement, <code>cmeans_resultats$U</code> est la matrice d’appartenance, soit une matrice de taille <em>n</em> x <em>k</em>, dont chaque case <span class="math inline">\(U_{ij}\)</span> indique la probabilité pour l’observation <em>i</em> d’appartenir au groupe <em>j</em>. <code>cmeans_resultats$H</code> contient le centre des groupes, et <code>cmeans_resultats$Clus</code>, le groupe auquel chaque observation à le plus de chances d’appartenir. Pour comparer plus facilement nos résultats avec ceux du <em>k-means</em>, nous pouvons changer l’ordre des groupes obtenus pour les faire coïncider avec les groupes les plus similaires obtenus avec la méthode <em>k-means</em>.</p>
<div class="sourceCode" id="cb1168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1168-1"><a href="sect134.html#cb1168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># changeons l&#39;ordre des groupes</span></span>
<span id="cb1168-2"><a href="sect134.html#cb1168-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> cmeans_resultats<span class="sc">$</span>U</span>
<span id="cb1168-3"><a href="sect134.html#cb1168-3" aria-hidden="true" tabindex="-1"></a>U2 <span class="ot">&lt;-</span> geocmeans<span class="sc">::</span><span class="fu">groups_matching</span>(<span class="fu">as.matrix</span>(matrice_gp_kmeans), <span class="fu">as.matrix</span>(U))</span>
<span id="cb1168-4"><a href="sect134.html#cb1168-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1168-5"><a href="sect134.html#cb1168-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mais aussi du centre des classes</span></span>
<span id="cb1168-6"><a href="sect134.html#cb1168-6" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">&quot;Clus &quot;</span>,<span class="st">&quot;&quot;</span>,<span class="fu">colnames</span>(U2), <span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1168-7"><a href="sect134.html#cb1168-7" aria-hidden="true" tabindex="-1"></a>H2 <span class="ot">&lt;-</span> cmeans_resultats<span class="sc">$</span>H[idx,]</span>
<span id="cb1168-8"><a href="sect134.html#cb1168-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1168-9"><a href="sect134.html#cb1168-9" aria-hidden="true" tabindex="-1"></a><span class="co"># et recalcul du groupe le plus probable</span></span>
<span id="cb1168-10"><a href="sect134.html#cb1168-10" aria-hidden="true" tabindex="-1"></a>Clus2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1168-11"><a href="sect134.html#cb1168-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Cluster&quot;</span> <span class="ot">=</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)[<span class="fu">max.col</span>(U2,<span class="at">ties.method=</span><span class="st">&quot;first&quot;</span>)],</span>
<span id="cb1168-12"><a href="sect134.html#cb1168-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Membership degree&quot;</span> <span class="ot">=</span> <span class="fu">apply</span>(U2, <span class="at">MARGIN =</span> <span class="dv">1</span>, max)</span>
<span id="cb1168-13"><a href="sect134.html#cb1168-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1168-14"><a href="sect134.html#cb1168-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1168-15"><a href="sect134.html#cb1168-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(U2) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Clus&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb1168-16"><a href="sect134.html#cb1168-16" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(H2) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Clus&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb1168-17"><a href="sect134.html#cb1168-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1168-18"><a href="sect134.html#cb1168-18" aria-hidden="true" tabindex="-1"></a>cmeans_resultats<span class="sc">$</span>U <span class="ot">&lt;-</span> U2</span>
<span id="cb1168-19"><a href="sect134.html#cb1168-19" aria-hidden="true" tabindex="-1"></a>cmeans_resultats<span class="sc">$</span>H <span class="ot">&lt;-</span> H2</span>
<span id="cb1168-20"><a href="sect134.html#cb1168-20" aria-hidden="true" tabindex="-1"></a>cmeans_resultats<span class="sc">$</span>Clus <span class="ot">&lt;-</span> Clus2</span></code></pre></div>
</div>
<div id="interprétation-des-résultats" class="section level5 hasAnchor" number="13.4.5.1.4">
<h5><span class="header-section-number">13.4.5.1.4</span> Interprétation des résultats<a href="sect134.html#interprétation-des-résultats" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Globalement, les approches pour interpréter les résultats issus d’une classification obtenue par <em>c-means</em> sont les mêmes que pour une classification obtenue par <em>k-means</em>.</p>
<p>Commençons donc par créer plusieurs cartes des probabilités d’appartenir aux différents groupes.</p>
<div class="sourceCode" id="cb1169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1169-1"><a href="sect134.html#cb1169-1" aria-hidden="true" tabindex="-1"></a>maps <span class="ot">&lt;-</span> <span class="fu">mapClusters</span>(LyonIris, cmeans_resultats<span class="sc">$</span>U)</span>
<span id="cb1169-2"><a href="sect134.html#cb1169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1169-3"><a href="sect134.html#cb1169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(maps<span class="sc">$</span>ProbaMaps, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cmeansD"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cmeansD-1.png" alt="Cartographie des probabilités d'appartenir aux quatre groupes identifiés par l'algorithme c-means" width="100%" />
<p class="caption">
Figure 13.27: Cartographie des probabilités d’appartenir aux quatre groupes identifiés par l’algorithme c-means
</p>
</div>
<p>Sur les cartes de la figure <a href="sect134.html#fig:cmeansD">13.27</a>, l’intensité de bleu correspond à la probabilité pour chaque IRIS d’appartenir aux différents groupes. Nous retrouvons les principales structures spatiales que nous avons identifiées avec le <em>k-means</em>; cependant, nous pouvons à présent constater que le groupe 1 est bien plus incertain que les autres. Nous pouvons une fois encore générer un graphique en radar pour comparer les profils des quatre groupes.</p>
<div class="sourceCode" id="cb1170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1170-1"><a href="sect134.html#cb1170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), <span class="at">mai =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>))</span>
<span id="cb1170-2"><a href="sect134.html#cb1170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spiderPlots</span>(X, cmeans_resultats<span class="sc">$</span>U,</span>
<span id="cb1170-3"><a href="sect134.html#cb1170-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">chartcolors =</span> <span class="fu">c</span>(<span class="st">&quot;#EFBE89&quot;</span>, <span class="st">&quot;#4A6A9F&quot;</span>, <span class="st">&quot;#7DB47C&quot;</span>, <span class="st">&quot;#FAF29C&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:cmeansE"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cmeansE-1.png" alt="Graphique en radar pour les résultats du c-means" width="100%" />
<p class="caption">
Figure 13.28: Graphique en radar pour les résultats du c-means
</p>
</div>
<p>Sans surprise, nous retrouvons essentiellement les profils que nous avons obtenus avec le <em>k-means</em> dans la figure <a href="sect134.html#fig:cmeansE">13.28</a>. Pour compléter la lecture des résultats, il est nécessaire de se pencher sur le tableau des statistiques descriptives des différents groupes. Une fois encore, nous proposons d’utiliser la fonction <code>summarizeClusters</code> du <em>package</em> <code>geocmeans</code>. Notez que cette fonction calcule les statistiques descriptives pondérées en fonction de l’appartenance des observations aux groupes. Ainsi, une observation ayant une faible chance d’appartenir à un groupe ne contribue que faiblement aux statistiques descriptives de ce groupe.</p>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb1171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1171-1"><a href="sect134.html#cb1171-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span>  <span class="fu">st_drop_geometry</span>(LyonIris[<span class="fu">c</span>(<span class="st">&quot;Lden&quot;</span>,<span class="st">&quot;NO2&quot;</span>,<span class="st">&quot;PM25&quot;</span>,<span class="st">&quot;VegHautPrt&quot;</span>,<span class="st">&quot;Pct0_14&quot;</span>,</span>
<span id="cb1171-2"><a href="sect134.html#cb1171-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Pct_65&quot;</span>,<span class="st">&quot;Pct_Img&quot;</span>, <span class="st">&quot;TxChom1564&quot;</span>,</span>
<span id="cb1171-3"><a href="sect134.html#cb1171-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">&quot;Pct_brevet&quot;</span>,<span class="st">&quot;NivVieMed&quot;</span>)])</span>
<span id="cb1171-4"><a href="sect134.html#cb1171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1171-5"><a href="sect134.html#cb1171-5" aria-hidden="true" tabindex="-1"></a>tableaux <span class="ot">&lt;-</span> <span class="fu">summarizeClusters</span>(<span class="at">data =</span> df, </span>
<span id="cb1171-6"><a href="sect134.html#cb1171-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">belongmatrix =</span> cmeans_resultats<span class="sc">$</span>U,</span>
<span id="cb1171-7"><a href="sect134.html#cb1171-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weighted =</span> <span class="cn">TRUE</span>, <span class="at">dec =</span> <span class="dv">1</span>)</span>
<span id="cb1171-8"><a href="sect134.html#cb1171-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1171-9"><a href="sect134.html#cb1171-9" aria-hidden="true" tabindex="-1"></a>tableau_tot <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, tableaux)</span></code></pre></div>
<table>
<caption>
<span id="tab:cmeansG">Tableau 13.9: </span>Description des groupes avec la méthode c-means
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Lden
</th>
<th style="text-align:right;">
NO2
</th>
<th style="text-align:right;">
PM25
</th>
<th style="text-align:right;">
VegHautPrt
</th>
<th style="text-align:right;">
Pct014
</th>
<th style="text-align:right;">
Pct65
</th>
<th style="text-align:right;">
PctImg
</th>
<th style="text-align:right;">
TxChom1564
</th>
<th style="text-align:right;">
Pctbrevet
</th>
<th style="text-align:right;">
NivVieMed
</th>
</tr>
</thead>
<tbody>
<tr grouplength="9">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>groupe 1</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q5
</td>
<td style="text-align:right;">
48,7
</td>
<td style="text-align:right;">
15,8
</td>
<td style="text-align:right;">
13,5
</td>
<td style="text-align:right;">
6,2
</td>
<td style="text-align:right;">
12,2
</td>
<td style="text-align:right;">
9,5
</td>
<td style="text-align:right;">
4,3
</td>
<td style="text-align:right;">
6,7
</td>
<td style="text-align:right;">
10,7
</td>
<td style="text-align:right;">
16 191,5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q10
</td>
<td style="text-align:right;">
50,5
</td>
<td style="text-align:right;">
18,7
</td>
<td style="text-align:right;">
13,9
</td>
<td style="text-align:right;">
7,4
</td>
<td style="text-align:right;">
14,2
</td>
<td style="text-align:right;">
11,4
</td>
<td style="text-align:right;">
5,7
</td>
<td style="text-align:right;">
7,6
</td>
<td style="text-align:right;">
13,7
</td>
<td style="text-align:right;">
17 616,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q25
</td>
<td style="text-align:right;">
52,4
</td>
<td style="text-align:right;">
20,9
</td>
<td style="text-align:right;">
14,7
</td>
<td style="text-align:right;">
11,4
</td>
<td style="text-align:right;">
16,8
</td>
<td style="text-align:right;">
14,2
</td>
<td style="text-align:right;">
7,8
</td>
<td style="text-align:right;">
9,3
</td>
<td style="text-align:right;">
18,4
</td>
<td style="text-align:right;">
19 559,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q50
</td>
<td style="text-align:right;">
54,7
</td>
<td style="text-align:right;">
25,0
</td>
<td style="text-align:right;">
15,6
</td>
<td style="text-align:right;">
15,8
</td>
<td style="text-align:right;">
19,0
</td>
<td style="text-align:right;">
17,7
</td>
<td style="text-align:right;">
11,2
</td>
<td style="text-align:right;">
12,1
</td>
<td style="text-align:right;">
24,0
</td>
<td style="text-align:right;">
21 947,5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q75
</td>
<td style="text-align:right;">
57,6
</td>
<td style="text-align:right;">
28,6
</td>
<td style="text-align:right;">
16,8
</td>
<td style="text-align:right;">
22,3
</td>
<td style="text-align:right;">
21,3
</td>
<td style="text-align:right;">
21,1
</td>
<td style="text-align:right;">
15,6
</td>
<td style="text-align:right;">
15,1
</td>
<td style="text-align:right;">
29,8
</td>
<td style="text-align:right;">
24 069,2
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q90
</td>
<td style="text-align:right;">
60,7
</td>
<td style="text-align:right;">
33,0
</td>
<td style="text-align:right;">
18,5
</td>
<td style="text-align:right;">
29,8
</td>
<td style="text-align:right;">
23,2
</td>
<td style="text-align:right;">
24,4
</td>
<td style="text-align:right;">
20,3
</td>
<td style="text-align:right;">
18,5
</td>
<td style="text-align:right;">
34,7
</td>
<td style="text-align:right;">
26 164,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q95
</td>
<td style="text-align:right;">
63,1
</td>
<td style="text-align:right;">
37,8
</td>
<td style="text-align:right;">
19,0
</td>
<td style="text-align:right;">
34,3
</td>
<td style="text-align:right;">
25,4
</td>
<td style="text-align:right;">
27,5
</td>
<td style="text-align:right;">
23,5
</td>
<td style="text-align:right;">
22,3
</td>
<td style="text-align:right;">
39,0
</td>
<td style="text-align:right;">
28 931,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Mean
</td>
<td style="text-align:right;">
55,1
</td>
<td style="text-align:right;">
25,4
</td>
<td style="text-align:right;">
15,8
</td>
<td style="text-align:right;">
17,5
</td>
<td style="text-align:right;">
18,9
</td>
<td style="text-align:right;">
17,9
</td>
<td style="text-align:right;">
12,4
</td>
<td style="text-align:right;">
13,0
</td>
<td style="text-align:right;">
24,7
</td>
<td style="text-align:right;">
21 951,6
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Std
</td>
<td style="text-align:right;">
4,4
</td>
<td style="text-align:right;">
6,3
</td>
<td style="text-align:right;">
1,7
</td>
<td style="text-align:right;">
8,6
</td>
<td style="text-align:right;">
4,5
</td>
<td style="text-align:right;">
5,7
</td>
<td style="text-align:right;">
6,8
</td>
<td style="text-align:right;">
6,8
</td>
<td style="text-align:right;">
10,3
</td>
<td style="text-align:right;">
3 744,1
</td>
</tr>
<tr grouplength="9">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>groupe 2</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q5
</td>
<td style="text-align:right;">
50,8
</td>
<td style="text-align:right;">
19,6
</td>
<td style="text-align:right;">
14,0
</td>
<td style="text-align:right;">
6,4
</td>
<td style="text-align:right;">
12,9
</td>
<td style="text-align:right;">
7,5
</td>
<td style="text-align:right;">
8,4
</td>
<td style="text-align:right;">
9,4
</td>
<td style="text-align:right;">
15,5
</td>
<td style="text-align:right;">
12 392,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q10
</td>
<td style="text-align:right;">
52,1
</td>
<td style="text-align:right;">
21,4
</td>
<td style="text-align:right;">
14,6
</td>
<td style="text-align:right;">
7,7
</td>
<td style="text-align:right;">
16,6
</td>
<td style="text-align:right;">
8,8
</td>
<td style="text-align:right;">
12,9
</td>
<td style="text-align:right;">
13,0
</td>
<td style="text-align:right;">
22,0
</td>
<td style="text-align:right;">
12 920,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q25
</td>
<td style="text-align:right;">
54,5
</td>
<td style="text-align:right;">
23,2
</td>
<td style="text-align:right;">
15,8
</td>
<td style="text-align:right;">
10,8
</td>
<td style="text-align:right;">
20,1
</td>
<td style="text-align:right;">
11,1
</td>
<td style="text-align:right;">
19,6
</td>
<td style="text-align:right;">
16,8
</td>
<td style="text-align:right;">
30,5
</td>
<td style="text-align:right;">
14 078,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q50
</td>
<td style="text-align:right;">
57,1
</td>
<td style="text-align:right;">
26,6
</td>
<td style="text-align:right;">
16,6
</td>
<td style="text-align:right;">
14,5
</td>
<td style="text-align:right;">
23,6
</td>
<td style="text-align:right;">
13,9
</td>
<td style="text-align:right;">
25,8
</td>
<td style="text-align:right;">
22,0
</td>
<td style="text-align:right;">
37,5
</td>
<td style="text-align:right;">
15 985,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q75
</td>
<td style="text-align:right;">
59,5
</td>
<td style="text-align:right;">
31,9
</td>
<td style="text-align:right;">
17,8
</td>
<td style="text-align:right;">
19,0
</td>
<td style="text-align:right;">
27,0
</td>
<td style="text-align:right;">
17,4
</td>
<td style="text-align:right;">
32,1
</td>
<td style="text-align:right;">
30,1
</td>
<td style="text-align:right;">
44,2
</td>
<td style="text-align:right;">
18 566,2
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q90
</td>
<td style="text-align:right;">
63,3
</td>
<td style="text-align:right;">
37,4
</td>
<td style="text-align:right;">
18,8
</td>
<td style="text-align:right;">
25,4
</td>
<td style="text-align:right;">
29,7
</td>
<td style="text-align:right;">
20,7
</td>
<td style="text-align:right;">
37,8
</td>
<td style="text-align:right;">
33,9
</td>
<td style="text-align:right;">
48,6
</td>
<td style="text-align:right;">
21 146,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q95
</td>
<td style="text-align:right;">
64,7
</td>
<td style="text-align:right;">
39,6
</td>
<td style="text-align:right;">
19,3
</td>
<td style="text-align:right;">
30,7
</td>
<td style="text-align:right;">
32,3
</td>
<td style="text-align:right;">
23,3
</td>
<td style="text-align:right;">
39,4
</td>
<td style="text-align:right;">
37,7
</td>
<td style="text-align:right;">
52,9
</td>
<td style="text-align:right;">
23 712,5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Mean
</td>
<td style="text-align:right;">
57,3
</td>
<td style="text-align:right;">
28,1
</td>
<td style="text-align:right;">
16,7
</td>
<td style="text-align:right;">
15,8
</td>
<td style="text-align:right;">
23,4
</td>
<td style="text-align:right;">
14,4
</td>
<td style="text-align:right;">
25,5
</td>
<td style="text-align:right;">
23,0
</td>
<td style="text-align:right;">
36,9
</td>
<td style="text-align:right;">
16 658,7
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Std
</td>
<td style="text-align:right;">
4,4
</td>
<td style="text-align:right;">
6,6
</td>
<td style="text-align:right;">
1,6
</td>
<td style="text-align:right;">
7,6
</td>
<td style="text-align:right;">
6,3
</td>
<td style="text-align:right;">
5,1
</td>
<td style="text-align:right;">
9,7
</td>
<td style="text-align:right;">
9,3
</td>
<td style="text-align:right;">
12,3
</td>
<td style="text-align:right;">
3 611,9
</td>
</tr>
<tr grouplength="9">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>groupe 3</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q5
</td>
<td style="text-align:right;">
50,6
</td>
<td style="text-align:right;">
27,5
</td>
<td style="text-align:right;">
16,3
</td>
<td style="text-align:right;">
6,2
</td>
<td style="text-align:right;">
8,6
</td>
<td style="text-align:right;">
6,8
</td>
<td style="text-align:right;">
6,0
</td>
<td style="text-align:right;">
7,6
</td>
<td style="text-align:right;">
7,5
</td>
<td style="text-align:right;">
16 976,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q10
</td>
<td style="text-align:right;">
51,9
</td>
<td style="text-align:right;">
28,8
</td>
<td style="text-align:right;">
17,1
</td>
<td style="text-align:right;">
7,7
</td>
<td style="text-align:right;">
10,4
</td>
<td style="text-align:right;">
8,4
</td>
<td style="text-align:right;">
7,0
</td>
<td style="text-align:right;">
8,6
</td>
<td style="text-align:right;">
8,7
</td>
<td style="text-align:right;">
18 434,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q25
</td>
<td style="text-align:right;">
53,8
</td>
<td style="text-align:right;">
30,9
</td>
<td style="text-align:right;">
18,3
</td>
<td style="text-align:right;">
10,2
</td>
<td style="text-align:right;">
12,6
</td>
<td style="text-align:right;">
10,8
</td>
<td style="text-align:right;">
9,1
</td>
<td style="text-align:right;">
11,1
</td>
<td style="text-align:right;">
11,0
</td>
<td style="text-align:right;">
19 785,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q50
</td>
<td style="text-align:right;">
56,5
</td>
<td style="text-align:right;">
35,0
</td>
<td style="text-align:right;">
18,9
</td>
<td style="text-align:right;">
13,4
</td>
<td style="text-align:right;">
15,2
</td>
<td style="text-align:right;">
14,1
</td>
<td style="text-align:right;">
12,3
</td>
<td style="text-align:right;">
13,1
</td>
<td style="text-align:right;">
14,8
</td>
<td style="text-align:right;">
22 289,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q75
</td>
<td style="text-align:right;">
59,4
</td>
<td style="text-align:right;">
38,7
</td>
<td style="text-align:right;">
19,6
</td>
<td style="text-align:right;">
17,6
</td>
<td style="text-align:right;">
17,9
</td>
<td style="text-align:right;">
17,5
</td>
<td style="text-align:right;">
15,9
</td>
<td style="text-align:right;">
15,5
</td>
<td style="text-align:right;">
21,5
</td>
<td style="text-align:right;">
24 522,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q90
</td>
<td style="text-align:right;">
62,7
</td>
<td style="text-align:right;">
41,1
</td>
<td style="text-align:right;">
20,0
</td>
<td style="text-align:right;">
24,8
</td>
<td style="text-align:right;">
20,5
</td>
<td style="text-align:right;">
20,5
</td>
<td style="text-align:right;">
18,9
</td>
<td style="text-align:right;">
18,4
</td>
<td style="text-align:right;">
27,6
</td>
<td style="text-align:right;">
27 600,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q95
</td>
<td style="text-align:right;">
64,3
</td>
<td style="text-align:right;">
44,3
</td>
<td style="text-align:right;">
20,2
</td>
<td style="text-align:right;">
30,6
</td>
<td style="text-align:right;">
21,8
</td>
<td style="text-align:right;">
23,5
</td>
<td style="text-align:right;">
21,0
</td>
<td style="text-align:right;">
20,6
</td>
<td style="text-align:right;">
32,2
</td>
<td style="text-align:right;">
29 732,8
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Mean
</td>
<td style="text-align:right;">
56,8
</td>
<td style="text-align:right;">
34,9
</td>
<td style="text-align:right;">
18,7
</td>
<td style="text-align:right;">
14,8
</td>
<td style="text-align:right;">
15,3
</td>
<td style="text-align:right;">
14,2
</td>
<td style="text-align:right;">
12,8
</td>
<td style="text-align:right;">
13,7
</td>
<td style="text-align:right;">
16,9
</td>
<td style="text-align:right;">
22 595,1
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Std
</td>
<td style="text-align:right;">
4,4
</td>
<td style="text-align:right;">
5,9
</td>
<td style="text-align:right;">
1,3
</td>
<td style="text-align:right;">
7,2
</td>
<td style="text-align:right;">
4,6
</td>
<td style="text-align:right;">
5,2
</td>
<td style="text-align:right;">
5,8
</td>
<td style="text-align:right;">
5,5
</td>
<td style="text-align:right;">
9,1
</td>
<td style="text-align:right;">
3 969,2
</td>
</tr>
<tr grouplength="9">
<td colspan="11" style="border-bottom: 1px solid;">
<strong>groupe 4</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q5
</td>
<td style="text-align:right;">
44,2
</td>
<td style="text-align:right;">
14,7
</td>
<td style="text-align:right;">
12,4
</td>
<td style="text-align:right;">
11,3
</td>
<td style="text-align:right;">
12,5
</td>
<td style="text-align:right;">
11,1
</td>
<td style="text-align:right;">
4,0
</td>
<td style="text-align:right;">
6,7
</td>
<td style="text-align:right;">
9,3
</td>
<td style="text-align:right;">
18 686,5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q10
</td>
<td style="text-align:right;">
45,7
</td>
<td style="text-align:right;">
15,6
</td>
<td style="text-align:right;">
12,9
</td>
<td style="text-align:right;">
16,4
</td>
<td style="text-align:right;">
14,1
</td>
<td style="text-align:right;">
13,0
</td>
<td style="text-align:right;">
4,5
</td>
<td style="text-align:right;">
7,2
</td>
<td style="text-align:right;">
11,2
</td>
<td style="text-align:right;">
20 220,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q25
</td>
<td style="text-align:right;">
49,3
</td>
<td style="text-align:right;">
18,7
</td>
<td style="text-align:right;">
13,7
</td>
<td style="text-align:right;">
24,7
</td>
<td style="text-align:right;">
16,5
</td>
<td style="text-align:right;">
15,8
</td>
<td style="text-align:right;">
5,8
</td>
<td style="text-align:right;">
7,9
</td>
<td style="text-align:right;">
14,2
</td>
<td style="text-align:right;">
22 622,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q50
</td>
<td style="text-align:right;">
52,3
</td>
<td style="text-align:right;">
22,0
</td>
<td style="text-align:right;">
14,6
</td>
<td style="text-align:right;">
30,4
</td>
<td style="text-align:right;">
18,6
</td>
<td style="text-align:right;">
19,0
</td>
<td style="text-align:right;">
7,5
</td>
<td style="text-align:right;">
9,7
</td>
<td style="text-align:right;">
17,9
</td>
<td style="text-align:right;">
24 843,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q75
</td>
<td style="text-align:right;">
55,1
</td>
<td style="text-align:right;">
26,3
</td>
<td style="text-align:right;">
15,9
</td>
<td style="text-align:right;">
37,9
</td>
<td style="text-align:right;">
20,8
</td>
<td style="text-align:right;">
22,3
</td>
<td style="text-align:right;">
10,1
</td>
<td style="text-align:right;">
12,1
</td>
<td style="text-align:right;">
22,8
</td>
<td style="text-align:right;">
28 590,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q90
</td>
<td style="text-align:right;">
58,9
</td>
<td style="text-align:right;">
30,9
</td>
<td style="text-align:right;">
17,1
</td>
<td style="text-align:right;">
42,3
</td>
<td style="text-align:right;">
22,4
</td>
<td style="text-align:right;">
27,2
</td>
<td style="text-align:right;">
14,4
</td>
<td style="text-align:right;">
15,3
</td>
<td style="text-align:right;">
30,1
</td>
<td style="text-align:right;">
31 294,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Q95
</td>
<td style="text-align:right;">
60,8
</td>
<td style="text-align:right;">
34,5
</td>
<td style="text-align:right;">
18,3
</td>
<td style="text-align:right;">
45,7
</td>
<td style="text-align:right;">
23,2
</td>
<td style="text-align:right;">
28,9
</td>
<td style="text-align:right;">
19,3
</td>
<td style="text-align:right;">
18,6
</td>
<td style="text-align:right;">
33,2
</td>
<td style="text-align:right;">
34 574,0
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Mean
</td>
<td style="text-align:right;">
52,3
</td>
<td style="text-align:right;">
22,8
</td>
<td style="text-align:right;">
14,9
</td>
<td style="text-align:right;">
30,3
</td>
<td style="text-align:right;">
18,4
</td>
<td style="text-align:right;">
19,4
</td>
<td style="text-align:right;">
8,8
</td>
<td style="text-align:right;">
10,9
</td>
<td style="text-align:right;">
19,5
</td>
<td style="text-align:right;">
25 547,4
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 0em;" indentlevel="1">
Std
</td>
<td style="text-align:right;">
5,1
</td>
<td style="text-align:right;">
6,3
</td>
<td style="text-align:right;">
1,7
</td>
<td style="text-align:right;">
10,0
</td>
<td style="text-align:right;">
4,1
</td>
<td style="text-align:right;">
5,9
</td>
<td style="text-align:right;">
5,5
</td>
<td style="text-align:right;">
6,2
</td>
<td style="text-align:right;">
9,2
</td>
<td style="text-align:right;">
4 603,5
</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="sect13462" class="section level4 hasAnchor" number="13.4.5.2">
<h4><span class="header-section-number">13.4.5.2</span> Mise en oeuvre du <em>c-medoids</em> dans R<a href="sect134.html#sect13462" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La méthode du <em>c-medoids</em> dans R peut être mise en oeuvre avec la fonction <code>FKM.med</code> du <em>package</em> <code>fclust</code>. Le processus d’analyse et de validation est identique à celui présenté ci-dessus pour le <em>c-means</em>. Nous ne donnons donc pas un exemple complet de la méthode.</p>
<div class="bloc_aller_loin">
<p><strong>Stabilité des groupes obtenus par les méthodes de nuées dynamiques</strong> :</p>
<p>Puisque la méthode <em>k-means</em> et ses variantes reposent sur une initialisation aléatoire de leur algorithme, les résultats peuvent varier en fonction de cet état de départ. Dans certains contextes, il est possible que les résultats obtenus varient significativement, ce qui signifie que les groupes obtenus ne sont pas représentatifs de la population étudiée. Une solution pour vérifier si ce problème se pose est simplement de relancer l’algorithme un grand nombre de fois (généralement 1000) et de comparer les résultats obtenus au cours de ces réplications.</p>
<p>Cette méthode est rarement implémentée directement et requiert d’écrire sa propre fonction. <code>geocmeans</code> dispose d’une fonction déjà existante, mais ne pouvant être appliquée qu’avec l’algorithme <em>c-means</em>. Nous proposons ici une implémentation pour la méthode <em>k-means</em> qui peut facilement être adaptée aux autres méthodes de classifications heuristiques.</p>
<p>La démarche à suivre est la suivante :</p>
<ol style="list-style-type: decimal">
<li>Appliquer l’algorithme une première fois pour obtenir une classification de référence à laquelle nous comparerons toutes les réplications.</li>
<li>Effectuer 1000 itérations au cours desquelles :
<ul>
<li>Une nouvelle classification est calculée.</li>
<li>Les groupes obtenus sont comparés à ceux de la classification de référence.</li>
<li>L’indice de Jacard est calculé entre les groupes des deux classifications.</li>
<li>Les valeurs de l’indice de Jacard sont enregistrées.</li>
<li>Les centres des groupes sont enregistrés.</li>
</ul></li>
</ol>
<p>Ainsi, nous obtenons 1000 valeurs de l’indice de Jacard pour chaque groupe. Cet indice permet de mesurer le degré d’accord entre deux variables (ici les probabilités d’appartenance des observations au même groupe pour deux classifications différentes.) Une valeur moyenne en dessous de 0,5 indique qu’un groupe est très instable, car nous obtenons des résultats très différents lors des réplications. Une valeur entre 0,6 et 0,75 indique qu’un groupe semble bien exister dans les données, bien que marqué par une certaine incertitude. Une valeur au-dessus de 0,8 indique un groupe bien identifié et stable.</p>
<p>Nous obtenons également les centres des groupes des 1000 classifications. Il est ainsi possible de représenter leurs histogrammes et de déterminer si les centres des groupes sont stables (unimodalité et faible variance) ou incertains (plusieurs modes et/ou forte variance).</p>
<div class="sourceCode" id="cb1172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1172-1"><a href="sect134.html#cb1172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X sera le jeu de données pour la classification</span></span>
<span id="cb1172-2"><a href="sect134.html#cb1172-2" aria-hidden="true" tabindex="-1"></a><span class="co"># clust_ref sera le vecteur indiquant le groupe de chaque observation obtenu par kmeans</span></span>
<span id="cb1172-3"><a href="sect134.html#cb1172-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nsim sera le nombre de simulations à effectuer</span></span>
<span id="cb1172-4"><a href="sect134.html#cb1172-4" aria-hidden="true" tabindex="-1"></a>kmeans_stability <span class="ot">&lt;-</span> <span class="cf">function</span>(X, clust_ref, nsim, <span class="at">verbose =</span> <span class="cn">TRUE</span>){</span>
<span id="cb1172-5"><a href="sect134.html#cb1172-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1172-6"><a href="sect134.html#cb1172-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># définition de la matrice d&#39;appartenance originale</span></span>
<span id="cb1172-7"><a href="sect134.html#cb1172-7" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(clust_ref))</span>
<span id="cb1172-8"><a href="sect134.html#cb1172-8" aria-hidden="true" tabindex="-1"></a>  ref_mat <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(clust_ref, <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1172-9"><a href="sect134.html#cb1172-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(ref_mat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;groupe_&quot;</span>,<span class="dv">1</span><span class="sc">:</span>k)</span>
<span id="cb1172-10"><a href="sect134.html#cb1172-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1172-11"><a href="sect134.html#cb1172-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lancement des itérations</span></span>
<span id="cb1172-12"><a href="sect134.html#cb1172-12" aria-hidden="true" tabindex="-1"></a>  sim_resultats <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>nsim, <span class="cf">function</span>(i){</span>
<span id="cb1172-13"><a href="sect134.html#cb1172-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1172-14"><a href="sect134.html#cb1172-14" aria-hidden="true" tabindex="-1"></a>     <span class="co"># afficher la progression si requis</span></span>
<span id="cb1172-15"><a href="sect134.html#cb1172-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(verbose){</span>
<span id="cb1172-16"><a href="sect134.html#cb1172-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;iteration numeros : &quot;</span>,i,<span class="st">&quot;/&quot;</span>,nsim))</span>
<span id="cb1172-17"><a href="sect134.html#cb1172-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1172-18"><a href="sect134.html#cb1172-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calculer le kmeans</span></span>
<span id="cb1172-19"><a href="sect134.html#cb1172-19" aria-hidden="true" tabindex="-1"></a>    km_res <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(X,k)</span>
<span id="cb1172-20"><a href="sect134.html#cb1172-20" aria-hidden="true" tabindex="-1"></a>    sim_mat <span class="ot">&lt;-</span> <span class="fu">dummy_cols</span>(km_res<span class="sc">$</span>cluster, <span class="at">remove_selected_columns =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1172-21"><a href="sect134.html#cb1172-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1172-22"><a href="sect134.html#cb1172-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ajustement de l&#39;ordre des groupes avec geocmeans</span></span>
<span id="cb1172-23"><a href="sect134.html#cb1172-23" aria-hidden="true" tabindex="-1"></a>    sim_mat <span class="ot">&lt;-</span> <span class="fu">groups_matching</span>(<span class="fu">as.matrix</span>(ref_mat), <span class="fu">as.matrix</span>(sim_mat))</span>
<span id="cb1172-24"><a href="sect134.html#cb1172-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1172-25"><a href="sect134.html#cb1172-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># calcul des indices de jacard</span></span>
<span id="cb1172-26"><a href="sect134.html#cb1172-26" aria-hidden="true" tabindex="-1"></a>    jac_idx <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="cf">function</span>(j){</span>
<span id="cb1172-27"><a href="sect134.html#cb1172-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">calc_jaccard_idx</span>(sim_mat[,j], ref_mat[,j])</span>
<span id="cb1172-28"><a href="sect134.html#cb1172-28" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb1172-29"><a href="sect134.html#cb1172-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1172-30"><a href="sect134.html#cb1172-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># recuperation des centres des groupes</span></span>
<span id="cb1172-31"><a href="sect134.html#cb1172-31" aria-hidden="true" tabindex="-1"></a>    idx <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">&quot;.data_&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="fu">colnames</span>(sim_mat),<span class="at">fixed =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1172-32"><a href="sect134.html#cb1172-32" aria-hidden="true" tabindex="-1"></a>    centers <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(km_res<span class="sc">$</span>centers)</span>
<span id="cb1172-33"><a href="sect134.html#cb1172-33" aria-hidden="true" tabindex="-1"></a>    centers <span class="ot">&lt;-</span> centers[idx,]</span>
<span id="cb1172-34"><a href="sect134.html#cb1172-34" aria-hidden="true" tabindex="-1"></a>    centers<span class="sc">$</span>groupe <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>k</span>
<span id="cb1172-35"><a href="sect134.html#cb1172-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1172-36"><a href="sect134.html#cb1172-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb1172-37"><a href="sect134.html#cb1172-37" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;jac_idx&quot;</span> <span class="ot">=</span> jac_idx,</span>
<span id="cb1172-38"><a href="sect134.html#cb1172-38" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;centers&quot;</span> <span class="ot">=</span> centers</span>
<span id="cb1172-39"><a href="sect134.html#cb1172-39" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb1172-40"><a href="sect134.html#cb1172-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1172-41"><a href="sect134.html#cb1172-41" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1172-42"><a href="sect134.html#cb1172-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1172-43"><a href="sect134.html#cb1172-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># les simulations sont finies, nous pouvons combiner les resultats</span></span>
<span id="cb1172-44"><a href="sect134.html#cb1172-44" aria-hidden="true" tabindex="-1"></a>  all_jac_values <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(sim_resultats, <span class="cf">function</span>(x){x<span class="sc">$</span>jac_idx}))</span>
<span id="cb1172-45"><a href="sect134.html#cb1172-45" aria-hidden="true" tabindex="-1"></a>  all_centers <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(sim_resultats, <span class="cf">function</span>(x){x<span class="sc">$</span>centers}))</span>
<span id="cb1172-46"><a href="sect134.html#cb1172-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb1172-47"><a href="sect134.html#cb1172-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;jacard_values&quot;</span> <span class="ot">=</span> all_jac_values,</span>
<span id="cb1172-48"><a href="sect134.html#cb1172-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;centers&quot;</span> <span class="ot">=</span> all_centers</span>
<span id="cb1172-49"><a href="sect134.html#cb1172-49" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb1172-50"><a href="sect134.html#cb1172-50" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Il ne nous reste plus qu’à utiliser notre nouvelle fonction pour déterminer si les groupes obtenus avec notre <em>k-means</em> sont stables.</p>
<div class="sourceCode" id="cb1173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1173-1"><a href="sect134.html#cb1173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(LyonIris)</span>
<span id="cb1173-2"><a href="sect134.html#cb1173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1173-3"><a href="sect134.html#cb1173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1173-4"><a href="sect134.html#cb1173-4" aria-hidden="true" tabindex="-1"></a><span class="co"># NB : LyonIris est un objet spatial, il faut donc extraire uniquement son DataFrame</span></span>
<span id="cb1173-5"><a href="sect134.html#cb1173-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">st_drop_geometry</span>(LyonIris[<span class="fu">c</span>(<span class="st">&quot;Lden&quot;</span>,<span class="st">&quot;NO2&quot;</span>,<span class="st">&quot;PM25&quot;</span>,<span class="st">&quot;VegHautPrt&quot;</span>,<span class="st">&quot;Pct0_14&quot;</span>,<span class="st">&quot;Pct_65&quot;</span>,<span class="st">&quot;Pct_Img&quot;</span>,</span>
<span id="cb1173-6"><a href="sect134.html#cb1173-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;TxChom1564&quot;</span>,<span class="st">&quot;Pct_brevet&quot;</span>,<span class="st">&quot;NivVieMed&quot;</span>)])</span>
<span id="cb1173-7"><a href="sect134.html#cb1173-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1173-8"><a href="sect134.html#cb1173-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Centrage et réduction de chaque colonne du DataFrame</span></span>
<span id="cb1173-9"><a href="sect134.html#cb1173-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">names</span>(X)){</span>
<span id="cb1173-10"><a href="sect134.html#cb1173-10" aria-hidden="true" tabindex="-1"></a>  X[[col]] <span class="ot">&lt;-</span> <span class="fu">scale</span>(X[[col]], <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1173-11"><a href="sect134.html#cb1173-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1173-12"><a href="sect134.html#cb1173-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1173-13"><a href="sect134.html#cb1173-13" aria-hidden="true" tabindex="-1"></a><span class="co"># calcul du kmeans de référence</span></span>
<span id="cb1173-14"><a href="sect134.html#cb1173-14" aria-hidden="true" tabindex="-1"></a>kmeans_ref <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(X, <span class="dv">4</span>)</span>
<span id="cb1173-15"><a href="sect134.html#cb1173-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1173-16"><a href="sect134.html#cb1173-16" aria-hidden="true" tabindex="-1"></a><span class="co"># application de la fonction de stabilité</span></span>
<span id="cb1173-17"><a href="sect134.html#cb1173-17" aria-hidden="true" tabindex="-1"></a>stab_results <span class="ot">&lt;-</span> <span class="fu">kmeans_stability</span>(X, kmeans_ref<span class="sc">$</span>cluster, <span class="at">nsim =</span> <span class="dv">1000</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Nous pouvons à présent vérifier la stabilité de nos quatre groupes.</p>
<div class="sourceCode" id="cb1174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1174-1"><a href="sect134.html#cb1174-1" aria-hidden="true" tabindex="-1"></a>jacard_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(stab_results<span class="sc">$</span>jacard_values)</span>
<span id="cb1174-2"><a href="sect134.html#cb1174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(jacard_values) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;groupe&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb1174-3"><a href="sect134.html#cb1174-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1174-4"><a href="sect134.html#cb1174-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(jacard_values)</span>
<span id="cb1174-5"><a href="sect134.html#cb1174-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>groupes <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>variable)</span>
<span id="cb1174-6"><a href="sect134.html#cb1174-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1174-7"><a href="sect134.html#cb1174-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb1174-8"><a href="sect134.html#cb1174-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> value), <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb1174-9"><a href="sect134.html#cb1174-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(groupes), <span class="at">ncol=</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb1174-10"><a href="sect134.html#cb1174-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Indice de Jacard&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansStab3"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansStab3-1.png" alt="Indices de Jacard obtenus sur 1000 réplications du k-means" width="90%"  />
<p class="caption">
Figure 13.29: Indices de Jacard obtenus sur 1000 réplications du k-means
</p>
</div>
<p>La figure <a href="sect134.html#fig:kmeansStab3">13.29</a> indique clairement que les groupes 1 et 2 sont très stables, car les valeurs de Jacard obtenues sont le plus souvent supérieures à 0,75. Le groupe 3 a le plus souvent des valeurs légèrement inférieures aux deux premiers groupes, mais tout de même bien supérieures à 0,5. En revanche, le groupe 4 a un grand nombre de valeurs inférieures à 0,5 indiquant une tendance du groupe à se dissoudre lors des réplications.</p>
<p>Considérant que le dernier groupe est le plus instable, nous décidons d’observer les valeurs des centres qu’il obtient pour les différentes réplications.</p>
<div class="sourceCode" id="cb1175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1175-1"><a href="sect134.html#cb1175-1" aria-hidden="true" tabindex="-1"></a>centers_groupe4 <span class="ot">&lt;-</span> <span class="fu">subset</span>(stab_results<span class="sc">$</span>centers, stab_results<span class="sc">$</span>centers<span class="sc">$</span>groupe <span class="sc">==</span> <span class="dv">4</span>)</span>
<span id="cb1175-2"><a href="sect134.html#cb1175-2" aria-hidden="true" tabindex="-1"></a>centers_groupe4<span class="sc">$</span>groupe <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1175-3"><a href="sect134.html#cb1175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1175-4"><a href="sect134.html#cb1175-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(centers_groupe4)</span>
<span id="cb1175-5"><a href="sect134.html#cb1175-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>variable)</span>
<span id="cb1175-6"><a href="sect134.html#cb1175-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1175-7"><a href="sect134.html#cb1175-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb1175-8"><a href="sect134.html#cb1175-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> value), <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb1175-9"><a href="sect134.html#cb1175-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(variable), <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1175-10"><a href="sect134.html#cb1175-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansStab4"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansStab4-1.png" alt="Distributions des valeurs des centres du groupe 4 sur 1000 itérations" width="90%"  />
<p class="caption">
Figure 13.30: Distributions des valeurs des centres du groupe 4 sur 1000 itérations
</p>
</div>
<p>Les différents histogrammes de la figure <a href="sect134.html#fig:kmeansStab4">13.30</a> indiquent clairement que pour plusieurs variables (<code>Lden</code>, <code>NO2</code>, <code>PM25</code>, <code>Pct_Img</code>, et <code>NivVieMed</code>) les caractéristiques du groupe 4 varient grandement sur l’ensemble des réplications. Nous pouvons comparer ce graphique à celui du groupe 2 qui est bien plus stable.</p>
<div class="sourceCode" id="cb1176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1176-1"><a href="sect134.html#cb1176-1" aria-hidden="true" tabindex="-1"></a>centers_groupe2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(stab_results<span class="sc">$</span>centers, stab_results<span class="sc">$</span>centers<span class="sc">$</span>groupe <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb1176-2"><a href="sect134.html#cb1176-2" aria-hidden="true" tabindex="-1"></a>centers_groupe2<span class="sc">$</span>groupe <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb1176-3"><a href="sect134.html#cb1176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1176-4"><a href="sect134.html#cb1176-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(centers_groupe2)</span>
<span id="cb1176-5"><a href="sect134.html#cb1176-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>variable <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>variable)</span>
<span id="cb1176-6"><a href="sect134.html#cb1176-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1176-7"><a href="sect134.html#cb1176-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df) <span class="sc">+</span> </span>
<span id="cb1176-8"><a href="sect134.html#cb1176-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> value), <span class="at">bins =</span> <span class="dv">30</span>) <span class="sc">+</span> </span>
<span id="cb1176-9"><a href="sect134.html#cb1176-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(variable), <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>) <span class="sc">+</span> </span>
<span id="cb1176-10"><a href="sect134.html#cb1176-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kmeansStab5"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kmeansStab5-1.png" alt="Distributions des valeurs des centres du groupe 2 sur 1000 itérations" width="90%"  />
<p class="caption">
Figure 13.31: Distributions des valeurs des centres du groupe 2 sur 1000 itérations
</p>
</div>
<p>Nous pouvons constater une plus faible variance des résultats obtenus (en regardant notamment l’axe horizontal) pour les centres des groupes à la figure <a href="sect134.html#fig:kmeansStab5">13.31</a>.</p>
</div>
</div>
</div>
</div>
<h3>R&eacute;f&eacute;rences</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-fukuyama1989" class="csl-entry">
Fukuyama, Yoshiki. 1989. <span>« A new method of choosing the number of clusters for the fuzzy c-mean method. »</span> In <em>Proc. 5th Fuzzy Syst. Symp., 1989</em>, 247‑250. s.n.
</div>
<div id="ref-2021_4" class="csl-entry">
———. 2021b. <span>« Apport de la classification floue c-means spatiale en g<span>é</span>ographie: essai de taxinomie socio-r<span>é</span>sidentielle et environnementale <span>à</span> Lyon. »</span> <em>Cybergeo: European Journal of Geography</em>. <a href="https://doi.org/10.4000/cybergeo.36414">https://doi.org/10.4000/cybergeo.36414</a>.
</div>
<div id="ref-macqueen1967" class="csl-entry">
MacQueen, James. 1967. <span>« Some methods for classification and analysis of multivariate observations. »</span> In <em>Proceedings of the fifth Berkeley symposium on mathematical statistics and probability</em>, 1:281‑297. 14. Oakland, CA, USA.
</div>
<div id="ref-xie1991validity" class="csl-entry">
Xie, Xuanli Lisa et Gerardo Beni. 1991. <span>« A validity measure for fuzzy clustering. »</span> <em>IEEE Transactions on pattern analysis and machine intelligence</em> 13 (8): 841‑847. <a href="https://doi.org/10.1109/34.85677">https://doi.org/10.1109/34.85677</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect133.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect135.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MethodesQuantitScSocialesBolR.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
