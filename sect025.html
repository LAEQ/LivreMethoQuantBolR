<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.5 Statistiques descriptives sur des variables quantitatives | Méthodes quantitatives en sciences sociales : un grand bol d’R</title>
  <meta name="description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="2.5 Statistiques descriptives sur des variables quantitatives | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="github-repo" content="LAEQ/livre_statistique_Phil_Jere" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.5 Statistiques descriptives sur des variables quantitatives | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  
  <meta name="twitter:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="twitter:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio et Jérémy Gelb" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect024.html"/>
<link rel="next" href="sect026.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d'R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Un manuel conçu comme un projet collaboratif</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment lire ce livre?</a></li>
<li class="chapter" data-level="" data-path="sect003B.html"><a href="sect003B.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en sciences sociales?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="sect007.html"><a href="sect007.html"><i class="fa fa-check"></i>Dédicace toute spéciale à Cargo et Ambrée</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auteurs.html"><a href="auteurs.html"><i class="fa fa-check"></i>À propos des auteurs</a></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Prise en main de R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Histoire et philosophie de R</a></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Environnement de travail</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Installation de R</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Environnement RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect0123"><i class="fa fa-check"></i><b>1.2.3</b> Installation et chargement un <em>package</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#aide-disponible"><i class="fa fa-check"></i><b>1.2.4</b> Aide disponible</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Bases du langage R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> <em>Hello World</em>!</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Objets et expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="sect013.html"><a href="sect013.html#sect0_133"><i class="fa fa-check"></i><b>1.3.3</b> Fonctions et arguments</a></li>
<li class="chapter" data-level="1.3.4" data-path="sect013.html"><a href="sect013.html#sect0134"><i class="fa fa-check"></i><b>1.3.4</b> Principaux types de données</a></li>
<li class="chapter" data-level="1.3.5" data-path="sect013.html"><a href="sect013.html#sect0135"><i class="fa fa-check"></i><b>1.3.5</b> Opérateurs</a></li>
<li class="chapter" data-level="1.3.6" data-path="sect013.html"><a href="sect013.html#sect0136"><i class="fa fa-check"></i><b>1.3.6</b> Structures de données</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Manipulation de données</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Manipulation d’un <em>DataFrame</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.5</b> Code R bien structuré</a></li>
<li class="chapter" data-level="1.6" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.6</b> Enregistrement des résultats</a></li>
<li class="chapter" data-level="1.7" data-path="sect018.html"><a href="sect018.html"><i class="fa fa-check"></i><b>1.7</b> Session de travail</a></li>
<li class="chapter" data-level="1.8" data-path="sect019.html"><a href="sect019.html"><i class="fa fa-check"></i><b>1.8</b> Conclusion et ressources pertinentes</a></li>
<li class="chapter" data-level="1.9" data-path="sect0110.html"><a href="sect0110.html"><i class="fa fa-check"></i><b>1.9</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>II Analyses univariées et graphiques dans R</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Statistiques descriptives univariées</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion et types de variable</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="sect021.html"><a href="sect021.html#sect0211"><i class="fa fa-check"></i><b>2.1.1</b> Notion de variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="sect021.html"><a href="sect021.html#sect0212"><i class="fa fa-check"></i><b>2.1.2</b> Types de variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Types de données</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Données secondaires <em>versus</em> données primaires</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Données transversales <em>versus</em> données longitudinales</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Données spatiales versus données aspatiales</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Données individuelles <em>versus</em> données agrégées</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Statistique descriptive et statistique inférentielle</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Population, échantillon et inférence</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Deux grandes familles de méthodes statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Notion de distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#définition-générale"><i class="fa fa-check"></i><b>2.4.1</b> Définition générale</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#anatomie-dune-distribution"><i class="fa fa-check"></i><b>2.4.2</b> Anatomie d’une distribution</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#principales-distributions"><i class="fa fa-check"></i><b>2.4.3</b> Principales distributions</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#conclusion-sur-les-distributions"><i class="fa fa-check"></i><b>2.4.4</b> Conclusion sur les distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Statistiques descriptives sur des variables quantitatives</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="sect025.html"><a href="sect025.html#sect0251"><i class="fa fa-check"></i><b>2.5.1</b> Paramètres de tendance centrale</a></li>
<li class="chapter" data-level="2.5.2" data-path="sect025.html"><a href="sect025.html#sect0252"><i class="fa fa-check"></i><b>2.5.2</b> Paramètres de position</a></li>
<li class="chapter" data-level="2.5.3" data-path="sect025.html"><a href="sect025.html#sect0253"><i class="fa fa-check"></i><b>2.5.3</b> Paramètres de dispersion</a></li>
<li class="chapter" data-level="2.5.4" data-path="sect025.html"><a href="sect025.html#sect0254"><i class="fa fa-check"></i><b>2.5.4</b> Paramètres de forme</a></li>
<li class="chapter" data-level="2.5.5" data-path="sect025.html"><a href="sect025.html#sect0255"><i class="fa fa-check"></i><b>2.5.5</b> Transformation des variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="sect025.html"><a href="sect025.html#sect0256"><i class="fa fa-check"></i><b>2.5.6</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="sect026.html"><a href="sect026.html#sect0261"><i class="fa fa-check"></i><b>2.6.1</b> Fréquences</a></li>
<li class="chapter" data-level="2.6.2" data-path="sect026.html"><a href="sect026.html#sect0262"><i class="fa fa-check"></i><b>2.6.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sect027.html"><a href="sect027.html"><i class="fa fa-check"></i><b>2.7</b> Statistiques descriptives pondérées : pour aller plus loin</a></li>
<li class="chapter" data-level="2.8" data-path="sect028.html"><a href="sect028.html"><i class="fa fa-check"></i><b>2.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Magie des graphiques</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Philosophie du ggplot2</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="sect031.html"><a href="sect031.html#sect0311"><i class="fa fa-check"></i><b>3.1.1</b> Grammaire</a></li>
<li class="chapter" data-level="3.1.2" data-path="sect031.html"><a href="sect031.html#sect0312"><i class="fa fa-check"></i><b>3.1.2</b> Types de géométries</a></li>
<li class="chapter" data-level="3.1.3" data-path="sect031.html"><a href="sect031.html#sect0313"><i class="fa fa-check"></i><b>3.1.3</b> Habillage</a></li>
<li class="chapter" data-level="3.1.4" data-path="sect031.html"><a href="sect031.html#utilisation-des-thèmes"><i class="fa fa-check"></i><b>3.1.4</b> Utilisation des thèmes</a></li>
<li class="chapter" data-level="3.1.5" data-path="sect031.html"><a href="sect031.html#sect0314"><i class="fa fa-check"></i><b>3.1.5</b> Composition d’une figure avec plusieurs graphiques</a></li>
<li class="chapter" data-level="3.1.6" data-path="sect031.html"><a href="sect031.html#sect0315"><i class="fa fa-check"></i><b>3.1.6</b> Couleur</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Principaux graphiques</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0321"><i class="fa fa-check"></i><b>3.2.1</b> Histogramme</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0322"><i class="fa fa-check"></i><b>3.2.2</b> Graphique de densité</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0323"><i class="fa fa-check"></i><b>3.2.3</b> Nuage de points</a></li>
<li class="chapter" data-level="3.2.4" data-path="sect032.html"><a href="sect032.html#sect0324"><i class="fa fa-check"></i><b>3.2.4</b> Graphique en ligne</a></li>
<li class="chapter" data-level="3.2.5" data-path="sect032.html"><a href="sect032.html#sect0325"><i class="fa fa-check"></i><b>3.2.5</b> Boîte à moustaches</a></li>
<li class="chapter" data-level="3.2.6" data-path="sect032.html"><a href="sect032.html#sect0326"><i class="fa fa-check"></i><b>3.2.6</b> Graphique en violon</a></li>
<li class="chapter" data-level="3.2.7" data-path="sect032.html"><a href="sect032.html#sect0327"><i class="fa fa-check"></i><b>3.2.7</b> Graphique en barre</a></li>
<li class="chapter" data-level="3.2.8" data-path="sect032.html"><a href="sect032.html#sect0328"><i class="fa fa-check"></i><b>3.2.8</b> Graphique circulaire</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Graphiques spéciaux</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Graphique en radar</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Diagramme d’accord</a></li>
<li class="chapter" data-level="3.3.3" data-path="sect033.html"><a href="sect033.html#sect0333"><i class="fa fa-check"></i><b>3.3.3</b> Nuage de mots</a></li>
<li class="chapter" data-level="3.3.4" data-path="sect033.html"><a href="sect033.html#sect0334"><i class="fa fa-check"></i><b>3.3.4</b> Carte proportionnelle</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Cartes</a></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Exportation des graphiques</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Conclusion sur les graphiques</a></li>
</ul></li>
<li class="part"><span><b>III Analyses bivariées</b></span></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Relation linéaire entre deux variables quantitatives</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Bref retour sur le postulat de la relation linéaire</a></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Covariance</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Formulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect043.html"><a href="sect043.html"><i class="fa fa-check"></i><b>4.3</b> Corrélation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="sect043.html"><a href="sect043.html#sect0431"><i class="fa fa-check"></i><b>4.3.1</b> Formulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="sect043.html"><a href="sect043.html#sect0432"><i class="fa fa-check"></i><b>4.3.2</b> Interprétation</a></li>
<li class="chapter" data-level="4.3.3" data-path="sect043.html"><a href="sect043.html#sect0433"><i class="fa fa-check"></i><b>4.3.3</b> Corrélations pour des variables anormalement distribuées (coefficient de Spearman, tau de Kendall)</a></li>
<li class="chapter" data-level="4.3.4" data-path="sect043.html"><a href="sect043.html#sect0434"><i class="fa fa-check"></i><b>4.3.4</b> Corrélations robustes (<em>Biweight midcorrelation</em>, <em>Percentage bend correlation</em> et la corrélation <em>pi</em> de Shepherd)</a></li>
<li class="chapter" data-level="4.3.5" data-path="sect043.html"><a href="sect043.html#sect0435"><i class="fa fa-check"></i><b>4.3.5</b> Significativité des coefficients de corrélation</a></li>
<li class="chapter" data-level="4.3.6" data-path="sect043.html"><a href="sect043.html#sect0436"><i class="fa fa-check"></i><b>4.3.6</b> Corrélation partielle</a></li>
<li class="chapter" data-level="4.3.7" data-path="sect043.html"><a href="sect043.html#sect0437"><i class="fa fa-check"></i><b>4.3.7</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.3.8" data-path="sect043.html"><a href="sect043.html#sect0438"><i class="fa fa-check"></i><b>4.3.8</b> Comment rapporter des valeurs de corrélations?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.4</b> Régression linéaire simple</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sect044.html"><a href="sect044.html#sect0441"><i class="fa fa-check"></i><b>4.4.1</b> Principe de base de la régression linéaire simple</a></li>
<li class="chapter" data-level="4.4.2" data-path="sect044.html"><a href="sect044.html#sect0442"><i class="fa fa-check"></i><b>4.4.2</b> Formulation de la droite de régression des moindres carrés ordinaires</a></li>
<li class="chapter" data-level="4.4.3" data-path="sect044.html"><a href="sect044.html#sect0443"><i class="fa fa-check"></i><b>4.4.3</b> Mesure de la qualité d’ajustement du modèle</a></li>
<li class="chapter" data-level="4.4.4" data-path="sect044.html"><a href="sect044.html#sect0444"><i class="fa fa-check"></i><b>4.4.4</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.4.5" data-path="sect044.html"><a href="sect044.html#sect0445"><i class="fa fa-check"></i><b>4.4.5</b> Comment rapporter une régression linéaire simple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Relation entre deux variables qualitatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Construction de tableau de contingence</a></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Test du khi-deux</a></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Interprétation d’un tableau de contingence</a></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Relation entre une variable qualitative et une variable quantitative</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Relation entre une variable quantitative et une variable qualitative à deux modalités</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Test <em>t</em> et ses différentes variantes</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Test non paramétrique de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Analyse de variance</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Test non paramétrique de Kruskal-Wallis</a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="6.2.4" data-path="sect062.html"><a href="sect062.html#sect0624"><i class="fa fa-check"></i><b>6.2.4</b> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Conclusion sur la troisième partie</a></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>IV Modèles de régression</b></span></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Principes de base de la régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Un peu d’équations…</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Hypothèses de la régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Évaluation de la qualité d’ajustement du modèle</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Mesures de la qualité d’un modèle</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Comparaison des modèles incrémentiels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Différentes mesures pour les coefficients de régression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sect074.html"><a href="sect074.html#sect0741"><i class="fa fa-check"></i><b>7.4.1</b> Coefficients de régression : évaluer l’effet des variables indépendantes</a></li>
<li class="chapter" data-level="7.4.2" data-path="sect074.html"><a href="sect074.html#sect0742"><i class="fa fa-check"></i><b>7.4.2</b> Coefficients de régression standardisés : repérer les variables les plus importantes du modèle</a></li>
<li class="chapter" data-level="7.4.3" data-path="sect074.html"><a href="sect074.html#sect0743"><i class="fa fa-check"></i><b>7.4.3</b> Significativité des coefficients de régression : valeurs de <em>t</em> et de <em>p</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="sect074.html"><a href="sect074.html#sect0744"><i class="fa fa-check"></i><b>7.4.4</b> Intervalle de confiance des coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Introduction de variables explicatives particulières</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sect075.html"><a href="sect075.html#sect0751"><i class="fa fa-check"></i><b>7.5.1</b> Exploration des relations non linéaires</a></li>
<li class="chapter" data-level="7.5.2" data-path="sect075.html"><a href="sect075.html#sect0752"><i class="fa fa-check"></i><b>7.5.2</b> Variable indépendante qualitative dichotomique</a></li>
<li class="chapter" data-level="7.5.3" data-path="sect075.html"><a href="sect075.html#sect0753"><i class="fa fa-check"></i><b>7.5.3</b> Variable indépendante qualitative polytomique</a></li>
<li class="chapter" data-level="7.5.4" data-path="sect075.html"><a href="sect075.html#sect0754"><i class="fa fa-check"></i><b>7.5.4</b> Variables d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sect076.html"><a href="sect076.html"><i class="fa fa-check"></i><b>7.6</b> Diagnostics de la régression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sect076.html"><a href="sect076.html#sect0761"><i class="fa fa-check"></i><b>7.6.1</b> Nombre d’observations</a></li>
<li class="chapter" data-level="7.6.2" data-path="sect076.html"><a href="sect076.html#sect0762"><i class="fa fa-check"></i><b>7.6.2</b> Normalité des résidus</a></li>
<li class="chapter" data-level="7.6.3" data-path="sect076.html"><a href="sect076.html#sect0763"><i class="fa fa-check"></i><b>7.6.3</b> Linéarité et homoscédasticité des résidus</a></li>
<li class="chapter" data-level="7.6.4" data-path="sect076.html"><a href="sect076.html#sect0764"><i class="fa fa-check"></i><b>7.6.4</b> Absence de multicolinéarité excessive</a></li>
<li class="chapter" data-level="7.6.5" data-path="sect076.html"><a href="sect076.html#sect0766"><i class="fa fa-check"></i><b>7.6.5</b> Absence d’observations aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sect077.html"><a href="sect077.html"><i class="fa fa-check"></i><b>7.7</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sect077.html"><a href="sect077.html#sect0771"><i class="fa fa-check"></i><b>7.7.1</b> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
<li class="chapter" data-level="7.7.2" data-path="sect077.html"><a href="sect077.html#sect0772"><i class="fa fa-check"></i><b>7.7.2</b> Comparaison des modèles</a></li>
<li class="chapter" data-level="7.7.3" data-path="sect077.html"><a href="sect077.html#sect0773"><i class="fa fa-check"></i><b>7.7.3</b> Diagnostic sur un modèle</a></li>
<li class="chapter" data-level="7.7.4" data-path="sect077.html"><a href="sect077.html#sect0774"><i class="fa fa-check"></i><b>7.7.4</b> Graphiques pour les effets marginaux</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sect078.html"><a href="sect078.html"><i class="fa fa-check"></i><b>7.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Régressions linéaires généralisées (GLM)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Qu’est qu’un modèle GLM?</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Formulation d’un GLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Autres distributions et rôle de la fonction de lien</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Conditions d’application</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Résidus et déviance</a></li>
<li class="chapter" data-level="8.1.5" data-path="sect081.html"><a href="sect081.html#sect0815"><i class="fa fa-check"></i><b>8.1.5</b> Vérification l’ajustement</a></li>
<li class="chapter" data-level="8.1.6" data-path="sect081.html"><a href="sect081.html#sect0816"><i class="fa fa-check"></i><b>8.1.6</b> Comparaison de deux modèles GLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Modèles GLM pour des variables qualitatives</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Modèle logistique binomial</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Modèle probit binomial</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Modèle logistique des cotes proportionnelles</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Modèle logistique multinomial</a></li>
<li class="chapter" data-level="8.2.5" data-path="sect082.html"><a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives"><i class="fa fa-check"></i><b>8.2.5</b> Conclusion sur les modèles pour des variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.3</b> Modèles GLM pour des variables de comptage</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="sect084.html"><a href="sect084.html#sect0841"><i class="fa fa-check"></i><b>8.3.1</b> Modèle de Poisson</a></li>
<li class="chapter" data-level="8.3.2" data-path="sect084.html"><a href="sect084.html#sect0842"><i class="fa fa-check"></i><b>8.3.2</b> Modèle binomial négatif</a></li>
<li class="chapter" data-level="8.3.3" data-path="sect084.html"><a href="sect084.html#sect0843"><i class="fa fa-check"></i><b>8.3.3</b> Modèle de Poisson avec excès fixe de zéros</a></li>
<li class="chapter" data-level="8.3.4" data-path="sect084.html"><a href="sect084.html#sect0844"><i class="fa fa-check"></i><b>8.3.4</b> Modèle de Poisson avec excès ajusté de zéros</a></li>
<li class="chapter" data-level="8.3.5" data-path="sect084.html"><a href="sect084.html#sect0845"><i class="fa fa-check"></i><b>8.3.5</b> Conclusion sur les modèles destinés à des variables de comptage</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sect085.html"><a href="sect085.html"><i class="fa fa-check"></i><b>8.4</b> Modèles GLM pour des variables continues</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sect085.html"><a href="sect085.html#sect0851"><i class="fa fa-check"></i><b>8.4.1</b> Modèle GLM gaussien</a></li>
<li class="chapter" data-level="8.4.2" data-path="sect085.html"><a href="sect085.html#sect0852"><i class="fa fa-check"></i><b>8.4.2</b> Modèle GLM avec une distribution de Student</a></li>
<li class="chapter" data-level="8.4.3" data-path="sect085.html"><a href="sect085.html#sect0853"><i class="fa fa-check"></i><b>8.4.3</b> Modèle GLM avec distribution Gamma</a></li>
<li class="chapter" data-level="8.4.4" data-path="sect085.html"><a href="sect085.html#sect0854"><i class="fa fa-check"></i><b>8.4.4</b> Modèle GLM avec une distribution bêta</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sect086.html"><a href="sect086.html"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="8.6" data-path="sect087.html"><a href="sect087.html"><i class="fa fa-check"></i><b>8.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Régressions à effets mixtes (GLMM)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Indépendance des observations et effets de groupes</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Terminologie: effets fixes et effets aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Principes de base des GLMM</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> GLMM avec constantes aléatoires</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.2</b> GLMM avec pentes aléatoires</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.3</b> GLMM avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Conditions d’application des GLMM</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Vérification de la distribution des effets aléatoires</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Homogénéité des variances au sein des groupes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Inférence dans les modèles GLMM</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#sect0941"><i class="fa fa-check"></i><b>9.4.1</b> Inférence pour les effets fixes</a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#sect0942"><i class="fa fa-check"></i><b>9.4.2</b> Inférence pour les effets aléatoires, effet global</a></li>
<li class="chapter" data-level="9.4.3" data-path="sect094.html"><a href="sect094.html#sect0943"><i class="fa fa-check"></i><b>9.4.3</b> Inférence pour les effets aléatoires, des constantes et des pentes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Conclusion sur les GLMM</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Mise en œuvre des GLMM dans R</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="sect096.html"><a href="sect096.html#sect0961"><i class="fa fa-check"></i><b>9.6.1</b> Ajustement du modèle avec uniquement une constante aléatoire</a></li>
<li class="chapter" data-level="9.6.2" data-path="sect096.html"><a href="sect096.html#sect0962"><i class="fa fa-check"></i><b>9.6.2</b> Ajustement du modèle avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sect097.html"><a href="sect097.html"><i class="fa fa-check"></i><b>9.7</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Régressions multiniveaux</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect101.html"><a href="sect101.html"><i class="fa fa-check"></i><b>10.1</b> Modèles multiniveaux : deux intérêts majeurs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect101.html"><a href="sect101.html#sect1011"><i class="fa fa-check"></i><b>10.1.1</b> Répartition de la variance entre les différents niveaux</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect101.html"><a href="sect101.html#sect1012"><i class="fa fa-check"></i><b>10.1.2</b> Estimation des coefficients aux différents niveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect102.html"><a href="sect102.html"><i class="fa fa-check"></i><b>10.2</b> Différents types de modèles multiniveaux</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect102.html"><a href="sect102.html#sect1021"><i class="fa fa-check"></i><b>10.2.1</b> Description du jeu de données utilisé</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect102.html"><a href="sect102.html#sect1022"><i class="fa fa-check"></i><b>10.2.2</b> Démarche classique pour les modèles multiniveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect103.html"><a href="sect103.html"><i class="fa fa-check"></i><b>10.3</b> Conditions d’application des régressions multiniveaux</a></li>
<li class="chapter" data-level="10.4" data-path="sect104.html"><a href="sect104.html"><i class="fa fa-check"></i><b>10.4</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect104.html"><a href="sect104.html#sect1041"><i class="fa fa-check"></i><b>10.4.1</b> Le modèle vide</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect104.html"><a href="sect104.html#sect1042"><i class="fa fa-check"></i><b>10.4.2</b> Modèle avec les variables indépendantes du niveau 1</a></li>
<li class="chapter" data-level="10.4.3" data-path="sect104.html"><a href="sect104.html#sect1043"><i class="fa fa-check"></i><b>10.4.3</b> Modèle avec les variables indépendantes aux niveaux 1 et 2</a></li>
<li class="chapter" data-level="10.4.4" data-path="sect104.html"><a href="sect104.html#sect10414"><i class="fa fa-check"></i><b>10.4.4</b> Modèle complet avec une interaction</a></li>
<li class="chapter" data-level="10.4.5" data-path="sect104.html"><a href="sect104.html#sect1045"><i class="fa fa-check"></i><b>10.4.5</b> Comparaison des quatre modèles</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect105.html"><a href="sect105.html"><i class="fa fa-check"></i><b>10.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> Modèles généralisés additifs</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sect111.html"><a href="sect111.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="sect111.html"><a href="sect111.html#sect1111"><i class="fa fa-check"></i><b>11.1.1</b> Non linéarité fonctionnelle</a></li>
<li class="chapter" data-level="11.1.2" data-path="sect111.html"><a href="sect111.html#sect1112"><i class="fa fa-check"></i><b>11.1.2</b> Non linéarité avec des polynomiales</a></li>
<li class="chapter" data-level="11.1.3" data-path="sect111.html"><a href="sect111.html#sect1113"><i class="fa fa-check"></i><b>11.1.3</b> Non linéarité par segments</a></li>
<li class="chapter" data-level="11.1.4" data-path="sect111.html"><a href="sect111.html#sect1114"><i class="fa fa-check"></i><b>11.1.4</b> Non linéarité avec des <em>splines</em></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sect112.html"><a href="sect112.html"><i class="fa fa-check"></i><b>11.2</b> <em>Spline</em> de régression et <em>spline</em> de lissage</a></li>
<li class="chapter" data-level="11.3" data-path="sect113.html"><a href="sect113.html"><i class="fa fa-check"></i><b>11.3</b> Interprétation d’une <em>spline</em></a></li>
<li class="chapter" data-level="11.4" data-path="sect114.html"><a href="sect114.html"><i class="fa fa-check"></i><b>11.4</b> Multicolinéarité non linéaire</a></li>
<li class="chapter" data-level="11.5" data-path="sect115.html"><a href="sect115.html"><i class="fa fa-check"></i><b>11.5</b> <em>Splines</em> avancées</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sect115.html"><a href="sect115.html#sect1151"><i class="fa fa-check"></i><b>11.5.1</b> <em>Splines</em> cycliques</a></li>
<li class="chapter" data-level="11.5.2" data-path="sect115.html"><a href="sect115.html#sect1152"><i class="fa fa-check"></i><b>11.5.2</b> Splines par groupe</a></li>
<li class="chapter" data-level="11.5.3" data-path="sect115.html"><a href="sect115.html#sect1153"><i class="fa fa-check"></i><b>11.5.3</b> <em>Splines</em> multivariées et <em>splines</em> d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="sect116.html"><a href="sect116.html"><i class="fa fa-check"></i><b>11.6</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="11.7" data-path="sect117.html"><a href="sect117.html"><i class="fa fa-check"></i><b>11.7</b> GAMM</a></li>
<li class="chapter" data-level="11.8" data-path="sect118.html"><a href="sect118.html"><i class="fa fa-check"></i><b>11.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>V Analyses exploratoires multivariées</b></span></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> Méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sect121.html"><a href="sect121.html"><i class="fa fa-check"></i><b>12.1</b> Aperçu des méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="sect121.html"><a href="sect121.html#sect1211"><i class="fa fa-check"></i><b>12.1.1</b> Méthodes factorielles et types de données</a></li>
<li class="chapter" data-level="12.1.2" data-path="sect121.html"><a href="sect121.html#sect1212"><i class="fa fa-check"></i><b>12.1.2</b> Bref historique des méthodes factorielles</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sect122.html"><a href="sect122.html"><i class="fa fa-check"></i><b>12.2</b> Analyses en composantes principales (ACP)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="sect122.html"><a href="sect122.html#sect1221"><i class="fa fa-check"></i><b>12.2.1</b> Recherche d’une simplification</a></li>
<li class="chapter" data-level="12.2.2" data-path="sect122.html"><a href="sect122.html#sect1222"><i class="fa fa-check"></i><b>12.2.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.2.3" data-path="sect122.html"><a href="sect122.html#sect1223"><i class="fa fa-check"></i><b>12.2.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sect123.html"><a href="sect123.html"><i class="fa fa-check"></i><b>12.3</b> Analyse factorielle des correspondances (AFC)</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="sect123.html"><a href="sect123.html#sect1231"><i class="fa fa-check"></i><b>12.3.1</b> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
<li class="chapter" data-level="12.3.2" data-path="sect123.html"><a href="sect123.html#sect1232"><i class="fa fa-check"></i><b>12.3.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.3.3" data-path="sect123.html"><a href="sect123.html#sect1233"><i class="fa fa-check"></i><b>12.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="sect124.html"><a href="sect124.html"><i class="fa fa-check"></i><b>12.4</b> Analyse de correspondances multiples (ACM)</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="sect124.html"><a href="sect124.html#sect1241"><i class="fa fa-check"></i><b>12.4.1</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.4.2" data-path="sect124.html"><a href="sect124.html#sect1242"><i class="fa fa-check"></i><b>12.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="sect125.html"><a href="sect125.html"><i class="fa fa-check"></i><b>12.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> Méthodes de classification non supervisée</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sect131.html"><a href="sect131.html"><i class="fa fa-check"></i><b>13.1</b> Méthodes de classification : un aperçu</a></li>
<li class="chapter" data-level="13.2" data-path="sect132.html"><a href="sect132.html"><i class="fa fa-check"></i><b>13.2</b> Notions essentielles en classification</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="sect132.html"><a href="sect132.html#sect1321"><i class="fa fa-check"></i><b>13.2.1</b> Distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="sect132.html"><a href="sect132.html#sect1322"><i class="fa fa-check"></i><b>13.2.2</b> Inertie</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="sect133.html"><a href="sect133.html"><i class="fa fa-check"></i><b>13.3</b> Classification ascendante hiérarchique</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="sect133.html"><a href="sect133.html#sect1331"><i class="fa fa-check"></i><b>13.3.1</b> Fonctionnement de l’algorithme</a></li>
<li class="chapter" data-level="13.3.2" data-path="sect133.html"><a href="sect133.html#sect1332"><i class="fa fa-check"></i><b>13.3.2</b> Choisir le bon nombre de groupes</a></li>
<li class="chapter" data-level="13.3.3" data-path="sect133.html"><a href="sect133.html#sect1333"><i class="fa fa-check"></i><b>13.3.3</b> Limites de la classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="13.3.4" data-path="sect133.html"><a href="sect133.html#sect1334"><i class="fa fa-check"></i><b>13.3.4</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sect134.html"><a href="sect134.html"><i class="fa fa-check"></i><b>13.4</b> Nuées dynamiques</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="sect134.html"><a href="sect134.html#sect1341"><i class="fa fa-check"></i><b>13.4.1</b> <em>K-means</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="sect134.html"><a href="sect134.html#sect1342"><i class="fa fa-check"></i><b>13.4.2</b> K-médianes</a></li>
<li class="chapter" data-level="13.4.3" data-path="sect134.html"><a href="sect134.html#sect1343"><i class="fa fa-check"></i><b>13.4.3</b> K-médoïds</a></li>
<li class="chapter" data-level="13.4.4" data-path="sect134.html"><a href="sect134.html#sect1344"><i class="fa fa-check"></i><b>13.4.4</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="13.4.5" data-path="sect134.html"><a href="sect134.html#sect1346"><i class="fa fa-check"></i><b>13.4.5</b> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sect135.html"><a href="sect135.html"><i class="fa fa-check"></i><b>13.5</b> Conclusion sur la cinquième partie</a></li>
<li class="chapter" data-level="13.6" data-path="sect136.html"><a href="sect136.html"><i class="fa fa-check"></i><b>13.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>VI Annexes</b></span></li>
<li class="chapter" data-level="14" data-path="annexe1.html"><a href="annexe1.html"><i class="fa fa-check"></i><b>14</b> Table des valeurs critiques de khi-deux</a></li>
<li class="chapter" data-level="15" data-path="annexe2.html"><a href="annexe2.html"><i class="fa fa-check"></i><b>15</b> Table des valeurs critiques de Fisher</a></li>
<li class="chapter" data-level="16" data-path="annexe3.html"><a href="annexe3.html"><i class="fa fa-check"></i><b>16</b> Table des valeurs critiques de <em>t</em></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect025" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Statistiques descriptives sur des variables quantitatives<a href="sect025.html#sect025" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sect0251" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Paramètres de tendance centrale<a href="sect025.html#sect0251" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Trois mesures de tendance centrale permettent de résumer rapidement une variable quantitative :</p>
<ul>
<li>la <strong>moyenne arithmétique</strong> est simplement la somme des données d’une variable divisée par le nombre d’observations (<em>n</em>), soit <span class="math inline">\(\frac{\sum_{i=1}^n x_i}{n}\)</span> notée <span class="math inline">\(\mu\)</span> (prononcé <em>mu</em>) pour des données pour une population et <span class="math inline">\(\bar{x}\)</span> (prononcé <em>x barre</em>) pour un échantillon.</li>
<li>la <strong>médiane</strong> est la valeur qui coupe la distribution d’une variable d’une population ou d’un échantillon en deux parties égales. Autrement dit, 50 % des valeurs des observations lui sont supérieures et 50 % lui sont inférieures.</li>
<li>le <strong>mode</strong> est la valeur la plus fréquente parmi un ensemble d’observations pour une variable. Il s’applique ainsi à des variables discrètes (avec un nombre fini de valeurs discrètes dans un intervalle donné) et non à des variables continues (avec un nombre infini de valeurs réelles dans un intervalle donné). Prenons deux variables : l’une discrète relative au nombre d’accidents par intersection (avec <span class="math inline">\(X \in \left[0,20\right]\)</span>) et l’autre continue relative à la distance de dépassement (en mètres) d’un personne à vélo par un personne conduisant un véhicule motorisé (avec <span class="math inline">\(X \in \left[0,5\right]\)</span>). Pour la première, le mode – la valeur la plus fréquente – est certainement 0. Pour la seconde, identifier le mode n’est pas pertinent puisqu’il peut y avoir un nombre infini de valeurs entre 0 et 5 mètres.</li>
</ul>
<p><strong>Il convient de ne pas confondre moyenne et médiane!</strong> Dans le tableau <a href="sect025.html#tab:tableRevMoyMed">2.1</a>, nous avons reporté les valeurs moyennes et médianes des revenus des ménages pour les municipalités de l’île de Montréal en 2015. Par exemple, les 8685 ménages résidant à Wesmount disposaient en moyenne d’un revenu de 295 099 $; la moitié de ces 8685 ménages avaient un revenu inférieur à 100 153 $ et l’autre moitié un revenu supérieur à cette valeur (médiane). Cela démontre clairement que la moyenne peut être grandement affectée par des valeurs extrêmes (faibles ou fortes). Autrement dit, plus l’écart entre les valeurs de la moyenne et la médiane est important, plus les données de la variable sont inégalement réparties. À Westmount, soit la municipalité la plus nantie de l’île de Montréal, les valeurs extrêmes sont des ménages avec des revenus très élevés tirant fortement la moyenne vers le haut. À l’inverse, le faible écart entre les valeurs moyenne et médiane dans la municipalité de Montréal-Est (58 594 $ versus 50 318 $) souligne que les revenus des ménages sont plus également répartis. Cela explique que pour comparer les revenus totaux ou d’emploi entre différents groupes (selon le sexe, le groupe d’âge, le niveau d’éducation, la municipalité ou région métropolitaine, etc.), nous privilégions habituellement l’utilisation des revenus médians.</p>
<table>
<caption>
<span id="tab:tableRevMoyMed">Tableau 2.1: </span>Revenus moyens et médians des ménages en dollars, municipalités de l’île de Montréal, 2015
</caption>
<thead>
<tr>
<th style="text-align:left;">
Municipalité
</th>
<th style="text-align:right;">
Nombre de ménages
</th>
<th style="text-align:right;">
Revenu moyen
</th>
<th style="text-align:right;">
Revenu médian
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Baie-D’Urf<e9>
</td>
<td style="text-align:right;">
1 330
</td>
<td style="text-align:right;">
171 390
</td>
<td style="text-align:right;">
118 784
</td>
</tr>
<tr>
<td style="text-align:left;">
Beaconsfield
</td>
<td style="text-align:right;">
6 660
</td>
<td style="text-align:right;">
187 173
</td>
<td style="text-align:right;">
123 392
</td>
</tr>
<tr>
<td style="text-align:left;">
C<f4>te-Saint-Luc
</td>
<td style="text-align:right;">
13 490
</td>
<td style="text-align:right;">
94 570
</td>
<td style="text-align:right;">
58 935
</td>
</tr>
<tr>
<td style="text-align:left;">
Dollard-Des Ormeaux
</td>
<td style="text-align:right;">
17 210
</td>
<td style="text-align:right;">
102 104
</td>
<td style="text-align:right;">
78 981
</td>
</tr>
<tr>
<td style="text-align:left;">
Dorval
</td>
<td style="text-align:right;">
8 390
</td>
<td style="text-align:right;">
89 952
</td>
<td style="text-align:right;">
64 689
</td>
</tr>
<tr>
<td style="text-align:left;">
Hampstead
</td>
<td style="text-align:right;">
2 470
</td>
<td style="text-align:right;">
250 497
</td>
<td style="text-align:right;">
122 496
</td>
</tr>
<tr>
<td style="text-align:left;">
Kirkland
</td>
<td style="text-align:right;">
6 685
</td>
<td style="text-align:right;">
144 676
</td>
<td style="text-align:right;">
115 381
</td>
</tr>
<tr>
<td style="text-align:left;">
Montr<e9>al
</td>
<td style="text-align:right;">
779 805
</td>
<td style="text-align:right;">
69 047
</td>
<td style="text-align:right;">
50 227
</td>
</tr>
<tr>
<td style="text-align:left;">
Montr<e9>al-Est
</td>
<td style="text-align:right;">
1 730
</td>
<td style="text-align:right;">
58 594
</td>
<td style="text-align:right;">
50 318
</td>
</tr>
<tr>
<td style="text-align:left;">
Montr<e9>al-Ouest
</td>
<td style="text-align:right;">
1 850
</td>
<td style="text-align:right;">
159 374
</td>
<td style="text-align:right;">
115 029
</td>
</tr>
<tr>
<td style="text-align:left;">
Mont-Royal
</td>
<td style="text-align:right;">
7 370
</td>
<td style="text-align:right;">
205 309
</td>
<td style="text-align:right;">
109 540
</td>
</tr>
<tr>
<td style="text-align:left;">
Pointe-Claire
</td>
<td style="text-align:right;">
12 380
</td>
<td style="text-align:right;">
100 294
</td>
<td style="text-align:right;">
80 242
</td>
</tr>
<tr>
<td style="text-align:left;">
Sainte-Anne-de-Bellevue
</td>
<td style="text-align:right;">
1 960
</td>
<td style="text-align:right;">
102 969
</td>
<td style="text-align:right;">
67 200
</td>
</tr>
<tr>
<td style="text-align:left;">
Senneville
</td>
<td style="text-align:right;">
345
</td>
<td style="text-align:right;">
203 790
</td>
<td style="text-align:right;">
116 224
</td>
</tr>
<tr>
<td style="text-align:left;">
Westmount
</td>
<td style="text-align:right;">
8 685
</td>
<td style="text-align:right;">
295 099
</td>
<td style="text-align:right;">
100 153
</td>
</tr>
</tbody>
</table>
</div>
<div id="sect0252" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Paramètres de position<a href="sect025.html#sect0252" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les paramètres de position permettent de diviser une distribution en <em>n</em> parties égales.</p>
<ul>
<li>Les <strong>quartiles</strong> qui divisent une distribution en quatre parties (25 %) :
<ul>
<li>Q1 (25 %), soit le quartile inférieur ou premier quartile;</li>
<li>Q2 (50 %), soit la médiane;</li>
<li>Q3 (75 %), soit le quartile supérieur ou troisième quartile.</li>
</ul></li>
<li>Les <strong>quintiles</strong> qui divisent une distribution en cinq parties égales (20 %).</li>
<li>Les <strong>déciles</strong> (de D1 à D9) qui divisent une distribution en dix parties égales (10 %).</li>
<li>Les <strong>centiles</strong> (de C1 à C99) qui divisent une distribution en cent parties égales (1 %).</li>
</ul>
<p>En cartographie, les quartiles et les quintiles sont souvent utilisés pour discrétiser une variable quantitative (continue ou discrète) en quatre ou cinq classes et plus rarement, en dix classes (déciles). Avec les quartiles, les bornes des classes qui comprennent chacune 25 % des unités spatiales sont définies comme suit : [Min à Q1], [Q1 à Q2], [Q2 à Q3] et [Q3 à Max]. La méthode de discrétisation selon les quartiles ou quintiles permet de repérer, en un coup d’œil, à quelle tranche de 25 % ou de 20 % des données appartient chacune des unités spatiales. Cette méthode de discrétisation est aussi utile pour comparer plusieurs cartes et vérifier si deux phénomènes sont ou non colocalisés <span class="citation">(<a href="#ref-pumain1994" role="doc-biblioref">Pumain et Béguin 1994</a>)</span>. En guise d’exemple, les pourcentages de personnes à faible revenu et de locataires par secteur de recensement ont clairement des distributions spatiales très semblables dans la région métropolitaine de Montréal en 2016 (figure <a href="sect025.html#fig:figunivarie2">2.24</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figunivarie2"></span>
<img src="images/univariee/figure2.jpg" alt="Exemples de cartographie avec une discrétisation selon les quantiles" width="85%" />
<p class="caption">
Figure 2.24: Exemples de cartographie avec une discrétisation selon les quantiles
</p>
</div>
<p>Une lecture attentive des valeurs des centiles permet de repérer la présence de valeurs extrêmes, voire aberrantes, dans un jeu de données. Il n’est donc pas rare de les voir reportées dans un tableau de statistiques descriptives d’un article scientifique, et ce, afin de décrire succinctement les variables à l’étude. Par exemple, dans une étude récente comparant les niveaux d’exposition au bruit des cyclistes dans trois villes <span class="citation">(<a href="#ref-2020_1" role="doc-biblioref">Apparicio et Gelb 2020</a>)</span>, les auteurs reportent à la fois les valeurs moyennes et celles de plusieurs centiles. Globalement, la lecture des valeurs moyennes permet de constater que, sur la base des données collectées, les cyclistes sont plus exposés au bruit à Paris qu’à Montréal et Copenhague (73,4 dB(A) contre 70,7 et 68,4, tableau <a href="sect025.html#tab:tableCentiles">2.2</a>). Compte tenu de l’échelle logarithmique du bruit, la différence de 5 dB(A) entre les valeurs moyennes du bruit de Copenhague et de Paris peut être considérée comme une multiplication de l’énergie sonore par plus de 3. Pour Paris, l’analyse des quartiles montre que durant 25 % du temps des trajets à vélo (plus de 63 heures de collecte), les participantes et participants ont été exposés à des niveaux de bruit soit inférieurs à 69,1 dB(A) (premier quartile), soit supérieurs à 74 dB(A) (troisième quartile). Quant à l’analyse des centiles, elle permet de constater que durant 5 % et 10 % du temps, les participantes et participants étaient exposés à des niveaux de bruit très élevés, dépassant 75 dB(A) (C90 = 76 et C90 = 77,2).</p>
<table>
<caption>
<span id="tab:tableCentiles">Tableau 2.2: </span>Stastistiques descriptives de l’exposition au bruit des cyclistes par minute dans trois villes (dB(A), Laeq 1min)
</caption>
<thead>
<tr>
<th style="text-align:left;">
Statistiques
</th>
<th style="text-align:right;">
Copenhague
</th>
<th style="text-align:right;">
Montréal
</th>
<th style="text-align:right;">
Paris
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
N
</td>
<td style="text-align:right;">
6 212,0
</td>
<td style="text-align:right;">
4 723,0
</td>
<td style="text-align:right;">
3 793,0
</td>
</tr>
<tr>
<td style="text-align:left;">
Moyenne de bruit
</td>
<td style="text-align:right;">
68,4
</td>
<td style="text-align:right;">
70,7
</td>
<td style="text-align:right;">
73,4
</td>
</tr>
<tr>
<td style="text-align:left;">
Centiles
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
57,5
</td>
<td style="text-align:right;">
59,2
</td>
<td style="text-align:right;">
62,3
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
59,1
</td>
<td style="text-align:right;">
61,1
</td>
<td style="text-align:right;">
65,0
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
60,3
</td>
<td style="text-align:right;">
62,3
</td>
<td style="text-align:right;">
66,5
</td>
</tr>
<tr>
<td style="text-align:left;">
25 (premier quartile)
</td>
<td style="text-align:right;">
62,7
</td>
<td style="text-align:right;">
64,5
</td>
<td style="text-align:right;">
69,1
</td>
</tr>
<tr>
<td style="text-align:left;">
50 (médiane)
</td>
<td style="text-align:right;">
66,0
</td>
<td style="text-align:right;">
67,7
</td>
<td style="text-align:right;">
71,6
</td>
</tr>
<tr>
<td style="text-align:left;">
75 (troisième quartile)
</td>
<td style="text-align:right;">
69,2
</td>
<td style="text-align:right;">
71,0
</td>
<td style="text-align:right;">
74,0
</td>
</tr>
<tr>
<td style="text-align:left;">
90
</td>
<td style="text-align:right;">
71,9
</td>
<td style="text-align:right;">
73,7
</td>
<td style="text-align:right;">
76,0
</td>
</tr>
<tr>
<td style="text-align:left;">
95
</td>
<td style="text-align:right;">
73,3
</td>
<td style="text-align:right;">
75,2
</td>
<td style="text-align:right;">
77,2
</td>
</tr>
<tr>
<td style="text-align:left;">
99
</td>
<td style="text-align:right;">
76,5
</td>
<td style="text-align:right;">
78,9
</td>
<td style="text-align:right;">
81,0
</td>
</tr>
</tbody>
</table>
</div>
<div id="sect0253" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Paramètres de dispersion<a href="sect025.html#sect0253" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Cinq principales mesures de dispersion permettent d’évaluer la variabilité des valeurs d’une variable quantitative : l’étendue, l’écart interquartile, la variance, l’écart-type et le coefficient de variation. Notez d’emblée que cette dernière mesure ne s’applique pas à des variables d’intervalle (section <a href="sect021.html#sect02122">2.1.2.2</a>).</p>
<ul>
<li><p><strong>L’étendue</strong> est la différence entre les valeurs minimale et maximale d’une variable, soit l’intervalle des valeurs dans lequel elle a été mesurée. Il convient d’analyser avec prudence cette mesure puisqu’elle inclut dans son calcul des valeurs potentiellement extrêmes, voire aberrantes (faibles ou fortes).</p></li>
<li><p><strong>L’intervalle ou écart interquartile</strong> est la différence entre les troisième et premier quartiles (Q3 − Q1). Il représente ainsi une mesure de la dispersion des valeurs de 50 % des observations centrales de la distribution. Plus la valeur de l’écart interquartile est élevée, plus la dispersion des 50 % des observations centrales est forte. Contrairement à l’étendue, cette mesure élimine l’influence des valeurs extrêmes puisqu’elle ne tient pas compte des 25 % des observations les plus faibles [Min à Q1] et des 25 % des observations les plus fortes [Q3 à Max]. Graphiquement, l’intervalle interquartile est représenté à l’aide d’une boîte à moustaches (<em>boxplot</em> en anglais) : plus l’intervalle interquartile est grand, plus la boîte est allongée (figure <a href="sect025.html#fig:figunivarie3">2.25</a>)</p></li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figunivarie3"></span>
<img src="images/univariee/figure3.jpg" alt="Graphique en violon, boîte à moustaches et intervalle interquartile" width="30%" />
<p class="caption">
Figure 2.25: Graphique en violon, boîte à moustaches et intervalle interquartile
</p>
</div>
<ul>
<li><strong>La variance</strong> est la somme des déviations à la moyenne au carré (numérateur) divisée par le nombre d’observations pour une population (<span class="math inline">\(\sigma^2\)</span>) ou divisée par le nombre d’observations moins une (<span class="math inline">\(s^2\)</span>) pour un échantillon (équation <a href="sect025.html#eq:variance">(2.20)</a>). Puisque les déviations à la moyenne sont mises au carré, la valeur de la variance (tout comme celle de l’écart-type) est toujours positive. Plus sa valeur est élevée, plus les observations sont dispersées autour de la moyenne. La variance représente ainsi l’écart au carré moyen des observations à la moyenne.</li>
</ul>
<p><span class="math display" id="eq:variance">\[\begin{equation}  
\sigma^2=\frac{\sum_{i=1}^n (x_{i}-\mu)^2}{n} \text{ ou } s^2=\frac{\sum_{i=1}^n (x_{i}-\bar{x})^2}{n-1}
\tag{2.20}
\end{equation}\]</span>
</p>
<ul>
<li><strong>L’écart-type</strong> est la racine carrée de la variance (équation <a href="sect025.html#eq:ecartype">(2.21)</a>). Rappelez-vous que la variance est calculée à partir des déviations à la moyenne mises au carré. Étant donné que l’écart-type est la racine carrée de la variance, il est donc évalué dans la même unité que la variable, contrairement à la variance. Bien entendu, comme pour la variance, plus la valeur de l’écart-type est élevée, plus la distribution des observations autour de la moyenne est dispersée.</li>
</ul>
<p><span class="math display" id="eq:ecartype">\[\begin{equation}  
\sigma=\sqrt{\sigma^2}=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\mu)^2}{n}} \text{ ou } s=\sqrt{s^2}=\sqrt{\frac{\sum_{i=1}^n (x_{i}-\bar{x})^2}{n-1}}
\tag{2.21}
\end{equation}\]</span>
</p>
<div class="bloc_notes">
<p>Les formules des variances et des écarts-types pour une population et un échantillon sont très similaires : seul le dénominateur change avec <span class="math inline">\(n\)</span> <em>versus</em> <span class="math inline">\(n-1\)</span> observations. Par conséquent, plus le nombre d’observations de votre jeu de données est important, plus l’écart entre ces deux mesures de dispersion pour une population et un échantillon est minime.</p>
<p>Comme dans la plupart des logiciels de statistique, les fonctions de base <code>var</code> et <code>sd</code> de R calculent la variance et l’écart-type pour un échantillon (<span class="math inline">\(n-1\)</span> au dénominateur). Si vous souhaitez les calculer pour une population, adaptez la syntaxe ci-dessous dans laquelle <code>df$var1</code> représente la variable intitulée <code>var1</code> présente dans un <em>DataFrame</em> nommé <code>df</code>.</p>
<p><code>var.p &lt;- mean((df$var1 - mean(df$var1))^2)</code></p>
<p><code>sd.p &lt;- sqrt(mean((df$var1 - mean(df$var1))^2))</code></p>
</div>
<ul>
<li><strong>Le coefficient de variation (CV)</strong> est le rapport entre l’écart-type et la moyenne, représentant ainsi une standardisation de l’écart-type ou, en d’autres termes, une mesure de dispersion relative (équation <a href="sect025.html#eq:cv">(2.22)</a>). L’écart-type étant exprimé dans l’unité de mesure de la variable, il ne peut pas être utilisé pour comparer les dispersions de variables exprimées des unités de mesure différentes (par exemple, en pourcentage, en kilomètres, en dollars, etc.). Pour y remédier, nous utilisons le coefficient de variation : une variable est plus dispersée qu’une autre si la valeur de son CV est plus élevée. Certaines personnes préfèrent multiplier la valeur du CV par 100 : l’écart-type est alors exprimé en pourcentage de la moyenne.</li>
</ul>
<p><span class="math display" id="eq:cv">\[\begin{equation}  
CV=\frac{\sigma}{\mu} \text{ ou } CV=\frac{s^2}{\bar{x}}
\tag{2.22}
\end{equation}\]</span>
</p>
<p>Illustrons comment calculer les cinq mesures de dispersion précédemment décrites à partir de valeurs fictives pour huit observations (colonne intitulée <span class="math inline">\(x_i\)</span> au tableau <a href="sect025.html#tab:datavar">2.3</a>). Les différentes statistiques reportées dans ce tableau sont calculées comme suit :</p>
<ul>
<li><p>La <strong>moyenne</strong> est la somme divisée par le nombre d’observations, soit <span class="math inline">\(\mbox{248/8}=\mbox{31}\)</span>.</p></li>
<li><p>L’<strong>étendue</strong> est la différence entre les valeurs maximale et minimale, soit <span class="math inline">\(\mbox{40}-\mbox{22}=\mbox{30}\)</span>.</p></li>
<li><p>Les quartiles coupent la distribution en quatre parties égales. Avec huit observations triées par ordre croissant, <strong>le premier quartile</strong> est égal à la valeur de la deuxième observation (soit 25), la <strong>médiane</strong> à celle de la quatrième (30), le <strong>troisième quartile</strong> à celle de la sixième (35).</p></li>
<li><p><strong>L’écart interquartile</strong> est la différence entre Q3 et Q1, soit <span class="math inline">\(\mbox{35}-\mbox{25}=\mbox{10}\)</span>.</p></li>
<li><p>La seconde colonne du tableau est l’écart à la moyenne (<span class="math inline">\(x_i-\bar{x}\)</span>), soit <span class="math inline">\(\mbox{22} - \mbox{31} = -\mbox{9}\)</span> pour l’observation <em>1</em>; la somme de ces écarts est toujours égale à 0. La troisième colonne est cette déviation mise au carré (<span class="math inline">\((x_i-\bar{x})^2\)</span>), soit <span class="math inline">\(-\mbox{9}^2 = \mbox{81}\)</span>, toujours pour l’observation <em>1</em>. La somme de ces déviations à la moyenne au carré (268) représente le numérateur de la variance (équation <a href="sect025.html#eq:variance">(2.20)</a>). En divisant cette somme par le nombre d’observations, nous obtenons la <strong>variance pour une population</strong> (<span class="math inline">\(\mbox{268}/\mbox{8}=\mbox{33,5}\)</span>) tandis que la <strong>variance d’un échantillon</strong> est égale à <span class="math inline">\(\mbox{268}/(\mbox{8}-\mbox{1})=\mbox{38,29}\)</span>.</p></li>
<li><p>L’écart-type est la racine carrée de la variance (équation <a href="sect025.html#eq:ecartype">(2.21)</a>), soit <span class="math inline">\(\sigma=\sqrt{\mbox{33,5}}=\mbox{5,79}\)</span> et <span class="math inline">\(s=\sqrt{\mbox{38,29}}=\mbox{6,19}\)</span>.</p></li>
<li><p>Finalement, les valeurs des coefficients de variation (équation <a href="sect025.html#eq:cv">(2.22)</a>) sont de <span class="math inline">\(\mbox{5,79}/\mbox{31}=\mbox{0,19}\)</span> pour une population et <span class="math inline">\(\mbox{6,19}/\mbox{31}=\mbox{0,20}\)</span> pour un échantillon.</p></li>
</ul>
<table>
<caption>
<span id="tab:datavar">Tableau 2.3: </span>Calcul des mesures de dispersion sur des données fictives
</caption>
<thead>
<tr>
<th style="text-align:left;">
Observation
</th>
<th style="text-align:right;">
<span class="math inline">\(x_i\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(x_i-\bar{x}\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\((x_i-\bar{x})^2\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
22,00
</td>
<td style="text-align:center;">
-9
</td>
<td style="text-align:right;">
81,0
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
25,00
</td>
<td style="text-align:center;">
-6
</td>
<td style="text-align:right;">
36,0
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
27,00
</td>
<td style="text-align:center;">
-4
</td>
<td style="text-align:right;">
16,0
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
30,00
</td>
<td style="text-align:center;">
-1
</td>
<td style="text-align:right;">
1,0
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
32,00
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:right;">
1,0
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
35,00
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:right;">
16,0
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
37,00
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:right;">
36,0
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
40,00
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:right;">
81,0
</td>
</tr>
<tr>
<td style="text-align:left;">
<strong>Statistique</strong>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
N
</td>
<td style="text-align:right;">
8,00
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Somme
</td>
<td style="text-align:right;">
248,00
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:right;">
268,0
</td>
</tr>
<tr>
<td style="text-align:left;">
Moyenne (<span class="math inline">\(\bar{x}\)</span> ou <span class="math inline">\(\mu\)</span>)
</td>
<td style="text-align:right;">
31,00
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:right;">
33,5
</td>
</tr>
<tr>
<td style="text-align:left;">
Étendue
</td>
<td style="text-align:right;">
18,00
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Premier quartile
</td>
<td style="text-align:right;">
25,00
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Troisième quartile
</td>
<td style="text-align:right;">
35,00
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Intervalle interquartile
</td>
<td style="text-align:right;">
10,00
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Variance (population, <span class="math inline">\(\sigma^2\)</span>)
</td>
<td style="text-align:right;">
33,50
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Écart-type (population, <span class="math inline">\(\sigma\)</span>)
</td>
<td style="text-align:right;">
5,79
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Variance (échantillon, <span class="math inline">\(s^2\)</span>)
</td>
<td style="text-align:right;">
38,29
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Écart-type (échantillon, <span class="math inline">\(s\)</span>)
</td>
<td style="text-align:right;">
6,19
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Coefficient de variation (<span class="math inline">\(\sigma / \mu\)</span>)
</td>
<td style="text-align:right;">
0,19
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Coefficient de variation (<span class="math inline">\(s / \bar{x}\)</span>)
</td>
<td style="text-align:right;">
0,20
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>Le tableau <a href="sect025.html#tab:datavar2">2.4</a> vise à démontrer, à partir de trois variables, comment certaines mesures de dispersion sont sensibles à l’unité de mesure et/ou aux valeurs extrêmes.</p>
<p>Concernant <strong>l’unité de mesure</strong>, nous avons créé deux variables <em>A</em> et <em>B</em>, où <em>B</em> étant simplement <em>A</em> multipliée par 10. Pour <em>A</em>, les valeurs de la moyenne, de l’étendue et de l’intervalle interquartile sont respectivement 31, 18 et 10. Sans surprise, celles de <em>B</em> sont multipliées par 10 (310, 180, 100). La variance étant la moyenne des déviations à la moyenne au carré, elle est égale à 33,50 pour <em>A</em> et donc à <span class="math inline">\(\mbox{33,50}\times10^2=\mbox{3350}\)</span> pour <em>B</em>; l’écart-type de <em>B</em> est égal à celui de <em>A</em> multiplié par 10. Cela démontre que l’étendue, l’intervalle interquartile, la variance et l’écart-type sont des mesures de dispersion dépendantes de l’unité de mesure. Par contre, étant donné que le coefficient de variation (CV) est le rapport de l’écart-type avec la moyenne, il a la même valeur pour <em>A</em> et <em>B</em>, ce qui démontre que le CV est bien une mesure de dispersion relative permettant de comparer des variables exprimées dans des unités de mesure différentes.</p>
<p>Concernant <strong>la sensibilité aux valeurs extrêmes</strong>, nous avons créé la variable <em>C</em> pour laquelle seule la huitième observation a une valeur différente (40 pour <em>A</em> et 105 pour <em>B</em>). Cette valeur de 105 pourrait être soit une valeur extrême positive mesurée, soit une valeur aberrante (par exemple, si l’unité de mesure était un pourcentage variant de 0 à 100 %). Cette valeur a un impact important sur la moyenne (31 contre 39,12) et l’étendue (18 contre 83) et corollairement sur la variance (33,50 contre 641,86), l’écart-type (5,79 contre 25,33) et le coefficient de variation (0,19 contre 0,65). Par contre, comme l’intervalle interquartile est calculé sur 50 % des observations centrales (<span class="math inline">\(\mbox{Q3}-\mbox{Q1}\)</span>), il n’est pas affecté par cette valeur extrême.</p>
<table>
<caption>
<span id="tab:datavar2">Tableau 2.4: </span>Illustration de la sensibilité des mesures de dispersion à l’unité de mesure et aux valeurs extrêmes
</caption>
<thead>
<tr>
<th style="text-align:left;">
Observation
</th>
<th style="text-align:right;">
A
</th>
<th style="text-align:right;">
B
</th>
<th style="text-align:right;">
C
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
22,00
</td>
<td style="text-align:right;">
220,00
</td>
<td style="text-align:right;">
22,00
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
25,00
</td>
<td style="text-align:right;">
250,00
</td>
<td style="text-align:right;">
25,00
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
27,00
</td>
<td style="text-align:right;">
270,00
</td>
<td style="text-align:right;">
27,00
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
30,00
</td>
<td style="text-align:right;">
300,00
</td>
<td style="text-align:right;">
30,00
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
32,00
</td>
<td style="text-align:right;">
320,00
</td>
<td style="text-align:right;">
32,00
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
35,00
</td>
<td style="text-align:right;">
350,00
</td>
<td style="text-align:right;">
35,00
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
37,00
</td>
<td style="text-align:right;">
370,00
</td>
<td style="text-align:right;">
37,00
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
40,00
</td>
<td style="text-align:right;">
400,00
</td>
<td style="text-align:right;">
105,00
</td>
</tr>
<tr>
<td style="text-align:left;">
<strong>Statistique</strong>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Moyenne (<span class="math inline">\(\mu\)</span>)
</td>
<td style="text-align:right;">
31,00
</td>
<td style="text-align:right;">
310,00
</td>
<td style="text-align:right;">
39,12
</td>
</tr>
<tr>
<td style="text-align:left;">
Étendue
</td>
<td style="text-align:right;">
18,00
</td>
<td style="text-align:right;">
180,00
</td>
<td style="text-align:right;">
83,00
</td>
</tr>
<tr>
<td style="text-align:left;">
Intervalle interquartile
</td>
<td style="text-align:right;">
10,00
</td>
<td style="text-align:right;">
100,00
</td>
<td style="text-align:right;">
10,00
</td>
</tr>
<tr>
<td style="text-align:left;">
Variance (population, <span class="math inline">\(\sigma^2\)</span>)
</td>
<td style="text-align:right;">
33,50
</td>
<td style="text-align:right;">
3 350,00
</td>
<td style="text-align:right;">
641,86
</td>
</tr>
<tr>
<td style="text-align:left;">
Écart-type (population, <span class="math inline">\(\sigma\)</span>)
</td>
<td style="text-align:right;">
5,79
</td>
<td style="text-align:right;">
57,88
</td>
<td style="text-align:right;">
25,33
</td>
</tr>
<tr>
<td style="text-align:left;">
Coefficient de variation (<span class="math inline">\(\sigma / \mu\)</span>)
</td>
<td style="text-align:right;">
0,19
</td>
<td style="text-align:right;">
0,19
</td>
<td style="text-align:right;">
0,65
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:resume">Tableau 2.5: </span>Résumé de la sensibilité de la moyenne et des mesures de dispersion
</caption>
<thead>
<tr>
<th style="text-align:left;">
Statistique
</th>
<th style="text-align:center;">
Unité de mesure
</th>
<th style="text-align:center;">
Valeurs extrêmes
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Moyenne
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
Étendue
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
Intervalle interquartile
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Variance
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
Écart-type
</td>
<td style="text-align:center;">
X
</td>
<td style="text-align:center;">
X
</td>
</tr>
<tr>
<td style="text-align:left;">
Coefficient de variation
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
X
</td>
</tr>
</tbody>
</table>
</div>
<div id="sect0254" class="section level3 hasAnchor" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> Paramètres de forme<a href="sect025.html#sect0254" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="vérification-de-la-normalité-dune-variable-quantitative" class="section level4 hasAnchor" number="2.5.4.1">
<h4><span class="header-section-number">2.5.4.1</span> Vérification de la normalité d’une variable quantitative<a href="sect025.html#vérification-de-la-normalité-dune-variable-quantitative" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="bloc_objectif">
<p>De nombreuses méthodes statistiques qui sont abordées dans les chapitres suivants – entre autres, la corrélation de Pearson, les test <em>t</em> et l’analyse de variance, les régressions simple et multiple – requièrent que la variable quantitative suive une <strong>distribution normale</strong> (nommée aussi <strong>distribution gaussienne</strong>).</p>
<p>Dans cette sous-section, nous décrivons trois démarches pour vérifier si la distribution d’une variable est normale : les coefficients d’asymétrie et d’aplatissement (<em>skewness</em> et <em>kurtosis</em> en anglais), les graphiques (histogramme avec courbe normale et diagramme quantile-quantile), les tests de normalité (tests de Shapiro-Wilk, de Kolmogorov-Smirnov, de Lilliefors, d’Anderson-Darling et de Jarque-Bera).</p>
<p><strong>Il est vivement recommandé de réaliser les trois démarches!</strong></p>
</div>
<p>Une distribution est normale quand elle est symétrique et mésokurtique (figure <a href="sect025.html#fig:figFormeDistr">2.26</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figFormeDistr"></span>
<img src="images/univariee/FormeDistribution.jpg" alt="Formes d'une distribution et coefficients d'asymétrie et d'aplatissement" width="70%" />
<p class="caption">
Figure 2.26: Formes d’une distribution et coefficients d’asymétrie et d’aplatissement
</p>
</div>
<div id="vérification-de-la-normalité-avec-les-coefficients-dasymétrie-et-daplatissement" class="section level5 hasAnchor" number="2.5.4.1.1">
<h5><span class="header-section-number">2.5.4.1.1</span> Vérification de la normalité avec les coefficients d’asymétrie et d’aplatissement<a href="sect025.html#vérification-de-la-normalité-avec-les-coefficients-dasymétrie-et-daplatissement" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><strong>Une distribution est dite symétrique</strong> quand la moyenne arithmétique est au centre de la distribution, c’est-à-dire que les observations sont bien réparties de part et d’autre de la moyenne qui est alors égale à la médiane et au mode (nous utilisons uniquement le mode pour une variable discrète et non pour une variable continue). Pour évaluer l’asymétrie, nous utilisons habituellement le coefficient d’asymétrie (<em>skewness</em> en anglais).</p>
<p>Sachez toutefois qu’il existe trois façons (formules) pour le calculer <span class="citation">(<a href="#ref-joanes1998comparing" role="doc-biblioref">Joanes et Gill 1998</a>)</span> : <span class="math inline">\(g_1\)</span> est la formule classique (équation <a href="sect025.html#eq:SkewType1">(2.23)</a>), disponible dans R avec la fonction <code>skewness</code> du <em>package</em> <code>moments</code>), <span class="math inline">\(G_1\)</span> est une version ajustée (équation <a href="sect025.html#eq:SkewType2">(2.24)</a>), utilisée dans les logiciels SAS et SPSS notamment) et <span class="math inline">\(b_1\)</span> est une autre version ajustée (équation <a href="sect025.html#eq:SkewType3">(2.25)</a>), utilisée par les logiciels MINITAB et BMDP). Nous verrons qu’avec les <em>packages</em> <code>DescTools</code> ou <code>e1071</code>, il est possible de calculer ces trois méthodes. Aussi, pour des grands échantillons (<span class="math inline">\(n&gt;100\)</span>), il y a très peu de différences entre les résultats produits par ces trois formules <span class="citation">(<a href="#ref-joanes1998comparing" role="doc-biblioref">Joanes et Gill 1998</a>)</span>. Quelle que soit la formule utilisée, le coefficient d’asymétrie s’interprète comme suit (figure <a href="sect025.html#fig:asymetrie">2.27</a>) :</p>
<ul>
<li>Quand la valeur du <em>skewness</em> est négative, la <strong>distribution est asymétrique négative</strong>. La distribution est alors tirée à gauche par des valeurs extrêmes faibles, mais peu nombreuses. Nous employons souvent l’expression <em>la queue de distribution</em> est étirée vers la gauche. La moyenne est alors inférieure à la médiane.</li>
<li>Quand la valeur du <em>skewness</em> est égale à 0, <strong>la distribution est symétrique</strong> (la médiane est égale à la moyenne). Pour une variable discrète, les valeurs du mode, de la moyenne et de la médiane sont égales.</li>
<li>Quand la valeur du <em>skewness</em> est positive, la <strong>distribution est symétrique positive</strong>. La distribution est alors tirée à droite par des valeurs extrêmes fortes, mais peu nombreuses. La queue de distribution est alors étirée vers la droite et la moyenne est supérieure à la médiane. En sciences sociales, les variables de revenu (totaux ou d’emploi, des individus ou des ménages) ont souvent des distributions asymétriques positives : la moyenne est affectée par quelques observations avec des valeurs de revenu très élevées et est ainsi supérieure à la médiane. En études urbaines, la densité de la population pour des unités géographiques d’une métropole donnée (secteur de recensement par exemple) a aussi souvent une distribution asymétrique positive : quelques secteurs de recensement au centre de la métropole sont caractérisés par des valeurs de densité très élevées qui tirent la distribution vers la droite.</li>
</ul>
<p><span class="math display" id="eq:SkewType1">\[\begin{equation}  
g_1=\frac{ \frac{1}{n} \sum_{i=1}^n(x_i-\bar{x})^3} { \left[\frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^2\right] ^\frac{3}{2}}
\tag{2.23}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:SkewType2">\[\begin{equation}  
G_1= \frac{\sqrt{n(n-1)}}{n-2} g_1
\tag{2.24}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:SkewType3">\[\begin{equation}  
b_1= \left( \frac{n-1}{n} \right) ^\frac{3}{2} g_1
\tag{2.25}
\end{equation}\]</span>
</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:asymetrie"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/asymetrie-1.png" alt="Asymétrie d'une distribution" width="100%" />
<p class="caption">
Figure 2.27: Asymétrie d’une distribution
</p>
</div>
<p><strong>Pour évaluer l’aplatissement d’une distribution</strong>, nous utilisons le coefficient d’aplatissement (<em>kurtosis</em> en anglais). Là encore, il existe trois formules pour le calculer (équation <a href="sect025.html#eq:KurtType1">(2.26)</a>, <a href="sect025.html#eq:KurtType2">(2.27)</a>, <a href="sect025.html#eq:KurtType3">(2.28)</a>) qui renvoient des valeurs très semblables pour de grands échantillons <span class="citation">(<a href="#ref-joanes1998comparing" role="doc-biblioref">Joanes et Gill 1998</a>)</span>. Cette mesure s’interprète comme suit (figure <a href="sect025.html#fig:asymetrie">2.27</a>) :</p>
<ul>
<li>Quand la valeur du <em>kurtosis</em> est négative, la <strong>distribution est platikurtique</strong>. La distribution est dite plate, c’est-à-dire que la valeur de l’écart-type est importante (comparativement à une distribution normale), signalant une grande dispersion des valeurs de part et d’autre la moyenne.</li>
<li>Quand la valeur du <em>kurtosis</em> est égale à 0, <strong>la distribution est mésokurtique</strong>, ce qui est typique d’une distribution normale.</li>
<li>Quand la valeur du <em>kurtosis</em> est positive, la <strong>distribution est leptokurtique</strong>, signalant que l’écart-type (la dispersion des valeurs) est plutôt faible. Autrement dit, la dispersion des valeurs autour de la moyenne est faible.</li>
</ul>
<p><span class="math display" id="eq:KurtType1">\[\begin{equation}  
g_2=\frac{\frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^4} {\left( \frac{1}{n}\sum_{i=1}^n(x_i-\bar{x})^2\right)^2}-3
\tag{2.26}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:KurtType2">\[\begin{equation}  
G_2 = \frac{n-1}{(n-2)(n-3)} \{(n+1) g_2 + 6\}
\tag{2.27}
\end{equation}\]</span>
</p>
<p><span class="math display" id="eq:KurtType3">\[\begin{equation}  
b_2 = (g_2 + 3) (1 - 1/n)^2 - 3
\tag{2.28}
\end{equation}\]</span>
</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:kurtosis"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/kurtosis-1.png" alt="Applatissement d'une distribution" width="100%" />
<p class="caption">
Figure 2.28: Applatissement d’une distribution
</p>
</div>
<div class="bloc_attention">
<p>Regardez attentivement les équations <a href="sect025.html#eq:KurtType1">(2.26)</a>, <a href="sect025.html#eq:KurtType2">(2.27)</a>, <a href="sect025.html#eq:KurtType3">(2.28)</a>; vous remarquez que pour <span class="math inline">\(g_2\)</span> et <span class="math inline">\(b_2\)</span>, il y a une soustraction de 3 et une addition 6 pour <span class="math inline">\(G_2\)</span>. Nous parlons alors de <em>kurtosis</em> normalisé (<em>excess kurtosis</em> en anglais). Pour une distribution normale, il prend la valeur de 0, comparativement à la valeur de 3 pour un <em>kurtosis</em> non normalisé. Par conséquent, avant de calculer le <em>kurtosis</em>, il convient de s’assurer que la fonction que vous utilisez implémente une méthode de calcul normalisée (donnant une valeur de 0 pour une distribution normale). Par exemple, la fonction <code>Kurt</code> du <em>package</em> <code>DescTools</code> calcule les trois formules normalisées tandis que la fonction <code>kurtosis</code> du <em>package</em> <code>moments</code> renvoie un <em>kurtosis</em> non normalisé.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="sect025.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb233-2"><a href="sect025.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb233-3"><a href="sect025.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Générer une variable normalement distribuée avec 1000 observations</span></span>
<span id="cb233-4"><a href="sect025.html#cb233-4" aria-hidden="true" tabindex="-1"></a>Normale <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1500</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb233-5"><a href="sect025.html#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(DescTools<span class="sc">::</span><span class="fu">Kurt</span>(Normale),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] -0.145</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="sect025.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(moments<span class="sc">::</span><span class="fu">kurtosis</span>(Normale),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 2.858</code></pre>
</div>
</div>
<div id="vérification-de-la-normalité-avec-des-graphiques" class="section level5 hasAnchor" number="2.5.4.1.2">
<h5><span class="header-section-number">2.5.4.1.2</span> Vérification de la normalité avec des graphiques<a href="sect025.html#vérification-de-la-normalité-avec-des-graphiques" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Les graphiques sont un excellent moyen de vérifier visuellement si une distribution est normale ou pas. Bien entendu, les histogrammes, que nous avons déjà largement utilisés, sont un incontournable. À titre de rappel, ils permettent de représenter la forme de la distribution des données (figure <a href="sect025.html#fig:CourbeNormale">2.29</a>). Un autre type de graphique intéressant est le <strong>diagramme quantile-quantile</strong> (<em>Q-Q plot</em> en anglais), qui permet de comparer la distribution d’une variable avec une distribution gaussienne (normale). Trois éléments composent ce graphique comme qu’illustré à la figure <a href="sect025.html#fig:qqplot">2.30</a> :</p>
<ul>
<li>les points, représentant les observations de la variable;</li>
<li>la distribution gaussienne (normale), représentée par une ligne;</li>
<li>l’intervalle de confiance à 95 % de la distribution normale (en marron sur la figure).</li>
</ul>
<p>Quand la variable est normalement distribuée, les points sont situés le long de la ligne. Plus les points localisés en dehors de l’intervalle de confiance (bande marron) sont nombreux, plus la variable est alors anormalement distribuée.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CourbeNormale"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/CourbeNormale-1.png" alt="Histogrammes et courbe normale" width="90%" />
<p class="caption">
Figure 2.29: Histogrammes et courbe normale
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qqplot"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/qqplot-1.png" alt="Diagrammes quantile-quantile" width="90%" />
<p class="caption">
Figure 2.30: Diagrammes quantile-quantile
</p>
</div>
</div>
<div id="sect025413" class="section level5 hasAnchor" number="2.5.4.1.3">
<h5><span class="header-section-number">2.5.4.1.3</span> Vérification de la normalité avec des tests de normalité<a href="sect025.html#sect025413" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Cinq principaux tests d’hypothèse permettent de vérifier la normalité d’une variable : les tests de <strong>Kolmogorov-Smirnov</strong> (KS), de <strong>Lilliefors</strong> (LF), de <strong>Shapiro-Wilk</strong> (SW), d’<strong>Anderson-Darling</strong> et de <strong>Jarque-Bera</strong> (JB). Sachez toutefois qu’il y en a d’autres non discutés ici (tests de d’Agostino–Pearson, de Cramer–von Mises, de Ryan-Joiner, de Shapiro–Francia, etc.). Pour les formules et une description détaillée de ces tests, vous pouvez consulter Razali et al. <span class="citation">(<a href="#ref-razali2011power" role="doc-biblioref">2011</a>)</span> ou Yap et Sim <span class="citation">(<a href="#ref-yap2011comparisons" role="doc-biblioref">2011</a>)</span>. <strong>Quel test choisir?</strong> Plusieurs auteur(e)s ont comparé ces différents tests à partir de plusieurs échantillons, et ce, en faisant varier la forme de la distribution et le nombre d’observations <span class="citation">(<a href="#ref-razali2011power" role="doc-biblioref">Razali et Wah 2011</a>; <a href="#ref-yap2011comparisons" role="doc-biblioref">Yap et Sim 2011</a>)</span>. Selon Razali et al. <span class="citation">(<a href="#ref-razali2011power" role="doc-biblioref">2011</a>)</span>, le meilleur test semble être celui de Shapiro-Wilk, puis ceux d’Anderson-Darling, de Lilliefors et de Kolmogorov-Smirnov. Yap et Sim <span class="citation">(<a href="#ref-yap2011comparisons" role="doc-biblioref">2011</a>)</span> concluent aussi que le Shapiro-Wilk semble être le plus performant.</p>
<p>Quoi qu’il en soit, ces cinq tests postulent que la variable suit une distribution gaussienne (hypothèse nulle, H<sub>0</sub>).</p>
<p>Cela signifie que si la valeur de <em>p</em> associée à la valeur de chacun des tests est inférieure ou égale au seuil alpha choisi (habituellement <span class="math inline">\(\alpha=\mbox{0,05}\)</span>), la distribution est anormale. À l’inverse, si <span class="math inline">\(p&gt;\mbox{0,05}\)</span>, la distribution est normale.</p>
<table>
<caption>
<span id="tab:testnormalites">Tableau 2.6: </span>Différents tests d’hypothèse pour la normalité
</caption>
<thead>
<tr>
<th>
Test
</th>
<th>
Propriétés et interprétation
</th>
<th>
Fonction R
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Kolmogorov-Smirnov
</td>
<td>
Plus sa valeur est proche de zéro, plus la distribution est normale. L’avantage de ce test est qu’il peut être utilisé pour vérifier si une variable suit la distribution de n’importe quelle loi (autre que la loi normale).
</td>
<td>
<code>ks.test</code> du <em>package</em> <code>stats</code>
</td>
</tr>
<tr>
<td>
Lilliefors
</td>
<td>
Ce test est une adaptation du test de Kolmogorov-Smirnov. Plus sa valeur est proche de zéro, plus la distribution est normale.
</td>
<td>
<code>lillie.test</code> du <em>package</em> <code>nortest</code>
</td>
</tr>
<tr>
<td>
Shapiro-Wilk
</td>
<td>
Si la valeur de la statistique de Shapiro-Wilk est proche de 1, alors la distribution est normale; anormale quand elle est inférieure à 1.
</td>
<td>
<code>shapiro.test</code> du <em>package</em> <code>stats</code>
</td>
</tr>
<tr>
<td>
Anderson-Darling
</td>
<td>
Ce test est une modification du test de Cramer-von Mises (CVM). Il peut être aussi utilisé pour tester d’autres distributions (uniforme, log-normale, exponentielle, Weibull, distribution de pareto généralisée, logistique, etc.).
</td>
<td>
<code>ad.test</code> du <em>package</em> <code>stats</code>
</td>
</tr>
<tr>
<td>
Jarque-Bera
</td>
<td>
Basé sur un test du type multiplicateur de Lagrange, ce test utilise dans son calcul les valeurs du <em>Skewness</em> et du <em>Kurtosis</em>. Plus sa valeur s’approche de 0, plus la distribution est normale. Ce test est surtout utilisé pour vérifier si les résidus d’un modèle de régression linéaire sont normalement distribués; nous y reviendrons dans le chapitre sur la régression multiple. Il s’écrit <span class="math inline">\(JB=\frac{1}{6} \left({g_1}^2+\frac{{g_1}^2}{4} \right)\)</span> avec <span class="math inline">\(g_1\)</span> et <span class="math inline">\(g_2\)</span> qui sont respectivement les valeurs du <em>skewness</em> et du <em>kurtosis</em> de la variable (voir les équations <a href="sect025.html#eq:SkewType1">(2.23)</a> et <a href="sect025.html#eq:KurtType1">(2.26)</a>).
</td>
<td>
<code>JarqueBeraTest</code> du <em>package</em> <code>DescTools</code>
</td>
</tr>
</tbody>
</table>
<p>Dans le tableau <a href="sect025.html#tab:calcultestnormalites">2.7</a> sont reportées les valeurs des différents tests pour les cinq types de distribution générés à la figure <a href="sect025.html#fig:CourbeNormale">2.29</a>. Sans surprise, pour l’ensemble des tests, la valeur de <em>p</em> est inférieure à 0,05 pour la distribution normale.</p>
<table>
<caption>
<span id="tab:calcultestnormalites">Tableau 2.7: </span>Tests de normalité pour différentes distributions
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Normale
</th>
<th style="text-align:right;">
Asymétrie négative
</th>
<th style="text-align:right;">
Asymétrie positive
</th>
<th style="text-align:right;">
Leptokurtique
</th>
<th style="text-align:right;">
Platikurtique
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Skewness
</td>
<td style="text-align:right;">
-0,064
</td>
<td style="text-align:right;">
1,686
</td>
<td style="text-align:right;">
-1,470
</td>
<td style="text-align:right;">
-0,265
</td>
<td style="text-align:right;">
-0,080
</td>
</tr>
<tr>
<td style="text-align:left;">
Kurtosis
</td>
<td style="text-align:right;">
0,055
</td>
<td style="text-align:right;">
4,274
</td>
<td style="text-align:right;">
3,813
</td>
<td style="text-align:right;">
3,672
</td>
<td style="text-align:right;">
-0,997
</td>
</tr>
<tr>
<td style="text-align:left;">
Kolmogorov-Smirnov (KS)
</td>
<td style="text-align:right;">
0,022
</td>
<td style="text-align:right;">
0,108
</td>
<td style="text-align:right;">
0,092
</td>
<td style="text-align:right;">
0,093
</td>
<td style="text-align:right;">
0,052
</td>
</tr>
<tr>
<td style="text-align:left;">
Lilliefors (LF)
</td>
<td style="text-align:right;">
0,022
</td>
<td style="text-align:right;">
0,108
</td>
<td style="text-align:right;">
0,092
</td>
<td style="text-align:right;">
0,093
</td>
<td style="text-align:right;">
0,052
</td>
</tr>
<tr>
<td style="text-align:left;">
Shapiro-Wilk (SW)
</td>
<td style="text-align:right;">
0,997
</td>
<td style="text-align:right;">
0,870
</td>
<td style="text-align:right;">
0,898
</td>
<td style="text-align:right;">
0,945
</td>
<td style="text-align:right;">
0,969
</td>
</tr>
<tr>
<td style="text-align:left;">
Anderson-Darling (AD)
</td>
<td style="text-align:right;">
0,277
</td>
<td style="text-align:right;">
13,676
</td>
<td style="text-align:right;">
9,864
</td>
<td style="text-align:right;">
7,048
</td>
<td style="text-align:right;">
3,006
</td>
</tr>
<tr>
<td style="text-align:left;">
Jarque-Bera (JB)
</td>
<td style="text-align:right;">
0,626
</td>
<td style="text-align:right;">
957,997
</td>
<td style="text-align:right;">
567,539
</td>
<td style="text-align:right;">
622,902
</td>
<td style="text-align:right;">
16,204
</td>
</tr>
<tr>
<td style="text-align:left;">
KS (valeur p)
</td>
<td style="text-align:right;">
0,972
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,140
</td>
</tr>
<tr>
<td style="text-align:left;">
LF (valeur p)
</td>
<td style="text-align:right;">
0,819
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,003
</td>
</tr>
<tr>
<td style="text-align:left;">
SW (valeur p)
</td>
<td style="text-align:right;">
0,644
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
</tr>
<tr>
<td style="text-align:left;">
AD (valeur p)
</td>
<td style="text-align:right;">
0,652
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
</tr>
<tr>
<td style="text-align:left;">
JB (valeur p)
</td>
<td style="text-align:right;">
0,731
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,000
</td>
</tr>
</tbody>
</table>
<div class="bloc_attention">
<p>La plupart des auteurs s’entendent sur le fait que ces tests sont très restrictifs : plus la taille de votre échantillon est importante, plus les tests risquent de vous signaler que vos distributions sont anormales (à la lecture des valeurs de <em>p</em>).</p>
<p>Certains conseillent même de ne pas les utiliser quand <span class="math inline">\(n&gt;200\)</span> et de vous fier uniquement aux graphiques (histogramme et diagramme Q-Q)!</p>
</div>
<div class="bloc_astuce">
<p>Bref, vérifier la normalité d’une variable n’est pas une tâche si simple. De nouveau, nous vous conseillons vivement de :</p>
<ul>
<li>Construire les graphiques pour analyser visuellement la forme de la distribution (histogramme avec courbe normale et diagramme Q-Q).</li>
<li>Calculer le <em>skewness</em> et le <em>kurtosis</em>.</li>
<li>Calculer plusieurs tests (minimalement Shapiro-Wilk et Kolmogorov-Smirnov).</li>
<li>Accorder une importance particulière aux graphiques lorsque vous traitez de grands échantillons (<span class="math inline">\(n&gt;200\)</span>).</li>
</ul>
</div>
</div>
</div>
<div id="sect02adjdistrib" class="section level4 hasAnchor" number="2.5.4.2">
<h4><span class="header-section-number">2.5.4.2</span> Tests pour d’autres formes de distribution<a href="sect025.html#sect02adjdistrib" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Comme nous l’avons vu, la distribution normale n’est que l’une des multiples distributions existantes. Dans de nombreuses situations, elle ne sera pas adaptée pour décrire vos variables. La démarche à adopter pour trouver une distribution adaptée est la suivante :</p>
<ol style="list-style-type: decimal">
<li>Définissez la nature de votre variable : identifier si elle est discrète ou continue et l’intervalle dans lequel elle est définie. Une variable dont les valeurs sont positives ou négatives ne peut pas être décrite avec une distribution Gamma par exemple (à moins de la décaler).</li>
<li>Explorez votre variable : affichez son histogramme et son graphique de densité pour avoir une vue générale de sa morphologie.</li>
<li>Présélectionnez un ensemble de distributions candidates en tenant compte des observations précédentes. Vous pouvez également vous reporter à la littérature existante sur votre sujet d’étude pour inclure d’autres distributions. Soyez flexible! Une variable strictement positive pourrait tout de même avoir une forme normale. De même, une variable décrivant des comptages suffisamment grands pourrait être mieux décrite par une distribution normale qu’une distribution de Poisson.</li>
<li>Tentez d’ajuster chacune des distributions retenues à vos données et comparez les qualités d’ajustements pour retenir la plus adaptée.</li>
</ol>
<p>Pour ajuster une distribution à un jeu de données, il faut trouver les valeurs des paramètres de cette distribution qui lui permettent d’adopter une forme la plus proche possible des données. Nous appelons cette opération <strong>ajuster un modèle</strong>, puisque la distribution théorique est utilisée pour modéliser les données. L’ajustement des paramètres est un problème d’optimisation que plusieurs algorithmes sont capables de résoudre (<em>gradient descent</em>, <em>Newton-Raphson method</em>, <em>Fisher scoring</em>, etc.). Dans R, le <em>package</em> <code>fitdistrplus</code> permet d’ajuster pratiquement n’importe quelle distribution à des données en offrant plusieurs stratégies d’optimisation grâce à la fonction <code>fitdist</code>. Il suffit de disposer d’une fonction représentant la distribution de densité ou de masse de la distribution en question, généralement noté <code>dnomdeladistribution</code> (<code>dnorm</code>, <code>dgamma</code>, <code>dpoisson</code>, etc.) dans R. Notez que certains <em>packages</em> comme <code>VGAM</code> ou <code>gamlss.dist</code> ajoutent un grand nombre de fonctions de densité et de masse à celles déjà disponibles de base dans R.</p>
<p>Pour comparer l’ajustement de plusieurs distributions théoriques à des données, trois approches doivent être combinées :</p>
<ul>
<li>Observer graphiquement l’ajustement de la courbe théorique à l’histogramme des données. Cela permet d’éliminer au premier coup d’œil les distributions qui ne correspondent pas.</li>
<li>Comparer les <em>loglikelihood</em>. Le <em>loglikelihood</em> est un score d’ajustement des distributions aux données. Pour faire simple, plus le <em>loglikelihood</em> est grand, plus la distribution théorique est proche des données. Référez-vous à l’encadré suivant pour une description plus en profondeur du <em>loglikelihood</em>.</li>
<li>Utiliser le test de Kolmogorov-Smirnov pour déterminer si une distribution particulière est mieux ajustée pour les données.</li>
</ul>
<div class="bloc_aller_loin">
<p><strong>Qu’est-ce-que le <em>loglikelihood</em></strong>?</p>
<p>Le <em>loglikelihood</em> est une mesure de l’ajustement d’un modèle à des données. Il est utilisé à peu près partout en statistique. Comprendre sa signification est donc un exercice important pour développer une meilleure intuition du fonctionnement général de nombreuses méthodes. Si les concepts de fonction de densité et de fonction de masse vous semblent encore flous, reportez-vous à la section <a href="sect024.html#sect024">2.4</a> sur les distributions dans un premier temps.</p>
<p>Admettons que nous disposons d’une variable continue <em>v</em> que nous tentons de modéliser avec une distribution <em>d</em> (il peut s’agir de n’importe quelle distribution). <em>d</em> a une fonction de densité avec laquelle il est possible de calculer, pour chacune des valeurs de <em>v</em>, la probabilité d’être observée selon le modèle <em>d</em>.</p>
<p>Prenons un exemple concret dans R. Admettons que nous avons une variable comprenant 10 valeurs (oui, c’est un petit échantillon, mais c’est pour faire un exemple simple).</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="sect025.html#cb237-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">7</span>)</span>
<span id="cb237-2"><a href="sect025.html#cb237-2" aria-hidden="true" tabindex="-1"></a>moyenne <span class="ot">&lt;-</span> <span class="fu">mean</span>(v)</span>
<span id="cb237-3"><a href="sect025.html#cb237-3" aria-hidden="true" tabindex="-1"></a>ecart_type <span class="ot">&lt;-</span> <span class="fu">sd</span>(v)</span></code></pre></div>
<p>En calculant la moyenne et l’écart-type de la variable, nous obtenons les paramètres d’une distribution normale que nous pouvons utiliser pour représenter les données observées. En utilisant la fonction <code>dnorm</code> (la fonction de densité de la distribution normale), nous pouvons calculer la probabilité d’observer chacune des valeurs de <em>v</em> selon cette distribution normale.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="sect025.html#cb238-1" aria-hidden="true" tabindex="-1"></a>probas <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(v, moyenne, ecart_type)</span>
<span id="cb238-2"><a href="sect025.html#cb238-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">valeur =</span> v,</span>
<span id="cb238-3"><a href="sect025.html#cb238-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">proba =</span> probas)</span>
<span id="cb238-4"><a href="sect025.html#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df)</span></code></pre></div>
<pre><code>##    valeur      proba
## 1       5 0.11203710
## 2       8 0.19624888
## 3       7 0.22228296
## 4       8 0.19624888
## 5      10 0.06009897
## 6       4 0.04985613
## 7       7 0.22228296
## 8       6 0.18439864
## 9       9 0.12689976
## 10      7 0.22228296</code></pre>
<p>Nous observons ainsi que les valeurs 7 et 8 sont très probables selon le modèle alors que les valeurs 4 et 10 sont très improbables.</p>
<p>Le <em>likelihood</em> est simplement le produit de toutes ces probabilités. Il s’agit donc de <strong>la probabilité conjointe</strong> d’avoir observé toutes les valeurs de <em>v</em> <strong>sous l’hypothèse</strong> que <em>d</em> est la distribution produisant ces valeurs. Si <em>d</em> décrit efficacement <em>v</em>, alors le <em>likelihood</em> est plus grand que si <em>d</em> ne décrit pas efficacement <em>v</em>. Il s’agit d’une forme de raisonnement par l’absurde : après avoir observé <em>v</em>, nous calculons la probabilité d’avoir observé <em>v</em> (<em>likelihood</em>) si notre modèle <em>d</em> était vrai. Si cette probabilité est très basse, alors c’est que notre modèle est mauvais puisqu’on a bien observé <em>v</em>.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="sect025.html#cb240-1" aria-hidden="true" tabindex="-1"></a>likelihood_norm <span class="ot">&lt;-</span> <span class="fu">prod</span>(probas)</span>
<span id="cb240-2"><a href="sect025.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(likelihood_norm)</span></code></pre></div>
<pre><code>## [1] 3.322759e-09</code></pre>
<p>Cependant, multiplier un grand nombre de valeurs inférieures à zéro tend à produire des chiffres infiniment petits et donc à complexifier grandement le calcul. Nous préférons donc utiliser le <em>loglikelihood</em> : l’idée étant transformer les probabilités obtenues avec la fonction <em>log</em> puis d’additionner leurs résultats, puisque <span class="math inline">\(log(xy) = log(x)+log(y)\)</span>.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="sect025.html#cb242-1" aria-hidden="true" tabindex="-1"></a>loglikelihood_norm <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">log</span>(probas))</span>
<span id="cb242-2"><a href="sect025.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(loglikelihood_norm)</span></code></pre></div>
<pre><code>## [1] -19.52247</code></pre>
<p>Comparons ce <em>loglikelihood</em> à celui d’un second modèle dans lequel nous utilisons toujours la distribution normale, mais avec une moyenne différente (faussée en ajoutant +3) :</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="sect025.html#cb244-1" aria-hidden="true" tabindex="-1"></a>probas2 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(v, moyenne<span class="sc">+</span><span class="dv">3</span>, ecart_type)</span>
<span id="cb244-2"><a href="sect025.html#cb244-2" aria-hidden="true" tabindex="-1"></a>loglikelihood_norm2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">log</span>(probas2))</span>
<span id="cb244-3"><a href="sect025.html#cb244-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(loglikelihood_norm2)</span></code></pre></div>
<pre><code>## [1] -33.53631</code></pre>
<p>Ce second <em>loglikehood</em> est plus faible, indiquant clairement que le premier modèle est plus adapté aux données.</p>
</div>
<p>Passons à la pratique avec deux exemples.</p>
<div id="temps-de-retard-des-bus-de-la-ville-de-toronto" class="section level5 hasAnchor" number="2.5.4.2.1">
<h5><span class="header-section-number">2.5.4.2.1</span> Temps de retard des bus de la ville de Toronto<a href="sect025.html#temps-de-retard-des-bus-de-la-ville-de-toronto" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Analysons les temps de retard pris par les bus de la ville de Toronto lorsqu’un évènement perturbe la circulation. Ce jeu de données est disponible sur le <a href="https://open.toronto.ca/catalogue/?search=bus%20delay&amp;sort=score%20desc" target="_blank">site des données ouvertes de la Ville de Toronto</a>. Compte tenu de la grande quantité d’observations, nous avons fait le choix de nous concentrer sur les évènements ayant eu lieu durant le mois de janvier 2019. Puisque la variable étudiée est une durée exprimée en minutes, elle est strictement positive (supérieure à 0), car un bus avec zéro minute de retard est à l’heure! Nous considérons également qu’un bus ayant plus de 150 minutes de retard (2 heures 30) n’est tout simplement pas passé (personne ne risque d’attendre 2 heures 30 pour prendre son bus). Commençons par charger les données et observer leur distribution empirique.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="sect025.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb246-2"><a href="sect025.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="co"># charger le jeu de données</span></span>
<span id="cb246-3"><a href="sect025.html#cb246-3" aria-hidden="true" tabindex="-1"></a>data_trt_bus <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/univariee/bus-delay-2019_janv.csv&#39;</span>, <span class="at">sep =</span><span class="st">&#39;;&#39;</span>)</span>
<span id="cb246-4"><a href="sect025.html#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="co"># retirer les observations aberrantes</span></span>
<span id="cb246-5"><a href="sect025.html#cb246-5" aria-hidden="true" tabindex="-1"></a>data_trt_bus <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_trt_bus, data_trt_bus<span class="sc">$</span>Min.Delay <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span></span>
<span id="cb246-6"><a href="sect025.html#cb246-6" aria-hidden="true" tabindex="-1"></a>                         data_trt_bus<span class="sc">$</span>Min.Delay <span class="sc">&lt;</span> <span class="dv">150</span>)</span>
<span id="cb246-7"><a href="sect025.html#cb246-7" aria-hidden="true" tabindex="-1"></a><span class="co"># représenter la distribution empirique du jeu de données</span></span>
<span id="cb246-8"><a href="sect025.html#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data_trt_bus) <span class="sc">+</span> </span>
<span id="cb246-9"><a href="sect025.html#cb246-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>Min.Delay, <span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb246-10"><a href="sect025.html#cb246-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>Min.Delay), <span class="at">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="at">bw =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb246-11"><a href="sect025.html#cb246-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;temps de retard (en minutes)&#39;</span>,</span>
<span id="cb246-12"><a href="sect025.html#cb246-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figbustrt"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/figbustrt-1.png" alt="Distribution empirique des temps de retard des bus à Toronto en janvier 2019" width="65%" />
<p class="caption">
Figure 2.31: Distribution empirique des temps de retard des bus à Toronto en janvier 2019
</p>
</div>
<p>Compte tenu de la forme de la distribution empirique et de sa nature, quatre distributions sont envisageables :</p>
<ul>
<li>La distribution Gamma, strictement positive et asymétrique, est aussi une généralisation de la distribution exponentielle utilisée pour modéliser des temps d’attente. Pour des raisons similaires, nous pouvons aussi retenir la distribution de Weibull et la distribution log-normale. Nous écartons ici la distribution normale asymétrique puisque le jeu de données n’a clairement pas une forme normale au départ.</li>
<li>La distribution de Pareto, strictement positive et permettant de représenter ici le fait que la plupart des retards durent moins de 10 minutes, mais que quelques retards sont également beaucoup plus longs.</li>
</ul>
<p>Commençons par ajuster les quatre distributions avec la fonction <code>fitdist</code> du <em>package</em> <code>fitdistrplus</code> et représentons-les graphiquement pour éliminer les moins bons candidats. Nous utilisons également le <em>package</em> <code>actuar</code> pour la fonction de densité de Pareto (<code>dpareto</code>).</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="sect025.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fitdistrplus)</span>
<span id="cb247-2"><a href="sect025.html#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(actuar)</span>
<span id="cb247-3"><a href="sect025.html#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb247-4"><a href="sect025.html#cb247-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ajustement des modèles</span></span>
<span id="cb247-5"><a href="sect025.html#cb247-5" aria-hidden="true" tabindex="-1"></a>model_gamma <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(data_trt_bus<span class="sc">$</span>Min.Delay, <span class="at">distr =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb247-6"><a href="sect025.html#cb247-6" aria-hidden="true" tabindex="-1"></a>model_weibull <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(data_trt_bus<span class="sc">$</span>Min.Delay, <span class="at">distr =</span> <span class="st">&quot;weibull&quot;</span>)</span>
<span id="cb247-7"><a href="sect025.html#cb247-7" aria-hidden="true" tabindex="-1"></a>model_lognorm <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(data_trt_bus<span class="sc">$</span>Min.Delay, <span class="at">distr =</span> <span class="st">&quot;lnorm&quot;</span>)</span>
<span id="cb247-8"><a href="sect025.html#cb247-8" aria-hidden="true" tabindex="-1"></a>model_pareto <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(data_trt_bus<span class="sc">$</span>Min.Delay, <span class="at">distr =</span> <span class="st">&quot;pareto&quot;</span>, </span>
<span id="cb247-9"><a href="sect025.html#cb247-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">start =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>),</span>
<span id="cb247-10"><a href="sect025.html#cb247-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method =</span> <span class="st">&quot;mse&quot;</span>) <span class="co"># différentes méthodes d&#39;optimisations</span></span>
<span id="cb247-11"><a href="sect025.html#cb247-11" aria-hidden="true" tabindex="-1"></a><span class="co"># réalisation des graphiques</span></span>
<span id="cb247-12"><a href="sect025.html#cb247-12" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data_trt_bus) <span class="sc">+</span> </span>
<span id="cb247-13"><a href="sect025.html#cb247-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>Min.Delay, <span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb247-14"><a href="sect025.html#cb247-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dgamma, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">0.8</span>, </span>
<span id="cb247-15"><a href="sect025.html#cb247-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">as.list</span>(model_gamma<span class="sc">$</span>estimate))<span class="sc">+</span></span>
<span id="cb247-16"><a href="sect025.html#cb247-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;temps de retard (en minutes)&#39;</span>,</span>
<span id="cb247-17"><a href="sect025.html#cb247-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb247-18"><a href="sect025.html#cb247-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Modèle Gamma&quot;</span>)</span>
<span id="cb247-19"><a href="sect025.html#cb247-19" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data_trt_bus) <span class="sc">+</span> </span>
<span id="cb247-20"><a href="sect025.html#cb247-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>Min.Delay, <span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb247-21"><a href="sect025.html#cb247-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dweibull, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">0.8</span>, </span>
<span id="cb247-22"><a href="sect025.html#cb247-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">as.list</span>(model_weibull<span class="sc">$</span>estimate))<span class="sc">+</span></span>
<span id="cb247-23"><a href="sect025.html#cb247-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;temps de retard (en minutes)&#39;</span>,</span>
<span id="cb247-24"><a href="sect025.html#cb247-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb247-25"><a href="sect025.html#cb247-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Modèle Weibull&quot;</span>)</span>
<span id="cb247-26"><a href="sect025.html#cb247-26" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data_trt_bus) <span class="sc">+</span> </span>
<span id="cb247-27"><a href="sect025.html#cb247-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>Min.Delay, <span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb247-28"><a href="sect025.html#cb247-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dlnorm, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">0.8</span>, </span>
<span id="cb247-29"><a href="sect025.html#cb247-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">as.list</span>(model_lognorm<span class="sc">$</span>estimate))<span class="sc">+</span></span>
<span id="cb247-30"><a href="sect025.html#cb247-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;temps de retard (en minutes)&#39;</span>,</span>
<span id="cb247-31"><a href="sect025.html#cb247-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb247-32"><a href="sect025.html#cb247-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Modèle log-normal&quot;</span>)</span>
<span id="cb247-33"><a href="sect025.html#cb247-33" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> data_trt_bus) <span class="sc">+</span> </span>
<span id="cb247-34"><a href="sect025.html#cb247-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x=</span>Min.Delay, <span class="at">y =</span> ..density..), <span class="at">bins =</span> <span class="dv">40</span>)<span class="sc">+</span></span>
<span id="cb247-35"><a href="sect025.html#cb247-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dpareto, <span class="at">color =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">0.8</span>, </span>
<span id="cb247-36"><a href="sect025.html#cb247-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">args =</span> <span class="fu">as.list</span>(model_pareto<span class="sc">$</span>estimate))<span class="sc">+</span></span>
<span id="cb247-37"><a href="sect025.html#cb247-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;temps de retard (en minutes)&#39;</span>,</span>
<span id="cb247-38"><a href="sect025.html#cb247-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb247-39"><a href="sect025.html#cb247-39" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Modèle Pareto&quot;</span>)</span>
<span id="cb247-40"><a href="sect025.html#cb247-40" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="at">plotlist =</span> <span class="fu">list</span>(plot1, plot2, plot3, plot4),</span>
<span id="cb247-41"><a href="sect025.html#cb247-41" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figbustrt2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/figbustrt2-1.png" alt="Comparaison des distributions ajustées aux données de retard des bus" width="65%" />
<p class="caption">
Figure 2.32: Comparaison des distributions ajustées aux données de retard des bus
</p>
</div>
<p>Visuellement, nous constatons que la distribution de Pareto est un mauvais choix. Pour les trois autres distributions, la comparaison des valeurs de <em>loglikelihood</em> s’impose (tableau <a href="sect025.html#tab:tabledistribs">2.8</a>).</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="sect025.html#cb248-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;Gamma&quot;</span>,<span class="st">&quot;Weibull&quot;</span>,</span>
<span id="cb248-2"><a href="sect025.html#cb248-2" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;log-normal&quot;</span>), </span>
<span id="cb248-3"><a href="sect025.html#cb248-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">loglikelihood =</span> <span class="fu">c</span>(model_gamma<span class="sc">$</span>loglik, </span>
<span id="cb248-4"><a href="sect025.html#cb248-4" aria-hidden="true" tabindex="-1"></a>                 model_weibull<span class="sc">$</span>loglik,</span>
<span id="cb248-5"><a href="sect025.html#cb248-5" aria-hidden="true" tabindex="-1"></a>                 model_lognorm<span class="sc">$</span>loglik))</span>
<span id="cb248-6"><a href="sect025.html#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="fu">show_table</span>(df, </span>
<span id="cb248-7"><a href="sect025.html#cb248-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;Distribution&quot;</span>,<span class="st">&quot;LogLikelihood&quot;</span>),</span>
<span id="cb248-8"><a href="sect025.html#cb248-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&#39;Comparaison des LogLikelihood des trois distributions&#39;</span>,</span>
<span id="cb248-9"><a href="sect025.html#cb248-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">align=</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="st">&quot;r&quot;</span>)</span>
<span id="cb248-10"><a href="sect025.html#cb248-10" aria-hidden="true" tabindex="-1"></a>          )</span></code></pre></div>
<table>
<caption>
<span id="tab:tabledistribs">Tableau 2.8: </span>Comparaison des LogLikelihood des trois distributions
</caption>
<thead>
<tr>
<th style="text-align:left;">
Distribution
</th>
<th style="text-align:right;">
LogLikelihood
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Gamma
</td>
<td style="text-align:right;">
-23 062,56
</td>
</tr>
<tr>
<td style="text-align:left;">
Weibull
</td>
<td style="text-align:right;">
-23 195,54
</td>
</tr>
<tr>
<td style="text-align:left;">
log-normal
</td>
<td style="text-align:right;">
-23 375,74
</td>
</tr>
</tbody>
</table>
<p>Le plus grand <em>logLikelihood</em> est obtenu par la distribution Gamma qui s’ajuste donc le mieux à nos données. Pour finir, nous pouvons tester formellement, avec le test de Kolmogorov-Smirnov, si les données proviennent bien de cette distribution Gamma.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="sect025.html#cb249-1" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">as.list</span>(model_gamma<span class="sc">$</span>estimate)</span>
<span id="cb249-2"><a href="sect025.html#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(data_trt_bus<span class="sc">$</span>Min.Delay,</span>
<span id="cb249-3"><a href="sect025.html#cb249-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> pgamma, <span class="at">shape =</span> params<span class="sc">$</span>shape, <span class="at">rate =</span> params<span class="sc">$</span>rate)</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  data_trt_bus$Min.Delay
## D = 0.099912, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<p>Comme la valeur de <em>p</em> est inférieure à 0,05, nous ne pouvons pas accepter l’hypothèse que notre jeu de données suit effectivement un loi de Gamma. Considérant le nombre d’observations et le fait que de nombreux temps d’attente sont identiques (ce à quoi le test est très sensible), ce résultat n’est pas surprenant. La distribution Gamma reste cependant la distribution qui représente le mieux nos données. Nous pouvons estimer grâce, à cette distribution, la probabilité qu’un bus ait un retard de plus de 10 minutes de la façon suivante :</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="sect025.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgamma</span>(<span class="dv">10</span>, <span class="at">shape =</span> params<span class="sc">$</span>shape, <span class="at">rate =</span> params<span class="sc">$</span>rate, <span class="at">lower.tail =</span> F)</span></code></pre></div>
<pre><code>## [1] 0.5409424</code></pre>
<p>ce qui correspond à 54 % de chance.</p>
<p>Pour moins de 10 minutes :</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="sect025.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgamma</span>(<span class="dv">10</span>, <span class="at">shape =</span> params<span class="sc">$</span>shape, <span class="at">rate =</span> params<span class="sc">$</span>rate, <span class="at">lower.tail =</span> T)</span></code></pre></div>
<pre><code>## [1] 0.4590576</code></pre>
<p>soit 46 %.</p>
<p>Un dernier exemple avec la probabilité qu’un retard dépasse 45 minutes :</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="sect025.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgamma</span>(<span class="dv">45</span>, <span class="at">shape =</span> params<span class="sc">$</span>shape, <span class="at">rate =</span> params<span class="sc">$</span>rate, <span class="at">lower.tail =</span> F)</span></code></pre></div>
<pre><code>## [1] 0.01348194</code></pre>
<p>Soit seulement 1,3 %.</p>
<p>Par conséquent, si un matin à Toronto votre bus a plus de 45 minutes de retard, bravo, vous êtes tombé sur une des très rares occasions où un tel retard se produit!</p>
</div>
<div id="accidents-de-vélo-à-montréal" class="section level5 hasAnchor" number="2.5.4.2.2">
<h5><span class="header-section-number">2.5.4.2.2</span> Accidents de vélo à Montréal<a href="sect025.html#accidents-de-vélo-à-montréal" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Le second jeu de données représente le nombre d’accidents de la route impliquant un vélo sur les intersections dans les quartiers centraux de Montréal (<a href="sect025.html#fig:figaccmtl">2.33</a>). Le jeu de données complet est disponible sur le site des <a href="http://donnees.ville.montreal.qc.ca/dataset/collisions-routieres" target="_blank">données ouvertes</a> de la Ville de Montréal. Puisque ces données correspondent à des comptages, la première distribution à envisager est la distribution de Poisson. Cependant, puisque nous aurons également un grand nombre d’intersections sans accident, il serait judicieux de tester la distribution de Poisson avec excès de zéro.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="sect025.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb257-2"><a href="sect025.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="co"># charger le jeu de données</span></span>
<span id="cb257-3"><a href="sect025.html#cb257-3" aria-hidden="true" tabindex="-1"></a>data_accidents <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;data/univariee/accidents_mtl.csv&#39;</span>, <span class="at">sep =</span><span class="st">&#39;,&#39;</span>)</span>
<span id="cb257-4"><a href="sect025.html#cb257-4" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">table</span>(data_accidents<span class="sc">$</span>nb_accident))</span>
<span id="cb257-5"><a href="sect025.html#cb257-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;nb_accident&quot;</span>,<span class="st">&#39;frequence&#39;</span>)</span>
<span id="cb257-6"><a href="sect025.html#cb257-6" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>nb_accident <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(counts<span class="sc">$</span>nb_accident))</span>
<span id="cb257-7"><a href="sect025.html#cb257-7" aria-hidden="true" tabindex="-1"></a>counts<span class="sc">$</span>prop <span class="ot">&lt;-</span> counts<span class="sc">$</span>frequence <span class="sc">/</span> <span class="fu">sum</span>(counts<span class="sc">$</span>frequence)</span>
<span id="cb257-8"><a href="sect025.html#cb257-8" aria-hidden="true" tabindex="-1"></a><span class="co"># représenter la distribution empirique du jeu de donnée</span></span>
<span id="cb257-9"><a href="sect025.html#cb257-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> counts) <span class="sc">+</span> </span>
<span id="cb257-10"><a href="sect025.html#cb257-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>nb_accident, <span class="at">weight =</span> frequence), <span class="at">width =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb257-11"><a href="sect025.html#cb257-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;nombre d&#39;accidents&quot;</span>,</span>
<span id="cb257-12"><a href="sect025.html#cb257-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">&#39;fréquence&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figaccmtl"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/figaccmtl-1.png" alt="Distribution empirique du nombre d'accidents par intersection impliquant un ou une cycliste à Montréal en 2017 dans les quartiers centraux" width="65%" />
<p class="caption">
Figure 2.33: Distribution empirique du nombre d’accidents par intersection impliquant un ou une cycliste à Montréal en 2017 dans les quartiers centraux
</p>
</div>
<p>Nous avons effectivement de nombreux zéros, alors essayons d’ajuster nos deux distributions à ce jeu de données. Dans la figure <a href="sect025.html#fig:figaccmtldist">2.34</a>, les barres grises représentent la distribution empirique du jeu de données et les barres rouges, les distributions théoriques ajustées. Nous utilisons ici le <em>package</em> <code>gamlss.dist</code> pour avoir la fonction de masse d’une distribution de Poisson avec excès de zéros.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="sect025.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss.dist)</span>
<span id="cb258-2"><a href="sect025.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ajuster le modèle de poisson</span></span>
<span id="cb258-3"><a href="sect025.html#cb258-3" aria-hidden="true" tabindex="-1"></a>model_poisson <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(data_accidents<span class="sc">$</span>nb_accident, <span class="at">distr =</span> <span class="st">&quot;pois&quot;</span>)</span>
<span id="cb258-4"><a href="sect025.html#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ajuster le modèle de poisson avec excès de zéros</span></span>
<span id="cb258-5"><a href="sect025.html#cb258-5" aria-hidden="true" tabindex="-1"></a>model_poissonzi <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(data_accidents<span class="sc">$</span>nb_accident, <span class="st">&quot;ZIP&quot;</span>,</span>
<span id="cb258-6"><a href="sect025.html#cb258-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">start =</span> <span class="fu">list</span>(<span class="at">mu =</span> <span class="dv">4</span>, <span class="at">sigma =</span> <span class="fl">0.15</span>), <span class="co"># valeurs pour faciliter la convergence</span></span>
<span id="cb258-7"><a href="sect025.html#cb258-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">optim.method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>, <span class="co"># méthode d&#39;optimisation recommandée dans la documentation</span></span>
<span id="cb258-8"><a href="sect025.html#cb258-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">lower =</span> <span class="fu">c</span>(<span class="fl">0.00001</span>, <span class="fl">0.00001</span>), <span class="co"># valeurs minimales des deux paramètres</span></span>
<span id="cb258-9"><a href="sect025.html#cb258-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">upper =</span> <span class="fu">c</span>(<span class="cn">Inf</span>, <span class="dv">1</span>)<span class="co"># valeurs maximales des deux paramètres</span></span>
<span id="cb258-10"><a href="sect025.html#cb258-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb258-11"><a href="sect025.html#cb258-11" aria-hidden="true" tabindex="-1"></a>dfpoisson <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb258-12"><a href="sect025.html#cb258-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span><span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, model_poisson<span class="sc">$</span>estimate)</span>
<span id="cb258-13"><a href="sect025.html#cb258-13" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb258-14"><a href="sect025.html#cb258-14" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb258-15"><a href="sect025.html#cb258-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>nb_accident, <span class="at">weight =</span> prop), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">data =</span> counts)<span class="sc">+</span></span>
<span id="cb258-16"><a href="sect025.html#cb258-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">weight =</span> y), <span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">data =</span> dfpoisson, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb258-17"><a href="sect025.html#cb258-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb258-18"><a href="sect025.html#cb258-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Modèle de Poisson&quot;</span>,</span>
<span id="cb258-19"><a href="sect025.html#cb258-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;nombre d&#39;accidents&quot;</span>,</span>
<span id="cb258-20"><a href="sect025.html#cb258-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb258-21"><a href="sect025.html#cb258-21" aria-hidden="true" tabindex="-1"></a>dfpoissonzi <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb258-22"><a href="sect025.html#cb258-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y=</span><span class="fu">dZIP</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, model_poissonzi<span class="sc">$</span>estimate[[<span class="dv">1</span>]],</span>
<span id="cb258-23"><a href="sect025.html#cb258-23" aria-hidden="true" tabindex="-1"></a>                               model_poissonzi<span class="sc">$</span>estimate[[<span class="dv">2</span>]])</span>
<span id="cb258-24"><a href="sect025.html#cb258-24" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb258-25"><a href="sect025.html#cb258-25" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb258-26"><a href="sect025.html#cb258-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>nb_accident, <span class="at">weight =</span> prop), <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">data =</span> counts)<span class="sc">+</span></span>
<span id="cb258-27"><a href="sect025.html#cb258-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">weight =</span> y), <span class="at">width =</span> <span class="fl">0.15</span>, <span class="at">data =</span> dfpoissonzi, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb258-28"><a href="sect025.html#cb258-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">7</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb258-29"><a href="sect025.html#cb258-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Modèle de Poisson avec excès de zéro&quot;</span>,</span>
<span id="cb258-30"><a href="sect025.html#cb258-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;nombre d&#39;accident&quot;</span>,</span>
<span id="cb258-31"><a href="sect025.html#cb258-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb258-32"><a href="sect025.html#cb258-32" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="at">plotlist =</span> <span class="fu">list</span>(plot1,plot2), <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:figaccmtldist"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/figaccmtldist-1.png" alt="Ajustement des distributions de Poisson et Poisson avec excès de zéros" width="65%" />
<p class="caption">
Figure 2.34: Ajustement des distributions de Poisson et Poisson avec excès de zéros
</p>
</div>
<p>Visuellement, comme nous pouvons l’observer à la figure <a href="sect025.html#fig:figaccmtldist">2.34</a>, le modèle avec excès de zéro semble s’imposer. Nous pouvons vérifier cette impression avec la comparaison des <em>loglikelihood</em>.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="sect025.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_poisson<span class="sc">$</span>loglik)</span></code></pre></div>
<pre><code>## [1] -989.83</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="sect025.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model_poissonzi<span class="sc">$</span>loglik)</span></code></pre></div>
<pre><code>## [1] -931.8778</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="sect025.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="co">#afficher les paramètres ajustés</span></span>
<span id="cb263-2"><a href="sect025.html#cb263-2" aria-hidden="true" tabindex="-1"></a>model_poisson<span class="sc">$</span>estimate</span></code></pre></div>
<pre><code>##    lambda 
## 0.1991963</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="sect025.html#cb265-1" aria-hidden="true" tabindex="-1"></a>model_poissonzi<span class="sc">$</span>estimate</span></code></pre></div>
<pre><code>##        mu     sigma 
## 0.6690301 0.7022605</code></pre>
<p>Nous avons donc la confirmation que le modèle de Poisson avec excès de zéros est mieux ajusté. Nous apprenons donc que 70 % (sigma = 0,70) des intersections sont en fait exclues du phénomène étudié (probablement parce que très peu de cyclistes les utilisent ou parce qu’elles sont très peu accidentogènes) et que pour les autres, le taux d’accidents par année en 2017 était de 0,67 (<em>mu</em> = 0,669, <em>mu</em> signifiant <span class="math inline">\(\lambda\)</span> pour le <em>package</em> <code>gamlss</code>). À nouveau, nous pouvons effectuer un test formel avec le fonction <code>ks.test</code>.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="sect025.html#cb267-1" aria-hidden="true" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">as.list</span>(model_poissonzi<span class="sc">$</span>estimate)</span>
<span id="cb267-2"><a href="sect025.html#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(data_accidents<span class="sc">$</span>nb_accident,</span>
<span id="cb267-3"><a href="sect025.html#cb267-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> pZIP, <span class="at">mu =</span> params<span class="sc">$</span>mu, <span class="at">sigma =</span> params<span class="sc">$</span>sigma)</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  data_accidents$nb_accident
## D = 0.85476, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<p>Encore une fois, nous devons rejeter l’hypothèse selon laquelle le test suit une distribution de Poisson avec excès de zéros. Ces deux exemples montrent à quel point ce test est restrictif.</p>
</div>
</div>
</div>
<div id="sect0255" class="section level3 hasAnchor" number="2.5.5">
<h3><span class="header-section-number">2.5.5</span> Transformation des variables<a href="sect025.html#sect0255" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect02551" class="section level4 hasAnchor" number="2.5.5.1">
<h4><span class="header-section-number">2.5.5.1</span> Transformations visant à atteindre la normalité<a href="sect025.html#sect02551" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Comme énoncé au début de cette section, plusieurs méthodes statistiques nécessitent que la variable quantitative soit normalement distribuée. C’est notamment le cas de l’analyse de variance et des tests <em>t</em> (abordés dans les chapitres suivants) qui fournissent des résultats plus robustes lorsque la variable est normalement distribuée. Plusieurs transformations sont possibles, les plus courantes étant la racine carrée, le logarithme et l’inverse de la variable. Selon plusieurs auteur(e)s (notamment, les statisticiennes Barbara G. Tabacknick et Linda S. Fidell <span class="citation">(<a href="#ref-tabachnick2007" role="doc-biblioref">2007, 89</a>)</span>), en fonction du type (positive ou négative) et du degré d’asymétrie, les transformations suivantes sont possibles afin d’améliorer la normalité de la variable :</p>
<ul>
<li>Asymétrie positive modérée : la racine carrée de la variable <em>X</em> avec la fonction <code>sqrt(df$x)</code>.</li>
<li>Asymétrie positive importante : le logarithme de la variable avec <code>log10(df$x)</code>.</li>
<li>Asymétrie positive sévère : l’inverse de la variable avec <code>1/(df$x)</code>.</li>
</ul>
<div class="bloc_astuce">
<p>Pour une valeur égale ou inférieure à 0, nous ne pouvons pas calculer une racine carrée ou un logarithme. Par conséquent, il convient de décaler simplement la distribution vers la droite afin de s’assurer qu’il n’y ait plus de valeurs négatives ou égales à 0 :</p>
<ul>
<li><code>sqrt(df$x - min(df$x+1))</code>pour une asymétrie positive avec des valeurs négatives ou égales à 0</li>
<li><code>log(df$x - min(df$x+1))</code>pour une asymétrie positive avec des valeurs négatives ou égales à 0</li>
</ul>
<p>Par exemple, si la valeur minimale de la variable est égale à -10, la valeur minimale de variable décalée sera ainsi de 11.</p>
<ul>
<li>Asymétrie négative modérée : <code>sqrt(max(df$x+1) - df$x)</code></li>
<li>Asymétrie négative importante : <code>log(max(df$x+1) - df$x)</code></li>
<li>Asymétrie négative sévère : <code>1/(max(df$x+1) - df$x)</code></li>
</ul>
</div>
<div class="bloc_attention">
<p><strong>Transformation des variables pour atteindre la normalité : ce n’est pas toujours la panacée!</strong></p>
<p>La transformation des données fait et fera encore longtemps débat à la fois parmi les statisticien(ne)s, et les personnes utilisatrices débutantes ou avancées des méthodes quantitatives. Field et al. <span class="citation">(<a href="#ref-field2012discovering" role="doc-biblioref">2012, 193</a>)</span> résument le tout avec humour : « to transform or not transform, that is the question ».</p>
<p><strong>Avantages de la transformation</strong></p>
<ul>
<li>L’obtention de <em>résultats plus robustes</em>.</li>
<li>Dans une régression linéaire multiple, la transformation de la variable dépendante peut <em>remédier au non-respect des hypothèses de base liées à la régression</em> (linéarité et homoscédasticité des erreurs, absence de valeurs aberrantes, etc.).</li>
</ul>
<p><strong>Inconvénients de la transformation</strong></p>
<ul>
<li><p><em>Une variable transformée est plus difficile à interpréter</em> puisque cela change l’unité de mesure de la variable. Prenons un exemple concret : vous souhaitez comparer les moyennes de revenu de deux groupes <em>A</em> et <em>B</em>. Vous obtenez une différence de 15 000 $, soit une valeur facile à interpréter. Par contre, si la variable a été préalablement transformée en logarithme, il est possible que vous obteniez une différence de 9, ce qui est beaucoup moins parlant. Aussi, en transformant la variable en <em>log</em>, vous ne comparez plus les moyennes arithmétiques des deux groupes, mais plutôt leurs moyennes géométriques <span class="citation">(<a href="#ref-field2012discovering" role="doc-biblioref">Field, Miles et Field 2012, 193</a>)</span>.</p></li>
<li><p><em>Pourquoi perdre la forme initiale de la distribution du phénomène à expliquer?</em> Il est possible, pour de nombreuses méthodes de choisir la distribution que nous souhaitons utiliser, il n’est donc pas nécessaire de toujours se limiter à la distribution normale. Par exemple, dans les modèles de régression généralisés (GLM), nous pourrions indiquer que la variable indépendante suit une distribution de Student plutôt que de vouloir à tout prix la rendre normale. De même, certains tests non paramétriques permettent d’analyser des variables ne suivant pas une distribution normale.</p></li>
</ul>
<p><strong>Démarche à suivre avant et après la transformation</strong></p>
<ul>
<li><p><em>La transformation est-elle nécessaire?</em> Ne transformez jamais une variable sans avoir analysé rigoureusement sa forme (histogramme avec courbe normale, <em>skewness</em> et <em>kurtosis</em>, tests de normalité).</p></li>
<li><p><em>D’autres options à la transformation d’une variable dépendante (VD) sont-elles envisageables?</em> Identifiez la forme de la distribution de la VD et utilisez au besoin un modèle GLM adapté à cette distribution. Autrement dit, ne transformez pas automatiquement votre VD simplement pour l’introduire dans une régression linéaire multiple.</p></li>
<li><p><em>La transformation a-t-elle un apport significatif?</em> Premièrement, vérifiez si la transformation utilisée (logarithme, racine carrée, inverse, etc.) améliore la normalité de la variable. Ce n’est pas toujours le cas, parfois c’est pire! Prenez soin de comparer les histogrammes, les valeurs de <em>skewness</em>, de <em>kurtosis</em> et des différents tests de normalité avant et après la transformation. Deuxièmement, comparez les résultats de vos analyses statistiques sans et avec transformation, et ce, dans une démarche coût-avantage. Vos résultats sont-ils bien plus robustes? Par exemple, un R<sup>2</sup> qui passe de 0,597 à 0,602 (avant et après la transformation des variables) avec des associations significatives similaires, mais qui sont plus difficiles à interpréter (du fait des transformations), n’est pas forcément un gain significatif. La modélisation en sciences sociales ne vise pas à prédire la trajectoire d’un satellite ou l’atterrissage d’un engin sur Mars! La précision à la quatrième décimale n’est pas une condition! Par conséquent, un modèle un peu moins robuste, mais plus facile à interpréter est parfois préférable.</p></li>
</ul>
</div>
</div>
<div id="sect02552" class="section level4 hasAnchor" number="2.5.5.2">
<h4><span class="header-section-number">2.5.5.2</span> Autres types de transformations<a href="sect025.html#sect02552" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Les trois transformations les plus couramment utilisées sont :</p>
<ul>
<li><strong>La côte <span class="math inline">\(z\)</span></strong> (<em>z score</em> en anglais) qui consiste à soustraire à chaque valeur sa moyenne (soit un centrage), puis à la diviser par son écart-type (soit une réduction) (équation <a href="sect025.html#eq:scorez">(2.29)</a>). Par conséquent, nous parlons aussi de variable centrée réduite qui a comme propriétés intéressantes une moyenne égale à 0 et un écart-type égal à 1 (la variance est aussi égale à 1 puisque 1<sup>2</sup> = 1). Nous verrons que cette transformation est largement utilisée dans les méthodes de classification (chapitre <a href="chap13.html#chap13">13</a>) et les méthodes factorielles (chapitre <a href="chap12.html#chap12">12</a>).</li>
</ul>
<p><span class="math display" id="eq:scorez">\[\begin{equation}  
z= \frac{x_i-\mu}{\sigma}
\tag{2.29}
\end{equation}\]</span>
</p>
<ul>
<li><p><strong>La transformation en rang</strong> qui consiste simplement à trier une variable en ordre croissant, puis à affecter le rang de chaque observation de 1 à <span class="math inline">\(n\)</span>. Cette transformation est très utilisée quand la variable est très anormalement distribuée, notamment pour calculer le coefficient de corrélation de Spearman (section <a href="sect043.html#sect0433">4.3.3</a>) et certains tests non paramétriques (sections <a href="sect061.html#sect0612">6.1.2</a> et <a href="sect062.html#sect0622">6.2.2</a>).</p></li>
<li><p><strong>La transformation sur une échelle de 0 à 1</strong> (ou de 0 à 100) qui consiste à soustraite à chaque observation la valeur minimale et à diviser le tout par l’étendue (équation <a href="sect025.html#eq:t01">(2.30)</a>).</p></li>
</ul>
<p><span class="math display" id="eq:t01">\[\begin{equation}  
X_{\in\lbrack0-1\rbrack}= \frac{x_i-max}{max-min} \text{ ou } X_{\in\lbrack0-100\rbrack}= \frac{x_i-min}{max-min}\times100
\tag{2.30}
\end{equation}\]</span>
</p>
<table>
<caption>
<span id="tab:AutresTransformation">Tableau 2.9: </span>Illustration des trois transformations
</caption>
<thead>
<tr>
<th style="text-align:left;">
Observation
</th>
<th style="text-align:right;">
<span class="math inline">\(x_i\)</span>
</th>
<th style="text-align:right;">
Côte <span class="math inline">\(z\)</span>
</th>
<th style="text-align:center;">
Rang
</th>
<th style="text-align:right;">
0 à 1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
22,00
</td>
<td style="text-align:right;">
-1,45
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:right;">
0,00
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
27,00
</td>
<td style="text-align:right;">
-0,65
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:right;">
0,28
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
25,00
</td>
<td style="text-align:right;">
-0,97
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:right;">
0,17
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
30,00
</td>
<td style="text-align:right;">
-0,16
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:right;">
0,44
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
37,00
</td>
<td style="text-align:right;">
0,97
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:right;">
0,83
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
32,00
</td>
<td style="text-align:right;">
0,16
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:right;">
0,56
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
35,00
</td>
<td style="text-align:right;">
0,65
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:right;">
0,72
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
40,00
</td>
<td style="text-align:right;">
1,45
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:right;">
1,00
</td>
</tr>
<tr>
<td style="text-align:left;">
Moyenne
</td>
<td style="text-align:right;">
31,00
</td>
<td style="text-align:right;">
0,00
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Écart-type
</td>
<td style="text-align:right;">
6,19
</td>
<td style="text-align:right;">
1,00
</td>
<td style="text-align:center;">
</td>
<td style="text-align:right;">
</td>
</tr>
</tbody>
</table>
<p>Pour un <em>DataFrame</em>, nommé <em>df</em>, comprenant une variable <em>X</em>, la syntaxe ci-dessous illustre comment obtenir quatre transformations (côte <span class="math inline">\(z\)</span>, rang, 0 à 1 et 0 à 100).</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="sect025.html#cb269-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> <span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">27</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">37</span>,<span class="dv">32</span>,<span class="dv">35</span>,<span class="dv">40</span>))</span>
<span id="cb269-2"><a href="sect025.html#cb269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-3"><a href="sect025.html#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation centrée réduite : côte Z</span></span>
<span id="cb269-4"><a href="sect025.html#cb269-4" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>zX <span class="ot">&lt;-</span> (df2<span class="sc">$</span>X<span class="sc">-</span><span class="fu">mean</span>(df2<span class="sc">$</span>X))<span class="sc">/</span><span class="fu">sd</span>(df2<span class="sc">$</span>X)</span>
<span id="cb269-5"><a href="sect025.html#cb269-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ou encore avec la fonction scale</span></span>
<span id="cb269-6"><a href="sect025.html#cb269-6" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>zX <span class="ot">&lt;-</span>  <span class="fu">scale</span>(df2<span class="sc">$</span>X, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb269-7"><a href="sect025.html#cb269-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-8"><a href="sect025.html#cb269-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation en rang avec la fonction rank</span></span>
<span id="cb269-9"><a href="sect025.html#cb269-9" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>rX <span class="ot">&lt;-</span> <span class="fu">rank</span>(df2<span class="sc">$</span>X)</span>
<span id="cb269-10"><a href="sect025.html#cb269-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-11"><a href="sect025.html#cb269-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation de 0 à 1 ou de 0 à 100</span></span>
<span id="cb269-12"><a href="sect025.html#cb269-12" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>X01 <span class="ot">&lt;-</span> (df2<span class="sc">$</span>X<span class="sc">-</span><span class="fu">min</span>(df2<span class="sc">$</span>X))<span class="sc">/</span>(<span class="fu">max</span>(df2<span class="sc">$</span>X)<span class="sc">-</span><span class="fu">min</span>(df2<span class="sc">$</span>X))</span>
<span id="cb269-13"><a href="sect025.html#cb269-13" aria-hidden="true" tabindex="-1"></a>df2<span class="sc">$</span>X0100 <span class="ot">&lt;-</span> (df2<span class="sc">$</span>X<span class="sc">-</span><span class="fu">min</span>(df2<span class="sc">$</span>X))<span class="sc">/</span>(<span class="fu">max</span>(df2<span class="sc">$</span>X)<span class="sc">-</span><span class="fu">min</span>(df2<span class="sc">$</span>X))<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<div class="bloc_aller_loin">
<p>Ces trois transformations sont parfois utilisées pour générer un indice composite à partir de plusieurs variables ou encore dans une analyse de sensibilité avec les indices de Sobol <span class="citation">(<a href="#ref-Sobol1993" role="doc-biblioref">1993</a>)</span>.</p>
</div>
</div>
</div>
<div id="sect0256" class="section level3 hasAnchor" number="2.5.6">
<h3><span class="header-section-number">2.5.6</span> Mise en œuvre dans R<a href="sect025.html#sect0256" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il existe une multitude de <em>packages</em> dédiés au calcul des statistiques descriptives univariées. Par parcimonie, nous en utiliserons uniquement trois : <code>DescTools</code>, <code>nortest</code> et <code>stats</code>. Libre à vous de faire vos recherches sur Internet pour utiliser d’autres <em>packages</em> au besoin. Les principales fonctions que nous utilisons ici sont :</p>
<ul>
<li><code>summary</code> : pour obtenir un résumé sommaire des statistiques descriptives (minimum, Q1, Q2, Q3, maximum)</li>
<li><code>mean</code> : moyenne</li>
<li><code>min</code> : minimum</li>
<li><code>max</code> : maximum</li>
<li><code>range</code> : minimum et maximum</li>
<li><code>quantile</code> : quartiles</li>
<li><code>quantile((x, probs = seq(.0, 1, by = .2))</code> : quintiles</li>
<li><code>quantile((x, probs = seq(.0, 1, by = .1))</code> : déciles</li>
<li><code>var</code> : variance</li>
<li><code>sd</code> : écart-type</li>
<li><code>Skew</code> du <em>package</em> <code>DescTools</code> : coefficient d’asymétrie</li>
<li><code>Kurt</code> du <em>package</em> <code>DescTools</code> : coefficient d’aplatissement</li>
<li><code>ks.test(x, "pnorm", mean=mean(x), sd=sd(x))</code> du <em>package</em> <code>nortest</code> : test de Kolmogorov-Smirnov</li>
<li><code>shapiro.test</code> du <em>package</em> <code>DescTools</code> : test de Shapiro-Wilk</li>
<li><code>lillie.test</code> du <em>package</em> <code>DescTools</code> : du package <code>nortest</code> : test de Lilliefors</li>
<li><code>ad.test</code> du <em>package</em> <code>DescTools</code> : test d’Anderson-Darling</li>
<li><code>JarqueBeraTest</code> du <em>package</em> <code>DescTools</code> : test de Jarque-Bera</li>
</ul>
<div id="sect02561" class="section level4 hasAnchor" number="2.5.6.1">
<h4><span class="header-section-number">2.5.6.1</span> Application à une seule variable<a href="sect025.html#sect02561" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Admettons que vous voulez obtenir des statistiques pour une seule variable présente dans un <em>DataFrame</em> (<code>dataMTL$PctFRev</code>) :</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="sect025.html#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb270-2"><a href="sect025.html#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb270-3"><a href="sect025.html#cb270-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb270-4"><a href="sect025.html#cb270-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-5"><a href="sect025.html#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Importation du fichier csv dans un DataFrame</span></span>
<span id="cb270-6"><a href="sect025.html#cb270-6" aria-hidden="true" tabindex="-1"></a>dataMTL <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/univariee/DataSR2016.csv&quot;</span>)</span>
<span id="cb270-7"><a href="sect025.html#cb270-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau sommaire pour la variable PctFRev</span></span>
<span id="cb270-8"><a href="sect025.html#cb270-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dataMTL<span class="sc">$</span>PctFRev)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.846  11.242  15.471  16.822  20.229  68.927</code></pre>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="sect025.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMÈTRES DE TENDANCE CENTRALE</span></span>
<span id="cb272-2"><a href="sect025.html#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dataMTL<span class="sc">$</span>PctFRev)   <span class="co"># Moyenne</span></span></code></pre></div>
<pre><code>## [1] 16.82247</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="sect025.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(dataMTL<span class="sc">$</span>PctFRev)   <span class="co"># Médiane</span></span></code></pre></div>
<pre><code>## [1] 15.471</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="sect025.html#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMÈTRES DE POSITION</span></span>
<span id="cb276-2"><a href="sect025.html#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Quartiles</span></span>
<span id="cb276-3"><a href="sect025.html#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(dataMTL<span class="sc">$</span>PctFRev)</span></code></pre></div>
<pre><code>##      0%     25%     50%     75%    100% 
##  1.8460 11.2420 15.4710 20.2285 68.9270</code></pre>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="sect025.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quintiles</span></span>
<span id="cb278-2"><a href="sect025.html#cb278-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(dataMTL<span class="sc">$</span>PctFRev, <span class="at">probs =</span> <span class="fu">seq</span>(.<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">2</span>))</span></code></pre></div>
<pre><code>##     0%    20%    40%    60%    80%   100% 
##  1.846 10.294 13.626 16.918 21.756 68.927</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="sect025.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Déciles</span></span>
<span id="cb280-2"><a href="sect025.html#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(dataMTL<span class="sc">$</span>PctFRev, <span class="at">probs =</span> <span class="fu">seq</span>(.<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##     0%    10%    20%    30%    40%    50%    60%    70%    80%    90%   100% 
##  1.846  8.402 10.294 12.172 13.626 15.471 16.918 18.868 21.756 26.854 68.927</code></pre>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="sect025.html#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentiles personnalisés avec apply</span></span>
<span id="cb282-2"><a href="sect025.html#cb282-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(dataMTL<span class="sc">$</span>PctFRev, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,.<span class="dv">05</span>,<span class="fl">0.10</span>,.<span class="dv">25</span>,.<span class="dv">50</span>,.<span class="dv">75</span>,.<span class="dv">90</span>,.<span class="dv">95</span>,.<span class="dv">99</span>))</span></code></pre></div>
<pre><code>##      1%      5%     10%     25%     50%     75%     90%     95%     99% 
##  5.2290  7.1470  8.4020 11.2420 15.4710 20.2285 26.8540 31.7530 45.6010</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="sect025.html#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMÈTRES DE DISPERSION</span></span>
<span id="cb284-2"><a href="sect025.html#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(dataMTL<span class="sc">$</span>PctFRev)  <span class="co"># Min et Max</span></span></code></pre></div>
<pre><code>## [1]  1.846 68.927</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="sect025.html#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Étendue</span></span>
<span id="cb286-2"><a href="sect025.html#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(dataMTL<span class="sc">$</span>PctFRev)<span class="sc">-</span><span class="fu">min</span>(dataMTL<span class="sc">$</span>PctFRev)</span></code></pre></div>
<pre><code>## [1] 67.081</code></pre>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="sect025.html#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Écart interquartile</span></span>
<span id="cb288-2"><a href="sect025.html#cb288-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(dataMTL<span class="sc">$</span>PctFRev)[<span class="dv">4</span>]<span class="sc">-</span><span class="fu">quantile</span>(dataMTL<span class="sc">$</span>PctFRev)[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>##    75% 
## 8.9865</code></pre>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="sect025.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(dataMTL<span class="sc">$</span>PctFRev) <span class="co"># Variance</span></span></code></pre></div>
<pre><code>## [1] 66.62482</code></pre>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="sect025.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(dataMTL<span class="sc">$</span>PctFRev)  <span class="co"># Écart-type</span></span></code></pre></div>
<pre><code>## [1] 8.162403</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="sect025.html#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(dataMTL<span class="sc">$</span>PctFRev) <span class="sc">/</span> <span class="fu">mean</span>(dataMTL<span class="sc">$</span>PctFRev) <span class="co"># CV</span></span></code></pre></div>
<pre><code>## [1] 0.4852083</code></pre>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="sect025.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMÈTRES DE FORME</span></span>
<span id="cb296-2"><a href="sect025.html#cb296-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Skew</span>(dataMTL<span class="sc">$</span>PctFRev)    <span class="co"># Skewness</span></span></code></pre></div>
<pre><code>## [1] 1.67367</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="sect025.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Kurt</span>(dataMTL<span class="sc">$</span>PctFRev)    <span class="co"># Kurtosis</span></span></code></pre></div>
<pre><code>## [1] 4.858815</code></pre>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="sect025.html#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TESTS D&#39;HYPOTHÈSE SUR LA NORMALITÉ</span></span>
<span id="cb300-2"><a href="sect025.html#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="co"># K-Smirnov</span></span>
<span id="cb300-3"><a href="sect025.html#cb300-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(dataMTL<span class="sc">$</span>PctFRev, <span class="st">&quot;pnorm&quot;</span>, <span class="at">mean=</span><span class="fu">mean</span>(dataMTL<span class="sc">$</span>PctFRev), <span class="at">sd=</span><span class="fu">sd</span>(dataMTL<span class="sc">$</span>PctFRev))</span></code></pre></div>
<pre><code>## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  dataMTL$PctFRev
## D = 0.10487, p-value = 1.646e-09
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="sect025.html#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(dataMTL<span class="sc">$</span>PctFRev) </span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  dataMTL$PctFRev
## W = 0.88748, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="sect025.html#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lillie.test</span>(dataMTL<span class="sc">$</span>PctFRev) </span></code></pre></div>
<pre><code>## 
##  Lilliefors (Kolmogorov-Smirnov) normality test
## 
## data:  dataMTL$PctFRev
## D = 0.10487, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="sect025.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ad.test</span>(dataMTL<span class="sc">$</span>PctFRev) </span></code></pre></div>
<pre><code>## 
##  Anderson-Darling normality test
## 
## data:  dataMTL$PctFRev
## A = 21.072, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="sect025.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">JarqueBeraTest</span>(dataMTL<span class="sc">$</span>PctFRev) </span></code></pre></div>
<pre><code>## 
##  Robust Jarque Bera Test
## 
## data:  dataMTL$PctFRev
## X-squared = 2173.1, df = 2, p-value &lt; 2.2e-16</code></pre>
<p>Pour construire un histogramme avec la courbe normale, consultez la section <a href="sect032.html#sect03213">3.2.1.3</a> ou la syntaxe ci-dessous.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="sect025.html#cb310-1" aria-hidden="true" tabindex="-1"></a>moyenne <span class="ot">&lt;-</span> <span class="fu">mean</span>(dataMTL<span class="sc">$</span>PctFRev)</span>
<span id="cb310-2"><a href="sect025.html#cb310-2" aria-hidden="true" tabindex="-1"></a>ecart_type <span class="ot">&lt;-</span> <span class="fu">sd</span>(dataMTL<span class="sc">$</span>PctFRev)</span>
<span id="cb310-3"><a href="sect025.html#cb310-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb310-4"><a href="sect025.html#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dataMTL) <span class="sc">+</span></span>
<span id="cb310-5"><a href="sect025.html#cb310-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> PctFRev, <span class="at">y =</span> ..density..),</span>
<span id="cb310-6"><a href="sect025.html#cb310-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>) <span class="sc">+</span></span>
<span id="cb310-7"><a href="sect025.html#cb310-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;personnes à faible revenu (%)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;densité&quot;</span>)<span class="sc">+</span></span>
<span id="cb310-8"><a href="sect025.html#cb310-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> moyenne, <span class="at">sd =</span> ecart_type), </span>
<span id="cb310-9"><a href="sect025.html#cb310-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GcourbeNormale"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/GcourbeNormale-1.png" alt="Histogramme avec courbe normale" width="65%" />
<p class="caption">
Figure 2.35: Histogramme avec courbe normale
</p>
</div>
</div>
<div id="sect02562" class="section level4 hasAnchor" number="2.5.6.2">
<h4><span class="header-section-number">2.5.6.2</span> Application à plusieurs variables<a href="sect025.html#sect02562" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour obtenir des sorties de statistiques descriptives pour plusieurs variables, nous vous conseillons :</p>
<ul>
<li>de créer un vecteur avec les noms des variables (<em>VarsSelect</em> dans la syntaxe ci-dessous);</li>
<li>d’utiliser ensuite les fonctions <code>sapply</code> et <code>apply.</code></li>
</ul>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="sect025.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Noms des variables du DataFrame</span></span>
<span id="cb311-2"><a href="sect025.html#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dataMTL)</span></code></pre></div>
<pre><code>##  [1] &quot;CTNAME&quot;                &quot;PopTotal&quot;              &quot;HabKm2&quot;                &quot;PctFRev&quot;              
##  [5] &quot;TxChomage&quot;             &quot;PctImmigrant&quot;          &quot;PctImgRecent&quot;          &quot;PctMenage1pers&quot;       
##  [9] &quot;PctFamilleMono&quot;        &quot;PctLangueMaternelleFR&quot; &quot;PctLangueMaternelleAN&quot; &quot;PctLangueMaternelleAU&quot;</code></pre>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="sect025.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vecteur pour trois variables</span></span>
<span id="cb313-2"><a href="sect025.html#cb313-2" aria-hidden="true" tabindex="-1"></a>VarsSelect <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HabKm2&quot;</span>, <span class="st">&quot;TxChomage&quot;</span>, <span class="st">&quot;PctFRev&quot;</span> )</span>
<span id="cb313-3"><a href="sect025.html#cb313-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-4"><a href="sect025.html#cb313-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tableau sommaire pour les 3 variables</span></span>
<span id="cb313-5"><a href="sect025.html#cb313-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dataMTL[VarsSelect])</span></code></pre></div>
<pre><code>##      HabKm2        TxChomage         PctFRev      
##  Min.   :   18   Min.   : 1.942   Min.   : 1.846  
##  1st Qu.: 1980   1st Qu.: 5.482   1st Qu.:11.242  
##  Median : 3773   Median : 7.130   Median :15.471  
##  Mean   : 5513   Mean   : 7.743   Mean   :16.822  
##  3rd Qu.: 7916   3rd Qu.: 9.391   3rd Qu.:20.229  
##  Max.   :50282   Max.   :26.882   Max.   :68.927</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="sect025.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMÈTRES DE TENDANCE CENTRALE</span></span>
<span id="cb315-2"><a href="sect025.html#cb315-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], mean)   <span class="co"># Moyenne</span></span></code></pre></div>
<pre><code>##      HabKm2   TxChomage     PctFRev 
## 5512.830705    7.743329   16.822470</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="sect025.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], median) <span class="co"># Médiane</span></span></code></pre></div>
<pre><code>##    HabKm2 TxChomage   PctFRev 
##  3773.000     7.130    15.471</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="sect025.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMÈTRES DE POSITION</span></span>
<span id="cb319-2"><a href="sect025.html#cb319-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Quartiles</span></span>
<span id="cb319-3"><a href="sect025.html#cb319-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], quantile)</span></code></pre></div>
<pre><code>##       HabKm2 TxChomage PctFRev
## 0%      18.0    1.9420  1.8460
## 25%   1980.5    5.4825 11.2420
## 50%   3773.0    7.1300 15.4710
## 75%   7915.5    9.3910 20.2285
## 100% 50282.0   26.8820 68.9270</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="sect025.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quintiles</span></span>
<span id="cb321-2"><a href="sect025.html#cb321-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(dataMTL[VarsSelect], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">seq</span>(.<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">2</span>)))</span></code></pre></div>
<pre><code>##      HabKm2 TxChomage PctFRev
## 0%       18     1.942   1.846
## 20%    1525     5.116  10.294
## 40%    2953     6.422  13.626
## 60%    4971     7.973  16.918
## 80%    9509    10.000  21.756
## 100%  50282    26.882  68.927</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="sect025.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Déciles</span></span>
<span id="cb323-2"><a href="sect025.html#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(dataMTL[VarsSelect], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">seq</span>(.<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>##      HabKm2 TxChomage PctFRev
## 0%       18     1.942   1.846
## 10%     455     4.369   8.402
## 20%    1525     5.116  10.294
## 30%    2298     5.780  12.172
## 40%    2953     6.422  13.626
## 50%    3773     7.130  15.471
## 60%    4971     7.973  16.918
## 70%    6918     8.909  18.868
## 80%    9509    10.000  21.756
## 90%   13055    11.749  26.854
## 100%  50282    26.882  68.927</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="sect025.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentiles personnalisés avec apply</span></span>
<span id="cb325-2"><a href="sect025.html#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(dataMTL[VarsSelect], <span class="dv">2</span>, </span>
<span id="cb325-3"><a href="sect025.html#cb325-3" aria-hidden="true" tabindex="-1"></a>      <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,.<span class="dv">05</span>,<span class="fl">0.10</span>,.<span class="dv">25</span>,.<span class="dv">50</span>,.<span class="dv">75</span>,.<span class="dv">90</span>,.<span class="dv">95</span>,.<span class="dv">99</span>)))</span></code></pre></div>
<pre><code>##      HabKm2 TxChomage PctFRev
## 1%     58.5    2.9665  5.2290
## 5%    178.0    3.8980  7.1470
## 10%   455.0    4.3690  8.4020
## 25%  1980.5    5.4825 11.2420
## 50%  3773.0    7.1300 15.4710
## 75%  7915.5    9.3910 20.2285
## 90% 13055.0   11.7490 26.8540
## 95% 15355.0   13.8400 31.7530
## 99% 18578.5   17.1920 45.6010</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="sect025.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMÈTRES DE DISPERSION</span></span>
<span id="cb327-2"><a href="sect025.html#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], range)  <span class="co"># Min et Max</span></span></code></pre></div>
<pre><code>##      HabKm2 TxChomage PctFRev
## [1,]     18     1.942   1.846
## [2,]  50282    26.882  68.927</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="sect025.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Étendue</span></span>
<span id="cb329-2"><a href="sect025.html#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], max) <span class="sc">-</span> <span class="fu">sapply</span>(dataMTL[VarsSelect], min)</span></code></pre></div>
<pre><code>##    HabKm2 TxChomage   PctFRev 
## 50264.000    24.940    67.081</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="sect025.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Écart interquartile</span></span>
<span id="cb331-2"><a href="sect025.html#cb331-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], quantile)[<span class="dv">4</span>,] <span class="sc">-</span> <span class="fu">sapply</span>(dataMTL[VarsSelect], quantile)[<span class="dv">2</span>,]</span></code></pre></div>
<pre><code>##    HabKm2 TxChomage   PctFRev 
## 5935.0000    3.9085    8.9865</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="sect025.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], var)    <span class="co"># Variance</span></span></code></pre></div>
<pre><code>##       HabKm2    TxChomage      PctFRev 
## 2.633462e+07 9.880932e+00 6.662482e+01</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="sect025.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], sd)     <span class="co"># Écart-type</span></span></code></pre></div>
<pre><code>##      HabKm2   TxChomage     PctFRev 
## 5131.726785    3.143395    8.162403</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="sect025.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient de variation</span></span>
<span id="cb337-2"><a href="sect025.html#cb337-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], sd) <span class="sc">/</span> <span class="fu">sapply</span>(dataMTL[VarsSelect], mean)</span></code></pre></div>
<pre><code>##    HabKm2 TxChomage   PctFRev 
## 0.9308696 0.4059488 0.4852083</code></pre>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="sect025.html#cb339-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PARAMÈTRES DE FORME</span></span>
<span id="cb339-2"><a href="sect025.html#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], Skew)    <span class="co"># Skewness</span></span></code></pre></div>
<pre><code>##    HabKm2 TxChomage   PctFRev 
##  1.967468  1.280216  1.673670</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="sect025.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], Kurt)    <span class="co"># Kurtosis</span></span></code></pre></div>
<pre><code>##    HabKm2 TxChomage   PctFRev 
##  8.546403  2.892443  4.858815</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="sect025.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TESTS D&#39;HYPOTHÈSE POUR LA NORMALITÉ</span></span>
<span id="cb343-2"><a href="sect025.html#cb343-2" aria-hidden="true" tabindex="-1"></a><span class="co"># K-Smirnov</span></span>
<span id="cb343-3"><a href="sect025.html#cb343-3" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(dataMTL[VarsSelect], <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">ks.test</span>(x, <span class="st">&quot;pnorm&quot;</span>, <span class="at">mean=</span><span class="fu">mean</span>(x), <span class="at">sd=</span><span class="fu">sd</span>(x)))</span></code></pre></div>
<pre><code>## $HabKm2
## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  x
## D = 0.14899, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided
## 
## 
## $TxChomage
## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  x
## D = 0.080183, p-value = 9.778e-06
## alternative hypothesis: two-sided
## 
## 
## $PctFRev
## 
##  Asymptotic one-sample Kolmogorov-Smirnov test
## 
## data:  x
## D = 0.10487, p-value = 1.646e-09
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="sect025.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], shapiro.test)       <span class="co"># Shapiro-Wilk</span></span></code></pre></div>
<pre><code>##           HabKm2                        TxChomage                     PctFRev                      
## statistic 0.8385086                     0.9235146                     0.8874803                    
## p.value   5.648795e-30                  1.451222e-21                  1.00278e-25                  
## method    &quot;Shapiro-Wilk normality test&quot; &quot;Shapiro-Wilk normality test&quot; &quot;Shapiro-Wilk normality test&quot;
## data.name &quot;X[[i]]&quot;                      &quot;X[[i]]&quot;                      &quot;X[[i]]&quot;</code></pre>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="sect025.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], lillie.test)       <span class="co"># Lilliefors</span></span></code></pre></div>
<pre><code>##           HabKm2                                          
## statistic 0.148988                                        
## p.value   5.689619e-58                                    
## method    &quot;Lilliefors (Kolmogorov-Smirnov) normality test&quot;
## data.name &quot;X[[i]]&quot;                                        
##           TxChomage                                       
## statistic 0.0801829                                       
## p.value   7.758887e-16                                    
## method    &quot;Lilliefors (Kolmogorov-Smirnov) normality test&quot;
## data.name &quot;X[[i]]&quot;                                        
##           PctFRev                                         
## statistic 0.1048704                                       
## p.value   7.43257e-28                                     
## method    &quot;Lilliefors (Kolmogorov-Smirnov) normality test&quot;
## data.name &quot;X[[i]]&quot;</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="sect025.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], ad.test)           <span class="co"># Anderson-Darling</span></span></code></pre></div>
<pre><code>##           HabKm2                            TxChomage                        
## statistic 36.40276                          14.9237                          
## p.value   3.7e-24                           3.7e-24                          
## method    &quot;Anderson-Darling normality test&quot; &quot;Anderson-Darling normality test&quot;
## data.name &quot;X[[i]]&quot;                          &quot;X[[i]]&quot;                         
##           PctFRev                          
## statistic 21.07194                         
## p.value   3.7e-24                          
## method    &quot;Anderson-Darling normality test&quot;
## data.name &quot;X[[i]]&quot;</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="sect025.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], JarqueBeraTest)    <span class="co"># Jarque-Bera</span></span></code></pre></div>
<pre><code>##           HabKm2                    TxChomage                 PctFRev                  
## statistic 4270.113                  639.2741                  2173.082                 
## parameter 2                         2                         2                        
## p.value   0                         0                         0                        
## method    &quot;Robust Jarque Bera Test&quot; &quot;Robust Jarque Bera Test&quot; &quot;Robust Jarque Bera Test&quot;
## data.name &quot;X[[i]]&quot;                  &quot;X[[i]]&quot;                  &quot;X[[i]]&quot;</code></pre>
</div>
<div id="sect02563" class="section level4 hasAnchor" number="2.5.6.3">
<h4><span class="header-section-number">2.5.6.3</span> Transformation d’une variable dans R<a href="sect025.html#sect02563" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La syntaxe ci-dessous illustre trois exemples de transformation (logarithme, racine carrée et inverse de la variable). Rappelez-vous qu’il faut comparer les valeurs de <em>skewness</em> et de <em>kurtosis</em> et des tests de Shapiro-Wilk avant et après les transformations pour identifier celle qui est la plus efficace.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="sect025.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb353-2"><a href="sect025.html#cb353-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-3"><a href="sect025.html#cb353-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Importation du fichier csv dans un DataFrame</span></span>
<span id="cb353-4"><a href="sect025.html#cb353-4" aria-hidden="true" tabindex="-1"></a>dataMTL <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/univariee/DataSR2016.csv&quot;</span>)</span>
<span id="cb353-5"><a href="sect025.html#cb353-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-6"><a href="sect025.html#cb353-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Noms des variables du DataFrame</span></span>
<span id="cb353-7"><a href="sect025.html#cb353-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dataMTL)</span></code></pre></div>
<pre><code>##  [1] &quot;CTNAME&quot;                &quot;PopTotal&quot;              &quot;HabKm2&quot;                &quot;PctFRev&quot;              
##  [5] &quot;TxChomage&quot;             &quot;PctImmigrant&quot;          &quot;PctImgRecent&quot;          &quot;PctMenage1pers&quot;       
##  [9] &quot;PctFamilleMono&quot;        &quot;PctLangueMaternelleFR&quot; &quot;PctLangueMaternelleAN&quot; &quot;PctLangueMaternelleAU&quot;</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="sect025.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformations</span></span>
<span id="cb355-2"><a href="sect025.html#cb355-2" aria-hidden="true" tabindex="-1"></a>dataMTL<span class="sc">$</span>HabKm2_log <span class="ot">&lt;-</span>  <span class="fu">log10</span>(dataMTL<span class="sc">$</span>HabKm2)</span>
<span id="cb355-3"><a href="sect025.html#cb355-3" aria-hidden="true" tabindex="-1"></a>dataMTL<span class="sc">$</span>HabKm2_sqrt <span class="ot">&lt;-</span>  <span class="fu">sqrt</span>(dataMTL<span class="sc">$</span>HabKm2)</span>
<span id="cb355-4"><a href="sect025.html#cb355-4" aria-hidden="true" tabindex="-1"></a>dataMTL<span class="sc">$</span>HabKm2_inv <span class="ot">&lt;-</span>  <span class="dv">1</span><span class="sc">/</span>dataMTL<span class="sc">$</span>HabKm2</span>
<span id="cb355-5"><a href="sect025.html#cb355-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-6"><a href="sect025.html#cb355-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Vecteur pour la variable et les trois transformations</span></span>
<span id="cb355-7"><a href="sect025.html#cb355-7" aria-hidden="true" tabindex="-1"></a>VarsSelect <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HabKm2&quot;</span>, <span class="st">&quot;HabKm2_log&quot;</span>, <span class="st">&quot;HabKm2_sqrt&quot;</span>, <span class="st">&quot;HabKm2_inv&quot;</span>)</span>
<span id="cb355-8"><a href="sect025.html#cb355-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb355-9"><a href="sect025.html#cb355-9" aria-hidden="true" tabindex="-1"></a><span class="co"># paramètres de forme</span></span>
<span id="cb355-10"><a href="sect025.html#cb355-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], Skew)    <span class="co"># Skewness</span></span></code></pre></div>
<pre><code>##      HabKm2  HabKm2_log HabKm2_sqrt  HabKm2_inv 
##   1.9674683  -1.2071326   0.4179037   8.2536901</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="sect025.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], Kurt)    <span class="co"># Kurtosis</span></span></code></pre></div>
<pre><code>##      HabKm2  HabKm2_log HabKm2_sqrt  HabKm2_inv 
##  8.54640302  1.55670769  0.04563433 82.85604898</code></pre>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="sect025.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TESTS D&#39;HYPOTHÈSE SUR LA NORMALITÉ</span></span>
<span id="cb359-2"><a href="sect025.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dataMTL[VarsSelect], shapiro.test) </span></code></pre></div>
<pre><code>##           HabKm2                        HabKm2_log                    HabKm2_sqrt                  
## statistic 0.8385086                     0.9113234                     0.9771699                    
## p.value   5.648795e-30                  4.11156e-23                   4.638049e-11                 
## method    &quot;Shapiro-Wilk normality test&quot; &quot;Shapiro-Wilk normality test&quot; &quot;Shapiro-Wilk normality test&quot;
## data.name &quot;X[[i]]&quot;                      &quot;X[[i]]&quot;                      &quot;X[[i]]&quot;                     
##           HabKm2_inv                   
## statistic 0.2530266                    
## p.value   8.324983e-52                 
## method    &quot;Shapiro-Wilk normality test&quot;
## data.name &quot;X[[i]]&quot;</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="sect025.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogrammes avec courbe normale</span></span>
<span id="cb361-2"><a href="sect025.html#cb361-2" aria-hidden="true" tabindex="-1"></a>Graph1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataMTL) <span class="sc">+</span></span>
<span id="cb361-3"><a href="sect025.html#cb361-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> HabKm2, <span class="at">y =</span> ..density..),</span>
<span id="cb361-4"><a href="sect025.html#cb361-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>) <span class="sc">+</span></span>
<span id="cb361-5"><a href="sect025.html#cb361-5" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">expression</span>(<span class="st">&quot;Habitants au km&quot;</span><span class="sc">^</span><span class="dv">2</span>), </span>
<span id="cb361-6"><a href="sect025.html#cb361-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">&quot;densité&quot;</span>)<span class="sc">+</span></span>
<span id="cb361-7"><a href="sect025.html#cb361-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb361-8"><a href="sect025.html#cb361-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dataMTL<span class="sc">$</span>HabKm2), </span>
<span id="cb361-9"><a href="sect025.html#cb361-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">sd =</span> <span class="fu">sd</span>(dataMTL<span class="sc">$</span>HabKm2)), </span>
<span id="cb361-10"><a href="sect025.html#cb361-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="at">size =</span> <span class="fl">1.2</span>)</span>
<span id="cb361-11"><a href="sect025.html#cb361-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-12"><a href="sect025.html#cb361-12" aria-hidden="true" tabindex="-1"></a>Graph2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataMTL) <span class="sc">+</span></span>
<span id="cb361-13"><a href="sect025.html#cb361-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> HabKm2_log, <span class="at">y =</span> ..density..),</span>
<span id="cb361-14"><a href="sect025.html#cb361-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>) <span class="sc">+</span></span>
<span id="cb361-15"><a href="sect025.html#cb361-15" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">expression</span>(<span class="st">&quot;Logarithme d&#39;habitants au km&quot;</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb361-16"><a href="sect025.html#cb361-16" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">&quot;densité&quot;</span>)<span class="sc">+</span></span>
<span id="cb361-17"><a href="sect025.html#cb361-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb361-18"><a href="sect025.html#cb361-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dataMTL<span class="sc">$</span>HabKm2_log), </span>
<span id="cb361-19"><a href="sect025.html#cb361-19" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">sd =</span> <span class="fu">sd</span>(dataMTL<span class="sc">$</span>HabKm2_log)), </span>
<span id="cb361-20"><a href="sect025.html#cb361-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="at">size =</span> <span class="fl">1.2</span>)</span>
<span id="cb361-21"><a href="sect025.html#cb361-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-22"><a href="sect025.html#cb361-22" aria-hidden="true" tabindex="-1"></a>Graph3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataMTL) <span class="sc">+</span></span>
<span id="cb361-23"><a href="sect025.html#cb361-23" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> HabKm2_sqrt, <span class="at">y =</span> ..density..),</span>
<span id="cb361-24"><a href="sect025.html#cb361-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>) <span class="sc">+</span></span>
<span id="cb361-25"><a href="sect025.html#cb361-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">expression</span>(<span class="st">&quot;Racine carrée d&#39;habitants au km&quot;</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb361-26"><a href="sect025.html#cb361-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">&quot;densité&quot;</span>)<span class="sc">+</span></span>
<span id="cb361-27"><a href="sect025.html#cb361-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb361-28"><a href="sect025.html#cb361-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dataMTL<span class="sc">$</span>HabKm2_sqrt), </span>
<span id="cb361-29"><a href="sect025.html#cb361-29" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">sd =</span> <span class="fu">sd</span>(dataMTL<span class="sc">$</span>HabKm2_sqrt)), </span>
<span id="cb361-30"><a href="sect025.html#cb361-30" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="at">size =</span> <span class="fl">1.2</span>)</span>
<span id="cb361-31"><a href="sect025.html#cb361-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-32"><a href="sect025.html#cb361-32" aria-hidden="true" tabindex="-1"></a>Graph4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataMTL) <span class="sc">+</span></span>
<span id="cb361-33"><a href="sect025.html#cb361-33" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">x =</span> HabKm2_inv, <span class="at">y =</span> ..density..),</span>
<span id="cb361-34"><a href="sect025.html#cb361-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">bins =</span> <span class="dv">30</span>, <span class="at">color =</span> <span class="st">&quot;#343a40&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#a8dadc&quot;</span>) <span class="sc">+</span></span>
<span id="cb361-35"><a href="sect025.html#cb361-35" aria-hidden="true" tabindex="-1"></a>          <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">expression</span>(<span class="st">&quot;Inverse d&#39;habitants au km&quot;</span><span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb361-36"><a href="sect025.html#cb361-36" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> <span class="st">&quot;densité&quot;</span>)<span class="sc">+</span></span>
<span id="cb361-37"><a href="sect025.html#cb361-37" aria-hidden="true" tabindex="-1"></a>          <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, </span>
<span id="cb361-38"><a href="sect025.html#cb361-38" aria-hidden="true" tabindex="-1"></a>                        <span class="at">args =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="fu">mean</span>(dataMTL<span class="sc">$</span>HabKm2_inv), </span>
<span id="cb361-39"><a href="sect025.html#cb361-39" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">sd =</span> <span class="fu">sd</span>(dataMTL<span class="sc">$</span>HabKm2_inv)), </span>
<span id="cb361-40"><a href="sect025.html#cb361-40" aria-hidden="true" tabindex="-1"></a>                        <span class="at">color =</span> <span class="st">&quot;#e63946&quot;</span>, <span class="at">size =</span> <span class="fl">1.2</span>)</span>
<span id="cb361-41"><a href="sect025.html#cb361-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-42"><a href="sect025.html#cb361-42" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(<span class="at">plotlist =</span> <span class="fu">list</span>(Graph1, Graph2, Graph3, Graph4), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GTranf"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/GTranf-1.png" alt="Histogramme des transformations" width="75%" />
<p class="caption">
Figure 2.36: Histogramme des transformations
</p>
</div>
<p>La variable <em>HabKm2</em> est asymétrique positive et leptokurtique. Les valeurs des statistiques de forme et du test de Shapiro-Wilk ainsi que les histogrammes semblent démontrer que la transformation la plus efficace est la racine carrée. Si la variable originale est asymétrique positive, sa transformation logarithme est par contre asymétrique négative. Cela démontre que la transformation logarithmique n’est pas toujours la panacée.</p>
</div>
</div>
</div>
<h3>R&eacute;f&eacute;rences</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-2020_1" class="csl-entry">
Apparicio, Philippe et Jérémy Gelb. 2020. <span>« Cyclists′ exposure to road traffic noise: A comparison of three North American and European cities. »</span> <em>Acoustics</em> 2 (1): 73‑86. <a href="https://doi.org/10.3390/acoustics2010006">https://doi.org/10.3390/acoustics2010006</a>.
</div>
<div id="ref-field2012discovering" class="csl-entry">
Field, Andy P, Jeremy Miles et Zoë Field. 2012. <span>« Discovering statistics using R. »</span> Thousand Oaks.
</div>
<div id="ref-joanes1998comparing" class="csl-entry">
Joanes, DN et CA Gill. 1998. <span>« Comparing measures of sample skewness and kurtosis. »</span> <em>Journal of the Royal Statistical Society: Series D (The Statistician)</em> 47 (1): 183‑189. <a href="https://www.jstor.org/stable/2988433">https://www.jstor.org/stable/2988433</a>.
</div>
<div id="ref-pumain1994" class="csl-entry">
Pumain, Denise et Michèle Béguin. 1994. <em>La représentation des données géographiques: statistique et cartographie</em>. Armand Colin.
</div>
<div id="ref-razali2011power" class="csl-entry">
Razali, Nornadiah Mohd et Yap Bee Wah. 2011. <span>« Power comparisons of Shapiro-Wilk, Kolmogorov-Smirnov, Lilliefors and Anderson-Darling tests. »</span> <em>Journal of statistical modeling and analytics</em> 2 (1): 21‑33.
</div>
<div id="ref-Sobol1993" class="csl-entry">
Sobol, IM. 1993. <span>« Sensitivity estimates for nonlinear mathematical models. »</span> <em>Mathematics and Computers in Simulation</em> 1 (4): 407‑414.
</div>
<div id="ref-tabachnick2007" class="csl-entry">
Tabachnick, Barbara G, Linda S Fidell et Jodie B Ullman. 2007. <em>Using multivariate statistics</em>. Pearson.
</div>
<div id="ref-yap2011comparisons" class="csl-entry">
Yap, Bee Wah et Chiaw Hock Sim. 2011. <span>« Comparisons of various types of normality tests. »</span> <em>Journal of Statistical Computation and Simulation</em> 81 (12): 2141‑2155. <a href="https://doi.org/10.1080/00949655.2010.520163">https://doi.org/10.1080/00949655.2010.520163</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect024.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect026.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MethodesQuantitScSocialesBolR.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
