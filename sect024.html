<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Autocorrélation spatiale locale | Notes de cours GMQ405 : Modélisation et analyse spatiale</title>
  <meta name="description" content="Mettre le description du cours." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Autocorrélation spatiale locale | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Mettre le description du cours." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Autocorrélation spatiale locale | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  
  <meta name="twitter:description" content="Mettre le description du cours." />
  <meta name="twitter:image" content="/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio, département de géomatique appliquée, Université de Sherbrooke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect023.html"/>
<link rel="next" href="sect025.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GMQ405 : modélisation et analyse spatiale</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Comment lire ce manuel?</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en géomatique appliquée et utiliser R?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
</ul></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Manipulation des données spatiales dans R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Importation de données géographiques</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sect011.html"><a href="sect011.html#sect0111"><i class="fa fa-check"></i><b>1.1.1</b> Importation de données vectorielles</a></li>
<li class="chapter" data-level="1.1.2" data-path="sect011.html"><a href="sect011.html#sect0112"><i class="fa fa-check"></i><b>1.1.2</b> Importation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Manipulation de données vectorielles</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Fonctions relatives à la projection cartographique</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Fonctions d’opérations géométriques sur une couche</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect01213"><i class="fa fa-check"></i><b>1.2.3</b> Fonctions d’opérations géométriques entre deux couches</a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#sect0124"><i class="fa fa-check"></i><b>1.2.4</b> Fonctions de mesures géométriques et de récupération des coordonnées géographiques</a></li>
<li class="chapter" data-level="1.2.5" data-path="sect012.html"><a href="sect012.html#sect0125"><i class="fa fa-check"></i><b>1.2.5</b> Jointures spatiales</a></li>
<li class="chapter" data-level="1.2.6" data-path="sect012.html"><a href="sect012.html#sect0126"><i class="fa fa-check"></i><b>1.2.6</b> Requêtes spatiales</a></li>
<li class="chapter" data-level="1.2.7" data-path="sect012.html"><a href="sect012.html#sect0127"><i class="fa fa-check"></i><b>1.2.7</b> Manipulation des données attributaires</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Manipulation de données <em>raster</em></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> Mosaïquage et découpage d’images</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Requêtes attributaires sur des images</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Exportation de données spatiales de R vers des formats géographiques</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Exportation de données vectorielles <code>sf</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Exportation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect015.html"><a href="sect015.html"><i class="fa fa-check"></i><b>1.5</b> Cartographie avec R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sect015.html"><a href="sect015.html#sect0151"><i class="fa fa-check"></i><b>1.5.1</b> Manipulation des couches géométriques</a></li>
<li class="chapter" data-level="1.5.2" data-path="sect015.html"><a href="sect015.html#sect0152"><i class="fa fa-check"></i><b>1.5.2</b> Cartes interactives</a></li>
<li class="chapter" data-level="1.5.3" data-path="sect015.html"><a href="sect015.html#sect0153"><i class="fa fa-check"></i><b>1.5.3</b> Mise en page d’une carte</a></li>
<li class="chapter" data-level="1.5.4" data-path="sect015.html"><a href="sect015.html#sect0154"><i class="fa fa-check"></i><b>1.5.4</b> Exportation d’une carte</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.6</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="1.7" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.7</b> Exercices de révision</a></li>
</ul></li>
<li class="part"><span><b>II Autocorrélation spatiale</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Autocorrélation spatiale</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion d’autocorrélation spatiale</a></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Matrices de pondération spatiale</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Matrices de contiguïté</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Matrices de proximité spatiale</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Standardisation des matrices de pondération spatiale en ligne</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Construction de matrices de pondération spatiale dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Autocorrélation spatiale globale</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Statistique du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Autocorrélation spatiale locale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#sect0241"><i class="fa fa-check"></i><b>2.4.1</b> Statistiques locales de Getis et Ord : repérer les points chauds et froids</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#sect0242"><i class="fa fa-check"></i><b>2.4.2</b> Version locale du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#sect0243"><i class="fa fa-check"></i><b>2.4.3</b> Nuage de points du <em>I</em> de Moran d’Anselin</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Méthodes de répartition ponctuelle</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Fréquence et densité des points dans l’espace d’étude</a></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Analyse centrographique</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0311"><i class="fa fa-check"></i><b>3.2.1</b> Paramètres de tendance centrale d’un semis de points</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0312"><i class="fa fa-check"></i><b>3.2.2</b> Paramètres de dispersion d’un semis de points</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0313"><i class="fa fa-check"></i><b>3.2.3</b> Mise en œuvre de l’analyse centrographique dans R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Forme d’un semis de points</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Méthode du plus proche voisin</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Méthode des quadrats</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Identification des agrégats spatiaux</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sect034.html"><a href="sect034.html#sect0341"><i class="fa fa-check"></i><b>3.4.1</b> Cartographie de la densité dans une maille irrégulière</a></li>
<li class="chapter" data-level="3.4.2" data-path="sect034.html"><a href="sect034.html#sect0342"><i class="fa fa-check"></i><b>3.4.2</b> Cartographie de la densité dans une maille régulière</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Méthodes de détection d’agrégats spatiaux et spatio-temporels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Agrégats d’entités spatiales ponctuelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sect041.html"><a href="sect041.html#sect0411"><i class="fa fa-check"></i><b>4.1.1</b> DBSCAN : agrégats spatiaux</a></li>
<li class="chapter" data-level="4.1.2" data-path="sect041.html"><a href="sect041.html#sect0412"><i class="fa fa-check"></i><b>4.1.2</b> ST-DBSCAN : agrégats spatio-temporels</a></li>
<li class="chapter" data-level="4.1.3" data-path="sect041.html"><a href="sect041.html#sect0414"><i class="fa fa-check"></i><b>4.1.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Méthodes de balayage de Kulldorff</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Objectifs de la méthode, types d’analyses, de modèles et d’agrégats</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Principes de base de la méthode</a></li>
<li class="chapter" data-level="4.2.3" data-path="sect042.html"><a href="sect042.html#sect043"><i class="fa fa-check"></i><b>4.2.3</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="4.4" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Mesures d’accessibilité spatiale selon les différents de modes de transport</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Notions relatives à l’analyse de réseau</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sect051.html"><a href="sect051.html#sect0511"><i class="fa fa-check"></i><b>5.1.1</b> Définition d’un réseau</a></li>
<li class="chapter" data-level="5.1.2" data-path="sect051.html"><a href="sect051.html#sect0512"><i class="fa fa-check"></i><b>5.1.2</b> Principaux problèmes résolus en analyse de réseau</a></li>
<li class="chapter" data-level="5.1.3" data-path="sect051.html"><a href="sect051.html#sect0513"><i class="fa fa-check"></i><b>5.1.3</b> Analyse de réseau et entités polygonales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Construction d’un réseau avec R5R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sect052.html"><a href="sect052.html#sect0521"><i class="fa fa-check"></i><b>5.2.1</b> Extraction des données spatiales pour R5R</a></li>
<li class="chapter" data-level="5.2.2" data-path="sect052.html"><a href="sect052.html#sect0522"><i class="fa fa-check"></i><b>5.2.2</b> Construction du réseau avec R5R</a></li>
<li class="chapter" data-level="5.2.3" data-path="sect052.html"><a href="sect052.html#sect0523"><i class="fa fa-check"></i><b>5.2.3</b> Calcul d’itinéraires avec R5R selon le mode de transport</a></li>
<li class="chapter" data-level="5.2.4" data-path="sect052.html"><a href="sect052.html#sect0524"><i class="fa fa-check"></i><b>5.2.4</b> Calcul de matrices OD selon différents modes de transport</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mesures d’accessibilité</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sect053.html"><a href="sect053.html#sect0531"><i class="fa fa-check"></i><b>5.3.1</b> Notion d’accessibilité</a></li>
<li class="chapter" data-level="5.3.2" data-path="sect053.html"><a href="sect053.html#sect0532"><i class="fa fa-check"></i><b>5.3.2</b> Accessibilité spatiale potentielle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Mesures d’accessibilité spatiale potentielle dans R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="sect054.html"><a href="sect054.html#sect0541"><i class="fa fa-check"></i><b>5.4.1</b> Accessibilité spatiale potentielle aux supermarchés</a></li>
<li class="chapter" data-level="5.4.2" data-path="sect054.html"><a href="sect054.html#sect0542"><i class="fa fa-check"></i><b>5.4.2</b> Accessibilité spatiale potentielle aux patinoires extérieures</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Introduction aux modèles de régression spatiale</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Modèles spatiaux autorégressifs</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Les différents modèles</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Quel modèle choisir?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Autres approches de modélisation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Modèles généralisées additifs (GAM) avec une <em>spline</em> bivariée sur les coordonnées géographiques</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> GAM avec <em>random markov field</em></a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Modèle SEVM (<em>Spatial eigenvector mapping</em>)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Modèles géographiquement pondérées</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sect063.html"><a href="sect063.html#sect0631"><i class="fa fa-check"></i><b>6.3.1</b> Modèles GWR classique</a></li>
<li class="chapter" data-level="6.3.2" data-path="sect063.html"><a href="sect063.html#sect0632"><i class="fa fa-check"></i><b>6.3.2</b> Modèles GWR mixte</a></li>
<li class="chapter" data-level="6.3.3" data-path="sect063.html"><a href="sect063.html#sect0633"><i class="fa fa-check"></i><b>6.3.3</b> Modèle MGWR</a></li>
<li class="chapter" data-level="6.3.4" data-path="sect063.html"><a href="sect063.html#sect0634"><i class="fa fa-check"></i><b>6.3.4</b> Modèles MGWR avec autocorrélation spatiale (MGWRSAR)</a></li>
<li class="chapter" data-level="6.3.5" data-path="sect063.html"><a href="sect063.html#sect0635"><i class="fa fa-check"></i><b>6.3.5</b> Extension des modèles GWR pour des variables binaires et de comptages</a></li>
<li class="chapter" data-level="6.3.6" data-path="sect063.html"><a href="sect063.html#sect0636"><i class="fa fa-check"></i><b>6.3.6</b> Autres extensions de la GWR : un aperçu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Introduction aux méthodes de classification spatiale</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Bref retour sur les méthodes de classification non-supervisées</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sect071.html"><a href="sect071.html#sect0711"><i class="fa fa-check"></i><b>7.1.1</b> Classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="7.1.2" data-path="sect071.html"><a href="sect071.html#sect0712"><i class="fa fa-check"></i><b>7.1.2</b> <em>K-means</em></a></li>
<li class="chapter" data-level="7.1.3" data-path="sect071.html"><a href="sect071.html#sect0713"><i class="fa fa-check"></i><b>7.1.3</b> <em>Fuzzy c-means</em></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Méthodes de classification par agrégation intégrant une constrainte spatiale</a></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Classifications spatiales</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Classification ascendante hiérarchique spatiale (<em>ClustGeo</em>)</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> <em>Spatial fuzzy c-means</em> (SFCM)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Méthodes d’interpolation spatiale</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Méthodes déterministes</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Interpolation polynomiale locale</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Interpolation de l’inverse à la distance - <em>IDW</em></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Méthodes géostatistiques</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Krigeage simple</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Krigeage universel</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Co-krigeage</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Krigeage résiduel</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect083.html"><a href="sect083.html"><i class="fa fa-check"></i><b>8.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="8.4" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Analyse spatiale par l’analyse d’images</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Fonctions mathématiques, booléennes, relationnelles et conditionnelles sur les images</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Fonctions mathématiques</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Fonctions booléennes</a></li>
<li class="chapter" data-level="9.1.3" data-path="sect091.html"><a href="sect091.html#sect0913"><i class="fa fa-check"></i><b>9.1.3</b> Fonctions relationnelles</a></li>
<li class="chapter" data-level="9.1.4" data-path="sect091.html"><a href="sect091.html#sect0914"><i class="fa fa-check"></i><b>9.1.4</b> Fonctions conditionnelles</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Fonctions locales, focales, zonales et globales sur les images</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> Fonctions locales</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0922"><i class="fa fa-check"></i><b>9.2.2</b> Fonctions focales</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.3</b> Fonctions zonales</a></li>
<li class="chapter" data-level="9.2.4" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.4</b> Fonctions globales</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Fonctions de surface</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Élevation</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Pente</a></li>
<li class="chapter" data-level="9.3.3" data-path="sect093.html"><a href="sect093.html#sect0933"><i class="fa fa-check"></i><b>9.3.3</b> Ombrage</a></li>
<li class="chapter" data-level="9.3.4" data-path="sect093.html"><a href="sect093.html#sect0934"><i class="fa fa-check"></i><b>9.3.4</b> Visibilité</a></li>
<li class="chapter" data-level="9.3.5" data-path="sect093.html"><a href="sect093.html#sect0935"><i class="fa fa-check"></i><b>9.3.5</b> Sky-view factor Index</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Données spatiotemporelles en mode image</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#fichier-netcdf"><i class="fa fa-check"></i><b>9.4.1</b> Fichier <em>netCDF</em></a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#exemples-applicatifs"><i class="fa fa-check"></i><b>9.4.2</b> Exemples applicatifs</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Correction des exercices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect1001.html"><a href="sect1001.html"><i class="fa fa-check"></i><b>10.1</b> Exercices du chapitre 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect1001.html"><a href="sect1001.html#sect10011"><i class="fa fa-check"></i><b>10.1.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect1001.html"><a href="sect1001.html#sect10012"><i class="fa fa-check"></i><b>10.1.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="sect1001.html"><a href="sect1001.html#sect10013"><i class="fa fa-check"></i><b>10.1.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="sect1001.html"><a href="sect1001.html#sect10014"><i class="fa fa-check"></i><b>10.1.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect1002.html"><a href="sect1002.html"><i class="fa fa-check"></i><b>10.2</b> Exercices du chapitre 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect1002.html"><a href="sect1002.html#sect10021"><i class="fa fa-check"></i><b>10.2.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect1002.html"><a href="sect1002.html#sect10022"><i class="fa fa-check"></i><b>10.2.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.2.3" data-path="sect1002.html"><a href="sect1002.html#sect10023"><i class="fa fa-check"></i><b>10.2.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.2.4" data-path="sect1002.html"><a href="sect1002.html#sect10024"><i class="fa fa-check"></i><b>10.2.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect1003.html"><a href="sect1003.html"><i class="fa fa-check"></i><b>10.3</b> Exercices du chapitre 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sect1003.html"><a href="sect1003.html#sect10031"><i class="fa fa-check"></i><b>10.3.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="sect1003.html"><a href="sect1003.html#sect10032"><i class="fa fa-check"></i><b>10.3.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.3.3" data-path="sect1003.html"><a href="sect1003.html#sect10033"><i class="fa fa-check"></i><b>10.3.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sect1004.html"><a href="sect1004.html"><i class="fa fa-check"></i><b>10.4</b> Exercices du chapitre 4</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect1004.html"><a href="sect1004.html#sect10041"><i class="fa fa-check"></i><b>10.4.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect1004.html"><a href="sect1004.html#sect10042"><i class="fa fa-check"></i><b>10.4.2</b> Exercice 2</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect1005.html"><a href="sect1005.html"><i class="fa fa-check"></i><b>10.5</b> Exercices du chapitre 5</a></li>
<li class="chapter" data-level="10.6" data-path="sect1006.html"><a href="sect1006.html"><i class="fa fa-check"></i><b>10.6</b> Exercices du chapitre 6</a></li>
<li class="chapter" data-level="10.7" data-path="sect1007.html"><a href="sect1007.html"><i class="fa fa-check"></i><b>10.7</b> Exercices du chapitre 7</a></li>
<li class="chapter" data-level="10.8" data-path="sect1008.html"><a href="sect1008.html"><i class="fa fa-check"></i><b>10.8</b> Exercices du chapitre 8</a></li>
<li class="chapter" data-level="10.9" data-path="sect1009.html"><a href="sect1009.html"><i class="fa fa-check"></i><b>10.9</b> Exercices du chapitre 9</a></li>
<li class="chapter" data-level="10.10" data-path="sect1011.html"><a href="sect1011.html"><i class="fa fa-check"></i><b>10.10</b> Exercices du chapitre 11</a></li>
<li class="chapter" data-level="10.11" data-path="sect1012.html"><a href="sect1012.html"><i class="fa fa-check"></i><b>10.11</b> Excercice du chapitre 12</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours GMQ405 :
Modélisation et analyse spatiale</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect024" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Autocorrélation spatiale locale<a href="sect024.html#sect024" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nous avons vu que les statistiques d’autocorrélation globale comme le <em>I</em> de Moran renvoie une valeur pour l’ensemble de l’espace d’étude. Une fois démontrée la présence d’autocorrélation spatiale (positive ou négative), il est pertinent de réaliser une analyse de l’autocorrélation spatiale locale afin de vérifier si chaque entité spatiale est significativement (dis)semblable à celles voisines ou proches. Comme l’indique le terme <em>locale</em>, les mesures d’autocorrélation spatiale locale renvoient des valeurs pour chacune des entités spatiales.</p>
<div id="sect0241" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Statistiques locales de Getis et Ord : repérer les points chauds et froids<a href="sect024.html#sect0241" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les statistiques locales de Getis et Ord permettent d’évaluer la similarité d’une entité spatiale avec celles voisines ou proches <span class="citation">(<a href="#ref-getis1992analysis" role="doc-biblioref">Getis et Ord 1992</a>; <a href="#ref-ord1995local" role="doc-biblioref">Ord et Getis 1995</a>)</span>. Autrement dit, elles nous informent si les valeurs fortes et les valeurs faibles d’une variable continue se regroupent significativement dans l’espace, et ce, avec n’importe quel type de matrice de contiguïté, de proximité, de plus proches voisins, etc. Cartographier ces statistiques permet alors de vérifier simultanément l’existence d’agrégats spatiaux de valeurs fortes (<strong>points chauds</strong>) et d’agrégats spatiaux de valeurs faibles (<strong>points froids</strong>).</p>
<p>Il existe deux versions légèrement différentes de ces mesures locales <span class="citation">(<a href="#ref-getis1992analysis" role="doc-biblioref">Getis et Ord 1992</a>; <a href="#ref-ord1995local" role="doc-biblioref">Ord et Getis 1995</a>)</span> :</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(G_i\)</span> tient compte uniquement des entités voisines ou proches à l’entité spatiale <span class="math inline">\(i\)</span>. Ainsi, <span class="math inline">\(\Sigma_{j=1}^n w_{ij}x_j\)</span> représente la moyenne pondérée (par les poids de la matrice de pondération spatiale standardisée en ligne) de la variable continue <span class="math inline">\(X\)</span> dans les entités voisines ou proches.</p></li>
<li><p><span class="math inline">\(G_i^*\)</span> tient compte à la fois des valeurs des entités voisines ou proches, mais aussi de celle de <span class="math inline">\(i\)</span>.</p></li>
</ol>
<p>Toutefois, nous cartographions rarement les valeurs de <span class="math inline">\(G_i\)</span> et de <span class="math inline">\(G_i^*\)</span>, mais plutôt celles de <span class="math inline">\(Z(G_i)\)</span> et de <span class="math inline">\(Z(G_i^*)\)</span> (équations <a href="sect024.html#eq:LocalGetis">(2.12)</a> et <a href="sect024.html#eq:LocalGetisStar">(2.13)</a>) qui représentent la cote Z qui, lorsque positive, indique un agrégat de valeurs plus élevées que la moyenne, et qui, lorsque négative, indique un agrégat de valeurs plus faibles que la moyenne <span class="citation">(<a href="#ref-bivand2018comparing" role="doc-biblioref">Bivand et Wong 2018</a>)</span>.</p>
<p>À première vue, ces deux formules peuvent sembler quelque peu complexes! Retenez simplement que le numérateur est la différence entre <span class="math inline">\(G_i\)</span> ou <span class="math inline">\(G_i^*\)</span> et la valeur attendue de <span class="math inline">\(G_i\)</span> ou de <span class="math inline">\(G_i^*\)</span> pour une distribution aléatoire (soit globalement la moyenne de la variable), tandis que le dénominateur représente l’écart-type de <span class="math inline">\(G_i\)</span> ou de <span class="math inline">\(G_i^*\)</span>.</p>
<p><span class="math display" id="eq:LocalGetis">\[\begin{equation}  
Z(G_i) = \frac{\bigr[ \Sigma_{j=1}^n w_{ij}x_j \bigr] - \bigr[ (\Sigma_{j=1}^nw_{ij}) \bar x_i \bigr]}
{s_i \sqrt{ \Bigr[ \Bigl((n-1)\Sigma_{j=1}^nw_{ij}^2-(\Sigma_{j=1}^nw_{ij})^2\Bigl) \Bigr] / (n-1) } } = \frac{G_i - \mathbb{E}(G_i)}{\sqrt{Var(G_i)}} \text{, }i \neq j
\tag{2.12}
\end{equation}\]</span>
</p>
<p><span class="math display">\[\text{avec } \bar x_i=\frac{\Sigma_{j=1}^nx_j}{n-1}  \text{, et } s_i = \sqrt{ \frac{\Sigma_{j=1}^nx_j^2}{n-1}-\bar x^2} \text{, } i \neq j\]</span>
<span class="math display" id="eq:LocalGetisStar">\[\begin{equation}  
Z(G_i^*) = \frac{\bigr[ \Sigma_{j=1}^n w_{ij}x_j \bigr] - \bigr[ (\Sigma_{j=1}^nw_{ij}) \bar x^* \bigr]}
{s^* \sqrt{ \Bigr[ \Bigl((n-1)\Sigma_{j=1}^nw_{ij}^2-(\Sigma_{j=1}^nw_{ij})^2\Bigl) \Bigr] / (n-1) } } = \frac{G_i^* - \mathbb{E}(G_i^*)}{\sqrt{Var(G_i^*)}}\text{, tous }
\tag{2.13}
\end{equation}\]</span>
</p>
<p><span class="math display">\[\text{avec } \bar x^*=\frac{\Sigma_{j=1}^nx_j}{n}  \text{, et } s^* = \sqrt{ \frac{\Sigma_{j=1}^nx_j^2}{n}-\bar x^{*2}} \text{, tous } j\]</span>
avec :</p>
<ul>
<li><p><em>n</em>, le nombre d’entités spatiales dans la couche géographique;</p></li>
<li><p><span class="math inline">\(w_{ij}\)</span>, la valeur de la pondération spatiale entre les entités spatiales <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>;</p></li>
<li><p><span class="math inline">\(x_j\)</span>, la valeur de variable continue <span class="math inline">\(X\)</span> pour l’entité spatiale <span class="math inline">\(j\)</span>;</p></li>
<li><p><span class="math inline">\(\bar{x^*}\)</span>, la valeur moyenne de la variable pour toutes les observations;</p></li>
<li><p><span class="math inline">\(\bar{x_i}\)</span>, la valeur moyenne de la variable pour toutes les observations sauf <span class="math inline">\(i\)</span>.</p></li>
</ul>
<div class="bloc_astuce">
<p><strong>Deux manières de calculer <span class="math inline">\(Z(G_i)\)</span> et <span class="math inline">\(Z(G_i^*)\)</span> avec le <em>package</em> <code>spdep</code></strong></p>
<ul>
<li><p>la fonction <code>localG</code> vous renvoie les valeurs de cote Z (<em>Z-score</em> en anglais) des statistiques de Getis et Ord avec les formules décrites plus haut.</p></li>
<li><p>la fonction <code>localG_perm</code> permet de les obtenir avec la méthode Monte-Carlo (avec habituellement 999 permutations).</p></li>
</ul>
<p><strong>Cartographie des cotes Z</strong></p>
<p>À partir des cotes Z, utilisez les bornes des classes suivantes et la palette de couleurs <code>-RdBu</code> :</p>
<ul>
<li>Minimum à -3,29 : point froid significatif avec <em>p</em> &lt; 0,001 (bleu foncé)</li>
<li>-3,29 à -2,58 : point froid significatif avec <em>p</em> &lt; 0,01 (bleu)</li>
<li>-2,58 à -1,96 : point froid significatif avec <em>p</em> &lt; 0,05 (bleu pâle)</li>
<li>-1,96 à 1,96 : non significatif, (gris)</li>
<li>1,96 à 2,58 : point chaud significatif avec <em>p</em> &lt; 0,05 (rouge pâle)</li>
<li>2,58 à 3,29 : point chaud significatif avec <em>p</em> &lt; 0,01 (rouge)</li>
<li>3,29 à Maximum : point chaud significatif avec *p &lt;0 ,001 (rouge foncé)</li>
</ul>
<p>Avec la palette <code>-RdBu</code>, les points froids et les points chauds sont respectivement bleus et rouges comme les pastilles de votre robinet! Bref, un beau travail de plomberie!</p>
<p>Pour un rappel sur la cote Z et les valeurs de <em>p</em> associées, consultez <a href="https://pro.arcgis.com/fr/pro-app/latest/tool-reference/spatial-statistics/what-is-a-z-score-what-is-a-p-value.htm">ce lien</a>.</p>
</div>
<p>La syntaxe ci-dessous calcule les deux statistiques locales avec <code>localG</code> et <code>localG_perm</code> pour le revenu moyen des ménages pour les aires de diffusion de 2021 de la ville de Sherbrooke.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="sect024.html#cb242-1" aria-hidden="true" tabindex="-1"></a>Rook1 <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(AD.DR, <span class="at">queen=</span><span class="cn">FALSE</span>)</span>
<span id="cb242-2"><a href="sect024.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrice de pondération</span></span>
<span id="cb242-3"><a href="sect024.html#cb242-3" aria-hidden="true" tabindex="-1"></a>W.RookG    <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Rook1, <span class="at">zero.policy=</span><span class="cn">TRUE</span>)</span>
<span id="cb242-4"><a href="sect024.html#cb242-4" aria-hidden="true" tabindex="-1"></a>W.RookStar <span class="ot">&lt;-</span><span class="fu">nb2listw</span>(<span class="fu">include.self</span>(Rook1), <span class="at">zero.policy=</span><span class="cn">TRUE</span>) <span class="co"># matrice incluant elle-même</span></span>
<span id="cb242-5"><a href="sect024.html#cb242-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul du Z(Gi) et du Z(Gi*)</span></span>
<span id="cb242-6"><a href="sect024.html#cb242-6" aria-hidden="true" tabindex="-1"></a>localGetis     <span class="ot">&lt;-</span> <span class="fu">localG</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.RookG)</span>
<span id="cb242-7"><a href="sect024.html#cb242-7" aria-hidden="true" tabindex="-1"></a>localGetisStar <span class="ot">&lt;-</span> <span class="fu">localG</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.RookStar)</span>
<span id="cb242-8"><a href="sect024.html#cb242-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul avec la méthode Monte-Carlo (999 permutations)</span></span>
<span id="cb242-9"><a href="sect024.html#cb242-9" aria-hidden="true" tabindex="-1"></a>localGetis.MC999     <span class="ot">&lt;-</span> <span class="fu">localG_perm</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.RookG, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb242-10"><a href="sect024.html#cb242-10" aria-hidden="true" tabindex="-1"></a>localGetis.StarMC999 <span class="ot">&lt;-</span> <span class="fu">localG_perm</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.RookStar, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb242-11"><a href="sect024.html#cb242-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Sommaires statistiques</span></span>
<span id="cb242-12"><a href="sect024.html#cb242-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localGetis)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -3.80885 -1.70432 -0.09828 -0.04120  1.41123  3.91835</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="sect024.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localGetisStar)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -4.04870 -1.88689 -0.13297 -0.03841  1.54641  4.10379</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="sect024.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localGetis.MC999)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -3.80885 -1.70432 -0.09828 -0.04120  1.41123  3.91835</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="sect024.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localGetis.StarMC999)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -4.04870 -1.88689 -0.13297 -0.03841  1.54641  4.10379</code></pre>
<p>Cartographions ces valeurs et repérons les regroupements de valeurs significativement fortes et faibles avec les statistiques de Getis et Ord (figures <a href="sect024.html#fig:GetisLocaleClassique">2.17</a> et <a href="sect024.html#fig:GetisLocaleMC">2.18</a>). Les quatre cartes sont très semblables et permettent de repérer un regroupement de valeurs faibles dans le centre-ville et un autre de valeurs fortes dans l’est de la ville.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="sect024.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Enregistrons les résultats dans deux nouveaux champs de la couche des AD</span></span>
<span id="cb250-2"><a href="sect024.html#cb250-2" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis <span class="ot">&lt;-</span> localGetis</span>
<span id="cb250-3"><a href="sect024.html#cb250-3" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetisStar <span class="ot">&lt;-</span> localGetisStar</span>
<span id="cb250-4"><a href="sect024.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des intervalles et des noms des classes</span></span>
<span id="cb250-5"><a href="sect024.html#cb250-5" aria-hidden="true" tabindex="-1"></a>classes.intervalles <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="fl">3.29</span>, <span class="sc">-</span><span class="fl">2.58</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>, <span class="fl">2.58</span>, <span class="fl">3.29</span>, <span class="cn">Inf</span>)</span>
<span id="cb250-6"><a href="sect024.html#cb250-6" aria-hidden="true" tabindex="-1"></a>classes.noms <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Point froid (p = 0,001)&quot;</span>, </span>
<span id="cb250-7"><a href="sect024.html#cb250-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point froid (p = 0,01)&quot;</span>, </span>
<span id="cb250-8"><a href="sect024.html#cb250-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point froid (p = 0,05)&quot;</span>, </span>
<span id="cb250-9"><a href="sect024.html#cb250-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Non significatif&quot;</span>,</span>
<span id="cb250-10"><a href="sect024.html#cb250-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,05)&quot;</span>, </span>
<span id="cb250-11"><a href="sect024.html#cb250-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,01)&quot;</span>, </span>
<span id="cb250-12"><a href="sect024.html#cb250-12" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,001)&quot;</span>)</span>
<span id="cb250-13"><a href="sect024.html#cb250-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d&#39;un champ avec les noms des classes</span></span>
<span id="cb250-14"><a href="sect024.html#cb250-14" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetisP <span class="ot">&lt;-</span> <span class="fu">cut</span>(AD.DR<span class="sc">$</span>RevMed_localGetis, </span>
<span id="cb250-15"><a href="sect024.html#cb250-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">breaks =</span> classes.intervalles, </span>
<span id="cb250-16"><a href="sect024.html#cb250-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> classes.noms)</span>
<span id="cb250-17"><a href="sect024.html#cb250-17" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetisStarP <span class="ot">&lt;-</span> <span class="fu">cut</span>(AD.DR<span class="sc">$</span>RevMed_localGetisStar, </span>
<span id="cb250-18"><a href="sect024.html#cb250-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">breaks =</span> classes.intervalles, </span>
<span id="cb250-19"><a href="sect024.html#cb250-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> classes.noms)</span>
<span id="cb250-20"><a href="sect024.html#cb250-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Cartographie pour le Z(Gi)</span></span>
<span id="cb250-21"><a href="sect024.html#cb250-21" aria-hidden="true" tabindex="-1"></a>Carte1 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb250-22"><a href="sect024.html#cb250-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_localGetisP&quot;</span>, </span>
<span id="cb250-23"><a href="sect024.html#cb250-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">&quot;Z(Gi)&quot;</span>, <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb250-24"><a href="sect024.html#cb250-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span><span class="cn">FALSE</span>)</span>
<span id="cb250-25"><a href="sect024.html#cb250-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Cartographie pour le Z(Gi)*</span></span>
<span id="cb250-26"><a href="sect024.html#cb250-26" aria-hidden="true" tabindex="-1"></a>Carte2 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb250-27"><a href="sect024.html#cb250-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_localGetisStarP&quot;</span>, </span>
<span id="cb250-28"><a href="sect024.html#cb250-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">&quot;Z(Gi*)&quot;</span>,  <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb250-29"><a href="sect024.html#cb250-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb250-30"><a href="sect024.html#cb250-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tm_credits</span>(<span class="st">&quot;Auteurs : Geoffroy et Jessie Chaux.&quot;</span>, </span>
<span id="cb250-31"><a href="sect024.html#cb250-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>), <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">align =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb250-32"><a href="sect024.html#cb250-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Composition avec les deux cartes</span></span>
<span id="cb250-33"><a href="sect024.html#cb250-33" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte1, Carte2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GetisLocaleClassique"></span>
<img src="GMQ405_files/figure-html/GetisLocaleClassique-1.png" alt="Points chauds et froids du revenu médian des ménages selon les statistiques de Getis et Ord (méthode classique)" width="85%" />
<p class="caption">
Figure 2.17: Points chauds et froids du revenu médian des ménages selon les statistiques de Getis et Ord (méthode classique)
</p>
</div>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="sect024.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Enregistrons les résultats dans deux champs de la couche des AD</span></span>
<span id="cb251-2"><a href="sect024.html#cb251-2" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis.MC999 <span class="ot">&lt;-</span> localGetis.MC999</span>
<span id="cb251-3"><a href="sect024.html#cb251-3" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis.StarMC999 <span class="ot">&lt;-</span> localGetis.StarMC999</span>
<span id="cb251-4"><a href="sect024.html#cb251-4" aria-hidden="true" tabindex="-1"></a>coupures <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="fl">3.29</span>, <span class="sc">-</span><span class="fl">2.58</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>, <span class="fl">2.58</span>, <span class="fl">3.29</span>, <span class="cn">Inf</span>)</span>
<span id="cb251-5"><a href="sect024.html#cb251-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Définition des intervalles et des noms des classes</span></span>
<span id="cb251-6"><a href="sect024.html#cb251-6" aria-hidden="true" tabindex="-1"></a>classes.intervalles <span class="ot">=</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="fl">3.29</span>, <span class="sc">-</span><span class="fl">2.58</span>, <span class="sc">-</span><span class="fl">1.96</span>, <span class="fl">1.96</span>, <span class="fl">2.58</span>, <span class="fl">3.29</span>, <span class="cn">Inf</span>)</span>
<span id="cb251-7"><a href="sect024.html#cb251-7" aria-hidden="true" tabindex="-1"></a>classes.noms <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Point froid (p = 0,05)&quot;</span>, </span>
<span id="cb251-8"><a href="sect024.html#cb251-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point froid (p = 0,01)&quot;</span>, </span>
<span id="cb251-9"><a href="sect024.html#cb251-9" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point froid (p = 0,001)&quot;</span>, </span>
<span id="cb251-10"><a href="sect024.html#cb251-10" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Non significatif&quot;</span>,</span>
<span id="cb251-11"><a href="sect024.html#cb251-11" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,05)&quot;</span>, </span>
<span id="cb251-12"><a href="sect024.html#cb251-12" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,01)&quot;</span>, </span>
<span id="cb251-13"><a href="sect024.html#cb251-13" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;Point chaud (p = 0,001)&quot;</span>)</span>
<span id="cb251-14"><a href="sect024.html#cb251-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d&#39;un champ avec les noms des classes</span></span>
<span id="cb251-15"><a href="sect024.html#cb251-15" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis.MC999P <span class="ot">&lt;-</span> <span class="fu">cut</span>(AD.DR<span class="sc">$</span>RevMed_localGetis.MC999, </span>
<span id="cb251-16"><a href="sect024.html#cb251-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">breaks =</span> classes.intervalles, </span>
<span id="cb251-17"><a href="sect024.html#cb251-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels =</span> classes.noms)</span>
<span id="cb251-18"><a href="sect024.html#cb251-18" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_localGetis.StarMC999P <span class="ot">&lt;-</span> <span class="fu">cut</span>(AD.DR<span class="sc">$</span>RevMed_localGetis.StarMC999, </span>
<span id="cb251-19"><a href="sect024.html#cb251-19" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">breaks =</span> classes.intervalles, </span>
<span id="cb251-20"><a href="sect024.html#cb251-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">labels =</span> classes.noms)</span>
<span id="cb251-21"><a href="sect024.html#cb251-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Cartographie pour le Z(Gi) Mont-Carlo</span></span>
<span id="cb251-22"><a href="sect024.html#cb251-22" aria-hidden="true" tabindex="-1"></a>Carte3 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb251-23"><a href="sect024.html#cb251-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_localGetis.MC999&quot;</span>, </span>
<span id="cb251-24"><a href="sect024.html#cb251-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">&quot;Z(Gi)&quot;</span>, <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb251-25"><a href="sect024.html#cb251-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span><span class="cn">FALSE</span>)</span>
<span id="cb251-26"><a href="sect024.html#cb251-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Cartographie pour le Z(Gi)* Mont-Carlo</span></span>
<span id="cb251-27"><a href="sect024.html#cb251-27" aria-hidden="true" tabindex="-1"></a>Carte4 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb251-28"><a href="sect024.html#cb251-28" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_localGetis.StarMC999&quot;</span>,</span>
<span id="cb251-29"><a href="sect024.html#cb251-29" aria-hidden="true" tabindex="-1"></a>                        <span class="at">title=</span><span class="st">&quot;Z(Gi*)&quot;</span>, <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb251-30"><a href="sect024.html#cb251-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span><span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb251-31"><a href="sect024.html#cb251-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">tm_credits</span>(<span class="st">&quot;Auteurs : Geoffroy et Jessie Chaux.&quot;</span>, </span>
<span id="cb251-32"><a href="sect024.html#cb251-32" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>), <span class="at">size =</span> <span class="fl">0.7</span>, <span class="at">align =</span> <span class="st">&quot;right&quot;</span>)</span>
<span id="cb251-33"><a href="sect024.html#cb251-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Composition avec les deux cartes</span></span>
<span id="cb251-34"><a href="sect024.html#cb251-34" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte3, Carte4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:GetisLocaleMC"></span>
<img src="GMQ405_files/figure-html/GetisLocaleMC-1.png" alt="Points chauds et froids du revenu médian des ménages selon les statistiques de Getis et Ord (999 permutations Monte-Carlo)" width="85%" />
<p class="caption">
Figure 2.18: Points chauds et froids du revenu médian des ménages selon les statistiques de Getis et Ord (999 permutations Monte-Carlo)
</p>
</div>
</div>
<div id="sect0242" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Version locale du <em>I</em> de Moran<a href="sect024.html#sect0242" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Une version locale du <em>I</em> de Moran (<span class="math inline">\(I_i\)</span>) a été proposée par Luc Anselin <span class="citation">(<a href="#ref-anselin1995local" role="doc-biblioref">1995</a>)</span>. Elle permet de vérifier si une entité spatiale est voisine ou proche – dépendamment de la matrice spatiale utilisée – d’entités spatiales avec des valeurs semblables (contexte d’autocorrélation spatiale locale positive) ou dissemblables (contexte d’autocorrélation spatiale locale négative). Le <em>I</em> de Moran local s’écrit :</p>
<p><span class="math display" id="eq:LocalIMoran">\[\begin{equation}  
I_i = \frac{(x_i-\bar{X})\Sigma_{j=1}^n w_{ij}(x_j-\bar{X})}
{\frac{1}{n} \Sigma_{i=1}^n(x_i-\bar{X})^2} =  \frac{z_i \Sigma_{j=1}^n z_j}{\frac{1}{n}\Sigma_{i=1}^n z_i^2} \text{, } i \ne j
\tag{2.14}
\end{equation}\]</span>
</p>
<p>avec :</p>
<ul>
<li><span class="math inline">\(z_i\)</span> étant la valeur de la variable continue centrée <span class="math inline">\(X\)</span> pour l’entité spatiale <span class="math inline">\(i\)</span>, c’est-à-dire simplement l’écart de <span class="math inline">\(i\)</span> à la moyenne de <span class="math inline">\(X\)</span> (<span class="math inline">\(x_i - \bar X\)</span>).</li>
<li><span class="math inline">\(z_j\)</span> étant la valeur de la variable centrée de <span class="math inline">\(X\)</span> pour l’entité spatiale <span class="math inline">\(j\)</span>.</li>
<li><span class="math inline">\(w_{ij}\)</span> étant la valeur de la matrice de pondération spatiale standardisée en ligne entre <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>.</li>
<li><span class="math inline">\(n\)</span> étant le nombre d’entités spatiales dans la couche géographique.</li>
</ul>
<p>Comme pour la version globale, il est possible de tester la significativité du <em>I</em> de Moran local de manière classique (selon la loi normale) ou avec l’approche Monte-Carlo (avec habituellement 999 permutations).</p>
<div class="bloc_aller_loin">
<p><strong>Test de significativité du <em>I</em> de Moran local</strong>.</p>
<p>Pour comprendre les différentes variantes pour tester la significativité <span class="citation">(<a href="#ref-anselin1995local" role="doc-biblioref">Anselin 1995</a>; <a href="#ref-sokal1998local" role="doc-biblioref">Sokal, Oden et Thomson 1998</a>)</span>, consultez Bivand et Wong <span class="citation">(<a href="#ref-bivand2018comparing" role="doc-biblioref">2018</a>)</span> ou l’ouvrage de Dubé et Legros <span class="citation">(<a href="#ref-dube2014econometrie" role="doc-biblioref">2014</a>)</span>.</p>
</div>
<p>Le calcul du <em>I</em> de Moran local s’opère avec les fonctions <code>localmoran</code> et <code>localMoranI.mc</code> du <em>package</em> <code>spdep</code> (voir la syntaxe ci-dessous). Comme pour la version globale, les résultats du <em>I</em> de Moran local sont les mêmes pour les deux fonctions, seules les valeurs de <em>p</em> peuvent varier.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="sect024.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul du I de Moran local</span></span>
<span id="cb252-2"><a href="sect024.html#cb252-2" aria-hidden="true" tabindex="-1"></a>localMoranI <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(AD.DR<span class="sc">$</span>RevMedMenage,  <span class="co"># variable</span></span>
<span id="cb252-3"><a href="sect024.html#cb252-3" aria-hidden="true" tabindex="-1"></a>                          W.RookG)             <span class="co"># matrice de pondération spatiale</span></span>
<span id="cb252-4"><a href="sect024.html#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Calcul du I de Moran local avec la méthode Monte-Carlo</span></span>
<span id="cb252-5"><a href="sect024.html#cb252-5" aria-hidden="true" tabindex="-1"></a>localMoranI.mc <span class="ot">&lt;-</span> <span class="fu">localmoran_perm</span>(AD.DR<span class="sc">$</span>RevMedMenage, <span class="co"># variable</span></span>
<span id="cb252-6"><a href="sect024.html#cb252-6" aria-hidden="true" tabindex="-1"></a>                             W.RookG,                 <span class="co"># matrice de pondération spatiale</span></span>
<span id="cb252-7"><a href="sect024.html#cb252-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">nsim =</span> <span class="dv">999</span>)              <span class="co"># nombre de permutations       </span></span>
<span id="cb252-8"><a href="sect024.html#cb252-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Sommaires statistiques</span></span>
<span id="cb252-9"><a href="sect024.html#cb252-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localMoranI)</span></code></pre></div>
<pre><code>##        Ii                E.Ii                Var.Ii               Z.Ii        
##  Min.   :-0.90053   Min.   :-3.054e-02   Min.   :0.0000003   Min.   :-1.9962  
##  1st Qu.: 0.08313   1st Qu.:-5.368e-03   1st Qu.:0.0370546   1st Qu.: 0.4539  
##  Median : 0.49029   Median :-2.755e-03   Median :0.1339044   Median : 1.4404  
##  Mean   : 0.61678   Mean   :-4.032e-03   Mean   :0.2149974   Mean   : 1.2503  
##  3rd Qu.: 0.97602   3rd Qu.:-8.287e-04   3rd Qu.:0.2510284   3rd Qu.: 2.1938  
##  Max.   : 3.37625   Max.   :-8.000e-09   Max.   :1.8207164   Max.   : 3.9184  
##  Pr(z != E(Ii))     
##  Min.   :0.0000892  
##  1st Qu.:0.0282519  
##  Median :0.1268505  
##  Mean   :0.2467939  
##  3rd Qu.:0.3948293  
##  Max.   :0.9833048</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="sect024.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(localMoranI.mc)</span></code></pre></div>
<pre><code>##        Ii                E.Ii               Var.Ii               Z.Ii        
##  Min.   :-0.90053   Min.   :-0.076891   Min.   :0.0000003   Min.   :-1.9980  
##  1st Qu.: 0.08313   1st Qu.:-0.010125   1st Qu.:0.0375051   1st Qu.: 0.4397  
##  Median : 0.49029   Median :-0.001863   Median :0.1354712   Median : 1.4461  
##  Mean   : 0.61678   Mean   :-0.004633   Mean   :0.2192609   Mean   : 1.2376  
##  3rd Qu.: 0.97602   3rd Qu.: 0.002259   3rd Qu.:0.2627092   3rd Qu.: 2.1224  
##  Max.   : 3.37625   Max.   : 0.034491   Max.   :1.7608115   Max.   : 3.9284  
##  Pr(z != E(Ii))      Pr(z != E(Ii)) Sim Pr(folded) Sim      Skewness        
##  Min.   :0.0000855   Min.   :0.0020     Min.   :0.0010   Min.   :-0.384142  
##  1st Qu.:0.0338037   1st Qu.:0.0220     1st Qu.:0.0110   1st Qu.:-0.214501  
##  Median :0.1273394   Median :0.1380     Median :0.0690   Median :-0.096098  
##  Mean   :0.2490675   Mean   :0.2542     Mean   :0.1271   Mean   :-0.005375  
##  3rd Qu.:0.3926740   3rd Qu.:0.4100     3rd Qu.:0.2050   3rd Qu.: 0.216255  
##  Max.   :0.9978887   Max.   :0.9940     Max.   :0.4970   Max.   : 0.414197  
##     Kurtosis       
##  Min.   :-0.52150  
##  1st Qu.:-0.26315  
##  Median :-0.18692  
##  Mean   :-0.17446  
##  3rd Qu.:-0.07932  
##  Max.   : 0.21484</code></pre>
<p>Avec la cartographie du <em>I</em> de Moran local, nous repérons localement l’autocorrélation spatiale positive (valeurs similaires, fortes ou faibles localement) et l’autocorrélation spatiale négative (valeurs dissemblables localement) (figure <a href="sect024.html#fig:Chap02CartoIMoranLocal">2.19</a>).</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="sect024.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Ajout de champs pour le I de Moran local</span></span>
<span id="cb256-2"><a href="sect024.html#cb256-2" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_IlocalMoran.MC999 <span class="ot">&lt;-</span> localMoranI.mc[, <span class="dv">1</span>]</span>
<span id="cb256-3"><a href="sect024.html#cb256-3" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>RevMed_IlocalMoran.MC999p <span class="ot">&lt;-</span> localMoranI.mc[, <span class="dv">5</span>]</span>
<span id="cb256-4"><a href="sect024.html#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Cartographie</span></span>
<span id="cb256-5"><a href="sect024.html#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb256-6"><a href="sect024.html#cb256-6" aria-hidden="true" tabindex="-1"></a>Carte1 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb256-7"><a href="sect024.html#cb256-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_polygons</span>(<span class="at">col =</span><span class="st">&quot;RevMed_IlocalMoran.MC999&quot;</span>, <span class="at">title=</span><span class="st">&quot;I Moran local&quot;</span>, </span>
<span id="cb256-8"><a href="sect024.html#cb256-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">style=</span><span class="st">&quot;cont&quot;</span>, <span class="at">palette=</span><span class="st">&quot;-RdBu&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb256-9"><a href="sect024.html#cb256-9" aria-hidden="true" tabindex="-1"></a>         <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb256-10"><a href="sect024.html#cb256-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-11"><a href="sect024.html#cb256-11" aria-hidden="true" tabindex="-1"></a>Carte2 <span class="ot">=</span> <span class="fu">tm_shape</span>(AD.DR)<span class="sc">+</span></span>
<span id="cb256-12"><a href="sect024.html#cb256-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">tm_polygons</span>(<span class="at">col=</span> <span class="st">&quot;RevMed_IlocalMoran.MC999p&quot;</span>, <span class="at">title=</span><span class="st">&quot;valeur de p&quot;</span>,</span>
<span id="cb256-13"><a href="sect024.html#cb256-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;gray&quot;</span>),  <span class="at">lwd =</span> <span class="dv">1</span>, </span>
<span id="cb256-14"><a href="sect024.html#cb256-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="cn">Inf</span>),</span>
<span id="cb256-15"><a href="sect024.html#cb256-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">title =</span><span class="st">&quot;En %&quot;</span>)<span class="sc">+</span></span>
<span id="cb256-16"><a href="sect024.html#cb256-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb256-17"><a href="sect024.html#cb256-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Combinaison des deux cartes</span></span>
<span id="cb256-18"><a href="sect024.html#cb256-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(Carte1, Carte2, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Chap02CartoIMoranLocal"></span>
<img src="GMQ405_files/figure-html/Chap02CartoIMoranLocal-1.png" alt="Cartographie du *I* de Moran local et de la valeur de p associée" width="85%" />
<p class="caption">
Figure 2.19: Cartographie du <em>I</em> de Moran local et de la valeur de p associée
</p>
</div>
</div>
<div id="sect0243" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Nuage de points du <em>I</em> de Moran d’Anselin<a href="sect024.html#sect0243" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le nuage de points du <em>I</em> de Moran a été proposé par Luc Anselin <span class="citation">(<a href="#ref-anselin1996chapter" role="doc-biblioref">1996</a>)</span>. L’idée est fort simple, mais extrêmement efficace! Avant tout, la variable continue est centrée réduite (cote <span class="math inline">\(z\)</span>, <em>z-score</em> en anglais). Pour un rappel sur la cote <span class="math inline">\(z\)</span>, consultez la <a href="https://laeq.github.io/LivreMethoQuantBolR/sect025.html#sect02552">section suivante</a> <span class="citation">(<a href="#ref-RBoldAir" role="doc-biblioref">Apparicio et Gelb 2022</a>)</span>. La moyenne est ainsi égale à 0 et l’écart-type à 1. Puis, il s’agit de construire un nuage de points entre :</p>
<ol style="list-style-type: decimal">
<li>Les valeurs de la variable centrée réduite (Z) <strong>sur l’axe des X</strong> pour les entités spatiales de la couche géographique.</li>
<li>Les valeurs de la variable centrée réduite spatialement décalée obtenues avec les pondération spatiale de la matrice <span class="math inline">\(W\)</span> (voir l’encadré ci-dessous).</li>
</ol>
<div class="bloc_notes">
<p><strong>Comment calculer une variable spatialement décalée avec une matrice de pondération spatiale?</strong></p>
<p>À la figure <a href="sect024.html#fig:Chap02FigureVariableSpatialementDecalee">2.20</a>, nous détaillons le calcul de la valeur d’une variable spatialement décalée pour l’entité spatiale <strong>A</strong> à partir d’une matrice de contiguïté (selon le partage d’un segment) standardisée en ligne. Notez que <strong>A</strong> a quatre voisins (b, c, d et e).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Chap02FigureVariableSpatialementDecalee"></span>
<img src="images/Chap02/FigureVariableSpatialementDecalee.png" alt="Illustration du calcul d'une variable spatialement décalée" width="65%" />
<p class="caption">
Figure 2.20: Illustration du calcul d’une variable spatialement décalée
</p>
</div>
<p>Dans R, la syntaxe est fort simple pour créer une cote <span class="math inline">\(z\)</span> et une variable spatiale décalée :</p>
<p><code>zx &lt;- (x - mean(x))/sd(x)     # variable X centrée réduite (cote z)</code>
<code>wzx &lt;- lag.listw(listW,zx)    # variable X centrée réduite spatialement décalée</code></p>
</div>
<p>Analysons les différents éléments du nuage de points du <em>I</em> de Moran à la figure <a href="sect024.html#fig:NuagePointsMoran">2.21</a> :</p>
<ul>
<li>La droite régression résume la relation linéaire entre la variable spatialement décalée (<span class="math inline">\(W.ZX\)</span>) et l’originale (<span class="math inline">\(ZX\)</span>). D’ailleurs, le coefficient de régression pour la variable <span class="math inline">\(ZX\)</span>, soit la pente de la droite, équivaut au <em>I</em> de Moran!</li>
<li>Les traits pointillés représentent les moyennes des deux variables, toutes deux égales à 0 puisqu’elles sont centrées-réduites (cote <span class="math inline">\(z\)</span>).</li>
</ul>
<p>Pour analyser ce nuage, nous le décomposons en quatre quadrants :</p>
<ol style="list-style-type: decimal">
<li><p>Le quadrant <strong>HH (<em>High-High</em>)</strong> en haut à droite regroupe des entités spatiales avec des valeurs <strong>fortes</strong> (H) qui sont voisines ou proches d’autres entités spatiales avec aussi des valeurs <strong>fortes</strong> (H). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale positive avec des valeurs fortes (HH)</strong>.</p></li>
<li><p>Le quadrant <strong>LL (<em>Low-Low</em>)</strong> en bas à gauche regroupe des entités spatiales avec des valeurs <strong>faibles</strong> (L) qui sont voisines ou proches d’autres entités spatiales avec aussi des valeurs <strong>faibles</strong> (L). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale positive avec des valeurs faibles (LL)</strong>.</p></li>
<li><p>Le quadrant <strong>HL (<em>High-Low</em>)</strong> en bas à droite regroupe des entités spatiales avec des valeurs <strong>fortes</strong> (H) qui sont voisines ou proches d’autres entités spatiales avec des valeurs <strong>faibles</strong> (L). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale négative (HL)</strong>. Avec humour, un collègue économiste qualifie ce quadrant de <strong>village gaulois</strong> (Obélix, Astérix et leurs compagnons sont très forts et ils sont entourés de voisins romains plus faibles…).</p></li>
<li><p>Le quadrant <strong>LH (<em>Low-High</em>)</strong> en haut à gauche regroupe des entités spatiales avec des valeurs <strong>faibles</strong> (L) qui sont voisines ou proches d’autres entités spatiales avec des valeurs <strong>fortes</strong> (H). Nous sommes donc en présence <strong>d’autocorrélation spatiale locale négative (LH)</strong>.</p></li>
</ol>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:NuagePointsMoran"></span>
<img src="GMQ405_files/figure-html/NuagePointsMoran-1.png" alt="Nuage de points du *I* de Moran d'Anselin" width="85%" />
<p class="caption">
Figure 2.21: Nuage de points du <em>I</em> de Moran d’Anselin
</p>
</div>
<p>Pour créer le nuage de points du <em>I</em> de Moran, nous avons écrit la fonction ci-dessous.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="sect024.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################################</span></span>
<span id="cb257-2"><a href="sect024.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Ne pas modifier les lignes ci-dessous jusqu&#39;au prochain encadré</span></span>
<span id="cb257-3"><a href="sect024.html#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################################</span></span>
<span id="cb257-4"><a href="sect024.html#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; Fonction pour créer le nuage de points de Moran.</span></span>
<span id="cb257-5"><a href="sect024.html#cb257-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param x un vecteur avec la variable continue X.</span></span>
<span id="cb257-6"><a href="sect024.html#cb257-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param listW un objet listw de spdep (matrice de pondération spatiale).</span></span>
<span id="cb257-7"><a href="sect024.html#cb257-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param titre du graphique</span></span>
<span id="cb257-8"><a href="sect024.html#cb257-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param titreAxeX titre de l&#39;axe des X</span></span>
<span id="cb257-9"><a href="sect024.html#cb257-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param titreAxeY titre de l&#39;axe des X</span></span>
<span id="cb257-10"><a href="sect024.html#cb257-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @param AfficheAide indique l&#39;affichage de l&#39;aide de lecture dans le graphique</span></span>
<span id="cb257-11"><a href="sect024.html#cb257-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&#39; @return un objet ggplot2.</span></span>
<span id="cb257-12"><a href="sect024.html#cb257-12" aria-hidden="true" tabindex="-1"></a>NuageMoran <span class="ot">&lt;-</span> <span class="cf">function</span>(x,listW,</span>
<span id="cb257-13"><a href="sect024.html#cb257-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">titre=</span><span class="st">&quot;Nuage de points du I de Moran&quot;</span>,</span>
<span id="cb257-14"><a href="sect024.html#cb257-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">titreAxeX =</span> <span class="st">&quot;X&quot;</span>,</span>
<span id="cb257-15"><a href="sect024.html#cb257-15" aria-hidden="true" tabindex="-1"></a>                       <span class="at">titreAxeY =</span> <span class="st">&quot;Variable spatialement décalée&quot;</span>,</span>
<span id="cb257-16"><a href="sect024.html#cb257-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">AfficheAide=</span><span class="cn">FALSE</span>)</span>
<span id="cb257-17"><a href="sect024.html#cb257-17" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb257-18"><a href="sect024.html#cb257-18" aria-hidden="true" tabindex="-1"></a>  zx <span class="ot">&lt;-</span> (x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">/</span><span class="fu">sd</span>(x)     <span class="co"># variable X centrée réduite (cote z)</span></span>
<span id="cb257-19"><a href="sect024.html#cb257-19" aria-hidden="true" tabindex="-1"></a>  wzx <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(listW,zx)    <span class="co"># variable X centrée réduite spatialement décalée</span></span>
<span id="cb257-20"><a href="sect024.html#cb257-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb257-21"><a href="sect024.html#cb257-21" aria-hidden="true" tabindex="-1"></a>  typo <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> wzx<span class="sc">&gt;</span><span class="dv">0</span>, <span class="st">&quot;HH&quot;</span>, <span class="st">&quot;ND&quot;</span>)</span>
<span id="cb257-22"><a href="sect024.html#cb257-22" aria-hidden="true" tabindex="-1"></a>  typo <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> wzx<span class="sc">&lt;</span><span class="dv">0</span>, <span class="st">&quot;LL&quot;</span>, typo)</span>
<span id="cb257-23"><a href="sect024.html#cb257-23" aria-hidden="true" tabindex="-1"></a>  typo <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> wzx<span class="sc">&lt;</span><span class="dv">0</span>, <span class="st">&quot;HL&quot;</span>, typo)</span>
<span id="cb257-24"><a href="sect024.html#cb257-24" aria-hidden="true" tabindex="-1"></a>  typo <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> wzx<span class="sc">&gt;</span><span class="dv">0</span>, <span class="st">&quot;LH&quot;</span>, typo)</span>
<span id="cb257-25"><a href="sect024.html#cb257-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb257-26"><a href="sect024.html#cb257-26" aria-hidden="true" tabindex="-1"></a>  couleurs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HH&quot;</span> <span class="ot">=</span> <span class="st">&quot;darkred&quot;</span>, </span>
<span id="cb257-27"><a href="sect024.html#cb257-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;LL&quot;</span> <span class="ot">=</span> <span class="st">&quot;darkblue&quot;</span>, </span>
<span id="cb257-28"><a href="sect024.html#cb257-28" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;HL&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb257-29"><a href="sect024.html#cb257-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;LH&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb257-30"><a href="sect024.html#cb257-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb257-31"><a href="sect024.html#cb257-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (AfficheAide){</span>
<span id="cb257-32"><a href="sect024.html#cb257-32" aria-hidden="true" tabindex="-1"></a>    notetxt <span class="ot">=</span> <span class="st">&quot;Autocorrélation positive</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb257-33"><a href="sect024.html#cb257-33" aria-hidden="true" tabindex="-1"></a>    notetxt <span class="ot">=</span> <span class="fu">paste</span>(notetxt, <span class="st">&quot;HH : valeur forte dans un contexte de valeurs fortes</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb257-34"><a href="sect024.html#cb257-34" aria-hidden="true" tabindex="-1"></a>    notetxt <span class="ot">=</span> <span class="fu">paste</span>(notetxt, <span class="st">&quot;LL : valeur faible dans un contexte de valeurs faibles</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb257-35"><a href="sect024.html#cb257-35" aria-hidden="true" tabindex="-1"></a>    notetxt <span class="ot">=</span> <span class="fu">paste</span>(notetxt, <span class="st">&quot;Autocorrélation négative</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb257-36"><a href="sect024.html#cb257-36" aria-hidden="true" tabindex="-1"></a>    notetxt <span class="ot">=</span> <span class="fu">paste</span>(notetxt, <span class="st">&quot;HL : valeur forte dans un contexte de valeurs faibles </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb257-37"><a href="sect024.html#cb257-37" aria-hidden="true" tabindex="-1"></a>    notetxt <span class="ot">=</span> <span class="fu">paste</span>(notetxt, <span class="st">&quot;LH : valeur faible dans un contexte de valeurs fortes&quot;</span>)</span>
<span id="cb257-38"><a href="sect024.html#cb257-38" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb257-39"><a href="sect024.html#cb257-39" aria-hidden="true" tabindex="-1"></a>    notetxt<span class="ot">&lt;-</span><span class="st">&quot;&quot;</span></span>
<span id="cb257-40"><a href="sect024.html#cb257-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb257-41"><a href="sect024.html#cb257-41" aria-hidden="true" tabindex="-1"></a>  morlm <span class="ot">&lt;-</span> <span class="fu">lm</span>(wzx <span class="sc">~</span> zx)</span>
<span id="cb257-42"><a href="sect024.html#cb257-42" aria-hidden="true" tabindex="-1"></a>  imoran <span class="ot">&lt;-</span> morlm<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb257-43"><a href="sect024.html#cb257-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">pty=</span><span class="st">&quot;s&quot;</span>)</span>
<span id="cb257-44"><a href="sect024.html#cb257-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb257-45"><a href="sect024.html#cb257-45" aria-hidden="true" tabindex="-1"></a>  Graphique <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>zx, <span class="at">y=</span>wzx, <span class="at">colour=</span>typo)) <span class="sc">+</span></span>
<span id="cb257-46"><a href="sect024.html#cb257-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb257-47"><a href="sect024.html#cb257-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> couleurs)<span class="sc">+</span></span>
<span id="cb257-48"><a href="sect024.html#cb257-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb257-49"><a href="sect024.html#cb257-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&quot;Typologie&quot;</span>,</span>
<span id="cb257-50"><a href="sect024.html#cb257-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> titre, </span>
<span id="cb257-51"><a href="sect024.html#cb257-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">&quot;I de Moran = &quot;</span>, <span class="fu">format</span>(<span class="fu">round</span>(imoran,<span class="dv">4</span>))),</span>
<span id="cb257-52"><a href="sect024.html#cb257-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> notetxt) <span class="sc">+</span></span>
<span id="cb257-53"><a href="sect024.html#cb257-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb257-54"><a href="sect024.html#cb257-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="at">size=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb257-55"><a href="sect024.html#cb257-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">colour=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb257-56"><a href="sect024.html#cb257-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(titreAxeX) <span class="sc">+</span></span>
<span id="cb257-57"><a href="sect024.html#cb257-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(titreAxeY)</span>
<span id="cb257-58"><a href="sect024.html#cb257-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Graphique)</span>
<span id="cb257-59"><a href="sect024.html#cb257-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb257-60"><a href="sect024.html#cb257-60" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################################</span></span>
<span id="cb257-61"><a href="sect024.html#cb257-61" aria-hidden="true" tabindex="-1"></a><span class="do">## Appel de la fonction, modifier les lignes ci-dessous au besoin</span></span>
<span id="cb257-62"><a href="sect024.html#cb257-62" aria-hidden="true" tabindex="-1"></a><span class="do">## pour changer la variable ou la matrice de pondération spatiale</span></span>
<span id="cb257-63"><a href="sect024.html#cb257-63" aria-hidden="true" tabindex="-1"></a><span class="do">##################################################################</span></span>
<span id="cb257-64"><a href="sect024.html#cb257-64" aria-hidden="true" tabindex="-1"></a><span class="do">## Réalisation du nuage de Moran avec la fonction NuageMoran</span></span>
<span id="cb257-65"><a href="sect024.html#cb257-65" aria-hidden="true" tabindex="-1"></a><span class="fu">NuageMoran</span>(<span class="at">x =</span> AD.DR<span class="sc">$</span>RevMedMenage,</span>
<span id="cb257-66"><a href="sect024.html#cb257-66" aria-hidden="true" tabindex="-1"></a>           <span class="at">listW =</span> W.Rook,</span>
<span id="cb257-67"><a href="sect024.html#cb257-67" aria-hidden="true" tabindex="-1"></a>           <span class="at">titre =</span> <span class="st">&quot;Nuage de points du I de Moran (matrice de contiguïté selon le partage d&#39;un segment)&quot;</span>,</span>
<span id="cb257-68"><a href="sect024.html#cb257-68" aria-hidden="true" tabindex="-1"></a>           <span class="at">titreAxeX =</span> <span class="st">&quot;ZX : Revenu médian des ménages centré réduit&quot;</span>,</span>
<span id="cb257-69"><a href="sect024.html#cb257-69" aria-hidden="true" tabindex="-1"></a>           <span class="at">titreAxeY =</span> <span class="st">&quot;WZ : Variable ZX spatialement décalée&quot;</span>,</span>
<span id="cb257-70"><a href="sect024.html#cb257-70" aria-hidden="true" tabindex="-1"></a>           <span class="at">AfficheAide=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Reste à déterminer si l’autocorrélation spatiale locale pour ces quatre quadrants est significative. Rien de plus simple, il suffit d’utiliser la valeur de <em>p</em> du <em>I</em> de Moran (section <a href="sect024.html#sect0242">2.4.2</a>). Nous choisissons un seuil de signification (habituellement <em>p</em> = 0,05) et obtenons ainsi la typologie comprenant cinq catégories :</p>
<ul>
<li>Autocorrélation spatiale locale positive et significative (<em>p</em> &lt; 0,05).
<ol style="list-style-type: decimal">
<li>HH</li>
<li>LL</li>
</ol></li>
<li>Autocorrélation spatiale locale négative et significative (<em>p</em> &lt; 0,05).
<ol start="3" style="list-style-type: decimal">
<li>HL</li>
<li>LH</li>
</ol></li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Autocorrélation spatiale locale non significative (<em>p</em> &gt; 0,05).</li>
</ol>
<p>Le code R ci-dessous permet d’obtenir la typologie de l’autocorrélation spatiale avec le <em>I</em> de Moran local pour le revenu médian des ménages avec une matrice de contiguïté selon le partage d’un segment (<em>Rook</em>). La figure <a href="sect024.html#fig:TypoIMoran">2.22</a> dénote surtout une autocorrélation spatiale positive importante (respectivement 25 et 47 aires de diffusion classées <em>HH</em> et <em>LL</em>), comparativement à l’autocorrélation spatiale négative qui ne comprend qu’une aire de diffusion (LH).</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="sect024.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Cote Z (variable centrée réduite)</span></span>
<span id="cb258-2"><a href="sect024.html#cb258-2" aria-hidden="true" tabindex="-1"></a>zx <span class="ot">&lt;-</span> (AD.DR<span class="sc">$</span>RevMedMenage <span class="sc">-</span> <span class="fu">mean</span>(AD.DR<span class="sc">$</span>RevMedMenage))<span class="sc">/</span><span class="fu">sd</span>(AD.DR<span class="sc">$</span>RevMedMenage)</span>
<span id="cb258-3"><a href="sect024.html#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="do">## variable X centrée réduite spatialement décalée avec une matrice Rook</span></span>
<span id="cb258-4"><a href="sect024.html#cb258-4" aria-hidden="true" tabindex="-1"></a>wzx <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(W.Rook, zx)    </span>
<span id="cb258-5"><a href="sect024.html#cb258-5" aria-hidden="true" tabindex="-1"></a><span class="do">## I de Moran local (notez que vous pouvez aussi utiliser la fonction localmoran_perm)</span></span>
<span id="cb258-6"><a href="sect024.html#cb258-6" aria-hidden="true" tabindex="-1"></a>localMoranI   <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(AD.DR<span class="sc">$</span>RevMedMenage, W.Rook)</span>
<span id="cb258-7"><a href="sect024.html#cb258-7" aria-hidden="true" tabindex="-1"></a><span class="co">#localMoranI.mc   &lt;- localmoran_perm(AD.DR$RevMedMenage, W.Rook, n=999)</span></span>
<span id="cb258-8"><a href="sect024.html#cb258-8" aria-hidden="true" tabindex="-1"></a>plocalMoranI  <span class="ot">&lt;-</span> localMoranI[, <span class="dv">5</span>]</span>
<span id="cb258-9"><a href="sect024.html#cb258-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Choix d&#39;un seuil de signification</span></span>
<span id="cb258-10"><a href="sect024.html#cb258-10" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb258-11"><a href="sect024.html#cb258-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Construction de la typologie</span></span>
<span id="cb258-12"><a href="sect024.html#cb258-12" aria-hidden="true" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wzx <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;1. HH&quot;</span>, <span class="cn">NA</span>)</span>
<span id="cb258-13"><a href="sect024.html#cb258-13" aria-hidden="true" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wzx <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;2. LL&quot;</span>, Typologie)</span>
<span id="cb258-14"><a href="sect024.html#cb258-14" aria-hidden="true" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wzx <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">&quot;3. HL&quot;</span>, Typologie)</span>
<span id="cb258-15"><a href="sect024.html#cb258-15" aria-hidden="true" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(zx <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> wzx <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">&quot;4. LH&quot;</span>, Typologie)</span>
<span id="cb258-16"><a href="sect024.html#cb258-16" aria-hidden="true" tabindex="-1"></a>Typologie <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(plocalMoranI <span class="sc">&gt;</span> signif, <span class="st">&quot;Non sign&quot;</span>, Typologie)  <span class="co"># Non significatif</span></span>
<span id="cb258-17"><a href="sect024.html#cb258-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Enregistrement de la typologie dans un champ</span></span>
<span id="cb258-18"><a href="sect024.html#cb258-18" aria-hidden="true" tabindex="-1"></a>AD.DR<span class="sc">$</span>TypoIMoran.RevMedian <span class="ot">&lt;-</span> Typologie</span>
<span id="cb258-19"><a href="sect024.html#cb258-19" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(AD.DR<span class="sc">$</span>TypoIMoran.RevMedian, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>## 
##    1. HH    2. LL    4. LH Non sign     &lt;NA&gt; 
##       33       48        1      167        0</code></pre>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="sect024.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Couleurs</span></span>
<span id="cb260-2"><a href="sect024.html#cb260-2" aria-hidden="true" tabindex="-1"></a>Couleurs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;lightpink&quot;</span>, <span class="st">&quot;skyblue2&quot;</span>, <span class="st">&quot;lightgray&quot;</span>)</span>
<span id="cb260-3"><a href="sect024.html#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Couleurs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1. HH&quot;</span>,<span class="st">&quot;2. LL&quot;</span>,<span class="st">&quot;3. HL&quot;</span>,<span class="st">&quot;4. LH&quot;</span>,<span class="st">&quot;Non sign&quot;</span>)</span>
<span id="cb260-4"><a href="sect024.html#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Cartographie</span></span>
<span id="cb260-5"><a href="sect024.html#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">&quot;plot&quot;</span>)</span>
<span id="cb260-6"><a href="sect024.html#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(AD.DR) <span class="sc">+</span> </span>
<span id="cb260-7"><a href="sect024.html#cb260-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">&quot;TypoIMoran.RevMedian&quot;</span>, </span>
<span id="cb260-8"><a href="sect024.html#cb260-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">palette =</span> Couleurs, </span>
<span id="cb260-9"><a href="sect024.html#cb260-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">title =</span><span class="st">&quot;Autocorrélation spatiale locale&quot;</span>)<span class="sc">+</span></span>
<span id="cb260-10"><a href="sect024.html#cb260-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">tm_layout</span>(<span class="at">frame =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:TypoIMoran"></span>
<img src="GMQ405_files/figure-html/TypoIMoran-1.png" alt="Typologie de l'autocorrélation spatiale locale avec le *I* de Moran local" width="85%" />
<p class="caption">
Figure 2.22: Typologie de l’autocorrélation spatiale locale avec le <em>I</em> de Moran local
</p>
</div>
<div class="bloc_attention">
<p><strong>Ne pas confondre les statistiques locales de Getis et Ord et la typologie avec le <em>I</em> de Moran local</strong>.</p>
<p>Succinctement, ces deux familles de mesures renvoient deux typologies différentes :</p>
<ul>
<li>Le <em>I</em> de Moran local comprend cinq classes : HH, LL, HL, LH et non significatif.</li>
<li>Les statistiques locales de Getis et Ord comprennent trois classes : points chauds (sensiblement l’équivalent de HH), points froids (sensiblement l’équivalent de LL) et non significatifs.</li>
</ul>
</div>
</div>
</div>
<h3>Références</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-anselin1995local" class="csl-entry">
Anselin, Luc. 1995. <span>« Local indicators of spatial association—LISA. »</span> <em>Geographical analysis</em> 27 (2): 93‑115. <a href="https://doi.org/10.1111/j.1538-4632.1995.tb00338.x">https://doi.org/10.1111/j.1538-4632.1995.tb00338.x</a>.
</div>
<div id="ref-anselin1996chapter" class="csl-entry">
———. 1996. <span>« The Moran scatterplot as an ESDA tool to Assess Local Instability in Spatial Association. »</span> In <em>Spatial Analytical Perspectives on GIS</em>, sous la dir. de Manfred M Fischer, 121‑137. Taylor &amp; Francis Group. <a href="https://doi.org/10.1201/9780203739051">https://doi.org/10.1201/9780203739051</a>.
</div>
<div id="ref-RBoldAir" class="csl-entry">
Apparicio, Philippe et Jérémy Gelb. 2022. <em>Méthodes quantitatives en sciences sociales : un grand bol d’R</em>. FabriqueREL, Licence CC BY-SA. <a href="https://laeq.github.io/LivreMethoQuantBolR/">https://laeq.github.io/LivreMethoQuantBolR/</a>.
</div>
<div id="ref-bivand2018comparing" class="csl-entry">
Bivand, Roger et David WS Wong. 2018. <span>« Comparing implementations of global and local indicators of spatial association. »</span> <em>Test</em> 27 (3): 716‑748. <a href="https://doi.org/10.1007/s11749-018-0599-x">https://doi.org/10.1007/s11749-018-0599-x</a>.
</div>
<div id="ref-dube2014econometrie" class="csl-entry">
Dubé, Jean et Diègo Legros. 2014. <em>Econom<span>é</span>trie spatiale appliqu<span>é</span>e des microdonn<span>é</span>es</em>. ISTE Group.
</div>
<div id="ref-getis1992analysis" class="csl-entry">
Getis, Arthur et J Keith Ord. 1992. <span>« The analysis of spatial association by use of distance statistics. »</span> <em>Geographical analysis</em> 24 (3): 189‑206. <a href="https://doi.org/10.1111/j.1538-4632.1992.tb00261.x">https://doi.org/10.1111/j.1538-4632.1992.tb00261.x</a>.
</div>
<div id="ref-ord1995local" class="csl-entry">
Ord, J Keith et Arthur Getis. 1995. <span>« Local spatial autocorrelation statistics: distributional issues and an application. »</span> <em>Geographical analysis</em> 27 (4): 286‑306. <a href="https://doi.org/10.1111/j.1538-4632.1995.tb00912.x">https://doi.org/10.1111/j.1538-4632.1995.tb00912.x</a>.
</div>
<div id="ref-sokal1998local" class="csl-entry">
Sokal, Robert R, Neal L Oden et Barbara A Thomson. 1998. <span>« Local spatial autocorrelation in a biological model. »</span> <em>Geographical Analysis</em> 30 (4): 331‑354. <a href="https://doi.org/10.1111/j.1538-4632.1998.tb00406.x">https://doi.org/10.1111/j.1538-4632.1998.tb00406.x</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect023.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect025.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["GMQ405.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
