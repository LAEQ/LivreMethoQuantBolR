<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 Autocorrélation spatiale globale | Notes de cours GMQ405 : Modélisation et analyse spatiale</title>
  <meta name="description" content="Mettre le description du cours." />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 Autocorrélation spatiale globale | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Mettre le description du cours." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 Autocorrélation spatiale globale | Notes de cours GMQ405 : Modélisation et analyse spatiale" />
  
  <meta name="twitter:description" content="Mettre le description du cours." />
  <meta name="twitter:image" content="/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio, département de géomatique appliquée, Université de Sherbrooke" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect022.html"/>
<link rel="next" href="sect024.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.2/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.2/leaflet-providers-plugin.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">GMQ405 : modélisation et analyse spatiale</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Comment lire ce manuel?</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en géomatique appliquée et utiliser R?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
</ul></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Manipulation des données spatiales dans R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Importation de données géographiques</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="sect011.html"><a href="sect011.html#sect0111"><i class="fa fa-check"></i><b>1.1.1</b> Importation de données vectorielles</a></li>
<li class="chapter" data-level="1.1.2" data-path="sect011.html"><a href="sect011.html#sect0112"><i class="fa fa-check"></i><b>1.1.2</b> Importation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Manipulation de données vectorielles</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Fonctions relatives à la projection cartographique</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Fonctions d’opérations géométriques sur une couche</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect01213"><i class="fa fa-check"></i><b>1.2.3</b> Fonctions d’opérations géométriques entre deux couches</a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#sect0124"><i class="fa fa-check"></i><b>1.2.4</b> Fonctions de mesures géométriques et de récupération des coordonnées géographiques</a></li>
<li class="chapter" data-level="1.2.5" data-path="sect012.html"><a href="sect012.html#sect0125"><i class="fa fa-check"></i><b>1.2.5</b> Jointures spatiales</a></li>
<li class="chapter" data-level="1.2.6" data-path="sect012.html"><a href="sect012.html#sect0126"><i class="fa fa-check"></i><b>1.2.6</b> Requêtes spatiales</a></li>
<li class="chapter" data-level="1.2.7" data-path="sect012.html"><a href="sect012.html#sect0127"><i class="fa fa-check"></i><b>1.2.7</b> Manipulation des données attributaires</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Manipulation de données <em>raster</em></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> Mosaïquage et découpage d’images</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Requêtes attributaires sur des images</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Exportation de données spatiales de R vers des formats géographiques</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Exportation de données vectorielles <code>sf</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Exportation de données <em>raster</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect015.html"><a href="sect015.html"><i class="fa fa-check"></i><b>1.5</b> Cartographie avec R</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="sect015.html"><a href="sect015.html#sect0151"><i class="fa fa-check"></i><b>1.5.1</b> Manipulation des couches géométriques</a></li>
<li class="chapter" data-level="1.5.2" data-path="sect015.html"><a href="sect015.html#sect0152"><i class="fa fa-check"></i><b>1.5.2</b> Cartes interactives</a></li>
<li class="chapter" data-level="1.5.3" data-path="sect015.html"><a href="sect015.html#sect0153"><i class="fa fa-check"></i><b>1.5.3</b> Mise en page d’une carte</a></li>
<li class="chapter" data-level="1.5.4" data-path="sect015.html"><a href="sect015.html#sect0154"><i class="fa fa-check"></i><b>1.5.4</b> Exportation d’une carte</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.6</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="1.7" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.7</b> Exercices de révision</a></li>
</ul></li>
<li class="part"><span><b>II Autocorrélation spatiale</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Autocorrélation spatiale</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion d’autocorrélation spatiale</a></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Matrices de pondération spatiale</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Matrices de contiguïté</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Matrices de proximité spatiale</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Standardisation des matrices de pondération spatiale en ligne</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Construction de matrices de pondération spatiale dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Autocorrélation spatiale globale</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Statistique du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Autocorrélation spatiale locale</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#sect0241"><i class="fa fa-check"></i><b>2.4.1</b> Statistiques locales de Getis et Ord : repérer les points chauds et froids</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#sect0242"><i class="fa fa-check"></i><b>2.4.2</b> Version locale du <em>I</em> de Moran</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#sect0243"><i class="fa fa-check"></i><b>2.4.3</b> Nuage de points du <em>I</em> de Moran d’Anselin</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Méthodes de répartition ponctuelle</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Fréquence et densité des points dans l’espace d’étude</a></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Analyse centrographique</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0311"><i class="fa fa-check"></i><b>3.2.1</b> Paramètres de tendance centrale d’un semis de points</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0312"><i class="fa fa-check"></i><b>3.2.2</b> Paramètres de dispersion d’un semis de points</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0313"><i class="fa fa-check"></i><b>3.2.3</b> Mise en œuvre de l’analyse centrographique dans R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Forme d’un semis de points</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Méthode du plus proche voisin</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Méthode des quadrats</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Identification des agrégats spatiaux</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="sect034.html"><a href="sect034.html#sect0341"><i class="fa fa-check"></i><b>3.4.1</b> Cartographie de la densité dans une maille irrégulière</a></li>
<li class="chapter" data-level="3.4.2" data-path="sect034.html"><a href="sect034.html#sect0342"><i class="fa fa-check"></i><b>3.4.2</b> Cartographie de la densité dans une maille régulière</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Méthodes de détection d’agrégats spatiaux et spatio-temporels</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Agrégats d’entités spatiales ponctuelles</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="sect041.html"><a href="sect041.html#sect0411"><i class="fa fa-check"></i><b>4.1.1</b> DBSCAN : agrégats spatiaux</a></li>
<li class="chapter" data-level="4.1.2" data-path="sect041.html"><a href="sect041.html#sect0412"><i class="fa fa-check"></i><b>4.1.2</b> ST-DBSCAN : agrégats spatio-temporels</a></li>
<li class="chapter" data-level="4.1.3" data-path="sect041.html"><a href="sect041.html#sect0414"><i class="fa fa-check"></i><b>4.1.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Méthodes de balayage de Kulldorff</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Objectifs de la méthode, types d’analyses, de modèles et d’agrégats</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Principes de base de la méthode</a></li>
<li class="chapter" data-level="4.2.3" data-path="sect042.html"><a href="sect042.html#sect043"><i class="fa fa-check"></i><b>4.2.3</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="4.4" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Mesures d’accessibilité spatiale selon les différents de modes de transport</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Notions relatives à l’analyse de réseau</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="sect051.html"><a href="sect051.html#sect0511"><i class="fa fa-check"></i><b>5.1.1</b> Définition d’un réseau</a></li>
<li class="chapter" data-level="5.1.2" data-path="sect051.html"><a href="sect051.html#sect0512"><i class="fa fa-check"></i><b>5.1.2</b> Principaux problèmes résolus en analyse de réseau</a></li>
<li class="chapter" data-level="5.1.3" data-path="sect051.html"><a href="sect051.html#sect0513"><i class="fa fa-check"></i><b>5.1.3</b> Analyse de réseau et entités polygonales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Construction d’un réseau avec R5R</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="sect052.html"><a href="sect052.html#sect0521"><i class="fa fa-check"></i><b>5.2.1</b> Extraction des données spatiales pour R5R</a></li>
<li class="chapter" data-level="5.2.2" data-path="sect052.html"><a href="sect052.html#sect0522"><i class="fa fa-check"></i><b>5.2.2</b> Construction du réseau avec R5R</a></li>
<li class="chapter" data-level="5.2.3" data-path="sect052.html"><a href="sect052.html#sect0523"><i class="fa fa-check"></i><b>5.2.3</b> Calcul d’itinéraires avec R5R selon le mode de transport</a></li>
<li class="chapter" data-level="5.2.4" data-path="sect052.html"><a href="sect052.html#sect0524"><i class="fa fa-check"></i><b>5.2.4</b> Calcul de matrices OD selon différents modes de transport</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mesures d’accessibilité</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="sect053.html"><a href="sect053.html#sect0531"><i class="fa fa-check"></i><b>5.3.1</b> Notion d’accessibilité</a></li>
<li class="chapter" data-level="5.3.2" data-path="sect053.html"><a href="sect053.html#sect0532"><i class="fa fa-check"></i><b>5.3.2</b> Accessibilité spatiale potentielle</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Mesures d’accessibilité spatiale potentielle dans R</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="sect054.html"><a href="sect054.html#sect0541"><i class="fa fa-check"></i><b>5.4.1</b> Accessibilité spatiale potentielle aux supermarchés</a></li>
<li class="chapter" data-level="5.4.2" data-path="sect054.html"><a href="sect054.html#sect0542"><i class="fa fa-check"></i><b>5.4.2</b> Accessibilité spatiale potentielle aux patinoires extérieures</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Introduction aux modèles de régression spatiale</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Modèles spatiaux autorégressifs</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Les différents modèles</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Quel modèle choisir?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Autres approches de modélisation</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Modèles généralisées additifs (GAM) avec une <em>spline</em> bivariée sur les coordonnées géographiques</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> GAM avec <em>random markov field</em></a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Modèle SEVM (<em>Spatial eigenvector mapping</em>)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Modèles géographiquement pondérées</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="sect063.html"><a href="sect063.html#sect0631"><i class="fa fa-check"></i><b>6.3.1</b> Modèles GWR classique</a></li>
<li class="chapter" data-level="6.3.2" data-path="sect063.html"><a href="sect063.html#sect0632"><i class="fa fa-check"></i><b>6.3.2</b> Modèles GWR mixte</a></li>
<li class="chapter" data-level="6.3.3" data-path="sect063.html"><a href="sect063.html#sect0633"><i class="fa fa-check"></i><b>6.3.3</b> Modèle MGWR</a></li>
<li class="chapter" data-level="6.3.4" data-path="sect063.html"><a href="sect063.html#sect0634"><i class="fa fa-check"></i><b>6.3.4</b> Modèles MGWR avec autocorrélation spatiale (MGWRSAR)</a></li>
<li class="chapter" data-level="6.3.5" data-path="sect063.html"><a href="sect063.html#sect0635"><i class="fa fa-check"></i><b>6.3.5</b> Extension des modèles GWR pour des variables binaires et de comptages</a></li>
<li class="chapter" data-level="6.3.6" data-path="sect063.html"><a href="sect063.html#sect0636"><i class="fa fa-check"></i><b>6.3.6</b> Autres extensions de la GWR : un aperçu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Introduction aux méthodes de classification spatiale</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Bref retour sur les méthodes de classification non-supervisées</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="sect071.html"><a href="sect071.html#sect0711"><i class="fa fa-check"></i><b>7.1.1</b> Classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="7.1.2" data-path="sect071.html"><a href="sect071.html#sect0712"><i class="fa fa-check"></i><b>7.1.2</b> <em>K-means</em></a></li>
<li class="chapter" data-level="7.1.3" data-path="sect071.html"><a href="sect071.html#sect0713"><i class="fa fa-check"></i><b>7.1.3</b> <em>Fuzzy c-means</em></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Méthodes de classification par agrégation intégrant une constrainte spatiale</a></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Classifications spatiales</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Classification ascendante hiérarchique spatiale (<em>ClustGeo</em>)</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> <em>Spatial fuzzy c-means</em> (SFCM)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Méthodes d’interpolation spatiale</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Méthodes déterministes</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Interpolation polynomiale locale</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Interpolation de l’inverse à la distance - <em>IDW</em></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Méthodes géostatistiques</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Krigeage simple</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Krigeage universel</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Co-krigeage</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Krigeage résiduel</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect083.html"><a href="sect083.html"><i class="fa fa-check"></i><b>8.3</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="8.4" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.4</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Analyse spatiale par l’analyse d’images</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Fonctions mathématiques, booléennes, relationnelles et conditionnelles sur les images</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Fonctions mathématiques</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Fonctions booléennes</a></li>
<li class="chapter" data-level="9.1.3" data-path="sect091.html"><a href="sect091.html#sect0913"><i class="fa fa-check"></i><b>9.1.3</b> Fonctions relationnelles</a></li>
<li class="chapter" data-level="9.1.4" data-path="sect091.html"><a href="sect091.html#sect0914"><i class="fa fa-check"></i><b>9.1.4</b> Fonctions conditionnelles</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Fonctions locales, focales, zonales et globales sur les images</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> Fonctions locales</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0922"><i class="fa fa-check"></i><b>9.2.2</b> Fonctions focales</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.3</b> Fonctions zonales</a></li>
<li class="chapter" data-level="9.2.4" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.4</b> Fonctions globales</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Fonctions de surface</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Élevation</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Pente</a></li>
<li class="chapter" data-level="9.3.3" data-path="sect093.html"><a href="sect093.html#sect0933"><i class="fa fa-check"></i><b>9.3.3</b> Ombrage</a></li>
<li class="chapter" data-level="9.3.4" data-path="sect093.html"><a href="sect093.html#sect0934"><i class="fa fa-check"></i><b>9.3.4</b> Visibilité</a></li>
<li class="chapter" data-level="9.3.5" data-path="sect093.html"><a href="sect093.html#sect0935"><i class="fa fa-check"></i><b>9.3.5</b> Sky-view factor Index</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Données spatiotemporelles en mode image</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#fichier-netcdf"><i class="fa fa-check"></i><b>9.4.1</b> Fichier <em>netCDF</em></a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#exemples-applicatifs"><i class="fa fa-check"></i><b>9.4.2</b> Exemples applicatifs</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Quiz de révision du chapitre</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Exercices de révision</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Correction des exercices</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect1001.html"><a href="sect1001.html"><i class="fa fa-check"></i><b>10.1</b> Exercices du chapitre 1</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect1001.html"><a href="sect1001.html#sect10011"><i class="fa fa-check"></i><b>10.1.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect1001.html"><a href="sect1001.html#sect10012"><i class="fa fa-check"></i><b>10.1.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.1.3" data-path="sect1001.html"><a href="sect1001.html#sect10013"><i class="fa fa-check"></i><b>10.1.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.1.4" data-path="sect1001.html"><a href="sect1001.html#sect10014"><i class="fa fa-check"></i><b>10.1.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect1002.html"><a href="sect1002.html"><i class="fa fa-check"></i><b>10.2</b> Exercices du chapitre 2</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect1002.html"><a href="sect1002.html#sect10021"><i class="fa fa-check"></i><b>10.2.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect1002.html"><a href="sect1002.html#sect10022"><i class="fa fa-check"></i><b>10.2.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.2.3" data-path="sect1002.html"><a href="sect1002.html#sect10023"><i class="fa fa-check"></i><b>10.2.3</b> Exercice 3</a></li>
<li class="chapter" data-level="10.2.4" data-path="sect1002.html"><a href="sect1002.html#sect10024"><i class="fa fa-check"></i><b>10.2.4</b> Exercice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect1003.html"><a href="sect1003.html"><i class="fa fa-check"></i><b>10.3</b> Exercices du chapitre 3</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="sect1003.html"><a href="sect1003.html#sect10031"><i class="fa fa-check"></i><b>10.3.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="sect1003.html"><a href="sect1003.html#sect10032"><i class="fa fa-check"></i><b>10.3.2</b> Exercice 2</a></li>
<li class="chapter" data-level="10.3.3" data-path="sect1003.html"><a href="sect1003.html#sect10033"><i class="fa fa-check"></i><b>10.3.3</b> Exercice 3</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="sect1004.html"><a href="sect1004.html"><i class="fa fa-check"></i><b>10.4</b> Exercices du chapitre 4</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect1004.html"><a href="sect1004.html#sect10041"><i class="fa fa-check"></i><b>10.4.1</b> Exercice 1</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect1004.html"><a href="sect1004.html#sect10042"><i class="fa fa-check"></i><b>10.4.2</b> Exercice 2</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect1005.html"><a href="sect1005.html"><i class="fa fa-check"></i><b>10.5</b> Exercices du chapitre 5</a></li>
<li class="chapter" data-level="10.6" data-path="sect1006.html"><a href="sect1006.html"><i class="fa fa-check"></i><b>10.6</b> Exercices du chapitre 6</a></li>
<li class="chapter" data-level="10.7" data-path="sect1007.html"><a href="sect1007.html"><i class="fa fa-check"></i><b>10.7</b> Exercices du chapitre 7</a></li>
<li class="chapter" data-level="10.8" data-path="sect1008.html"><a href="sect1008.html"><i class="fa fa-check"></i><b>10.8</b> Exercices du chapitre 8</a></li>
<li class="chapter" data-level="10.9" data-path="sect1009.html"><a href="sect1009.html"><i class="fa fa-check"></i><b>10.9</b> Exercices du chapitre 9</a></li>
<li class="chapter" data-level="10.10" data-path="sect1011.html"><a href="sect1011.html"><i class="fa fa-check"></i><b>10.10</b> Exercices du chapitre 11</a></li>
<li class="chapter" data-level="10.11" data-path="sect1012.html"><a href="sect1012.html"><i class="fa fa-check"></i><b>10.11</b> Excercice du chapitre 12</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes de cours GMQ405 :
Modélisation et analyse spatiale</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect023" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Autocorrélation spatiale globale<a href="sect023.html#sect023" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sect0231" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Statistique du <em>I</em> de Moran<a href="sect023.html#sect0231" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sect02311" class="section level4 hasAnchor" number="2.3.1.1">
<h4><span class="header-section-number">2.3.1.1</span> Formulation du <em>I</em> de Moran<a href="sect023.html#sect02311" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour évaluer le degré d’autocorrélation spatiale d’une variable continue, les deux principales statistiques utilisées sont le <em>I</em> de Moran <span class="citation">(<a href="#ref-moran1950test" role="doc-biblioref">1950</a>)</span> et le <em>c</em> de Geary <span class="citation">(<a href="#ref-geary1954contiguity" role="doc-biblioref">1954</a>)</span>. Puisqu’elles renvoient une seule valeur pour la variable continue de la couche géographique étudiée, elles sont qualifiées de mesures globales de l’autocorrélation spatiale, par opposition aux mesures locales qui renvoient une valeur par entité spatiale (section <a href="sect024.html#sect024">2.4</a>). Nous présentons ici uniquement le <em>I</em> de Moran pour deux raisons principales. Premièrement, étant basée sur la covariance, son interprétation est bien plus facile que celle du <em>c</em> de Geary (basé sur la variance des écarts), c’est-à-dire qu’elle est très similaire au bien connu <a href="https://laeq.github.io/LivreMethoQuantBolR/sect043.html">coefficient de corrélation</a> <span class="citation">(<a href="#ref-RBoldAir" role="doc-biblioref">Apparicio et Gelb 2022</a>)</span>. Deuxièmement, elle constitue la mesure la plus utilisée. Le <em>I</em> de Moran s’écrit :</p>
<p><span class="math display" id="eq:MoranIa">\[\begin{equation}  
I = \frac{n}{\Sigma_{i=1}^n \Sigma_{j=1}^n w_{ij}} \frac{\Sigma_{i=1}^n \Sigma_{j=1}^n w_{ij}(x_i-\bar{x})(x_j-\bar{x})}{\Sigma_{i=1}^n (x_i-\bar{x})^2} \text{ avec :}
\tag{2.10}
\end{equation}\]</span>
</p>
<ul>
<li><em>n</em>, le nombre d’entités spatiales dans la couche géographique;</li>
<li><span class="math inline">\(w_{ij}\)</span>, la valeur de la pondération spatiale entre les entités spatiales <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>;</li>
<li><span class="math inline">\(x_i\)</span> et <span class="math inline">\(x_j\)</span>, les valeurs de la variable continue pour les entités spatiales <span class="math inline">\(i\)</span> et <span class="math inline">\(j\)</span>;</li>
<li><span class="math inline">\(\bar{x}\)</span>, la valeur moyenne de la variable <span class="math inline">\(X\)</span> à l’étude.</li>
</ul>
<div class="bloc_notes">
<p><strong>Standardisation de la matrice de pondération et <em>I</em> de Moran</strong></p>
<p>Nous avons vu que si la matrice de pondération spatiale est standardisée en ligne (section <a href="sect022.html#sect0223">2.2.3</a>), alors chaque ligne de la matrice vaut 1 et la somme de l’ensemble des valeurs de la matrice est égale au nombre d’entités spatiales (<span class="math inline">\(n\)</span>). Or, dans l’équation <a href="sect023.html#eq:MoranIa">(2.10)</a>, <span class="math inline">\(\Sigma_{i=1}^n \Sigma_{j=1}^n w_{ij}\)</span> représente la somme des pondérations de la matrice, soit <span class="math inline">\(n\)</span> si elles sont standardisées en ligne. Puisque <span class="math inline">\(\frac{n}{n}=1\)</span>, alors l’équation du <em>I</em> de Moran est simplifié comme suit :</p>
<p><span class="math display" id="eq:MoranIb">\[\begin{equation}  
I = \frac{\Sigma_{i=1}^n \Sigma_{j=1}^n w_{ij}(x_i-\bar{x})(x_j-\bar{x})}{\Sigma_{i=1}^n (x_i-\bar{x})^2}
\tag{2.11}
\end{equation}\]</span>
</p>
<p>Comme évoqué dans la section <a href="sect022.html#sect0223">2.2.3</a>, cela démontre l’intérêt de la standardisation : la comparaison des valeurs du <em>I</em> de Moran obtenues avec différentes matrices de contiguïté afin de sélectionner (éventuellement) celle avec laquelle la dépendance spatiale est la plus forte.</p>
</div>
</div>
<div id="sect02312" class="section level4 hasAnchor" number="2.3.1.2">
<h4><span class="header-section-number">2.3.1.2</span> Interprétation du <em>I</em> de Moran<a href="sect023.html#sect02312" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Avec une matrice standardisée, la statistique du <em>I</em> de Moran varie de -1 à 1 et s’interprète de la façon suivante :</p>
<ul>
<li>quand <span class="math inline">\(I&gt;0\)</span>, l’autocorrélation est positive, c’est-à-dire que les entités géographiques ont tendance à se ressembler d’autant plus qu’elles sont voisines ou proches;</li>
<li>quand <span class="math inline">\(I=0\)</span>, l’autocorrélation est nulle et la contiguïté ou la proximité spatiale des zones ne joue donc aucun rôle;</li>
<li>quand <span class="math inline">\(I&lt;0\)</span>, l’autocorrélation est négative, c’est-à-dire que les entités géographiques ont tendance à être dissemblables d’autant plus qu’elles sont voisines ou proches.</li>
</ul>
</div>
<div id="sect02313" class="section level4 hasAnchor" number="2.3.1.3">
<h4><span class="header-section-number">2.3.1.3</span> Significativité du <em>I</em> de Moran<a href="sect023.html#sect02313" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Comme pour le coefficient de corrélation calculé entre deux variables, il est possible de tester la significativité de la valeur du <em>I</em> de Moran obtenu. Sans que nous détaillions les calculs de significativité, notez qu’il existe trois manières de tester la significativité :</p>
<ul>
<li>selon l’hypothèse de la normalité;</li>
<li>selon l’hypothèse de la randomisation;</li>
<li>selon des permutations Monte-Carlo (habituellement avec 999 échantillons).</li>
</ul>
<div class="bloc_aller_loin">
<p><strong>Comment calculer les trois tests de significativité du <em>I</em> de Moran?</strong></p>
<p>Pour une description détaillée du calcul des trois tests, consultez l’ouvrage de Jean Dubé et Diego Legros <span class="citation">(<a href="#ref-dube2014econometrie" role="doc-biblioref">2014</a>)</span>.</p>
</div>
</div>
</div>
<div id="sect0232" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Mise en œuvre dans R<a href="sect023.html#sect0232" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="bloc_objectif">
<p><strong>Calcul du <em>I</em> de Moran dans R</strong></p>
<p>Pour illustrer le calcul de <em>I</em> de Moran dans R, nous utilisons une couche des aires de diffusion (AD) de la ville de Sherbrooke. Les étapes suivantes sont réalisées :</p>
<ol style="list-style-type: decimal">
<li>Construire une panoplie de matrices de pondération spatiale selon la contiguïté, la connectivité, la proximité et le critère des plus proches voisins.</li>
<li>Comparer les valeurs de significativité (<em>p</em>) pour une variable continue (<code>HabKm2</code>).</li>
<li>Pour cette même variable, trouver avec quelle matrice la valeur du <em>I</em> de Moran est la plus forte.</li>
<li>Comparer les valeurs de <em>I</em> de Moran calculées sur plusieurs variables.</li>
</ol>
</div>
<div id="sect02321" class="section level4 hasAnchor" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> Étape 1. Construction des matrices de pondération spatiale<a href="sect023.html#sect02321" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="sect023.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb229-2"><a href="sect023.html#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span>
<span id="cb229-3"><a href="sect023.html#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Importation de la couche des aires de diffusion de la ville de Sherbrooke</span></span>
<span id="cb229-4"><a href="sect023.html#cb229-4" aria-hidden="true" tabindex="-1"></a>AD.DR <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">&quot;data/chap02/Recen2021Sherbrooke.gpkg&quot;</span>,</span>
<span id="cb229-5"><a href="sect023.html#cb229-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">layer =</span> <span class="st">&quot;DR_SherbADDonnees2021&quot;</span>, <span class="at">quiet=</span><span class="cn">TRUE</span>)</span>
<span id="cb229-6"><a href="sect023.html#cb229-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-7"><a href="sect023.html#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrices de contiguïté</span></span>
<span id="cb229-8"><a href="sect023.html#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################</span></span>
<span id="cb229-9"><a href="sect023.html#cb229-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Partage d&#39;un nœud (Queen)</span></span>
<span id="cb229-10"><a href="sect023.html#cb229-10" aria-hidden="true" tabindex="-1"></a>Queen <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(AD.DR, <span class="at">queen=</span><span class="cn">TRUE</span>)</span>
<span id="cb229-11"><a href="sect023.html#cb229-11" aria-hidden="true" tabindex="-1"></a>W.Queen <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Queen, <span class="at">zero.policy=</span><span class="cn">TRUE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-12"><a href="sect023.html#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Partage d&#39;un segment (Rook)</span></span>
<span id="cb229-13"><a href="sect023.html#cb229-13" aria-hidden="true" tabindex="-1"></a>Rook <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(AD.DR, <span class="at">queen=</span><span class="cn">FALSE</span>)</span>
<span id="cb229-14"><a href="sect023.html#cb229-14" aria-hidden="true" tabindex="-1"></a>W.Rook <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Rook, <span class="at">zero.policy=</span><span class="cn">TRUE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-15"><a href="sect023.html#cb229-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Partage d&#39;un segment (Rook) et ordres d&#39;adjacence de 2 à 5</span></span>
<span id="cb229-16"><a href="sect023.html#cb229-16" aria-hidden="true" tabindex="-1"></a>Rook2 <span class="ot">&lt;-</span> <span class="fu">nblag_cumul</span>(<span class="fu">nblag</span>(Rook, <span class="dv">2</span>))</span>
<span id="cb229-17"><a href="sect023.html#cb229-17" aria-hidden="true" tabindex="-1"></a>Rook3 <span class="ot">&lt;-</span> <span class="fu">nblag_cumul</span>(<span class="fu">nblag</span>(Rook, <span class="dv">3</span>))</span>
<span id="cb229-18"><a href="sect023.html#cb229-18" aria-hidden="true" tabindex="-1"></a>Rook4 <span class="ot">&lt;-</span> <span class="fu">nblag_cumul</span>(<span class="fu">nblag</span>(Rook, <span class="dv">4</span>))</span>
<span id="cb229-19"><a href="sect023.html#cb229-19" aria-hidden="true" tabindex="-1"></a>Rook5 <span class="ot">&lt;-</span> <span class="fu">nblag_cumul</span>(<span class="fu">nblag</span>(Rook, <span class="dv">5</span>))</span>
<span id="cb229-20"><a href="sect023.html#cb229-20" aria-hidden="true" tabindex="-1"></a>W.Rook2 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Rook2, <span class="at">zero.policy=</span><span class="cn">TRUE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-21"><a href="sect023.html#cb229-21" aria-hidden="true" tabindex="-1"></a>W.Rook3 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Rook3, <span class="at">zero.policy=</span><span class="cn">TRUE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-22"><a href="sect023.html#cb229-22" aria-hidden="true" tabindex="-1"></a>W.Rook4 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Rook4, <span class="at">zero.policy=</span><span class="cn">TRUE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-23"><a href="sect023.html#cb229-23" aria-hidden="true" tabindex="-1"></a>W.Rook5 <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Rook5, <span class="at">zero.policy=</span><span class="cn">TRUE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-24"><a href="sect023.html#cb229-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-25"><a href="sect023.html#cb229-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrice de connectivité</span></span>
<span id="cb229-26"><a href="sect023.html#cb229-26" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################</span></span>
<span id="cb229-27"><a href="sect023.html#cb229-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrice binaire avec un seuil de 2500 mètres</span></span>
<span id="cb229-28"><a href="sect023.html#cb229-28" aria-hidden="true" tabindex="-1"></a>Connect2500m <span class="ot">&lt;-</span>   <span class="fu">dnearneigh</span>(<span class="fu">st_centroid</span>(AD.DR), <span class="at">d1 =</span> <span class="dv">0</span>, <span class="at">d2 =</span> <span class="dv">2500</span>)</span>
<span id="cb229-29"><a href="sect023.html#cb229-29" aria-hidden="true" tabindex="-1"></a>W.Connect2500m <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Connect2500m, <span class="at">zero.policy=</span><span class="cn">TRUE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-30"><a href="sect023.html#cb229-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-31"><a href="sect023.html#cb229-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrices de proximité</span></span>
<span id="cb229-32"><a href="sect023.html#cb229-32" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################</span></span>
<span id="cb229-33"><a href="sect023.html#cb229-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Coordonnées géographiques et matrice de distance</span></span>
<span id="cb229-34"><a href="sect023.html#cb229-34" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(<span class="fu">st_centroid</span>(AD.DR))</span>
<span id="cb229-35"><a href="sect023.html#cb229-35" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(coords, <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>))</span>
<span id="cb229-36"><a href="sect023.html#cb229-36" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(distances) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb229-37"><a href="sect023.html#cb229-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrices inverse de la distance et inverse de la distance au carré</span></span>
<span id="cb229-38"><a href="sect023.html#cb229-38" aria-hidden="true" tabindex="-1"></a>InvDistances <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distances<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span>distances, distances)</span>
<span id="cb229-39"><a href="sect023.html#cb229-39" aria-hidden="true" tabindex="-1"></a>InvDistances2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distances<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span>distances<span class="sc">^</span><span class="dv">2</span>, distances)</span>
<span id="cb229-40"><a href="sect023.html#cb229-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrices de pondération spatiale standardisées en ligne</span></span>
<span id="cb229-41"><a href="sect023.html#cb229-41" aria-hidden="true" tabindex="-1"></a>W.InvDistances  <span class="ot">&lt;-</span> <span class="fu">mat2listw</span>(InvDistances, <span class="at">style=</span><span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-42"><a href="sect023.html#cb229-42" aria-hidden="true" tabindex="-1"></a>W.InvDistances2 <span class="ot">&lt;-</span> <span class="fu">mat2listw</span>(InvDistances2, <span class="at">style=</span><span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-43"><a href="sect023.html#cb229-43" aria-hidden="true" tabindex="-1"></a><span class="do">## Création de différentes matrices avec différents seuils</span></span>
<span id="cb229-44"><a href="sect023.html#cb229-44" aria-hidden="true" tabindex="-1"></a>InvDistances<span class="fl">.2500</span>m  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distances<span class="sc">&lt;=</span><span class="dv">2500</span> <span class="sc">&amp;</span> distances<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span>distances, <span class="dv">0</span>)</span>
<span id="cb229-45"><a href="sect023.html#cb229-45" aria-hidden="true" tabindex="-1"></a>InvDistances<span class="fl">.5000</span>m  <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distances<span class="sc">&lt;=</span><span class="dv">5000</span> <span class="sc">&amp;</span> distances<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span>distances, <span class="dv">0</span>)</span>
<span id="cb229-46"><a href="sect023.html#cb229-46" aria-hidden="true" tabindex="-1"></a>InvDistances2<span class="fl">.2500</span>m <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distances<span class="sc">&lt;=</span><span class="dv">2500</span> <span class="sc">&amp;</span> distances<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span>distances<span class="sc">^</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb229-47"><a href="sect023.html#cb229-47" aria-hidden="true" tabindex="-1"></a>InvDistances2<span class="fl">.5000</span>m <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(distances<span class="sc">&lt;=</span><span class="dv">5000</span> <span class="sc">&amp;</span> distances<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span>distances<span class="sc">^</span><span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb229-48"><a href="sect023.html#cb229-48" aria-hidden="true" tabindex="-1"></a>W.InvDistances_2500 <span class="ot">&lt;-</span> <span class="fu">mat2listw</span>(InvDistances<span class="fl">.2500</span>m, <span class="at">style=</span><span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-49"><a href="sect023.html#cb229-49" aria-hidden="true" tabindex="-1"></a>W.InvDistances_5000 <span class="ot">&lt;-</span> <span class="fu">mat2listw</span>(InvDistances<span class="fl">.5000</span>m, <span class="at">style=</span><span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-50"><a href="sect023.html#cb229-50" aria-hidden="true" tabindex="-1"></a>W.InvDistances2_2500 <span class="ot">&lt;-</span> <span class="fu">mat2listw</span>(InvDistances2<span class="fl">.2500</span>m, <span class="at">style=</span><span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-51"><a href="sect023.html#cb229-51" aria-hidden="true" tabindex="-1"></a>W.InvDistances2_5000 <span class="ot">&lt;-</span> <span class="fu">mat2listw</span>(InvDistances2<span class="fl">.5000</span>m, <span class="at">style=</span><span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-52"><a href="sect023.html#cb229-52" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrice de distance réduite standardisée</span></span>
<span id="cb229-53"><a href="sect023.html#cb229-53" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords))</span>
<span id="cb229-54"><a href="sect023.html#cb229-54" aria-hidden="true" tabindex="-1"></a>plusprochevoisin.max <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1,coords)))</span>
<span id="cb229-55"><a href="sect023.html#cb229-55" aria-hidden="true" tabindex="-1"></a>Voisins.DistMax <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(coords, <span class="dv">0</span>, plusprochevoisin.max)                            </span>
<span id="cb229-56"><a href="sect023.html#cb229-56" aria-hidden="true" tabindex="-1"></a>distances <span class="ot">&lt;-</span> <span class="fu">nbdists</span>(Voisins.DistMax, coords)</span>
<span id="cb229-57"><a href="sect023.html#cb229-57" aria-hidden="true" tabindex="-1"></a>InvDistances <span class="ot">&lt;-</span> <span class="fu">lapply</span>(distances, <span class="cf">function</span>(x) (<span class="dv">1</span><span class="sc">/</span>x))</span>
<span id="cb229-58"><a href="sect023.html#cb229-58" aria-hidden="true" tabindex="-1"></a>InvDistances2 <span class="ot">&lt;-</span> <span class="fu">lapply</span>(distances, <span class="cf">function</span>(x) (<span class="dv">1</span><span class="sc">/</span>x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb229-59"><a href="sect023.html#cb229-59" aria-hidden="true" tabindex="-1"></a>W_InvDistancesReduite  <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Voisins.DistMax, <span class="at">glist =</span> InvDistances, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-60"><a href="sect023.html#cb229-60" aria-hidden="true" tabindex="-1"></a>W_InvDistances2Reduite <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(Voisins.DistMax, <span class="at">glist =</span> InvDistances2, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-61"><a href="sect023.html#cb229-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-62"><a href="sect023.html#cb229-62" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrice selon le critère des plus proches voisins</span></span>
<span id="cb229-63"><a href="sect023.html#cb229-63" aria-hidden="true" tabindex="-1"></a><span class="do">#####################################################</span></span>
<span id="cb229-64"><a href="sect023.html#cb229-64" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrices des plus proches voisins de 2 à 5</span></span>
<span id="cb229-65"><a href="sect023.html#cb229-65" aria-hidden="true" tabindex="-1"></a>k2 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">2</span>))</span>
<span id="cb229-66"><a href="sect023.html#cb229-66" aria-hidden="true" tabindex="-1"></a>k3 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">3</span>))</span>
<span id="cb229-67"><a href="sect023.html#cb229-67" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">4</span>))</span>
<span id="cb229-68"><a href="sect023.html#cb229-68" aria-hidden="true" tabindex="-1"></a>k5 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k =</span> <span class="dv">5</span>))</span>
<span id="cb229-69"><a href="sect023.html#cb229-69" aria-hidden="true" tabindex="-1"></a><span class="do">## Matrices de pondération spatiale standardisées en ligne</span></span>
<span id="cb229-70"><a href="sect023.html#cb229-70" aria-hidden="true" tabindex="-1"></a>W.k2 <span class="ot">&lt;-</span>  <span class="fu">nb2listw</span>(k2, <span class="at">zero.policy=</span><span class="cn">FALSE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-71"><a href="sect023.html#cb229-71" aria-hidden="true" tabindex="-1"></a>W.k3 <span class="ot">&lt;-</span>  <span class="fu">nb2listw</span>(k3, <span class="at">zero.policy=</span><span class="cn">FALSE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-72"><a href="sect023.html#cb229-72" aria-hidden="true" tabindex="-1"></a>W.k4 <span class="ot">&lt;-</span>  <span class="fu">nb2listw</span>(k4, <span class="at">zero.policy=</span><span class="cn">FALSE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span>
<span id="cb229-73"><a href="sect023.html#cb229-73" aria-hidden="true" tabindex="-1"></a>W.k5 <span class="ot">&lt;-</span>  <span class="fu">nb2listw</span>(k5, <span class="at">zero.policy=</span><span class="cn">FALSE</span>, <span class="at">style =</span> <span class="st">&quot;W&quot;</span>)</span></code></pre></div>
</div>
<div id="sect02322" class="section level4 hasAnchor" number="2.3.2.2">
<h4><span class="header-section-number">2.3.2.2</span> Étape 2. Calcul du <em>I</em> de Moran et des trois tests de significativité<a href="sect023.html#sect02322" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Calculons la statistique du <em>I</em> de Moran sur la variable continue cartographiée à la figure <a href="sect023.html#fig:CartoADDRSherbrooke">2.12</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CartoADDRSherbrooke"></span>
<img src="GMQ405_files/figure-html/CartoADDRSherbrooke-1.png" alt="Densité de population, aires de diffusion de la ville de Sherbrooke" width="85%" />
<p class="caption">
Figure 2.12: Densité de population, aires de diffusion de la ville de Sherbrooke
</p>
</div>
<p>Les fonctions <code>moran.test</code> et <code>moran.mc</code> du <em>package</em> <code>spdep</code> permettent de calculer le <em>I</em> de Moran selon les trois façons de tester la significativité :</p>
<ul>
<li>selon l’hypothèse de la normalité avec le paramètre <code>randomisation = FALSE</code>
<ul>
<li><code>moran.test(ObjetSf$Variable, listw=MatriceW, zero.policy=TRUE, randomisation = FALSE)</code></li>
</ul></li>
<li>selon l’hypothèse de la randomisation avec le paramètre <code>randomisation = TRUE</code>
<ul>
<li><code>moran.test(ObjetSf$Variable, listw=MatriceW, zero.policy=TRUE, randomisation = TRUE)</code></li>
</ul></li>
<li>selon des permutations Monte-Carlo (ci-dessus avec 999 permutations)
<ul>
<li><code>moran.mc(ObjetSf$Variable, listw=MatriceW, zero.policy=TRUE, nsim=999)</code></li>
</ul></li>
</ul>
<p>Bien entendu, dans les sorties des trois méthodes, la valeur du <em>I</em> de Moran est la même, contrairement à la valeur de <em>p</em> qui peut varier.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="sect023.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(AD.DR<span class="sc">$</span>HabKm2,          <span class="co"># nom de l&#39;objet sf et de la variable continue</span></span>
<span id="cb230-2"><a href="sect023.html#cb230-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>W.Queen,         <span class="co"># nom de la matrice de pondération spatiale</span></span>
<span id="cb230-3"><a href="sect023.html#cb230-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy=</span><span class="cn">TRUE</span>,    </span>
<span id="cb230-4"><a href="sect023.html#cb230-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">randomisation =</span> <span class="cn">FALSE</span>) <span class="co"># significativité selon l’hypothèse de la normalité</span></span></code></pre></div>
<pre><code>## 
##  Moran I test under normality
## 
## data:  AD.DR$HabKm2  
## weights: W.Queen    
## 
## Moran I statistic standard deviate = 11.724, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##       0.433714579      -0.004032258       0.001394035</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="sect023.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.test</span>(AD.DR<span class="sc">$</span>HabKm2,          <span class="co"># nom de l&#39;objet sf et de la variable continue</span></span>
<span id="cb232-2"><a href="sect023.html#cb232-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">listw=</span>W.Queen,         <span class="co"># nom de la matrice de pondération spatiale</span></span>
<span id="cb232-3"><a href="sect023.html#cb232-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy=</span><span class="cn">TRUE</span>,    </span>
<span id="cb232-4"><a href="sect023.html#cb232-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">randomisation =</span> <span class="cn">TRUE</span>)  <span class="co"># significativité selon l’hypothèse de la randomisation</span></span></code></pre></div>
<pre><code>## 
##  Moran I test under randomisation
## 
## data:  AD.DR$HabKm2  
## weights: W.Queen    
## 
## Moran I statistic standard deviate = 11.761, p-value &lt; 2.2e-16
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##       0.433714579      -0.004032258       0.001385364</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="sect023.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.mc</span>(AD.DR<span class="sc">$</span>HabKm2,            <span class="co"># nom de l&#39;objet sf et de la variable continue</span></span>
<span id="cb234-2"><a href="sect023.html#cb234-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">listw=</span>W.Queen,           <span class="co"># nom de la matrice de pondération spatiale </span></span>
<span id="cb234-3"><a href="sect023.html#cb234-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">zero.policy=</span><span class="cn">TRUE</span>, </span>
<span id="cb234-4"><a href="sect023.html#cb234-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">nsim=</span><span class="dv">999</span>)                <span class="co"># 999 permutations</span></span></code></pre></div>
<pre><code>## 
##  Monte-Carlo simulation of Moran I
## 
## data:  AD.DR$HabKm2 
## weights: W.Queen  
## number of simulations + 1: 1000 
## 
## statistic = 0.43371, observed rank = 1000, p-value = 0.001
## alternative hypothesis: greater</code></pre>
<p>Nous allons calculer la mesure du <em>I</em> de Moran sur la variable continue cartographiée à la figure <a href="sect023.html#fig:FigIMoranLoiNormale">2.13</a>.</p>
<p>La statistique du <em>I</em> de Moran (<em>I</em> = 0,43, <em>p</em> &lt; 0,001) indique que la variable <em>densité de population</em> a une forte autocorrélation spatiale positive (figure <a href="sect023.html#fig:FigIMoranLoiNormale">2.13</a>), avec des valeurs fortes dans les aires de diffusion contiguës dans la partie centrale de la ville et des valeurs faibles dans les aires de diffusion contiguës dans les secteurs périphériques (figure <a href="sect023.html#fig:CartoADDRSherbrooke">2.12</a>).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:FigIMoranLoiNormale"></span>
<img src="images/Chap02/IdeMoran.png" alt="Résultats du *I* de Moran selon l'hypothèse de la loi normale" width="80%" />
<p class="caption">
Figure 2.13: Résultats du <em>I</em> de Moran selon l’hypothèse de la loi normale
</p>
</div>
</div>
<div id="sect02323" class="section level4 hasAnchor" number="2.3.2.3">
<h4><span class="header-section-number">2.3.2.3</span> Étape 3. Identification de la plus forte autocorrélation spatiale selon les différentes matrices<a href="sect023.html#sect02323" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La syntaxe ci-dessous permet de calculer la statistique du <em>I</em> de Moran avec plusieurs matrices de pondération spatiale.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="sect023.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Création d&#39;un vecteur pour les noms des matrices</span></span>
<span id="cb236-2"><a href="sect023.html#cb236-2" aria-hidden="true" tabindex="-1"></a>VecteurMatrices <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;W.Queen&quot;</span>, <span class="st">&quot;W.Rook&quot;</span>, <span class="st">&quot;W.Rook2&quot;</span>, <span class="st">&quot;W.Rook3&quot;</span>, <span class="st">&quot;W.Rook4&quot;</span>, <span class="st">&quot;W.Rook5&quot;</span>,</span>
<span id="cb236-3"><a href="sect023.html#cb236-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;W.Connect2500m&quot;</span>,</span>
<span id="cb236-4"><a href="sect023.html#cb236-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;W.InvDistances&quot;</span>, <span class="st">&quot;W.InvDistances2&quot;</span>,</span>
<span id="cb236-5"><a href="sect023.html#cb236-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;W_InvDistancesReduite&quot;</span>, <span class="st">&quot;W_InvDistances2Reduite&quot;</span>,</span>
<span id="cb236-6"><a href="sect023.html#cb236-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;W.InvDistances_2500&quot;</span>, <span class="st">&quot;W.InvDistances_5000&quot;</span>,</span>
<span id="cb236-7"><a href="sect023.html#cb236-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;W.InvDistances2_2500&quot;</span>,<span class="st">&quot;W.InvDistances2_5000&quot;</span>,</span>
<span id="cb236-8"><a href="sect023.html#cb236-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;W.k2&quot;</span>, <span class="st">&quot;W.k3&quot;</span>, <span class="st">&quot;W.k4&quot;</span>, <span class="st">&quot;W.k5&quot;</span>)</span>
<span id="cb236-9"><a href="sect023.html#cb236-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Création d&#39;une liste pour toutes les matrices</span></span>
<span id="cb236-10"><a href="sect023.html#cb236-10" aria-hidden="true" tabindex="-1"></a>ListeMatrices <span class="ot">&lt;-</span> <span class="fu">list</span>(W.Queen, W.Rook, W.Rook2, W.Rook3, W.Rook4, W.Rook5,</span>
<span id="cb236-11"><a href="sect023.html#cb236-11" aria-hidden="true" tabindex="-1"></a>                      W.Connect2500m,</span>
<span id="cb236-12"><a href="sect023.html#cb236-12" aria-hidden="true" tabindex="-1"></a>                      W.InvDistances, W.InvDistances2,</span>
<span id="cb236-13"><a href="sect023.html#cb236-13" aria-hidden="true" tabindex="-1"></a>                      W_InvDistancesReduite, W_InvDistances2Reduite,</span>
<span id="cb236-14"><a href="sect023.html#cb236-14" aria-hidden="true" tabindex="-1"></a>                      W.InvDistances_2500, W.InvDistances2_2500,</span>
<span id="cb236-15"><a href="sect023.html#cb236-15" aria-hidden="true" tabindex="-1"></a>                      W.InvDistances2_2500, W.InvDistances2_5000,</span>
<span id="cb236-16"><a href="sect023.html#cb236-16" aria-hidden="true" tabindex="-1"></a>                      W.k2, W.k3, W.k4, W.k5)</span>
<span id="cb236-17"><a href="sect023.html#cb236-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Vecteur pour le I de Moran et la valeur de p</span></span>
<span id="cb236-18"><a href="sect023.html#cb236-18" aria-hidden="true" tabindex="-1"></a>MoranI <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb236-19"><a href="sect023.html#cb236-19" aria-hidden="true" tabindex="-1"></a>Pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb236-20"><a href="sect023.html#cb236-20" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb236-21"><a href="sect023.html#cb236-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Boucle pour calculer le I de Moran avec la liste des matrices</span></span>
<span id="cb236-22"><a href="sect023.html#cb236-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (e <span class="cf">in</span> ListeMatrices){</span>
<span id="cb236-23"><a href="sect023.html#cb236-23" aria-hidden="true" tabindex="-1"></a>   i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb236-24"><a href="sect023.html#cb236-24" aria-hidden="true" tabindex="-1"></a>   Test <span class="ot">&lt;-</span><span class="fu">moran.mc</span>(AD.DR<span class="sc">$</span>HabKm2,</span>
<span id="cb236-25"><a href="sect023.html#cb236-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">listw=</span>e, </span>
<span id="cb236-26"><a href="sect023.html#cb236-26" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy=</span><span class="cn">TRUE</span>, </span>
<span id="cb236-27"><a href="sect023.html#cb236-27" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nsim=</span><span class="dv">999</span>)</span>
<span id="cb236-28"><a href="sect023.html#cb236-28" aria-hidden="true" tabindex="-1"></a>   MoranI[i]<span class="ot">&lt;-</span>Test<span class="sc">$</span>statistic</span>
<span id="cb236-29"><a href="sect023.html#cb236-29" aria-hidden="true" tabindex="-1"></a>   Pvalue[i] <span class="ot">&lt;-</span> Test<span class="sc">$</span>p.value</span>
<span id="cb236-30"><a href="sect023.html#cb236-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb236-31"><a href="sect023.html#cb236-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d&#39;un DataFrame avec les valeurs du I de Moran et de p</span></span>
<span id="cb236-32"><a href="sect023.html#cb236-32" aria-hidden="true" tabindex="-1"></a>MoranData1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Matrices=</span>VecteurMatrices,</span>
<span id="cb236-33"><a href="sect023.html#cb236-33" aria-hidden="true" tabindex="-1"></a>                         <span class="at">MoranIs=</span>MoranI,</span>
<span id="cb236-34"><a href="sect023.html#cb236-34" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Pvalues=</span>Pvalue)</span>
<span id="cb236-35"><a href="sect023.html#cb236-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(MoranData1)</span></code></pre></div>
<pre><code>##                  Matrices    MoranIs Pvalues
## 1                 W.Queen 0.43371458   0.001
## 2                  W.Rook 0.44970946   0.001
## 3                 W.Rook2 0.32509097   0.001
## 4                 W.Rook3 0.21527754   0.001
## 5                 W.Rook4 0.12614476   0.001
## 6                 W.Rook5 0.07129756   0.001
## 7          W.Connect2500m 0.25583250   0.001
## 8          W.InvDistances 0.10632882   0.001
## 9         W.InvDistances2 0.27216034   0.001
## 10  W_InvDistancesReduite 0.28566705   0.001
## 11 W_InvDistances2Reduite 0.38836327   0.001
## 12    W.InvDistances_2500 0.32115230   0.001
## 13    W.InvDistances_5000 0.40350492   0.001
## 14   W.InvDistances2_2500 0.40350492   0.001
## 15   W.InvDistances2_5000 0.34988630   0.001
## 16                   W.k2 0.51070049   0.001
## 17                   W.k3 0.44458619   0.001
## 18                   W.k4 0.44800959   0.001
## 19                   W.k5 0.43874109   0.001</code></pre>
<p>La lecture détaillée du tableau <a href="sect023.html#tab:TableauIMoranMatrices">2.3</a> permet d’avancer plusieurs constats intéressants :</p>
<ul>
<li>D’emblée, signalons que toutes les valeurs sont positives et significatives, témoignant d’une autocorrélation spatiale positive.</li>
<li>Concernant les <strong>matrices de contiguïté</strong>, la dépendance spatiale est plus forte selon le partage d’un segment que d’un nœud (0,4497 contre 0,4337). Par conséquent, si nous devons choisir une matrice de contiguïté, il serait préférable d’utiliser celle définie selon le partage d’une chaîne (<em>Rook</em>).</li>
<li>Sans surprise, plus nous ajoutons des <strong>ordres d’adjacence</strong>, plus la valeur de la statistique du <em>I</em> de Moran est faible, passant de 0,3251 à 0,0713 du deuxième au cinquième ordre.</li>
<li>La valeur du <em>I</em> de Moran avec une <strong>matrice de connectivité</strong> avec 2500 mètres est de 0,2558. Elle est plus faible que celles de l’inverse de la distance et l’inverse de la distance au carré, avec le même seuil de 2500 mètres (0,3212 et 0,4035).</li>
<li>Concernant les <strong>matrices de proximité</strong>, la méthode de l’inverse de la distance au carré, qui accorde un poids plus important aux entités spatiales très proches (comparativement à l’inverse de la distance), renvoie des valeurs toujours plus élevées, et ce, que la matrice soit complète ou réduite. Aussi, les matrices de distance réduites présentent toujours des valeurs plus fortes que celles complètes.</li>
<li>Concernant les matrices <strong>selon le critère des plus proches voisins</strong>, l’autocorrélation spatiale diminue légèrement de <em>k</em> = 2 à <em>k</em> = 5. D’ailleurs, la valeur la plus forte est pour deux voisins (<em>I</em> = 0,5107). Toutefois, retenir uniquement deux voisins est discutable puisque les AD sont très majoritairement contiguës à plus de deux autres AD (sur les 249 AD, seuls 9 sont contiguës à deux autres AD selon le partage d’un segment). Pour le vérifier, tapez <code>summary(W.Rook)</code> et analysez le tableau sous la ligne <code>Link number distribution</code>.</li>
</ul>
<table>
<caption>
<span id="tab:TableauIMoranMatrices">Tableau 2.3: </span>Résultats du <em>I</em> de Moran selon les différentes matrices
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nom
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:center;">
<em>I</em> de Moran
</th>
<th style="text-align:center;">
p (999 permutations)
</th>
</tr>
</thead>
<tbody>
<tr grouplength="2">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Matrices de contiguïté</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.Queen
</td>
<td style="text-align:left;">
Partage d’un nœud
</td>
<td style="text-align:center;">
0,4337
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.Rook
</td>
<td style="text-align:left;">
Partage d’un segment
</td>
<td style="text-align:center;">
0,4497
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Matrices de contiguïté selon le partage d’un segment et ordre d’adjacence</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.Rook2
</td>
<td style="text-align:left;">
Ordre 2
</td>
<td style="text-align:center;">
0,3251
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.Rook3
</td>
<td style="text-align:left;">
Ordre 3
</td>
<td style="text-align:center;">
0,2153
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.Rook4
</td>
<td style="text-align:left;">
Ordre 4
</td>
<td style="text-align:center;">
0,1261
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.Rook5
</td>
<td style="text-align:left;">
Ordre 5
</td>
<td style="text-align:center;">
0,0713
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr grouplength="1">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Matrices de connectivité</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.Connect2500m
</td>
<td style="text-align:left;">
2500 mètres
</td>
<td style="text-align:center;">
0,2558
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr grouplength="2">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Matrices de distance (complètes)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.InvDistances
</td>
<td style="text-align:left;">
Inverse de la distance
</td>
<td style="text-align:center;">
0,1063
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.InvDistances2
</td>
<td style="text-align:left;">
Inverse de la distance au carré
</td>
<td style="text-align:center;">
0,2722
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr grouplength="2">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Matrices de distance (réduites)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W_InvDistancesReduite
</td>
<td style="text-align:left;">
Inverse de la distance
</td>
<td style="text-align:center;">
0,2857
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W_InvDistances2Reduite
</td>
<td style="text-align:left;">
Inverse de la distance au carré
</td>
<td style="text-align:center;">
0,3884
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Matrices de distance avec un seuil maximal</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.InvDistances_2500
</td>
<td style="text-align:left;">
Inverse de la distance (2500 mètres)
</td>
<td style="text-align:center;">
0,3212
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.InvDistances_5000
</td>
<td style="text-align:left;">
Inverse de la distance (5000 mètres)
</td>
<td style="text-align:center;">
0,4035
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.InvDistances2_2500
</td>
<td style="text-align:left;">
Inverse de la distance au carré (2500 mètres)
</td>
<td style="text-align:center;">
0,4035
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.InvDistances2_5000
</td>
<td style="text-align:left;">
Inverse de la distance au carré (5000 mètres)
</td>
<td style="text-align:center;">
0,3499
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Matrices selon le critère des plus proches voisins</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.k2
</td>
<td style="text-align:left;">
<em>k</em> = 2
</td>
<td style="text-align:center;">
0,5107
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.k3
</td>
<td style="text-align:left;">
<em>k</em> = 3
</td>
<td style="text-align:center;">
0,4446
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.k4
</td>
<td style="text-align:left;">
<em>k</em> = 4
</td>
<td style="text-align:center;">
0,4480
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
W.k5
</td>
<td style="text-align:left;">
<em>k</em> = 5
</td>
<td style="text-align:center;">
0,4387
</td>
<td style="text-align:center;">
0,001
</td>
</tr>
</tbody>
</table>
<p><strong>Quelle est la matrice avec laquelle la dépendance spatiale de la variable est la plus forte?</strong></p>
<p>Pour la trouver, nous construisons un graphique avec les valeurs du <em>I</em> de Moran triées par ordre décroissant. La valeur la plus forte est obtenue avec la matrice selon les deux plus proches voisins, suivie de la matrice <em>Rook</em>. Quoi qu’il en soit, il serait plus judicieux de privilégier la matrice de contiguïté selon le partage d’un segment comme expliqué plus haut.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="sect023.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb238-2"><a href="sect023.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>MoranData1, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Matrices,MoranIs), <span class="at">y=</span>MoranIs)) <span class="sc">+</span></span>
<span id="cb238-3"><a href="sect023.html#cb238-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>( <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Matrices,MoranIs), </span>
<span id="cb238-4"><a href="sect023.html#cb238-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xend=</span><span class="fu">reorder</span>(Matrices,MoranIs), </span>
<span id="cb238-5"><a href="sect023.html#cb238-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y=</span><span class="dv">0</span>, <span class="at">yend=</span>MoranIs)) <span class="sc">+</span></span>
<span id="cb238-6"><a href="sect023.html#cb238-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">size=</span><span class="dv">4</span>,<span class="at">fill=</span><span class="st">&quot;red&quot;</span>,<span class="at">shape=</span><span class="dv">21</span>)<span class="sc">+</span></span>
<span id="cb238-7"><a href="sect023.html#cb238-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Matrice de pondération spatiale&quot;</span>) <span class="sc">+</span></span>
<span id="cb238-8"><a href="sect023.html#cb238-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;I de Moran&quot;</span>)<span class="sc">+</span></span>
<span id="cb238-9"><a href="sect023.html#cb238-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:loliplotMoran1"></span>
<img src="GMQ405_files/figure-html/loliplotMoran1-1.png" alt="Graphique avec les valeurs du *I* de Moran selon les différentes matrices de pondération spatiale" width="75%" />
<p class="caption">
Figure 2.14: Graphique avec les valeurs du <em>I</em> de Moran selon les différentes matrices de pondération spatiale
</p>
</div>
</div>
<div id="sect02324" class="section level4 hasAnchor" number="2.3.2.4">
<h4><span class="header-section-number">2.3.2.4</span> Étape 4. Comparaison des valeurs du <em>I</em> de Moran pour plusieurs variables avec la même matrice<a href="sect023.html#sect02324" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La syntaxe ci-dessous permet de calculer la statistique du <em>I</em> de Moran pour plusieurs variables (figure <a href="sect023.html#fig:CarteQuatreVariables">2.15</a>) avec la même matrice de pondération spatiale (ici, matrice de contiguïté selon le partage d’un segment).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CarteQuatreVariables"></span>
<img src="GMQ405_files/figure-html/CarteQuatreVariables-1.png" alt="Quatre variables sélectionnées pour les AD de la ville de Sherbrooke" width="85%" />
<p class="caption">
Figure 2.15: Quatre variables sélectionnées pour les AD de la ville de Sherbrooke
</p>
</div>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="sect023.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Vecteur pour les variables à analyser</span></span>
<span id="cb239-2"><a href="sect023.html#cb239-2" aria-hidden="true" tabindex="-1"></a>listeVars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PctLog1960_Av&quot;</span>, <span class="st">&quot;RevMedMenage&quot;</span> , <span class="st">&quot;PctProprieta&quot;</span>, <span class="st">&quot;PctPop0_14&quot;</span>)</span>
<span id="cb239-3"><a href="sect023.html#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Vecteur pour le I de Moran et la valeur de p</span></span>
<span id="cb239-4"><a href="sect023.html#cb239-4" aria-hidden="true" tabindex="-1"></a>MoranI <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb239-5"><a href="sect023.html#cb239-5" aria-hidden="true" tabindex="-1"></a>VarName <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb239-6"><a href="sect023.html#cb239-6" aria-hidden="true" tabindex="-1"></a>Pvalue <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb239-7"><a href="sect023.html#cb239-7" aria-hidden="true" tabindex="-1"></a>i<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb239-8"><a href="sect023.html#cb239-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Boucle pour calculer le I de Moran pour les différentes variables</span></span>
<span id="cb239-9"><a href="sect023.html#cb239-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (e <span class="cf">in</span> listeVars){</span>
<span id="cb239-10"><a href="sect023.html#cb239-10" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">&lt;-</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb239-11"><a href="sect023.html#cb239-11" aria-hidden="true" tabindex="-1"></a>  Test <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(AD.DR[[e]],</span>
<span id="cb239-12"><a href="sect023.html#cb239-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">listw=</span>W.Rook,</span>
<span id="cb239-13"><a href="sect023.html#cb239-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">zero.policy=</span><span class="cn">TRUE</span>,</span>
<span id="cb239-14"><a href="sect023.html#cb239-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nsim=</span><span class="dv">999</span>)</span>
<span id="cb239-15"><a href="sect023.html#cb239-15" aria-hidden="true" tabindex="-1"></a>  MoranI[i]<span class="ot">&lt;-</span><span class="fu">round</span>(Test<span class="sc">$</span>statistic,<span class="dv">4</span>)</span>
<span id="cb239-16"><a href="sect023.html#cb239-16" aria-hidden="true" tabindex="-1"></a>  VarName[i]<span class="ot">&lt;-</span>e</span>
<span id="cb239-17"><a href="sect023.html#cb239-17" aria-hidden="true" tabindex="-1"></a>  Pvalue[i] <span class="ot">&lt;-</span> Test<span class="sc">$</span>p.value</span>
<span id="cb239-18"><a href="sect023.html#cb239-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb239-19"><a href="sect023.html#cb239-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Création d&#39;un DataFrame avec les valeurs du I de Moran et de p</span></span>
<span id="cb239-20"><a href="sect023.html#cb239-20" aria-hidden="true" tabindex="-1"></a>MoranData2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable=</span>listeVars,</span>
<span id="cb239-21"><a href="sect023.html#cb239-21" aria-hidden="true" tabindex="-1"></a>                         <span class="at">MoranIs=</span>MoranI,</span>
<span id="cb239-22"><a href="sect023.html#cb239-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Pvalues=</span>Pvalue)</span>
<span id="cb239-23"><a href="sect023.html#cb239-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(MoranData2)</span></code></pre></div>
<pre><code>##        Variable MoranIs Pvalues
## 1 PctLog1960_Av  0.7071   0.001
## 2  RevMedMenage  0.6168   0.001
## 3  PctProprieta  0.6028   0.001
## 4    PctPop0_14  0.4474   0.001</code></pre>
<p>De nouveau, en quelques lignes de code, il est aisé de réaliser un graphique pour comparer les valeurs du <em>I</em> de Moran pour les différentes variables (figure <a href="sect023.html#fig:loliplotMoran2">2.16</a>).</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="sect023.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb241-2"><a href="sect023.html#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>MoranData2, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Variable,MoranIs), <span class="at">y=</span>MoranIs)) <span class="sc">+</span></span>
<span id="cb241-3"><a href="sect023.html#cb241-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>( <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Variable,MoranIs), </span>
<span id="cb241-4"><a href="sect023.html#cb241-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">xend=</span><span class="fu">reorder</span>(Variable,MoranIs), </span>
<span id="cb241-5"><a href="sect023.html#cb241-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y=</span><span class="dv">0</span>, <span class="at">yend=</span>MoranIs)) <span class="sc">+</span></span>
<span id="cb241-6"><a href="sect023.html#cb241-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">size=</span><span class="dv">4</span>,<span class="at">fill=</span><span class="st">&quot;red&quot;</span>,<span class="at">shape=</span><span class="dv">21</span>)<span class="sc">+</span></span>
<span id="cb241-7"><a href="sect023.html#cb241-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Variable continue&quot;</span>) <span class="sc">+</span></span>
<span id="cb241-8"><a href="sect023.html#cb241-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;I de Moran&quot;</span>)<span class="sc">+</span></span>
<span id="cb241-9"><a href="sect023.html#cb241-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:loliplotMoran2"></span>
<img src="GMQ405_files/figure-html/loliplotMoran2-1.png" alt="Graphique avec les valeurs du *I* de Moran pour les quatre variables" width="75%" />
<p class="caption">
Figure 2.16: Graphique avec les valeurs du <em>I</em> de Moran pour les quatre variables
</p>
</div>
</div>
</div>
</div>
<h3>Références</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-RBoldAir" class="csl-entry">
Apparicio, Philippe et Jérémy Gelb. 2022. <em>Méthodes quantitatives en sciences sociales : un grand bol d’R</em>. FabriqueREL, Licence CC BY-SA. <a href="https://laeq.github.io/LivreMethoQuantBolR/">https://laeq.github.io/LivreMethoQuantBolR/</a>.
</div>
<div id="ref-dube2014econometrie" class="csl-entry">
Dubé, Jean et Diègo Legros. 2014. <em>Econom<span>é</span>trie spatiale appliqu<span>é</span>e des microdonn<span>é</span>es</em>. ISTE Group.
</div>
<div id="ref-geary1954contiguity" class="csl-entry">
Geary, Robert C. 1954. <span>« The contiguity ratio and statistical mapping. »</span> <em>The incorporated statistician</em> 5 (3): 115‑146. <a href="https://doi.org/10.2307/2986645">https://doi.org/10.2307/2986645</a>.
</div>
<div id="ref-moran1950test" class="csl-entry">
Moran, Patrick. 1950. <span>« A test for the serial independence of residuals. »</span> <em>Biometrika</em> 37 (1/2): 178‑181. <a href="https://doi.org/10.2307/2332162">https://doi.org/10.2307/2332162</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect022.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect024.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["GMQ405.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
