<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.4 Modèles GLM pour des variables continues | Méthodes quantitatives en sciences sociales : un grand bol d’R</title>
  <meta name="description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="8.4 Modèles GLM pour des variables continues | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://laeq.github.io/LivreStatistique_website/" />
  <meta property="og:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="github-repo" content="LAEQ/livre_statistique_Phil_Jere" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.4 Modèles GLM pour des variables continues | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  
  <meta name="twitter:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="twitter:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio et Jérémy Gelb" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect084.html"/>
<link rel="next" href="sect086.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d'R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Un manuel conçu comme un projet collaboratif</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment lire ce livre?</a></li>
<li class="chapter" data-level="" data-path="sect003B.html"><a href="sect003B.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en sciences sociales?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="sect007.html"><a href="sect007.html"><i class="fa fa-check"></i>Dédicace toute spéciale à Cargo et Ambrée</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auteurs.html"><a href="auteurs.html"><i class="fa fa-check"></i>À propos des auteurs</a></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Prise en main de R</a><ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Histoire et philosophie de R</a></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Environnement de travail</a><ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Installation de R</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Environnement RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect0123"><i class="fa fa-check"></i><b>1.2.3</b> Installation et chargement un <em>package</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#aide-disponible"><i class="fa fa-check"></i><b>1.2.4</b> Aide disponible</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Bases du langage R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> <em>Hello World</em>!</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Objets et expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="sect013.html"><a href="sect013.html#sect0_133"><i class="fa fa-check"></i><b>1.3.3</b> Fonctions et arguments</a></li>
<li class="chapter" data-level="1.3.4" data-path="sect013.html"><a href="sect013.html#sect0134"><i class="fa fa-check"></i><b>1.3.4</b> Principaux types de données</a></li>
<li class="chapter" data-level="1.3.5" data-path="sect013.html"><a href="sect013.html#sect0135"><i class="fa fa-check"></i><b>1.3.5</b> Opérateurs</a></li>
<li class="chapter" data-level="1.3.6" data-path="sect013.html"><a href="sect013.html#sect0136"><i class="fa fa-check"></i><b>1.3.6</b> Structures de données</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Manipulation de données</a><ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Manipulation d’un <em>DataFrame</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.5</b> Code R bien structuré</a></li>
<li class="chapter" data-level="1.6" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.6</b> Enregistrement des résultats</a></li>
<li class="chapter" data-level="1.7" data-path="sect018.html"><a href="sect018.html"><i class="fa fa-check"></i><b>1.7</b> Session de travail</a></li>
<li class="chapter" data-level="1.8" data-path="sect019.html"><a href="sect019.html"><i class="fa fa-check"></i><b>1.8</b> Conclusion et ressources pertinentes</a></li>
<li class="chapter" data-level="1.9" data-path="sect0110.html"><a href="sect0110.html"><i class="fa fa-check"></i><b>1.9</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>II Analyses univariées et graphiques dans R</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Statistiques descriptives univariées</a><ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion et types de variable</a><ul>
<li class="chapter" data-level="2.1.1" data-path="sect021.html"><a href="sect021.html#sect0211"><i class="fa fa-check"></i><b>2.1.1</b> Notion de variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="sect021.html"><a href="sect021.html#sect0212"><i class="fa fa-check"></i><b>2.1.2</b> Types de variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Types de données</a><ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Données secondaires <em>versus</em> données primaires</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Données transversales <em>versus</em> données longitudinales</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Données spatiales versus données aspatiales</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Données individuelles <em>versus</em> données agrégées</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Statistique descriptive et statistique inférentielle</a><ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Population, échantillon et inférence</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Deux grandes familles de méthodes statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Notion de distribution</a><ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#définition-générale"><i class="fa fa-check"></i><b>2.4.1</b> Définition générale</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#anatomie-dune-distribution"><i class="fa fa-check"></i><b>2.4.2</b> Anatomie d’une distribution</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#principales-distributions"><i class="fa fa-check"></i><b>2.4.3</b> Principales distributions</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#conclusion-sur-les-distributions"><i class="fa fa-check"></i><b>2.4.4</b> Conclusion sur les distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Statistiques descriptives sur des variables quantitatives</a><ul>
<li class="chapter" data-level="2.5.1" data-path="sect025.html"><a href="sect025.html#sect0251"><i class="fa fa-check"></i><b>2.5.1</b> Paramètres de tendance centrale</a></li>
<li class="chapter" data-level="2.5.2" data-path="sect025.html"><a href="sect025.html#sect0252"><i class="fa fa-check"></i><b>2.5.2</b> Paramètres de position</a></li>
<li class="chapter" data-level="2.5.3" data-path="sect025.html"><a href="sect025.html#sect0253"><i class="fa fa-check"></i><b>2.5.3</b> Paramètres de dispersion</a></li>
<li class="chapter" data-level="2.5.4" data-path="sect025.html"><a href="sect025.html#sect0254"><i class="fa fa-check"></i><b>2.5.4</b> Paramètres de forme</a></li>
<li class="chapter" data-level="2.5.5" data-path="sect025.html"><a href="sect025.html#sect0255"><i class="fa fa-check"></i><b>2.5.5</b> Transformation des variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="sect025.html"><a href="sect025.html#sect0256"><i class="fa fa-check"></i><b>2.5.6</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a><ul>
<li class="chapter" data-level="2.6.1" data-path="sect026.html"><a href="sect026.html#sect0261"><i class="fa fa-check"></i><b>2.6.1</b> Fréquences</a></li>
<li class="chapter" data-level="2.6.2" data-path="sect026.html"><a href="sect026.html#sect0262"><i class="fa fa-check"></i><b>2.6.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sect027.html"><a href="sect027.html"><i class="fa fa-check"></i><b>2.7</b> Statistiques descriptives pondérées : pour aller plus loin</a></li>
<li class="chapter" data-level="2.8" data-path="sect028.html"><a href="sect028.html"><i class="fa fa-check"></i><b>2.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Magie des graphiques</a><ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Philosophie du ggplot2</a><ul>
<li class="chapter" data-level="3.1.1" data-path="sect031.html"><a href="sect031.html#sect0311"><i class="fa fa-check"></i><b>3.1.1</b> Grammaire</a></li>
<li class="chapter" data-level="3.1.2" data-path="sect031.html"><a href="sect031.html#sect0312"><i class="fa fa-check"></i><b>3.1.2</b> Types de géométries</a></li>
<li class="chapter" data-level="3.1.3" data-path="sect031.html"><a href="sect031.html#sect0313"><i class="fa fa-check"></i><b>3.1.3</b> Habillage</a></li>
<li class="chapter" data-level="3.1.4" data-path="sect031.html"><a href="sect031.html#utilisation-des-thèmes"><i class="fa fa-check"></i><b>3.1.4</b> Utilisation des thèmes</a></li>
<li class="chapter" data-level="3.1.5" data-path="sect031.html"><a href="sect031.html#sect0314"><i class="fa fa-check"></i><b>3.1.5</b> Composition d’une figure avec plusieurs graphiques</a></li>
<li class="chapter" data-level="3.1.6" data-path="sect031.html"><a href="sect031.html#sect0315"><i class="fa fa-check"></i><b>3.1.6</b> Couleur</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Principaux graphiques</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0321"><i class="fa fa-check"></i><b>3.2.1</b> Histogramme</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0322"><i class="fa fa-check"></i><b>3.2.2</b> Graphique de densité</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0323"><i class="fa fa-check"></i><b>3.2.3</b> Nuage de points</a></li>
<li class="chapter" data-level="3.2.4" data-path="sect032.html"><a href="sect032.html#sect0324"><i class="fa fa-check"></i><b>3.2.4</b> Graphique en ligne</a></li>
<li class="chapter" data-level="3.2.5" data-path="sect032.html"><a href="sect032.html#sect0325"><i class="fa fa-check"></i><b>3.2.5</b> Boîte à moustaches</a></li>
<li class="chapter" data-level="3.2.6" data-path="sect032.html"><a href="sect032.html#sect0326"><i class="fa fa-check"></i><b>3.2.6</b> Graphique en violon</a></li>
<li class="chapter" data-level="3.2.7" data-path="sect032.html"><a href="sect032.html#sect0327"><i class="fa fa-check"></i><b>3.2.7</b> Graphique en barre</a></li>
<li class="chapter" data-level="3.2.8" data-path="sect032.html"><a href="sect032.html#sect0328"><i class="fa fa-check"></i><b>3.2.8</b> Graphique circulaire</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Graphiques spéciaux</a><ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Graphique en radar</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Diagramme d’accord</a></li>
<li class="chapter" data-level="3.3.3" data-path="sect033.html"><a href="sect033.html#sect0333"><i class="fa fa-check"></i><b>3.3.3</b> Nuage de mots</a></li>
<li class="chapter" data-level="3.3.4" data-path="sect033.html"><a href="sect033.html#sect0334"><i class="fa fa-check"></i><b>3.3.4</b> Carte proportionnelle</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Cartes</a></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Exportation des graphiques</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Conclusion sur les graphiques</a></li>
</ul></li>
<li class="part"><span><b>III Analyses bivariées</b></span></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Relation linéaire entre deux variables quantitatives</a><ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Bref retour sur le postulat de la relation linéaire</a></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Covariance</a><ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Formulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect043.html"><a href="sect043.html"><i class="fa fa-check"></i><b>4.3</b> Corrélation</a><ul>
<li class="chapter" data-level="4.3.1" data-path="sect043.html"><a href="sect043.html#sect0431"><i class="fa fa-check"></i><b>4.3.1</b> Formulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="sect043.html"><a href="sect043.html#sect0432"><i class="fa fa-check"></i><b>4.3.2</b> Interprétation</a></li>
<li class="chapter" data-level="4.3.3" data-path="sect043.html"><a href="sect043.html#sect0433"><i class="fa fa-check"></i><b>4.3.3</b> Corrélations pour des variables anormalement distribuées (coefficient de Spearman, tau de Kendall)</a></li>
<li class="chapter" data-level="4.3.4" data-path="sect043.html"><a href="sect043.html#sect0434"><i class="fa fa-check"></i><b>4.3.4</b> Corrélations robustes (<em>Biweight midcorrelation</em>, <em>Percentage bend correlation</em> et la corrélation <em>pi</em> de Shepherd)</a></li>
<li class="chapter" data-level="4.3.5" data-path="sect043.html"><a href="sect043.html#sect0435"><i class="fa fa-check"></i><b>4.3.5</b> Significativité des coefficients de corrélation</a></li>
<li class="chapter" data-level="4.3.6" data-path="sect043.html"><a href="sect043.html#sect0436"><i class="fa fa-check"></i><b>4.3.6</b> Corrélation partielle</a></li>
<li class="chapter" data-level="4.3.7" data-path="sect043.html"><a href="sect043.html#sect0437"><i class="fa fa-check"></i><b>4.3.7</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.3.8" data-path="sect043.html"><a href="sect043.html#sect0438"><i class="fa fa-check"></i><b>4.3.8</b> Comment rapporter des valeurs de corrélations?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.4</b> Régression linéaire simple</a><ul>
<li class="chapter" data-level="4.4.1" data-path="sect044.html"><a href="sect044.html#sect0441"><i class="fa fa-check"></i><b>4.4.1</b> Principe de base de la régression linéaire simple</a></li>
<li class="chapter" data-level="4.4.2" data-path="sect044.html"><a href="sect044.html#sect0442"><i class="fa fa-check"></i><b>4.4.2</b> Formulation de la droite de régression des moindres carrés ordinaires</a></li>
<li class="chapter" data-level="4.4.3" data-path="sect044.html"><a href="sect044.html#sect0443"><i class="fa fa-check"></i><b>4.4.3</b> Mesure de la qualité d’ajustement du modèle</a></li>
<li class="chapter" data-level="4.4.4" data-path="sect044.html"><a href="sect044.html#sect0444"><i class="fa fa-check"></i><b>4.4.4</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.4.5" data-path="sect044.html"><a href="sect044.html#sect0445"><i class="fa fa-check"></i><b>4.4.5</b> Comment rapporter une régression linéaire simple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Relation entre deux variables qualitatives</a><ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Construction de tableau de contingence</a></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Test du khi-deux</a></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Interprétation d’un tableau de contingence</a></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Relation entre une variable qualitative et une variable quantitative</a><ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Relation entre une variable quantitative et une variable qualitative à deux modalités</a><ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Test <em>t</em> et ses différentes variantes</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Test non paramétrique de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a><ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Analyse de variance</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Test non paramétrique de Kruskal-Wallis</a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="6.2.4" data-path="sect062.html"><a href="sect062.html#sect0624"><i class="fa fa-check"></i><b>6.2.4</b> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Conclusion sur la troisième partie</a></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>IV Modèles de régression</b></span></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Régression linéaire multiple</a><ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Principes de base de la régression linéaire multiple</a><ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Un peu d’équations…</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Hypothèses de la régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Évaluation de la qualité d’ajustement du modèle</a><ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Mesures de la qualité d’un modèle</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Comparaison des modèles incrémentiels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Différentes mesures pour les coefficients de régression</a><ul>
<li class="chapter" data-level="7.4.1" data-path="sect074.html"><a href="sect074.html#sect0741"><i class="fa fa-check"></i><b>7.4.1</b> Coefficients de régression : évaluer l’effet des variables indépendantes</a></li>
<li class="chapter" data-level="7.4.2" data-path="sect074.html"><a href="sect074.html#sect0742"><i class="fa fa-check"></i><b>7.4.2</b> Coefficients de régression standardisés : repérer les variables les plus importantes du modèle</a></li>
<li class="chapter" data-level="7.4.3" data-path="sect074.html"><a href="sect074.html#sect0743"><i class="fa fa-check"></i><b>7.4.3</b> Significativité des coefficients de régression : valeurs de <em>t</em> et de <em>p</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="sect074.html"><a href="sect074.html#sect0744"><i class="fa fa-check"></i><b>7.4.4</b> Intervalle de confiance des coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Introduction de variables explicatives particulières</a><ul>
<li class="chapter" data-level="7.5.1" data-path="sect075.html"><a href="sect075.html#sect0751"><i class="fa fa-check"></i><b>7.5.1</b> Exploration des relations non linéaires</a></li>
<li class="chapter" data-level="7.5.2" data-path="sect075.html"><a href="sect075.html#sect0752"><i class="fa fa-check"></i><b>7.5.2</b> Variable indépendante qualitative dichotomique</a></li>
<li class="chapter" data-level="7.5.3" data-path="sect075.html"><a href="sect075.html#sect0753"><i class="fa fa-check"></i><b>7.5.3</b> Variable indépendante qualitative polytomique</a></li>
<li class="chapter" data-level="7.5.4" data-path="sect075.html"><a href="sect075.html#sect0754"><i class="fa fa-check"></i><b>7.5.4</b> Variables d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sect076.html"><a href="sect076.html"><i class="fa fa-check"></i><b>7.6</b> Diagnostics de la régression</a><ul>
<li class="chapter" data-level="7.6.1" data-path="sect076.html"><a href="sect076.html#sect0761"><i class="fa fa-check"></i><b>7.6.1</b> Nombre d’observations</a></li>
<li class="chapter" data-level="7.6.2" data-path="sect076.html"><a href="sect076.html#sect0762"><i class="fa fa-check"></i><b>7.6.2</b> Normalité des résidus</a></li>
<li class="chapter" data-level="7.6.3" data-path="sect076.html"><a href="sect076.html#sect0763"><i class="fa fa-check"></i><b>7.6.3</b> Linéarité et homoscédasticité des résidus</a></li>
<li class="chapter" data-level="7.6.4" data-path="sect076.html"><a href="sect076.html#sect0764"><i class="fa fa-check"></i><b>7.6.4</b> Absence de multicolinéarité excessive</a></li>
<li class="chapter" data-level="7.6.5" data-path="sect076.html"><a href="sect076.html#sect0766"><i class="fa fa-check"></i><b>7.6.5</b> Absence d’observations aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sect077.html"><a href="sect077.html"><i class="fa fa-check"></i><b>7.7</b> Mise en œuvre dans R</a><ul>
<li class="chapter" data-level="7.7.1" data-path="sect077.html"><a href="sect077.html#sect0771"><i class="fa fa-check"></i><b>7.7.1</b> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
<li class="chapter" data-level="7.7.2" data-path="sect077.html"><a href="sect077.html#sect0772"><i class="fa fa-check"></i><b>7.7.2</b> Comparaison des modèles</a></li>
<li class="chapter" data-level="7.7.3" data-path="sect077.html"><a href="sect077.html#sect0773"><i class="fa fa-check"></i><b>7.7.3</b> Diagnostic sur un modèle</a></li>
<li class="chapter" data-level="7.7.4" data-path="sect077.html"><a href="sect077.html#sect0774"><i class="fa fa-check"></i><b>7.7.4</b> Graphiques pour les effets marginaux</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sect078.html"><a href="sect078.html"><i class="fa fa-check"></i><b>7.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Régressions linéaires généralisées (GLM)</a><ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Qu’est qu’un modèle GLM?</a><ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Formulation d’un GLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Autres distributions et rôle de la fonction de lien</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Conditions d’application</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Résidus et déviance</a></li>
<li class="chapter" data-level="8.1.5" data-path="sect081.html"><a href="sect081.html#sect0815"><i class="fa fa-check"></i><b>8.1.5</b> Vérification l’ajustement</a></li>
<li class="chapter" data-level="8.1.6" data-path="sect081.html"><a href="sect081.html#sect0816"><i class="fa fa-check"></i><b>8.1.6</b> Comparaison de deux modèles GLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Modèles GLM pour des variables qualitatives</a><ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Modèle logistique binomial</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Modèle probit binomial</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Modèle logistique des cotes proportionnelles</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Modèle logistique multinomial</a></li>
<li class="chapter" data-level="8.2.5" data-path="sect082.html"><a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives"><i class="fa fa-check"></i><b>8.2.5</b> Conclusion sur les modèles pour des variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.3</b> Modèles GLM pour des variables de comptage</a><ul>
<li class="chapter" data-level="8.3.1" data-path="sect084.html"><a href="sect084.html#sect0841"><i class="fa fa-check"></i><b>8.3.1</b> Modèle de Poisson</a></li>
<li class="chapter" data-level="8.3.2" data-path="sect084.html"><a href="sect084.html#sect0842"><i class="fa fa-check"></i><b>8.3.2</b> Modèle binomial négatif</a></li>
<li class="chapter" data-level="8.3.3" data-path="sect084.html"><a href="sect084.html#sect0843"><i class="fa fa-check"></i><b>8.3.3</b> Modèle de Poisson avec excès fixe de zéros</a></li>
<li class="chapter" data-level="8.3.4" data-path="sect084.html"><a href="sect084.html#sect0844"><i class="fa fa-check"></i><b>8.3.4</b> Modèle de Poisson avec excès ajusté de zéros</a></li>
<li class="chapter" data-level="8.3.5" data-path="sect084.html"><a href="sect084.html#sect0845"><i class="fa fa-check"></i><b>8.3.5</b> Conclusion sur les modèles destinés à des variables de comptage</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sect085.html"><a href="sect085.html"><i class="fa fa-check"></i><b>8.4</b> Modèles GLM pour des variables continues</a><ul>
<li class="chapter" data-level="8.4.1" data-path="sect085.html"><a href="sect085.html#sect0851"><i class="fa fa-check"></i><b>8.4.1</b> Modèle GLM gaussien</a></li>
<li class="chapter" data-level="8.4.2" data-path="sect085.html"><a href="sect085.html#sect0852"><i class="fa fa-check"></i><b>8.4.2</b> Modèle GLM avec une distribution de Student</a></li>
<li class="chapter" data-level="8.4.3" data-path="sect085.html"><a href="sect085.html#sect0853"><i class="fa fa-check"></i><b>8.4.3</b> Modèle GLM avec distribution Gamma</a></li>
<li class="chapter" data-level="8.4.4" data-path="sect085.html"><a href="sect085.html#sect0854"><i class="fa fa-check"></i><b>8.4.4</b> Modèle GLM avec une distribution bêta</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sect086.html"><a href="sect086.html"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="8.6" data-path="sect087.html"><a href="sect087.html"><i class="fa fa-check"></i><b>8.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Régressions à effets mixtes (GLMM)</a><ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Indépendance des observations et effets de groupes</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Terminologie: effets fixes et effets aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Principes de base des GLMM</a><ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> GLMM avec constantes aléatoires</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.2</b> GLMM avec pentes aléatoires</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.3</b> GLMM avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Conditions d’application des GLMM</a><ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Vérification de la distribution des effets aléatoires</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Homogénéité des variances au sein des groupes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Inférence dans les modèles GLMM</a><ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#sect0941"><i class="fa fa-check"></i><b>9.4.1</b> Inférence pour les effets fixes</a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#sect0942"><i class="fa fa-check"></i><b>9.4.2</b> Inférence pour les effets aléatoires, effet global</a></li>
<li class="chapter" data-level="9.4.3" data-path="sect094.html"><a href="sect094.html#sect0943"><i class="fa fa-check"></i><b>9.4.3</b> Inférence pour les effets aléatoires, des constantes et des pentes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Conclusion sur les GLMM</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Mise en œuvre des GLMM dans R</a><ul>
<li class="chapter" data-level="9.6.1" data-path="sect096.html"><a href="sect096.html#sect0961"><i class="fa fa-check"></i><b>9.6.1</b> Ajustement du modèle avec uniquement une constante aléatoire</a></li>
<li class="chapter" data-level="9.6.2" data-path="sect096.html"><a href="sect096.html#sect0962"><i class="fa fa-check"></i><b>9.6.2</b> Ajustement du modèle avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sect097.html"><a href="sect097.html"><i class="fa fa-check"></i><b>9.7</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Régressions multiniveaux</a><ul>
<li class="chapter" data-level="10.1" data-path="sect101.html"><a href="sect101.html"><i class="fa fa-check"></i><b>10.1</b> Modèles multiniveaux : deux intérêts majeurs</a><ul>
<li class="chapter" data-level="10.1.1" data-path="sect101.html"><a href="sect101.html#sect1011"><i class="fa fa-check"></i><b>10.1.1</b> Répartition de la variance entre les différents niveaux</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect101.html"><a href="sect101.html#sect1012"><i class="fa fa-check"></i><b>10.1.2</b> Estimation des coefficients aux différents niveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect102.html"><a href="sect102.html"><i class="fa fa-check"></i><b>10.2</b> Différents types de modèles multiniveaux</a><ul>
<li class="chapter" data-level="10.2.1" data-path="sect102.html"><a href="sect102.html#sect1021"><i class="fa fa-check"></i><b>10.2.1</b> Description du jeu de données utilisé</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect102.html"><a href="sect102.html#sect1022"><i class="fa fa-check"></i><b>10.2.2</b> Démarche classique pour les modèles multiniveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect103.html"><a href="sect103.html"><i class="fa fa-check"></i><b>10.3</b> Conditions d’application des régressions multiniveaux</a></li>
<li class="chapter" data-level="10.4" data-path="sect104.html"><a href="sect104.html"><i class="fa fa-check"></i><b>10.4</b> Mise en œuvre dans R</a><ul>
<li class="chapter" data-level="10.4.1" data-path="sect104.html"><a href="sect104.html#sect1041"><i class="fa fa-check"></i><b>10.4.1</b> Le modèle vide</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect104.html"><a href="sect104.html#sect1042"><i class="fa fa-check"></i><b>10.4.2</b> Modèle avec les variables indépendantes du niveau 1</a></li>
<li class="chapter" data-level="10.4.3" data-path="sect104.html"><a href="sect104.html#sect1043"><i class="fa fa-check"></i><b>10.4.3</b> Modèle avec les variables indépendantes aux niveaux 1 et 2</a></li>
<li class="chapter" data-level="10.4.4" data-path="sect104.html"><a href="sect104.html#sect10414"><i class="fa fa-check"></i><b>10.4.4</b> Modèle complet avec une interaction</a></li>
<li class="chapter" data-level="10.4.5" data-path="sect104.html"><a href="sect104.html#sect1045"><i class="fa fa-check"></i><b>10.4.5</b> Comparaison des quatre modèles</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect105.html"><a href="sect105.html"><i class="fa fa-check"></i><b>10.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> Modèles généralisés additifs</a><ul>
<li class="chapter" data-level="11.1" data-path="sect111.html"><a href="sect111.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a><ul>
<li class="chapter" data-level="11.1.1" data-path="sect111.html"><a href="sect111.html#sect1111"><i class="fa fa-check"></i><b>11.1.1</b> Non linéarité fonctionnelle</a></li>
<li class="chapter" data-level="11.1.2" data-path="sect111.html"><a href="sect111.html#sect1112"><i class="fa fa-check"></i><b>11.1.2</b> Non linéarité avec des polynomiales</a></li>
<li class="chapter" data-level="11.1.3" data-path="sect111.html"><a href="sect111.html#sect1113"><i class="fa fa-check"></i><b>11.1.3</b> Non linéarité par segments</a></li>
<li class="chapter" data-level="11.1.4" data-path="sect111.html"><a href="sect111.html#sect1114"><i class="fa fa-check"></i><b>11.1.4</b> Non linéarité avec des <em>splines</em></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sect112.html"><a href="sect112.html"><i class="fa fa-check"></i><b>11.2</b> <em>Spline</em> de régression et <em>spline</em> de lissage</a></li>
<li class="chapter" data-level="11.3" data-path="sect113.html"><a href="sect113.html"><i class="fa fa-check"></i><b>11.3</b> Interprétation d’une <em>spline</em></a></li>
<li class="chapter" data-level="11.4" data-path="sect114.html"><a href="sect114.html"><i class="fa fa-check"></i><b>11.4</b> Multicolinéarité non linéaire</a></li>
<li class="chapter" data-level="11.5" data-path="sect115.html"><a href="sect115.html"><i class="fa fa-check"></i><b>11.5</b> <em>Splines</em> avancées</a><ul>
<li class="chapter" data-level="11.5.1" data-path="sect115.html"><a href="sect115.html#sect1151"><i class="fa fa-check"></i><b>11.5.1</b> <em>Splines</em> cycliques</a></li>
<li class="chapter" data-level="11.5.2" data-path="sect115.html"><a href="sect115.html#sect1152"><i class="fa fa-check"></i><b>11.5.2</b> Splines par groupe</a></li>
<li class="chapter" data-level="11.5.3" data-path="sect115.html"><a href="sect115.html#sect1153"><i class="fa fa-check"></i><b>11.5.3</b> <em>Splines</em> multivariées et <em>splines</em> d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="sect116.html"><a href="sect116.html"><i class="fa fa-check"></i><b>11.6</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="11.7" data-path="sect117.html"><a href="sect117.html"><i class="fa fa-check"></i><b>11.7</b> GAMM</a></li>
<li class="chapter" data-level="11.8" data-path="sect118.html"><a href="sect118.html"><i class="fa fa-check"></i><b>11.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>V Analyses exploratoires multivariées</b></span></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> Méthodes factorielles</a><ul>
<li class="chapter" data-level="12.1" data-path="sect121.html"><a href="sect121.html"><i class="fa fa-check"></i><b>12.1</b> Aperçu des méthodes factorielles</a><ul>
<li class="chapter" data-level="12.1.1" data-path="sect121.html"><a href="sect121.html#sect1211"><i class="fa fa-check"></i><b>12.1.1</b> Méthodes factorielles et types de données</a></li>
<li class="chapter" data-level="12.1.2" data-path="sect121.html"><a href="sect121.html#sect1212"><i class="fa fa-check"></i><b>12.1.2</b> Bref historique des méthodes factorielles</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sect122.html"><a href="sect122.html"><i class="fa fa-check"></i><b>12.2</b> Analyses en composantes principales (ACP)</a><ul>
<li class="chapter" data-level="12.2.1" data-path="sect122.html"><a href="sect122.html#sect1221"><i class="fa fa-check"></i><b>12.2.1</b> Recherche d’une simplification</a></li>
<li class="chapter" data-level="12.2.2" data-path="sect122.html"><a href="sect122.html#sect1222"><i class="fa fa-check"></i><b>12.2.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.2.3" data-path="sect122.html"><a href="sect122.html#sect1223"><i class="fa fa-check"></i><b>12.2.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sect123.html"><a href="sect123.html"><i class="fa fa-check"></i><b>12.3</b> Analyse factorielle des correspondances (AFC)</a><ul>
<li class="chapter" data-level="12.3.1" data-path="sect123.html"><a href="sect123.html#sect1231"><i class="fa fa-check"></i><b>12.3.1</b> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
<li class="chapter" data-level="12.3.2" data-path="sect123.html"><a href="sect123.html#sect1232"><i class="fa fa-check"></i><b>12.3.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.3.3" data-path="sect123.html"><a href="sect123.html#sect1233"><i class="fa fa-check"></i><b>12.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="sect124.html"><a href="sect124.html"><i class="fa fa-check"></i><b>12.4</b> Analyse de correspondances multiples (ACM)</a><ul>
<li class="chapter" data-level="12.4.1" data-path="sect124.html"><a href="sect124.html#sect1241"><i class="fa fa-check"></i><b>12.4.1</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.4.2" data-path="sect124.html"><a href="sect124.html#sect1242"><i class="fa fa-check"></i><b>12.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="sect125.html"><a href="sect125.html"><i class="fa fa-check"></i><b>12.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> Méthodes de classification non supervisée</a><ul>
<li class="chapter" data-level="13.1" data-path="sect131.html"><a href="sect131.html"><i class="fa fa-check"></i><b>13.1</b> Méthodes de classification : un aperçu</a></li>
<li class="chapter" data-level="13.2" data-path="sect132.html"><a href="sect132.html"><i class="fa fa-check"></i><b>13.2</b> Notions essentielles en classification</a><ul>
<li class="chapter" data-level="13.2.1" data-path="sect132.html"><a href="sect132.html#sect1321"><i class="fa fa-check"></i><b>13.2.1</b> Distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="sect132.html"><a href="sect132.html#sect1322"><i class="fa fa-check"></i><b>13.2.2</b> Inertie</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="sect133.html"><a href="sect133.html"><i class="fa fa-check"></i><b>13.3</b> Classification ascendante hiérarchique</a><ul>
<li class="chapter" data-level="13.3.1" data-path="sect133.html"><a href="sect133.html#sect1331"><i class="fa fa-check"></i><b>13.3.1</b> Fonctionnement de l’algorithme</a></li>
<li class="chapter" data-level="13.3.2" data-path="sect133.html"><a href="sect133.html#sect1332"><i class="fa fa-check"></i><b>13.3.2</b> Choisir le bon nombre de groupes</a></li>
<li class="chapter" data-level="13.3.3" data-path="sect133.html"><a href="sect133.html#sect1333"><i class="fa fa-check"></i><b>13.3.3</b> Limites de la classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="13.3.4" data-path="sect133.html"><a href="sect133.html#sect1334"><i class="fa fa-check"></i><b>13.3.4</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sect134.html"><a href="sect134.html"><i class="fa fa-check"></i><b>13.4</b> Nuées dynamiques</a><ul>
<li class="chapter" data-level="13.4.1" data-path="sect134.html"><a href="sect134.html#sect1341"><i class="fa fa-check"></i><b>13.4.1</b> <em>K-means</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="sect134.html"><a href="sect134.html#sect1342"><i class="fa fa-check"></i><b>13.4.2</b> K-médianes</a></li>
<li class="chapter" data-level="13.4.3" data-path="sect134.html"><a href="sect134.html#sect1343"><i class="fa fa-check"></i><b>13.4.3</b> K-médoïds</a></li>
<li class="chapter" data-level="13.4.4" data-path="sect134.html"><a href="sect134.html#sect1344"><i class="fa fa-check"></i><b>13.4.4</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="13.4.5" data-path="sect134.html"><a href="sect134.html#sect1346"><i class="fa fa-check"></i><b>13.4.5</b> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sect135.html"><a href="sect135.html"><i class="fa fa-check"></i><b>13.5</b> Conclusion sur la cinquième partie</a></li>
<li class="chapter" data-level="13.6" data-path="sect136.html"><a href="sect136.html"><i class="fa fa-check"></i><b>13.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="annexes.html"><a href="annexes.html"><i class="fa fa-check"></i><b>14</b> Annexes</a><ul>
<li class="chapter" data-level="14.1" data-path="annexe1.html"><a href="annexe1.html"><i class="fa fa-check"></i><b>14.1</b> Table des valeurs critiques de khi-deux</a></li>
<li class="chapter" data-level="14.2" data-path="annexe2.html"><a href="annexe2.html"><i class="fa fa-check"></i><b>14.2</b> Table des valeurs critiques de Fisher</a></li>
<li class="chapter" data-level="14.3" data-path="annexe3.html"><a href="annexe3.html"><i class="fa fa-check"></i><b>14.3</b> Table des valeurs critiques de <em>t</em></a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect085" class="section level2">
<h2><span class="header-section-number">8.4</span> Modèles GLM pour des variables continues</h2>
<p>Comme nous l’avons vu dans la section <a href="sect024.html#sect024">2.4</a>, il existe un grand nombre de distributions permettant de décrire une grande diversité de variables continues. Il serait fastidieux de toutes les présenter, nous revenons donc seulement sur les plus fréquentes.</p>
<div id="sect0851" class="section level3">
<h3><span class="header-section-number">8.4.1</span> Modèle GLM gaussien</h3>
<p>Comme nous l’avons vu en introduction, le modèle GLM gaussien est le plus simple puisqu’il correspond à la transposition de la régression linéaire classique (des moindres carrés) dans la forme des modèles généralisés.</p>
<table>
<caption>
<span id="tab:gaussiandentity">Tableau 8.29: </span>Carte d’identité du modèle gaussien
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable continue dans l’intervalle <span class="math inline">\(]-\infty ; + \infty[\)</span>
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Normale
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim Normal(\mu,\sigma)\)</span> <br/> <span class="math inline">\(g(\mu) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(g(x) = x\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
Identitaire
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
<span class="math inline">\(\mu\)</span>
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span> et <span class="math inline">\(\sigma\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Homoscédasticité
</td>
</tr>
</tbody>
</table>
<div id="conditions-dapplication-4" class="section level4">
<h4><span class="header-section-number">8.4.1.1</span> Conditions d’application</h4>
<p>Les conditions d’application sont les mêmes que celles d’une régression linéaire classique. La condition de l’homoscédasticité (homogénéité de la variance) est due au fait que la variance du modèle est contrôlée par un seul paramètre fixe <span class="math inline">\(var(y) = \sigma\)</span> (l’écart-type de la distribution normale). À titre de comparaison, rappelons que dans un modèle de Poisson, la variance est égale à la moyenne (<span class="math inline">\(var(y) = E(y)\)</span>) alors que dans un modèle binomial négatif, la variance est fonction de la moyenne et d’un paramètre <span class="math inline">\(\theta\)</span> (<span class="math inline">\(var(y) = E(y) + E(y)^{\frac{2}{\theta}}\)</span>). Pour ces deux exemples, la variance augmente au fur et à mesure que la moyenne augmente.</p>
</div>
<div id="interprétation-des-paramètres-4" class="section level4">
<h4><span class="header-section-number">8.4.1.2</span> Interprétation des paramètres</h4>
<p>L’interprétation des paramètres est la même que pour une régression linéaire classique :</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> : la constante, soit la moyenne attendue de la variable <em>Y</em> lorsque les valeurs de toutes les variables <em>X</em> sont 0.</li>
<li><span class="math inline">\(\beta\)</span> : les coefficients de régression qui quantifient l’effet d’une augmentation d’une unité des variables <em>X</em> sur la moyenne de la variable <em>Y</em>.</li>
<li><span class="math inline">\(\sigma\)</span> : l’écart-type de <em>Y</em> après avoir contrôlé les variables <em>X</em>. Il peut s’interpréter comme l’incertitude restante après modélisation de la moyenne de <em>Y</em>. Concrètement, si vous utilisez votre équation de régression pour prédire une nouvelle valeur de <em>Y</em> : <span class="math inline">\(\hat{Y}\)</span>, l’intervalle de confiance à 95 % de cette prédiction est (<span class="math inline">\(\hat{Y} - 3\sigma\text{ ; }\hat{Y} + 3\sigma\)</span>). Vous noterez donc que plus <span class="math inline">\(\sigma\)</span> est grand, plus grande est l’incertitude de la prédiction.</li>
</ul>
</div>
<div id="exemple-appliqué-dans-r-5" class="section level4">
<h4><span class="header-section-number">8.4.1.3</span> Exemple appliqué dans R</h4>
<p>Pour cet exemple, nous reprenons le modèle LM que nous avons présenté dans la section <a href="sect077.html#sect077">7.7</a>. À titre de rappel, l’objectif est de modéliser la densité végétale dans les secteurs de recensement de Montréal. Pour cela, nous utilisons des variables relatives aux populations vulnérables physiologiquement ou socioéconomiquement, tout en contrôlant l’effet de la forme urbaine. Parmi ces dernières, l’âge médian des bâtiments est ajouté au modèle avec une polynomiale d’ordre deux, et la densité d’habitants est transformée avec la fonction logarithmique.</p>
<p><strong>Vérification des conditions d’application</strong></p>
<p>La première étape de la vérification des conditions d’application est bien sûr de s’assurer de l’absence de multicolinéarité excessive.</p>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="sect085.html#cb894-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb894-2"><a href="sect085.html#cb894-2"></a><span class="kw">load</span>(<span class="st">&quot;data/lm/DataVegetation.RData&quot;</span>)</span>
<span id="cb894-3"><a href="sect085.html#cb894-3"></a><span class="co"># Calcul du VIF</span></span>
<span id="cb894-4"><a href="sect085.html#cb894-4"></a><span class="kw">library</span>(car)</span>
<span id="cb894-5"><a href="sect085.html#cb894-5"></a><span class="kw">vif</span>(<span class="kw">glm</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb894-6"><a href="sect085.html#cb894-6"></a><span class="st">                       </span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR, <span class="dt">data =</span> DataFinal))</span></code></pre></div>
<pre><code>##                        GVIF Df GVIF^(1/(2*Df))
## log(HABHA)         1.289495  1        1.135559
## poly(AgeMedian, 2) 1.387429  2        1.085307
## Pct_014            1.517957  1        1.232054
## Pct_65P            1.304094  1        1.141969
## Pct_MV             1.480275  1        1.216666
## Pct_FR             1.729646  1        1.315160</code></pre>
<p>Puisque l’ensemble des valeurs de VIF sont inférieures à deux, nos données ne sont pas marquées par une multicolinéarité problématique. La seconde étape du diagnostic consiste à calculer et à afficher les distances de Cook.</p>
<div class="figure" style="text-align: center"><span id="fig:gausscook"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/gausscook-1.png" alt="Distances de Cook pour le modèle gaussien" width="65%" />
<p class="caption">
Figure 8.40: Distances de Cook pour le modèle gaussien
</p>
</div>
<p>La figure <a href="sect085.html#fig:gausscook">8.40</a> indique clairement que quatre observations sont très influentes dans le modèle.</p>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="sect085.html#cb896-1"></a><span class="co"># Sélection des cas étranges</span></span>
<span id="cb896-2"><a href="sect085.html#cb896-2"></a>cas_etranges &lt;-<span class="st"> </span><span class="kw">subset</span>(DataFinal, cooksd <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.03</span>)</span>
<span id="cb896-3"><a href="sect085.html#cb896-3"></a><span class="kw">print</span>(cas_etranges)</span></code></pre></div>
<pre><code>##      VegPct ArbPct V250Pct V500Pct A250Pct A500Pct      HABHA AgeMedian Pct_014
## 3374 10.481  5.478  18.987  13.744   2.908   2.704  74.835867       226    4.76
## 3378  0.000  0.000  12.709  12.505   2.116   2.324  88.006946       206    6.25
## 4446 23.162  5.209  31.437  31.535   8.672   9.108 313.142733       206   14.40
## 9088 85.767 27.583  78.195  83.492  42.999  51.074   2.070472       207   12.00
##      Pct_65P Pct_MV Pct_FR DistCBDkm   SDRNOM
## 3374   14.29  23.81  14.29     0.748 Montréal
## 3378   12.50  25.00  12.50     0.706 Montréal
## 4446   16.87  53.50  42.39     8.678 Montréal
## 9088   24.00  12.00  16.00    28.440 Montréal</code></pre>
<p>Il s’agit de quatre îlots dans Montréal avec des logements très anciens : plus de 200 ans, alors que la moyenne est de 52 ans pour le reste de la zone d’étude. Le fait que nous ayons dans le modèle une polynomiale d’ordre 2 pour cette variable intensifie l’influence de ces valeurs extrêmes. Par conséquent, nous décidons de simplement les supprimer. Nous verrons plus tard qu’une alternative envisageable est de changer la distribution du modèle pour une distribution de Student (plus robuste aux valeurs extrêmes).</p>
<div class="figure" style="text-align: center"><span id="fig:gausscook2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/gausscook2-1.png" alt="Distances de Cook pour le modèle gaussien après suppression des observations influentes" width="65%" />
<p class="caption">
Figure 8.41: Distances de Cook pour le modèle gaussien après suppression des observations influentes
</p>
</div>
<p>Une fois ces observations retirées, les nouvelles distances de Cook (figure <a href="sect085.html#fig:gausscook2">8.41</a>) ne révèlent plus d’observations fortement influentes. Nous pouvons passer à l’analyse des résidus simulés. La figure <a href="sect085.html#fig:gaussresid">8.42</a> démontre que la distribution des résidus est significativement différente d’une distribution uniforme, que des valeurs aberrantes sont encore présentes et qu’il existe un lien entre résidus et prédiction dans le modèle.</p>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="sect085.html#cb898-1"></a><span class="co"># Extraction des prédictions du modèle</span></span>
<span id="cb898-2"><a href="sect085.html#cb898-2"></a>mus &lt;-<span class="st"> </span><span class="kw">predict</span>(modele, <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb898-3"><a href="sect085.html#cb898-3"></a>modsigma &lt;-<span class="st"> </span><span class="kw">sigma</span>(modele)</span>
<span id="cb898-4"><a href="sect085.html#cb898-4"></a><span class="co"># Extraction de l&#39;écart type du modèle</span></span>
<span id="cb898-5"><a href="sect085.html#cb898-5"></a><span class="co"># Génération de 1000 simulations pour chaque prédiction</span></span>
<span id="cb898-6"><a href="sect085.html#cb898-6"></a>nsim &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb898-7"><a href="sect085.html#cb898-7"></a>cols &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mus),<span class="cf">function</span>(i){</span>
<span id="cb898-8"><a href="sect085.html#cb898-8"></a>  mu &lt;-<span class="st"> </span>mus[[i]]</span>
<span id="cb898-9"><a href="sect085.html#cb898-9"></a>  sims &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsim, <span class="dt">mean=</span>mu, <span class="dt">sd =</span> modsigma)</span>
<span id="cb898-10"><a href="sect085.html#cb898-10"></a>  <span class="kw">return</span>(sims)</span>
<span id="cb898-11"><a href="sect085.html#cb898-11"></a>})</span>
<span id="cb898-12"><a href="sect085.html#cb898-12"></a>mat_sims &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, cols)</span>
<span id="cb898-13"><a href="sect085.html#cb898-13"></a><span class="co"># Calculer les résidus simulés</span></span>
<span id="cb898-14"><a href="sect085.html#cb898-14"></a>sim_res &lt;-<span class="st"> </span><span class="kw">createDHARMa</span>(<span class="dt">simulatedResponse =</span> mat_sims, </span>
<span id="cb898-15"><a href="sect085.html#cb898-15"></a>                            <span class="dt">observedResponse =</span> DataFinal2<span class="op">$</span>VegPct,</span>
<span id="cb898-16"><a href="sect085.html#cb898-16"></a>                            <span class="dt">fittedPredictedResponse =</span> mus,</span>
<span id="cb898-17"><a href="sect085.html#cb898-17"></a>                            <span class="dt">integerResponse =</span> F)</span>
<span id="cb898-18"><a href="sect085.html#cb898-18"></a><span class="kw">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gaussresid"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/gaussresid-1.png" alt="Diagnostic général des résidus simulés pour le modèle gaussien" width="65%" />
<p class="caption">
Figure 8.42: Diagnostic général des résidus simulés pour le modèle gaussien
</p>
</div>
<p>Pour mieux cerner ce problème, nous pouvons, dans un premier temps, comparer la distribution originale des données et les simulations issues du modèle. La figure <a href="sect085.html#fig:gausssim">8.43</a> montre clairement que la distribution normale est mal ajustée aux données. Ces dernières sont légèrement asymétriques et ne peuvent pas être inférieures à zéro, ce que la distribution normale ne parvient pas à reproduire.</p>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="sect085.html#cb899-1"></a>df &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(mat_sims[,<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>])</span>
<span id="cb899-2"><a href="sect085.html#cb899-2"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb899-3"><a href="sect085.html#cb899-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">data =</span> DataFinal2, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> VegPct, <span class="dt">y =</span> ..density..),</span>
<span id="cb899-4"><a href="sect085.html#cb899-4"></a>                 <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">50</span>)<span class="op">+</span></span>
<span id="cb899-5"><a href="sect085.html#cb899-5"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">group =</span> Var2), </span>
<span id="cb899-6"><a href="sect085.html#cb899-6"></a>               <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>), <span class="dt">fill =</span> <span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))<span class="op">+</span></span>
<span id="cb899-7"><a href="sect085.html#cb899-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Pourcentage de végétation dans l&#39;îlot (%)&quot;</span>,</span>
<span id="cb899-8"><a href="sect085.html#cb899-8"></a>  <span class="dt">y =</span> <span class="st">&quot;Densité&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gausssim"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/gausssim-1.png" alt="Comparaison de la distribution originale de la variable et des simulations issues du modèle" width="65%" />
<p class="caption">
Figure 8.43: Comparaison de la distribution originale de la variable et des simulations issues du modèle
</p>
</div>
<p>Il est également possible de vérifier si la condition d’homogénéité de la variance s’applique bien aux données.</p>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="sect085.html#cb900-1"></a><span class="co"># Extraction des prédictions du modèle</span></span>
<span id="cb900-2"><a href="sect085.html#cb900-2"></a>mus &lt;-<span class="st"> </span><span class="kw">predict</span>(modele, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb900-3"><a href="sect085.html#cb900-3"></a>sigma_model &lt;-<span class="st"> </span><span class="kw">sigma</span>(modele)</span>
<span id="cb900-4"><a href="sect085.html#cb900-4"></a><span class="co"># Création d&#39;un DataFrame pour contenir les prédictions et les vraies valeurs</span></span>
<span id="cb900-5"><a href="sect085.html#cb900-5"></a>df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb900-6"><a href="sect085.html#cb900-6"></a>  <span class="dt">mus =</span> mus,</span>
<span id="cb900-7"><a href="sect085.html#cb900-7"></a>  <span class="dt">reals =</span> DataFinal2<span class="op">$</span>VegPct</span>
<span id="cb900-8"><a href="sect085.html#cb900-8"></a>)</span>
<span id="cb900-9"><a href="sect085.html#cb900-9"></a><span class="co"># Calcul de l&#39;intervalle de confiance à 95 % selon la distribution normale</span></span>
<span id="cb900-10"><a href="sect085.html#cb900-10"></a><span class="co"># et stockage dans un second DataFrame</span></span>
<span id="cb900-11"><a href="sect085.html#cb900-11"></a>seqa &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>)</span>
<span id="cb900-12"><a href="sect085.html#cb900-12"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb900-13"><a href="sect085.html#cb900-13"></a>  <span class="dt">mus =</span> seqa,</span>
<span id="cb900-14"><a href="sect085.html#cb900-14"></a>  <span class="dt">lower =</span> <span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.025</span>, <span class="dt">mean =</span> seqa, <span class="dt">sd =</span> sigma_model),</span>
<span id="cb900-15"><a href="sect085.html#cb900-15"></a>  <span class="dt">upper =</span> <span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="fl">0.975</span>, <span class="dt">mean =</span> seqa, <span class="dt">sd =</span> sigma_model)</span>
<span id="cb900-16"><a href="sect085.html#cb900-16"></a>)</span>
<span id="cb900-17"><a href="sect085.html#cb900-17"></a></span>
<span id="cb900-18"><a href="sect085.html#cb900-18"></a><span class="co"># Affichage des valeurs réelles et prédites (en rouge)</span></span>
<span id="cb900-19"><a href="sect085.html#cb900-19"></a><span class="co"># et de leur variance selon le modèle (en noir)</span></span>
<span id="cb900-20"><a href="sect085.html#cb900-20"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb900-21"><a href="sect085.html#cb900-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> df1, </span>
<span id="cb900-22"><a href="sect085.html#cb900-22"></a>             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mus, <span class="dt">y =</span> reals),</span>
<span id="cb900-23"><a href="sect085.html#cb900-23"></a>             <span class="dt">color =</span><span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb900-24"><a href="sect085.html#cb900-24"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> df2,</span>
<span id="cb900-25"><a href="sect085.html#cb900-25"></a>                <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mus, <span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper),</span>
<span id="cb900-26"><a href="sect085.html#cb900-26"></a>                <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb900-27"><a href="sect085.html#cb900-27"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;valeurs prédites&#39;</span>,</span>
<span id="cb900-28"><a href="sect085.html#cb900-28"></a>       <span class="dt">y =</span> <span class="st">&quot;valeurs réelles&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gausssim2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/gausssim2-1.png" alt="Comparaison de la distribution originale de la variable et des simulations issues du modèle" width="65%" />
<p class="caption">
Figure 8.44: Comparaison de la distribution originale de la variable et des simulations issues du modèle
</p>
</div>
<p>À nouveau, nous constatons à la figure <a href="sect085.html#fig:gausssim2">8.44</a> que le modèle s’attend à trouver des valeurs négatives pour la concentration de végétation, ce qui n’est pas possible dans notre cas. En revanche, il semble que la variance soit bien homogène puisque la dispersion des observations semble suivre à peu près la dispersion attendue par le modèle (en noir).</p>
<p>Malgré ces différents constats indiquant clairement qu’un modèle gaussien est un choix sous-optimal pour ces données, nous poursuivons l’analyse de ce modèle.</p>
<p><strong>Vérification de la qualité d’ajustement</strong></p>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="sect085.html#cb901-1"></a><span class="co"># Ajustement d&#39;un modèle nul</span></span>
<span id="cb901-2"><a href="sect085.html#cb901-2"></a>modelenull &lt;-<span class="st"> </span><span class="kw">glm</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb901-3"><a href="sect085.html#cb901-3"></a>                  <span class="dt">data =</span> DataFinal2, </span>
<span id="cb901-4"><a href="sect085.html#cb901-4"></a>                  <span class="dt">family =</span> <span class="kw">gaussian</span>())</span>
<span id="cb901-5"><a href="sect085.html#cb901-5"></a><span class="co"># Calcul des pseudo R2</span></span>
<span id="cb901-6"><a href="sect085.html#cb901-6"></a><span class="kw">rsqs</span>(<span class="dt">loglike.full =</span> <span class="kw">logLik</span>(modele),</span>
<span id="cb901-7"><a href="sect085.html#cb901-7"></a>     <span class="dt">loglike.null =</span> <span class="kw">logLik</span>(modelenull),</span>
<span id="cb901-8"><a href="sect085.html#cb901-8"></a>     <span class="dt">full.deviance =</span> <span class="kw">deviance</span>(modele),</span>
<span id="cb901-9"><a href="sect085.html#cb901-9"></a>     <span class="dt">null.deviance =</span> <span class="kw">deviance</span>(modelenull), </span>
<span id="cb901-10"><a href="sect085.html#cb901-10"></a>     <span class="dt">nb.params =</span> modele<span class="op">$</span>rank,</span>
<span id="cb901-11"><a href="sect085.html#cb901-11"></a>     <span class="dt">n =</span> <span class="kw">nrow</span>(DataFinal2)</span>
<span id="cb901-12"><a href="sect085.html#cb901-12"></a>     )</span></code></pre></div>
<pre><code>## $`deviance expliquee`
## [1] 0.4706321
## 
## $`McFadden ajuste`
## &#39;log Lik.&#39; 0.07310662 (df=9)
## 
## $`Cox and Snell`
## &#39;log Lik.&#39; 0.4706321 (df=9)
## 
## $Nagelkerke
## &#39;log Lik.&#39; 0.4707122 (df=9)</code></pre>
<p>Le modèle parvient à expliquer 47 % de la déviance totale, mais obtient un R<sup>2</sup> ajusté de McFadden de seulement 0,07.</p>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="sect085.html#cb903-1"></a><span class="co"># Calcul du RMSE</span></span>
<span id="cb903-2"><a href="sect085.html#cb903-2"></a><span class="kw">sqrt</span>(<span class="kw">mean</span>((<span class="kw">predict</span>(modele, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>) <span class="op">-</span><span class="st"> </span>DataFinal2<span class="op">$</span>VegPct)<span class="op">**</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 13.49885</code></pre>
<p>L’erreur quadratique moyenne et de 13,5 points de pourcentage, ce qui indique que le modèle a une assez faible capacité prédictive.</p>
<p><strong>Interprétation des résultats</strong></p>
<p>L’ensemble des coefficients du modèle sont accessibles via la fonction <code>summary</code>; le tableau <a href="sect085.html#tab:tableaugauss">8.30</a> présente les résultats pour les coefficients du modèle.</p>
<table>
<caption>
<span id="tab:tableaugauss">Tableau 8.30: </span>Résultats du modèle gaussien
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coeff.
</th>
<th style="text-align:right;">
Err.std
</th>
<th style="text-align:right;">
Val.z
</th>
<th style="text-align:right;">
val.p
</th>
<th style="text-align:right;">
IC coeff 2,5 %
</th>
<th style="text-align:right;">
IC coeff 97,5 %
</th>
<th style="text-align:right;">
Sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Constante
</td>
<td style="text-align:right;">
53,606
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
53,640
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
51,647
</td>
<td style="text-align:right;">
55,565
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
AgeMedian ordre 1
</td>
<td style="text-align:right;">
2,732
</td>
<td style="text-align:right;">
15,560
</td>
<td style="text-align:right;">
0,180
</td>
<td style="text-align:right;">
0,861
</td>
<td style="text-align:right;">
-27,772
</td>
<td style="text-align:right;">
33,237
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
AgeMedian ordre 2
</td>
<td style="text-align:right;">
-320,869
</td>
<td style="text-align:right;">
14,000
</td>
<td style="text-align:right;">
-22,910
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
-348,318
</td>
<td style="text-align:right;">
-293,420
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_014
</td>
<td style="text-align:right;">
0,915
</td>
<td style="text-align:right;">
0,030
</td>
<td style="text-align:right;">
29,310
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,853
</td>
<td style="text-align:right;">
0,976
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_65P
</td>
<td style="text-align:right;">
0,280
</td>
<td style="text-align:right;">
0,020
</td>
<td style="text-align:right;">
15,050
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,243
</td>
<td style="text-align:right;">
0,316
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_MV
</td>
<td style="text-align:right;">
-0,042
</td>
<td style="text-align:right;">
0,010
</td>
<td style="text-align:right;">
-4,190
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
-0,061
</td>
<td style="text-align:right;">
-0,022
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_FR
</td>
<td style="text-align:right;">
-0,340
</td>
<td style="text-align:right;">
0,010
</td>
<td style="text-align:right;">
-30,940
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
-0,362
</td>
<td style="text-align:right;">
-0,318
</td>
<td style="text-align:right;">
***
</td>
</tr>
</tbody>
</table>
<p>Les résultats de la régression linéaire multiple ont déjà été interprétés dans la section <a href="sect077.html#sect0771">7.7.1</a>, nous ne commenterons pas ici les résultats du modèle GLM gaussien qui sont identiques.</p>
</div>
</div>
<div id="sect0852" class="section level3">
<h3><span class="header-section-number">8.4.2</span> Modèle GLM avec une distribution de Student</h3>
<p>Pour rappel, la distribution de Student ressemble à une distribution normale (section <a href="sect024.html#sect024311">2.4.3.11</a>). Elle est symétrique autour de sa moyenne et a également une forme de cloche. Cependant, elle dispose de queues lourdes, ce qui signifie qu’elle permet de représenter des phénomènes présentant davantage de valeurs extrêmes qu’une distribution normale. Pour contrôler le poids des queues, la distribution de Student intègre un troisième paramètre : <span class="math inline">\(\nu\)</span> (nu). Lorsque <span class="math inline">\(\nu\)</span> tends vers l’infini, la distribution de Student tend vers une distribution normale (figure <a href="sect085.html#fig:studentdistrib">8.45</a>).</p>
<div class="figure"><span id="fig:studentdistrib"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/studentdistrib-1.png" alt="Effet du paramètre nu sur une distribution de Student" width="65%" />
<p class="caption">
Figure 8.45: Effet du paramètre nu sur une distribution de Student
</p>
</div>
<p>Comme vous pouvez le constater dans la carte d’identité au tableau <a href="sect085.html#tab:studentdentity">8.31</a>, le modèle GLM de Student est très proche du modèle GLM gaussien. Nous modélisons explicitement la moyenne de la distribution et son paramètre de dispersion (variance) est laissé fixe. Ce GLM est même souvent utilisé comme une version « robuste » du modèle gaussien du fait de sa capacité à intégrer explicitement l’effet des observations extrêmes. En effet, dans un modèle gaussien, les observations extrêmes (aussi appelées observations aberrantes) vont davantage influencer les paramètres du modèle que pour un modèle utilisant une distribution de Student.</p>
<table>
<caption>
<span id="tab:studentdentity">Tableau 8.31: </span>Carte d’identité du modèle de Student
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable continue dans l’intervalle <span class="math inline">\(]-\infty ; + \infty[\)</span>
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Student
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim Student(\mu,\sigma,\nu)\)</span> <br/> <span class="math inline">\(g(\mu) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(g(x) = x\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
Identitaire
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
<span class="math inline">\(\mu\)</span>
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\sigma\)</span> et <span class="math inline">\(\nu\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
Homoscédasticité
</td>
</tr>
</tbody>
</table>
<div id="conditions-dapplication-5" class="section level4">
<h4><span class="header-section-number">8.4.2.1</span> Conditions d’application</h4>
<p>Les conditions d’application sont les mêmes que pour un modèle GLM gaussien, à ceci prêt que le modèle utilisant la distribution de Student est moins sensible aux observations extrêmes.</p>
</div>
<div id="interprétation-des-paramètres-5" class="section level4">
<h4><span class="header-section-number">8.4.2.2</span> Interprétation des paramètres</h4>
<p>L’interprétation des paramètres est la même que pour un modèle gaussien puisque nous modélisons la moyenne de la distribution et que la fonction de lien est la fonction identitaire. Le seul paramètre supplémentaire est <span class="math inline">\(\nu\)</span>, qui n’a en soit aucune interprétation pratique. Notez simplement que si <span class="math inline">\(\nu\)</span> est supérieur à 30, un simple modèle GLM gaussien serait sûrement suffisant.</p>
</div>
<div id="exemple-appliqué-dans-r-6" class="section level4">
<h4><span class="header-section-number">8.4.2.3</span> Exemple appliqué dans R</h4>
<p>Nous proposons ici de simplement réajuster le modèle gaussien présenté dans la section précédente en utilisant une distribution de Student. Nous utilisons pour cela la fonction <code>gam</code> du <em>package</em> <code>mgcv</code> avec le paramètre <code>family=scat</code> pour utiliser une distribution de Student. Les valeurs de VIF ont déjà été calculées dans l’exemple précédent, nous pouvons donc passer directement au calcul des distances de Cook.</p>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="sect085.html#cb905-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb905-2"><a href="sect085.html#cb905-2"></a><span class="kw">load</span>(<span class="st">&quot;data/lm/DataVegetation.RData&quot;</span>)</span>
<span id="cb905-3"><a href="sect085.html#cb905-3"></a><span class="co"># Ajustement du modèle</span></span>
<span id="cb905-4"><a href="sect085.html#cb905-4"></a>modele &lt;-<span class="st"> </span><span class="kw">gam</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb905-5"><a href="sect085.html#cb905-5"></a><span class="st">                       </span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR, <span class="dt">data =</span> DataFinal,</span>
<span id="cb905-6"><a href="sect085.html#cb905-6"></a>              <span class="dt">family =</span> scat)</span>
<span id="cb905-7"><a href="sect085.html#cb905-7"></a></span>
<span id="cb905-8"><a href="sect085.html#cb905-8"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb905-9"><a href="sect085.html#cb905-9"></a>cooksd &lt;-<span class="st"> </span><span class="kw">cooks.distance</span>(modele)</span>
<span id="cb905-10"><a href="sect085.html#cb905-10"></a><span class="co"># Affichage des valeurs</span></span>
<span id="cb905-11"><a href="sect085.html#cb905-11"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb905-12"><a href="sect085.html#cb905-12"></a>  <span class="dt">cook =</span> cooksd,</span>
<span id="cb905-13"><a href="sect085.html#cb905-13"></a>  <span class="dt">oid =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(cooksd)</span>
<span id="cb905-14"><a href="sect085.html#cb905-14"></a>)</span>
<span id="cb905-15"><a href="sect085.html#cb905-15"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df) <span class="op">+</span><span class="st"> </span></span>
<span id="cb905-16"><a href="sect085.html#cb905-16"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> oid, <span class="dt">y =</span> cook), <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.7</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb905-17"><a href="sect085.html#cb905-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;distance de Cook&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:stucookdist"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/stucookdist-1.png" alt="Distances de Cook pour un modèle GLM avec une distribution de Student" width="50%" />
<p class="caption">
Figure 8.46: Distances de Cook pour un modèle GLM avec une distribution de Student
</p>
</div>
<p>Nous retrouvons les quatre observations avec des distances de Cook très fortes que nous avons identifiées dans le modèle gaussien. Nous décidons donc de les enlever pour les mêmes raisons que précédemment.</p>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="sect085.html#cb906-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb906-2"><a href="sect085.html#cb906-2"></a>DataFinal2 &lt;-<span class="st"> </span><span class="kw">subset</span>(DataFinal, cooksd<span class="op">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb906-3"><a href="sect085.html#cb906-3"></a><span class="co"># Ajustement du modèle</span></span>
<span id="cb906-4"><a href="sect085.html#cb906-4"></a>modele &lt;-<span class="st"> </span><span class="kw">gam</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb906-5"><a href="sect085.html#cb906-5"></a><span class="st">                       </span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR, <span class="dt">data =</span> DataFinal2,</span>
<span id="cb906-6"><a href="sect085.html#cb906-6"></a>              <span class="dt">family =</span> scat)</span>
<span id="cb906-7"><a href="sect085.html#cb906-7"></a></span>
<span id="cb906-8"><a href="sect085.html#cb906-8"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb906-9"><a href="sect085.html#cb906-9"></a>cooksd &lt;-<span class="st"> </span><span class="kw">cooks.distance</span>(modele)</span>
<span id="cb906-10"><a href="sect085.html#cb906-10"></a><span class="co"># Affichage des valeurs</span></span>
<span id="cb906-11"><a href="sect085.html#cb906-11"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb906-12"><a href="sect085.html#cb906-12"></a>  <span class="dt">cook =</span> cooksd,</span>
<span id="cb906-13"><a href="sect085.html#cb906-13"></a>  <span class="dt">oid =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(cooksd)</span>
<span id="cb906-14"><a href="sect085.html#cb906-14"></a>)</span>
<span id="cb906-15"><a href="sect085.html#cb906-15"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df) <span class="op">+</span><span class="st"> </span></span>
<span id="cb906-16"><a href="sect085.html#cb906-16"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> oid, <span class="dt">y =</span> cook), <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.7</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb906-17"><a href="sect085.html#cb906-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;distance de Cook&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:stucookdist2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/stucookdist2-1.png" alt="Distances de Cook pour un modèle GLM avec une distribution de Student après suppression des valeurs fortement influentes" width="50%" />
<p class="caption">
Figure 8.47: Distances de Cook pour un modèle GLM avec une distribution de Student après suppression des valeurs fortement influentes
</p>
</div>
<p>Nous pouvons à présent vérifier si les résidus simulés se comportent tel qu’attendu.</p>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="sect085.html#cb907-1"></a><span class="co"># Extraction des prédictions du modèle</span></span>
<span id="cb907-2"><a href="sect085.html#cb907-2"></a>mus &lt;-<span class="st"> </span><span class="kw">predict</span>(modele, <span class="dt">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb907-3"><a href="sect085.html#cb907-3"></a><span class="co"># Affichage des paramètres nu et sigma</span></span>
<span id="cb907-4"><a href="sect085.html#cb907-4"></a>modele<span class="op">$</span>family<span class="op">$</span>family</span></code></pre></div>
<pre><code>## [1] &quot;Scaled t(6.333,11.281)&quot;</code></pre>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="sect085.html#cb909-1"></a>sigma_model &lt;-<span class="st"> </span><span class="fl">11.281</span></span>
<span id="cb909-2"><a href="sect085.html#cb909-2"></a>nu_model &lt;-<span class="st"> </span><span class="fl">6.333</span></span>
<span id="cb909-3"><a href="sect085.html#cb909-3"></a><span class="kw">library</span>(LaplacesDemon) <span class="co"># pour simuler des données d&#39;une distribution de Student</span></span>
<span id="cb909-4"><a href="sect085.html#cb909-4"></a><span class="co"># Génération de 1000 simulations pour chaque prédiction</span></span>
<span id="cb909-5"><a href="sect085.html#cb909-5"></a>nsim &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb909-6"><a href="sect085.html#cb909-6"></a>cols &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mus),<span class="cf">function</span>(i){</span>
<span id="cb909-7"><a href="sect085.html#cb909-7"></a>  mu &lt;-<span class="st"> </span>mus[[i]]</span>
<span id="cb909-8"><a href="sect085.html#cb909-8"></a>  sims &lt;-<span class="st"> </span><span class="kw">rst</span>(nsim, <span class="dt">mu=</span>mu, <span class="dt">sigma =</span> sigma_model, <span class="dt">nu =</span> nu_model)</span>
<span id="cb909-9"><a href="sect085.html#cb909-9"></a>  <span class="kw">return</span>(sims)</span>
<span id="cb909-10"><a href="sect085.html#cb909-10"></a>})</span>
<span id="cb909-11"><a href="sect085.html#cb909-11"></a>mat_sims &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, cols)</span>
<span id="cb909-12"><a href="sect085.html#cb909-12"></a><span class="co"># Calculer les résidus simulés</span></span>
<span id="cb909-13"><a href="sect085.html#cb909-13"></a>sim_res &lt;-<span class="st"> </span><span class="kw">createDHARMa</span>(<span class="dt">simulatedResponse =</span> mat_sims, </span>
<span id="cb909-14"><a href="sect085.html#cb909-14"></a>                            <span class="dt">observedResponse =</span> DataFinal2<span class="op">$</span>VegPct,</span>
<span id="cb909-15"><a href="sect085.html#cb909-15"></a>                            <span class="dt">fittedPredictedResponse =</span> mus,</span>
<span id="cb909-16"><a href="sect085.html#cb909-16"></a>                            <span class="dt">integerResponse =</span> F)</span>
<span id="cb909-17"><a href="sect085.html#cb909-17"></a><span class="kw">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:studentresid"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/studentresid-1.png" alt="Diagnostic général des résidus simulés pour le GLM avec distribution de Student" width="65%" />
<p class="caption">
Figure 8.48: Diagnostic général des résidus simulés pour le GLM avec distribution de Student
</p>
</div>
<p>Il semble que nous obtenons des résultats similaires à ceux du modèle gaussien: les résidus divergent significativement d’une distribution uniforme (figure <a href="sect085.html#fig:studentresid">8.48</a>). Le graphique quantile-quantile n’est parfois pas très adapté pour discerner une déviation de la distribution uniforme, nous pouvons dans ce cas afficher un histogramme des résidus pour en avoir le coeur net (figure <a href="sect085.html#fig:studentresid2">8.49</a>).</p>
<div class="sourceCode" id="cb910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb910-1"><a href="sect085.html#cb910-1"></a><span class="kw">ggplot</span>()<span class="op">+</span></span>
<span id="cb910-2"><a href="sect085.html#cb910-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">residuals</span>(sim_res)), <span class="dt">bins =</span> <span class="dv">50</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb910-3"><a href="sect085.html#cb910-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;effectifs&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;résidus simulés&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:studentresid2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/studentresid2-1.png" alt="Distribution des résidus simulés du modèle GLM avec distribution de Student" width="60%" />
<p class="caption">
Figure 8.49: Distribution des résidus simulés du modèle GLM avec distribution de Student
</p>
</div>
<p>Pour cet exercice, il est intéressant de comparer les formes des simulations issues du modèle gaussien et du modèle de Student pour bien distinguer la différence entre les deux.</p>
<div class="figure" style="text-align: center"><span id="fig:studentresid3"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/studentresid3-1.png" alt="Simulations issues des modèles gaussien et de Student, comparées aux données originales" width="60%" />
<p class="caption">
Figure 8.50: Simulations issues des modèles gaussien et de Student, comparées aux données originales
</p>
</div>
<p>Nous constatons ainsi que la différence entre les deux modèles est ici très mince, voire inexistante. Le seul élément que nous pouvons noter est que le modèle de Student à une courbe (une queue de distribution) moins aplatie vers la droite. Cela lui permettrait de mieux tenir compte de cas extrêmes avec de fortes densités de végétation (ce qui concerne donc très peu d’observations puisque cette variable a un maximum de 100).</p>
<p>Pour déterminer si le modèle de Student est plus pertinent à retenir que le modèle gaussien, nous pouvons ajuster un second modèle de Student pour lequel nous forçons artificiellement <span class="math inline">\(\nu\)</span> à être très élevé. Pour rappel, quand <span class="math inline">\(\nu\)</span> tend vers l’infini, la distribution de Student tend vers une distribution normale. Nous forçons ici <span class="math inline">\(\nu\)</span> à être supérieur à 100 pour créer un second modèle de Student se comportant quasiment comme un modèle gaussien et calculons les AIC des deux modèles.</p>
<div class="sourceCode" id="cb911"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb911-1"><a href="sect085.html#cb911-1"></a><span class="co"># Calcul d&#39;un modèle de Student identitique à un modèle gaussien</span></span>
<span id="cb911-2"><a href="sect085.html#cb911-2"></a>modele2 &lt;-<span class="st"> </span><span class="kw">gam</span>(VegPct <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(HABHA)<span class="op">+</span><span class="kw">poly</span>(AgeMedian,<span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb911-3"><a href="sect085.html#cb911-3"></a><span class="st">                   </span>Pct_<span class="dv">014</span><span class="op">+</span>Pct_65P<span class="op">+</span>Pct_MV<span class="op">+</span>Pct_FR, <span class="dt">data =</span> DataFinal2,</span>
<span id="cb911-4"><a href="sect085.html#cb911-4"></a>               <span class="dt">family =</span> <span class="kw">scat</span>(<span class="dt">min.df =</span> <span class="dv">100</span>))</span>
<span id="cb911-5"><a href="sect085.html#cb911-5"></a><span class="co"># Calcul des deux AIC</span></span>
<span id="cb911-6"><a href="sect085.html#cb911-6"></a><span class="kw">AIC</span>(modele)</span></code></pre></div>
<pre><code>## [1] 81771.92</code></pre>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="sect085.html#cb913-1"></a><span class="kw">AIC</span>(modele2)</span></code></pre></div>
<pre><code>## [1] 82057.79</code></pre>
<p>Le second AIC (modèle gaussien) est plus élevé, indiquant que le modèle est moins bien ajusté aux données. Dans le cas présent, il est plus pertinent de retenir le modèle de Student même si les écarts entre ces deux modèles sont minimes. Ce résultat n’est pas surprenant puisque la variable <em>Y</em> (pourcentage de végétation dans les îlots de l’île de Montréal) est relativement compacte et comporte peu / pas de valeurs pouvant être qualifiées de valeurs extrêmes.</p>
<p>Nous ne détaillons pas ici l’interprétation des coefficients du modèle (présentés au tableau <a href="sect085.html#tab:glmstudentres">8.32</a>) puisqu’ils s’interprètent de la même façon qu’un modèle GLM et qu’un modèle de régression linéaire multiple.</p>
<table>
<caption>
<span id="tab:glmstudentres">Tableau 8.32: </span>Résultats du modèle Student
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coeff.
</th>
<th style="text-align:right;">
Err.std
</th>
<th style="text-align:right;">
Val.z
</th>
<th style="text-align:right;">
val.p
</th>
<th style="text-align:right;">
IC coeff 2,5 %
</th>
<th style="text-align:right;">
IC coeff 97,5 %
</th>
<th style="text-align:right;">
Sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Constante
</td>
<td style="text-align:right;">
65,096
</td>
<td style="text-align:right;">
0,940
</td>
<td style="text-align:right;">
69,110
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
63,250
</td>
<td style="text-align:right;">
66,943
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
log(HABHA)
</td>
<td style="text-align:right;">
-9,502
</td>
<td style="text-align:right;">
0,160
</td>
<td style="text-align:right;">
-60,160
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
-9,811
</td>
<td style="text-align:right;">
-9,192
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_014
</td>
<td style="text-align:right;">
0,866
</td>
<td style="text-align:right;">
0,030
</td>
<td style="text-align:right;">
29,450
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,808
</td>
<td style="text-align:right;">
0,924
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_65P
</td>
<td style="text-align:right;">
0,237
</td>
<td style="text-align:right;">
0,020
</td>
<td style="text-align:right;">
13,540
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,203
</td>
<td style="text-align:right;">
0,272
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_MV
</td>
<td style="text-align:right;">
-0,015
</td>
<td style="text-align:right;">
0,010
</td>
<td style="text-align:right;">
-1,650
</td>
<td style="text-align:right;">
0,099
</td>
<td style="text-align:right;">
-0,034
</td>
<td style="text-align:right;">
0,003
</td>
<td style="text-align:right;">
.
</td>
</tr>
<tr>
<td style="text-align:left;">
Pct_FR
</td>
<td style="text-align:right;">
-0,301
</td>
<td style="text-align:right;">
0,010
</td>
<td style="text-align:right;">
-29,040
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
-0,321
</td>
<td style="text-align:right;">
-0,280
</td>
<td style="text-align:right;">
***
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sect0853" class="section level3">
<h3><span class="header-section-number">8.4.3</span> Modèle GLM avec distribution Gamma</h3>
<p>Pour rappel, la distribution Gamma est strictement positive (<span class="math inline">\([0;+\infty[\)</span>), asymétrique, et a une variance proportionnelle à sa moyenne (hétéroscedastique). Dans la section sur les distributions, nous avons vu que la distribution Gamma (section <a href="sect024.html#sect024315">2.4.3.15</a>) est formulée avec deux paramètres : sa forme (<span class="math inline">\(\alpha\)</span> ou <em>shape</em>) et son échelle (<span class="math inline">\(b\)</span> ou <em>scale</em>). Ces deux paramètres n’ont pas une interprétation intuitive, mais il est possible avec un peu de jonglage mathématique d’arriver à une reparamétrisation intéressante. Cela est détaillé dans l’encadré ci-dessous; notez toutefois qu’il n’est pas nécessaire de maîtriser le contenu de cet encadré pour lire la suite de cette section sur les modèles GLM avec une distribution Gamma.</p>
<div class="bloc_aller_loin">
<p><strong>Reparamétrisation d’une distribution Gamma pour un GLM</strong></p>
<p>Si nous disposons d’une variable <em>Y</em>, suivant une distribution Gamma telle que <span class="math inline">\(Y \sim Gamma(\alpha,b)\)</span> avec <span class="math inline">\(\alpha\)</span> le paramètre de forme et <span class="math inline">\(b\)</span> le paramètre d’échelle, alors, l’espérance et la variance de <em>Y</em> peuvent être définies comme suit :</p>
<p><span class="math display" id="eq:glm18">\[\begin{equation}
\begin{aligned}
&amp;E(Y) = \alpha \times b \\
&amp;Var(Y) = \alpha \times b^2\\
\end{aligned}
\tag{8.22}
\end{equation}\]</span>
</p>
<p>En d’autres termes, l’espérance (l’équivalent de la moyenne pour une distribution normale) de notre variable <em>Y</em> est égale au produit des paramètres de forme et d’échelle.</p>
<p>Avec ces propriétés, il est possible de redéfinir la fonction de densité de la distribution Gamma et d’arriver à une nouvelle formulation : <span class="math inline">\(Y \sim Gamma(\mu,\alpha)\)</span>. <span class="math inline">\(\mu\)</span> est donc l’espérance de <em>Y</em> (interprétable comme sa moyenne, soit sa valeur attendue) et <span class="math inline">\(\alpha\)</span> permet de capturer la dispersion de la distribution Gamma. Par extension des relations présentées ci-dessus, il est possible de reformuler la variance en fonction de <span class="math inline">\(\mu\)</span> et de <span class="math inline">\(\alpha\)</span>.</p>
<p><span class="math display" id="eq:glm19">\[\begin{equation}
\begin{aligned}
&amp;Var(Y) = \alpha \times b^2\\
&amp;\mu = \alpha \times b \text{ soit }b = \frac{\mu}{a}\\
&amp;Var(Y) = \alpha \times (\frac{\mu}{\alpha})^2 \text{ soit } Var(Y) = \frac{\mu^2}{\alpha}\\
\end{aligned}
\tag{8.23}
\end{equation}\]</span>
</p>
<p>Nous observons donc que la variance dans un modèle Gamma augmente de façon quadratique avec la moyenne, mais est tempérée par le paramètre de forme. Nous en concluons qu’un paramètre de forme plus grand produit une distribution moins étalée.</p>
<p>Dans ce contexte, <span class="math inline">\(\mu\)</span> doit être strictement positif : la valeur attendue moyenne d’une distribution Gamma doit être positive par définition puisqu’une distribution Gamma ne peut pas produire de valeurs négatives. Il est donc logique d’utiliser la fonction logarithmique comme fonction de lien, puisque sa contrepartie (la fonction exponentielle) ne produit que des résultats positifs.</p>
</div>
<p>Pour résumer, nous nous retrouvons donc avec un modèle qui prédit, sur une échelle logarithmique, l’espérance (~moyenne) d’une distribution Gamma. Notez qu’il existe d’autres façons de spécifier un modèle GLM avec une distribution Gamma, mais celle-ci est la plus intuitive.</p>
<table>
<caption>
<span id="tab:gammadentity">Tableau 8.33: </span>Carte d’identité du modèle Gamma
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable continue dans l’intervalle <span class="math inline">\(]0 ; + \infty[\)</span>
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Gamma
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim Gamma(\mu,\alpha)\)</span> <br/> <span class="math inline">\(g(\mu) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(g(x) = log(x)\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
log
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
<span class="math inline">\(\mu\)</span>
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span>, et <span class="math inline">\(\alpha\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
<span class="math inline">\(Variance = \frac{\mu^2}{\alpha}\)</span>
</td>
</tr>
</tbody>
</table>
<div id="interprétation-des-paramètres-6" class="section level4">
<h4><span class="header-section-number">8.4.3.1</span> Interprétation des paramètres</h4>
<p>Puisque le modèle utilise la fonction de lien <em>log</em>, alors les coefficients <span class="math inline">\(\beta\)</span> expriment l’augmentation de l’espérance (la valeur attendue de <em>Y</em>, ce qui est proche de l’idée de moyenne) de la variable Y sur une échelle logarithmique (comme dans un modèle de Poisson). Il est possible de convertir les coefficients dans l’échelle originale de la variable <em>Y</em> en utilisant la fonction exponentielle (l’inverse de la fonction <em>log</em>), mais ces coefficients représentent alors des effets multiplicatifs et non des effets additifs.
Prenons un exemple, admettons que le coefficient <span class="math inline">\(\beta_1\)</span>, associé à la variable <span class="math inline">\(X_1\)</span> soit de 1,5. Cela signifie qu’une augmentation d’une unité de <span class="math inline">\(X_1\)</span>, augmente le log de l’espérance de <em>Y</em> de 1,5 unité. L’exponentielle du coefficient est 4,48, ce qui signifie qu’une augmentation d’une unité entraîne une multiplication par 4,48 de la valeur attendue de <em>Y</em> (l’espérance de <em>Y</em>). Le paramètre de forme (<span class="math inline">\(\alpha\)</span>) n’a pas d’interprétation pratique, bien qu’il soit utilisé dans les différents tests des conditions d’application du modèle et dans le calcul de sa déviance.</p>
</div>
<div id="conditions-dapplication-6" class="section level4">
<h4><span class="header-section-number">8.4.3.2</span> Conditions d’application</h4>
<p>Dans un modèle GLM gaussien, la variance est capturée par un paramètre <span class="math inline">\(\sigma\)</span> et est constante, produisant la condition d’homoscédasticité des résidus. Dans un modèle Gamma, la variance varie en fonction de l’espérance et du paramètre de forme selon la relation : <span class="math inline">\(Var(Y) = \frac{E(Y)^2}{\alpha}\)</span>. Les résidus sont donc par nature hétéroscédastiques dans un modèle Gamma et doivent suivre cette relation.</p>
</div>
<div id="exemple-appliqué-dans-r-7" class="section level4">
<h4><span class="header-section-number">8.4.3.3</span> Exemple appliqué dans R</h4>
<p>Pour cet exemple, nous nous intéressons à la durée de déplacement en milieu urbain. Ce type d’analyse permet notamment de mieux comprendre les habitudes de déplacement de la population et d’orienter les politiques de transport. Plusieurs travaux concluent que les durées de déplacement en milieu urbain varient en fonction du motif du déplacement, du mode de transport utilisé, des caractéristiques socio-économiques de l’individu et des caractéristiques du trajet lui-même <span class="citation">(Anastasopoulos et al. <a href="#ref-anastasopoulos2012analysis" role="doc-biblioref">2012</a>; Frank et al. <a href="#ref-frank2008urban" role="doc-biblioref">2008</a>)</span>. Nous modélisons ici la durée en minute d’un ensemble de déplacements effectués par des Montréalais en 2017 et enregistrés avec l’application MTL Trajet proposée par la Ville de Montréal. Ces données sont disponibles sur le site web des <a href="http://donnees.ville.montreal.qc.ca/dataset/mtl-trajet">données ouvertes de Montréal</a> et son anonymisées. Nous ne disposons donc d’aucune information individuelle. Compte tenu du très grand nombre d’observations (plus de 185 000), nous avons dû effectuer quelques opérations de tri et nous avons ainsi supprimé:</p>
<ul>
<li>les trajets utilisant de multiples modes de transport (sauf en combinaison avec la marche à pied, par exemple, un trajet effectué à pied et en transport en commun a été recatégorisé comme un trajet en transport en commun uniquement). Les déplacements multimodaux se distinguent largement des déplacements unimodaux dans la littérature scientifique;</li>
<li>les trajets de nuit (seuls les trajets démarrant dans l’intervalle de 7 h à 21 h ont été conservés);</li>
<li>les trajets dont le point de départ est un arrondissement / municipalité pour lequel moins de 150 trajets ont été enregistrés (trop peu d’observations);</li>
<li>les trajets de plus de deux heures (cas rares, considérés comme des données aberrantes);</li>
<li>les trajets dont le point de départ est à moins de 100 mètres du point d’arrivée (formant des boucles plutôt que des déplacements).</li>
</ul>
<p>Nous arrivons ainsi à un total de 24 969 observations. Pour modéliser ces durées de déplacement, nous utilisons les variables indépendantes présentées dans le tableau <a href="sect085.html#tab:variablegamma">8.34</a>.</p>
<table>
<caption>
<span id="tab:variablegamma">Tableau 8.34: </span>Variables indépendantes utilisées dans le modèle Gamma
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nom de la variable
</th>
<th style="text-align:left;">
Signification
</th>
<th style="text-align:left;">
Type de variable
</th>
<th style="text-align:left;">
Mesure
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Mode
</td>
<td style="text-align:left;">
Mode de déplacement
</td>
<td style="text-align:left;">
Variable catégorielle
</td>
<td style="text-align:left;">
Transport collectif; piéton; vélo et véhicule individuel
</td>
</tr>
<tr>
<td style="text-align:left;">
Motif
</td>
<td style="text-align:left;">
Motif du déplacement
</td>
<td style="text-align:left;">
Variable catégorielle
</td>
<td style="text-align:left;">
Travail; loisir; magasinage et éducation
</td>
</tr>
<tr>
<td style="text-align:left;">
HeureDep
</td>
<td style="text-align:left;">
Heure de départ
</td>
<td style="text-align:left;">
Variable catégorielle
</td>
<td style="text-align:left;">
De 7 h à 21 h
</td>
</tr>
<tr>
<td style="text-align:left;">
ArrondDep
</td>
<td style="text-align:left;">
Arrondissement de départ
</td>
<td style="text-align:left;">
Variable catégorielle
</td>
<td style="text-align:left;">
Nom de l’arrondissement dont part le trajet
</td>
</tr>
<tr>
<td style="text-align:left;">
LogDist
</td>
<td style="text-align:left;">
Logarithme de la distance à vol d’oiseau en km
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Logarithme de la distance à vol d’oiseau en km entre le point de départ et d’arrivée
</td>
</tr>
<tr>
<td style="text-align:left;">
MemeArrond
</td>
<td style="text-align:left;">
L’arrivée du trajet se situe-t-elle dans le même arrondissement que celui du départ?
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Oui ou non
</td>
</tr>
<tr>
<td style="text-align:left;">
Semaine
</td>
<td style="text-align:left;">
Le trajet a-t-il été effectué en semaine ou en fin de semaine?
</td>
<td style="text-align:left;">
Variable binaire
</td>
<td style="text-align:left;">
Semaine ou fin de semaine
</td>
</tr>
</tbody>
</table>
<p>Les temps de trajet forment une variable strictement positive et très vraisemblablement asymétrique. En effet, nous nous attendons à observer une certaine concentration de valeurs autour d’une moyenne, et davantage de trajets avec de courtes durées que de trajets avec de longues durées. Pour nous en assurer, réalisons un histogramme de la distribution de notre variable <em>Y</em> et comparons la avec des distributions normale et Gamma.</p>
<div class="sourceCode" id="cb915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb915-1"><a href="sect085.html#cb915-1"></a><span class="co"># Chargement des données</span></span>
<span id="cb915-2"><a href="sect085.html#cb915-2"></a>dataset &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/glm/DureeTrajets.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> F)</span>
<span id="cb915-3"><a href="sect085.html#cb915-3"></a>arrondMTL &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mercier-Hochelaga-Maisonneuve&quot;</span>, <span class="st">&quot;Villeray-Saint-Michel-Parc-Extension&quot;</span>, </span>
<span id="cb915-4"><a href="sect085.html#cb915-4"></a>               <span class="st">&quot;Ville-Marie&quot;</span>, <span class="st">&quot;Verdun&quot;</span>, <span class="st">&quot;Saint-Leonard&quot;</span>, <span class="st">&quot;Saint-Laurent&quot;</span>, </span>
<span id="cb915-5"><a href="sect085.html#cb915-5"></a>               <span class="st">&quot;Rosemont-La Petite-Patrie&quot;</span>, <span class="st">&quot;Riviere-des-Prairies-Pointe-aux-Trembles&quot;</span>, </span>
<span id="cb915-6"><a href="sect085.html#cb915-6"></a>               <span class="st">&quot;Pierrefonds-Roxboro&quot;</span>, <span class="st">&quot;Outremont&quot;</span>, <span class="st">&quot;Montreal-Nord&quot;</span>, <span class="st">&quot;Le Sud-Ouest&quot;</span>, </span>
<span id="cb915-7"><a href="sect085.html#cb915-7"></a>               <span class="st">&quot;Le Plateau-Mont-Royal&quot;</span>, <span class="st">&quot;Lachine&quot;</span> , <span class="st">&quot;Ahuntsic-Cartierville&quot;</span>,</span>
<span id="cb915-8"><a href="sect085.html#cb915-8"></a>               <span class="st">&quot;Anjou&quot;</span> ,<span class="st">&quot;Cote-des-Neiges-Notre-Dame-de-Grace&quot;</span>, <span class="st">&quot;LaSalle&quot;</span>  </span>
<span id="cb915-9"><a href="sect085.html#cb915-9"></a>)</span>
<span id="cb915-10"><a href="sect085.html#cb915-10"></a>dataset &lt;-<span class="st"> </span><span class="kw">subset</span>(dataset,dataset<span class="op">$</span>ArrondDep <span class="op">%in%</span><span class="st"> </span>arrondMTL)</span>
<span id="cb915-11"><a href="sect085.html#cb915-11"></a><span class="co"># Définissons 7 h du matin comme la référence pour la variable Heure de départ</span></span>
<span id="cb915-12"><a href="sect085.html#cb915-12"></a>dataset<span class="op">$</span>HeureDep &lt;-<span class="st"> </span><span class="kw">relevel</span>(</span>
<span id="cb915-13"><a href="sect085.html#cb915-13"></a>  <span class="kw">factor</span>(dataset<span class="op">$</span>HeureDep, <span class="dt">levels =</span> <span class="kw">as.character</span>(<span class="dv">7</span><span class="op">:</span><span class="dv">21</span>)),</span>
<span id="cb915-14"><a href="sect085.html#cb915-14"></a>  <span class="dt">ref =</span> <span class="st">&quot;7&quot;</span>)</span>
<span id="cb915-15"><a href="sect085.html#cb915-15"></a><span class="co"># Comparaison de la distribution originale avec une distribution </span></span>
<span id="cb915-16"><a href="sect085.html#cb915-16"></a><span class="co"># normale et une distribution Gamma</span></span>
<span id="cb915-17"><a href="sect085.html#cb915-17"></a><span class="kw">library</span>(fitdistrplus)</span>
<span id="cb915-18"><a href="sect085.html#cb915-18"></a>model_gamma &lt;-<span class="st"> </span><span class="kw">fitdist</span>(dataset<span class="op">$</span>Duree, <span class="dt">distr =</span> <span class="st">&quot;gamma&quot;</span>)</span>
<span id="cb915-19"><a href="sect085.html#cb915-19"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dataset) <span class="op">+</span><span class="st"> </span></span>
<span id="cb915-20"><a href="sect085.html#cb915-20"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Duree, <span class="dt">y =</span> ..density..), <span class="dt">bins =</span> <span class="dv">40</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)<span class="op">+</span></span>
<span id="cb915-21"><a href="sect085.html#cb915-21"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dgamma, <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>, </span>
<span id="cb915-22"><a href="sect085.html#cb915-22"></a>                <span class="dt">args =</span> <span class="kw">as.list</span>(model_gamma<span class="op">$</span>estimate))<span class="op">+</span></span>
<span id="cb915-23"><a href="sect085.html#cb915-23"></a><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">color =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>, </span>
<span id="cb915-24"><a href="sect085.html#cb915-24"></a>                <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(dataset<span class="op">$</span>Duree), </span>
<span id="cb915-25"><a href="sect085.html#cb915-25"></a>                            <span class="dt">sd =</span> <span class="kw">sd</span>(dataset<span class="op">$</span>Duree)))<span class="op">+</span></span>
<span id="cb915-26"><a href="sect085.html#cb915-26"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Temps de déplacement (minutes)&#39;</span>,</span>
<span id="cb915-27"><a href="sect085.html#cb915-27"></a>       <span class="dt">y =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb915-28"><a href="sect085.html#cb915-28"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;modèles Gamma et gaussien&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gammadatadistrib"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/gammadatadistrib-1.png" alt="Distribution des temps de trajet diurne à Montréal" width="50%" />
<p class="caption">
Figure 8.51: Distribution des temps de trajet diurne à Montréal
</p>
</div>
<p>La figure <a href="sect085.html#fig:gammadatadistrib">8.51</a> permet de constater l’asymétrie de la distribution des temps de trajet et qu’un modèle Gamma (ligne rouge) a plus de chance d’être adapté aux données qu’un modèle gaussien (ligne bleue).</p>
<p><strong>Vérification des conditions d’application</strong></p>
<p>Comme pour les modèles précédents, nous commençons par la vérification de l’absence de multicolinéarité.</p>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="sect085.html#cb916-1"></a><span class="co">## Calcul du VIF</span></span>
<span id="cb916-2"><a href="sect085.html#cb916-2"></a><span class="kw">vif</span>(<span class="kw">glm</span>(Duree <span class="op">~</span><span class="st"> </span>Mode <span class="op">+</span><span class="st"> </span>Motif <span class="op">+</span><span class="st"> </span>HeureDep <span class="op">+</span><span class="st"> </span>LogDist <span class="op">+</span></span>
<span id="cb916-3"><a href="sect085.html#cb916-3"></a><span class="st">          </span>ArrondDep <span class="op">+</span><span class="st"> </span>MemeArrond <span class="op">+</span><span class="st"> </span>Jour,</span>
<span id="cb916-4"><a href="sect085.html#cb916-4"></a>        <span class="dt">data =</span> dataset,</span>
<span id="cb916-5"><a href="sect085.html#cb916-5"></a>        <span class="dt">family =</span> <span class="kw">Gamma</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>)))</span></code></pre></div>
<pre><code>##                GVIF Df GVIF^(1/(2*Df))
## Mode       2.103392  3        1.131931
## Motif      1.934997  3        1.116298
## HeureDep   1.791009 14        1.021032
## LogDist    2.665998  1        1.632789
## ArrondDep  1.439499 17        1.010772
## MemeArrond 2.151113  1        1.466667
## Jour       1.330091  6        1.024055</code></pre>
<p>L’ensemble des valeurs de VIF sont inférieures à trois, indiquant donc l’absence de multicolinéarité excessive. Nous pouvons donc ajuster une première version du modèle (ici avec le <em>package</em> <code>VGAM</code> et la fonction <code>vglm</code>) et calculer les distances de Cook.</p>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="sect085.html#cb918-1"></a><span class="co"># Calcul du modèle avec VGAM</span></span>
<span id="cb918-2"><a href="sect085.html#cb918-2"></a>modele &lt;-<span class="st"> </span><span class="kw">vglm</span>(Duree <span class="op">~</span><span class="st"> </span>Mode <span class="op">+</span><span class="st"> </span>Motif <span class="op">+</span><span class="st"> </span>HeureDep <span class="op">+</span><span class="st"> </span>LogDist <span class="op">+</span></span>
<span id="cb918-3"><a href="sect085.html#cb918-3"></a><span class="st">                 </span>ArrondDep<span class="op">+</span><span class="st"> </span>MemeArrond <span class="op">+</span><span class="st"> </span>Semaine,</span>
<span id="cb918-4"><a href="sect085.html#cb918-4"></a>               <span class="dt">data =</span> dataset,</span>
<span id="cb918-5"><a href="sect085.html#cb918-5"></a>               <span class="dt">family=</span><span class="kw">gamma2</span>(<span class="dt">lmu =</span> <span class="st">&quot;loglink&quot;</span>))</span>
<span id="cb918-6"><a href="sect085.html#cb918-6"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb918-7"><a href="sect085.html#cb918-7"></a>hats &lt;-<span class="st"> </span><span class="kw">hatvaluesvlm</span>(modele)[,<span class="dv">1</span>]</span>
<span id="cb918-8"><a href="sect085.html#cb918-8"></a>res &lt;-<span class="st"> </span><span class="kw">residuals</span>(modele,<span class="dt">type =</span> <span class="st">&quot;pearson&quot;</span>)[,<span class="dv">1</span>]</span>
<span id="cb918-9"><a href="sect085.html#cb918-9"></a>disp &lt;-<span class="st"> </span>modele<span class="op">@</span>coefficients[[<span class="dv">2</span>]]<span class="op">**-</span><span class="dv">1</span></span>
<span id="cb918-10"><a href="sect085.html#cb918-10"></a>nbparams &lt;-<span class="st"> </span>modele<span class="op">@</span>rank</span>
<span id="cb918-11"><a href="sect085.html#cb918-11"></a>cooksd &lt;-<span class="st"> </span>(res<span class="op">/</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>hats))<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>hats<span class="op">/</span>(disp <span class="op">*</span><span class="st"> </span>nbparams)</span>
<span id="cb918-12"><a href="sect085.html#cb918-12"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb918-13"><a href="sect085.html#cb918-13"></a>  <span class="dt">cook =</span> cooksd,</span>
<span id="cb918-14"><a href="sect085.html#cb918-14"></a>  <span class="dt">oid =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(cooksd)</span>
<span id="cb918-15"><a href="sect085.html#cb918-15"></a>)</span>
<span id="cb918-16"><a href="sect085.html#cb918-16"></a><span class="co"># Représentation des distances de Cook</span></span>
<span id="cb918-17"><a href="sect085.html#cb918-17"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df)<span class="op">+</span></span>
<span id="cb918-18"><a href="sect085.html#cb918-18"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> oid, <span class="dt">y =</span> cook), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb918-19"><a href="sect085.html#cb918-19"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">0.003</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb918-20"><a href="sect085.html#cb918-20"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;distance de Cook&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cookdistgamma"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookdistgamma-1.png" alt="Distances de Cook pour le modèle Gamma" width="50%" />
<p class="caption">
Figure 8.52: Distances de Cook pour le modèle Gamma
</p>
</div>
<p>Puisque nous disposons d’un (très) grand nombre d’observations, nous pouvons nous permettre de retirer les quelques observations fortement influentes (distance de Cook &gt; 0,003 dans notre cas) qui apparaissent dans la figure <a href="sect085.html#fig:cookdistgamma">8.52</a>. Nous retirons ainsi 28 observations et réajustons le modèle.</p>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="sect085.html#cb919-1"></a><span class="co"># Retirer les valeurs influentes</span></span>
<span id="cb919-2"><a href="sect085.html#cb919-2"></a>dataset2 &lt;-<span class="st"> </span><span class="kw">subset</span>(dataset, cooksd<span class="op">&lt;</span><span class="fl">0.003</span>)</span>
<span id="cb919-3"><a href="sect085.html#cb919-3"></a><span class="co"># Calcul du modèle avec VGAM</span></span>
<span id="cb919-4"><a href="sect085.html#cb919-4"></a>modele &lt;-<span class="st"> </span><span class="kw">vglm</span>(Duree <span class="op">~</span><span class="st"> </span>Mode <span class="op">+</span><span class="st"> </span>Motif <span class="op">+</span><span class="st"> </span>HeureDep <span class="op">+</span><span class="st"> </span>LogDist <span class="op">+</span></span>
<span id="cb919-5"><a href="sect085.html#cb919-5"></a><span class="st">                 </span>ArrondDep<span class="op">+</span><span class="st"> </span>MemeArrond <span class="op">+</span><span class="st"> </span>Semaine,</span>
<span id="cb919-6"><a href="sect085.html#cb919-6"></a>               <span class="dt">data =</span> dataset2,</span>
<span id="cb919-7"><a href="sect085.html#cb919-7"></a>               <span class="dt">family=</span><span class="kw">gamma2</span>(<span class="dt">lmu =</span> <span class="st">&quot;loglink&quot;</span>))</span></code></pre></div>
<p>Nous constatons ainsi que dans la nouvelle version du modèle (figure <a href="sect085.html#fig:cookdistgamma2">8.53</a>), aucune valeur particulièrement influente ne semble être présente.</p>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="sect085.html#cb920-1"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb920-2"><a href="sect085.html#cb920-2"></a>hats &lt;-<span class="st"> </span><span class="kw">hatvaluesvlm</span>(modele)[,<span class="dv">1</span>]</span>
<span id="cb920-3"><a href="sect085.html#cb920-3"></a>res &lt;-<span class="st"> </span><span class="kw">residuals</span>(modele,<span class="dt">type =</span> <span class="st">&quot;pearson&quot;</span>)[,<span class="dv">1</span>]</span>
<span id="cb920-4"><a href="sect085.html#cb920-4"></a>disp &lt;-<span class="st"> </span>modele<span class="op">@</span>coefficients[[<span class="dv">2</span>]]<span class="op">**-</span><span class="dv">1</span></span>
<span id="cb920-5"><a href="sect085.html#cb920-5"></a>nbparams &lt;-<span class="st"> </span>modele<span class="op">@</span>rank</span>
<span id="cb920-6"><a href="sect085.html#cb920-6"></a>cooksd &lt;-<span class="st"> </span>(res<span class="op">/</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>hats))<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>hats<span class="op">/</span>(disp <span class="op">*</span><span class="st"> </span>nbparams)</span>
<span id="cb920-7"><a href="sect085.html#cb920-7"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb920-8"><a href="sect085.html#cb920-8"></a>  <span class="dt">cook =</span> cooksd,</span>
<span id="cb920-9"><a href="sect085.html#cb920-9"></a>  <span class="dt">oid =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(cooksd)</span>
<span id="cb920-10"><a href="sect085.html#cb920-10"></a>)</span>
<span id="cb920-11"><a href="sect085.html#cb920-11"></a><span class="co"># Représentation des distances de Cook</span></span>
<span id="cb920-12"><a href="sect085.html#cb920-12"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df)<span class="op">+</span></span>
<span id="cb920-13"><a href="sect085.html#cb920-13"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> oid, <span class="dt">y =</span> cook), <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>)) <span class="op">+</span></span>
<span id="cb920-14"><a href="sect085.html#cb920-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;distance de Cook&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cookdistgamma2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookdistgamma2-1.png" alt="Distances de Cook pour le modèle Gamma (sans les observations fortement influentes)" width="50%" />
<p class="caption">
Figure 8.53: Distances de Cook pour le modèle Gamma (sans les observations fortement influentes)
</p>
</div>
<div class="sourceCode" id="cb921"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb921-1"><a href="sect085.html#cb921-1"></a><span class="co"># Extraction des prédictions du modèle (mu)</span></span>
<span id="cb921-2"><a href="sect085.html#cb921-2"></a>mus &lt;-<span class="st"> </span>modele<span class="op">@</span>fitted.values</span>
<span id="cb921-3"><a href="sect085.html#cb921-3"></a><span class="co"># Extration du paramètre de forme</span></span>
<span id="cb921-4"><a href="sect085.html#cb921-4"></a>shape &lt;-<span class="st"> </span><span class="kw">exp</span>(modele<span class="op">@</span>coefficients[[<span class="dv">2</span>]])</span>
<span id="cb921-5"><a href="sect085.html#cb921-5"></a><span class="co"># Calcul des simulations</span></span>
<span id="cb921-6"><a href="sect085.html#cb921-6"></a>nsim &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb921-7"><a href="sect085.html#cb921-7"></a>cols &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mus),<span class="cf">function</span>(i){</span>
<span id="cb921-8"><a href="sect085.html#cb921-8"></a>  mu &lt;-<span class="st"> </span>mus[[i]]</span>
<span id="cb921-9"><a href="sect085.html#cb921-9"></a>  sims &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dt">n =</span> nsim,<span class="dt">shape =</span> shape, <span class="dt">scale =</span> mu<span class="op">/</span>shape)</span>
<span id="cb921-10"><a href="sect085.html#cb921-10"></a>  <span class="kw">return</span>(sims)</span>
<span id="cb921-11"><a href="sect085.html#cb921-11"></a>})</span>
<span id="cb921-12"><a href="sect085.html#cb921-12"></a>mat_sims &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, cols)</span>
<span id="cb921-13"><a href="sect085.html#cb921-13"></a><span class="co"># Représentation graphique de 20 simulations</span></span>
<span id="cb921-14"><a href="sect085.html#cb921-14"></a>df2 &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(mat_sims[,<span class="dv">0</span><span class="op">:</span><span class="dv">20</span>])</span>
<span id="cb921-15"><a href="sect085.html#cb921-15"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb921-16"><a href="sect085.html#cb921-16"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Duree, <span class="dt">y =</span> ..density..),</span>
<span id="cb921-17"><a href="sect085.html#cb921-17"></a>                 <span class="dt">data =</span> dataset, <span class="dt">bins =</span> <span class="dv">100</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb921-18"><a href="sect085.html#cb921-18"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y=</span>..density.., <span class="dt">group =</span> Var2), <span class="dt">data =</span> df2, </span>
<span id="cb921-19"><a href="sect085.html#cb921-19"></a>               <span class="dt">fill =</span> <span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.9</span>,<span class="fl">0.22</span>,<span class="fl">0.27</span>,<span class="fl">0.4</span>), <span class="dt">size =</span> <span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb921-20"><a href="sect085.html#cb921-20"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">0</span>,<span class="dv">200</span>)<span class="op">+</span></span>
<span id="cb921-21"><a href="sect085.html#cb921-21"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">X=</span><span class="st">&quot;durée (minutes)&quot;</span>, <span class="dt">y=</span><span class="st">&quot;densité&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:simdistribgamma"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/simdistribgamma-1.png" alt="Comparaison de la distribution originale et de simulations issues du modèle Gamma" width="60%" />
<p class="caption">
Figure 8.54: Comparaison de la distribution originale et de simulations issues du modèle Gamma
</p>
</div>
<p>Avant de calculer les résidus simulés, nous comparons la distribution originale des données et des simulations issues du modèle. La figure <a href="sect085.html#fig:simdistribgamma">8.54</a> permet de constater que le modèle semble bien capturer l’essentiel de la forme de la variable <em>Y</em> originale. Nous notons un léger décalage entre la pointe des deux distributions, laissant penser que les valeurs prédites par le modèle tendent à être légèrement plus grandes que les valeurs réelles. Pour mieux appréhender ce constat, nous passons à l’analyse des résidus simulés.</p>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="sect085.html#cb922-1"></a><span class="co"># DHarma tests</span></span>
<span id="cb922-2"><a href="sect085.html#cb922-2"></a>sim_res &lt;-<span class="st"> </span><span class="kw">createDHARMa</span>(<span class="dt">simulatedResponse =</span> mat_sims, </span>
<span id="cb922-3"><a href="sect085.html#cb922-3"></a>                            <span class="dt">observedResponse =</span> dataset2<span class="op">$</span>Duree,</span>
<span id="cb922-4"><a href="sect085.html#cb922-4"></a>                            <span class="dt">fittedPredictedResponse =</span> modele<span class="op">@</span>fitted.values[,<span class="dv">1</span>],</span>
<span id="cb922-5"><a href="sect085.html#cb922-5"></a>                            <span class="dt">integerResponse =</span> F)</span>
<span id="cb922-6"><a href="sect085.html#cb922-6"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb922-7"><a href="sect085.html#cb922-7"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">residuals</span>(sim_res)), <span class="dt">bins =</span> <span class="dv">100</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb922-8"><a href="sect085.html#cb922-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;résidus simulés&quot;</span>,</span>
<span id="cb922-9"><a href="sect085.html#cb922-9"></a>        <span class="dt">y =</span> <span class="st">&quot;effectifs&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gammaresids"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/gammaresids-1.png" alt="Distribution des résidus simulés du modèle Gamma" width="60%" />
<p class="caption">
Figure 8.55: Distribution des résidus simulés du modèle Gamma
</p>
</div>
<p>Nul besoin d’un test statistique pour constater que ces résidus (figure <a href="sect085.html#fig:gammaresids">8.55</a>) ne suivent pas une distribution uniforme. Nous observons une nette surreprésentation de résidus à 1 et une nette sous-représentation de résidus à 0. Il y a donc de nombreuses observations dans notre modèle pour lesquelles les simulations sont systématiquement trop fortes et il n’y en a pas assez pour lesquelles les simulations seraient systématiquement trop faibles.</p>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="sect085.html#cb923-1"></a><span class="kw">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gammaresids2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/gammaresids2-1.png" alt="Diagnostic général des résidus simulés du modèle Gamma" width="65%" />
<p class="caption">
Figure 8.56: Diagnostic général des résidus simulés du modèle Gamma
</p>
</div>
<p>La figure <a href="sect085.html#fig:gammaresids2">8.56</a> indique que le modèle souffre à la fois d’un problème de dispersion (la relation espérance-variance n’est donc pas respectée) et est affecté par des valeurs aberrantes. Considérant que nous avons encore un très grand nombre d’observations, nous faisons le choix de retirer celles pour lesquelles la méthode des résidus simulés estime qu’elles sont des valeurs aberrantes dans au moins 1 % des simulations, soit environ 620 observations.</p>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="sect085.html#cb924-1"></a><span class="co"># Sélection des valeurs aberrantes au seuil 0.01</span></span>
<span id="cb924-2"><a href="sect085.html#cb924-2"></a>sim_outliers &lt;-<span class="st"> </span><span class="kw">outliers</span>(sim_res, </span>
<span id="cb924-3"><a href="sect085.html#cb924-3"></a>                         <span class="dt">lowerQuantile =</span> <span class="fl">0.01</span>,</span>
<span id="cb924-4"><a href="sect085.html#cb924-4"></a>                         <span class="dt">upperQuantile =</span> <span class="fl">0.99</span>, </span>
<span id="cb924-5"><a href="sect085.html#cb924-5"></a>                         <span class="dt">return =</span> <span class="st">&quot;logical&quot;</span>)</span>
<span id="cb924-6"><a href="sect085.html#cb924-6"></a><span class="kw">table</span>(sim_outliers)</span></code></pre></div>
<pre><code>## sim_outliers
## FALSE  TRUE 
## 22936   610</code></pre>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="sect085.html#cb926-1"></a><span class="co"># Retirer ces observations des données</span></span>
<span id="cb926-2"><a href="sect085.html#cb926-2"></a>dataset3 &lt;-<span class="st"> </span><span class="kw">subset</span>(dataset2, sim_outliers<span class="op">==</span><span class="ot">FALSE</span>)</span>
<span id="cb926-3"><a href="sect085.html#cb926-3"></a><span class="co"># Réajuster le modèle</span></span>
<span id="cb926-4"><a href="sect085.html#cb926-4"></a>modele &lt;-<span class="st"> </span><span class="kw">vglm</span>(Duree <span class="op">~</span><span class="st"> </span>Mode <span class="op">+</span><span class="st"> </span>Motif <span class="op">+</span><span class="st"> </span>HeureDep <span class="op">+</span><span class="st"> </span></span>
<span id="cb926-5"><a href="sect085.html#cb926-5"></a><span class="st">                 </span>LogDist <span class="op">+</span><span class="st"> </span>ArrondDep <span class="op">+</span><span class="st"> </span>MemeArrond <span class="op">+</span><span class="st"> </span>Semaine,</span>
<span id="cb926-6"><a href="sect085.html#cb926-6"></a>               <span class="dt">data =</span> dataset3,</span>
<span id="cb926-7"><a href="sect085.html#cb926-7"></a>               <span class="dt">model =</span> T,</span>
<span id="cb926-8"><a href="sect085.html#cb926-8"></a>               <span class="dt">family=</span>gamma2)</span>
<span id="cb926-9"><a href="sect085.html#cb926-9"></a>modele2 &lt;-<span class="st"> </span><span class="kw">vglm</span>(Duree <span class="op">~</span><span class="st"> </span>Mode <span class="op">+</span><span class="st"> </span>Motif <span class="op">+</span><span class="st"> </span>HeureDep <span class="op">+</span><span class="st"> </span>ArrondDep <span class="op">+</span><span class="st"> </span>MemeArrond <span class="op">+</span><span class="st"> </span>Semaine,</span>
<span id="cb926-10"><a href="sect085.html#cb926-10"></a>               <span class="dt">data =</span> dataset3,</span>
<span id="cb926-11"><a href="sect085.html#cb926-11"></a>               <span class="dt">model =</span> T,</span>
<span id="cb926-12"><a href="sect085.html#cb926-12"></a>               <span class="dt">family=</span>gamma2)</span>
<span id="cb926-13"><a href="sect085.html#cb926-13"></a><span class="co"># Extraction des prédictions du modèle (mu)</span></span>
<span id="cb926-14"><a href="sect085.html#cb926-14"></a>mus &lt;-<span class="st"> </span>modele<span class="op">@</span>fitted.values</span>
<span id="cb926-15"><a href="sect085.html#cb926-15"></a><span class="co"># Extration du paramètre de forme</span></span>
<span id="cb926-16"><a href="sect085.html#cb926-16"></a>shape &lt;-<span class="st"> </span><span class="kw">exp</span>(modele<span class="op">@</span>coefficients[[<span class="dv">2</span>]])</span>
<span id="cb926-17"><a href="sect085.html#cb926-17"></a><span class="co"># Calcul des simulations</span></span>
<span id="cb926-18"><a href="sect085.html#cb926-18"></a>nsim &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb926-19"><a href="sect085.html#cb926-19"></a>cols &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mus),<span class="cf">function</span>(i){</span>
<span id="cb926-20"><a href="sect085.html#cb926-20"></a>  mu &lt;-<span class="st"> </span>mus[[i]]</span>
<span id="cb926-21"><a href="sect085.html#cb926-21"></a>  sims &lt;-<span class="st"> </span><span class="kw">rgamma</span>(<span class="dt">n =</span> nsim,<span class="dt">shape =</span> shape, <span class="dt">scale =</span> mu<span class="op">/</span>shape)</span>
<span id="cb926-22"><a href="sect085.html#cb926-22"></a>  <span class="kw">return</span>(sims)</span>
<span id="cb926-23"><a href="sect085.html#cb926-23"></a>})</span>
<span id="cb926-24"><a href="sect085.html#cb926-24"></a>mat_sims &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, cols)</span>
<span id="cb926-25"><a href="sect085.html#cb926-25"></a><span class="co"># Calcul des résidus simulés</span></span>
<span id="cb926-26"><a href="sect085.html#cb926-26"></a>sim_res &lt;-<span class="st"> </span><span class="kw">createDHARMa</span>(<span class="dt">simulatedResponse =</span> mat_sims, </span>
<span id="cb926-27"><a href="sect085.html#cb926-27"></a>                            <span class="dt">observedResponse =</span> dataset3<span class="op">$</span>Duree,</span>
<span id="cb926-28"><a href="sect085.html#cb926-28"></a>                            <span class="dt">fittedPredictedResponse =</span> modele<span class="op">@</span>fitted.values[,<span class="dv">1</span>],</span>
<span id="cb926-29"><a href="sect085.html#cb926-29"></a>                            <span class="dt">integerResponse =</span> F)</span>
<span id="cb926-30"><a href="sect085.html#cb926-30"></a><span class="kw">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:gammaresids3"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/gammaresids3-1.png" alt="Diagnostic général des résidus simulés du modèle Gamma (après suppression d'environ 620 valeurs aberrantes)" width="65%" />
<p class="caption">
Figure 8.57: Diagnostic général des résidus simulés du modèle Gamma (après suppression d’environ 620 valeurs aberrantes)
</p>
</div>
<p>La figure <a href="sect085.html#fig:gammaresids3">8.57</a> indique que les résidus simulés ne suivent toujours pas une distribution uniforme et qu’il existe une relation prononcée (panneau de droite) entre les résidus et les valeurs prédites. Cette dernière laisse penser que des variables indépendantes importantes ont été omises dans le modèle, ce qui n’est pas surprenant compte tenu du fait que nous ne disposons d’aucune donnée socioéconomique sur les individus ayant réalisé les trajets. Nos données sont également potentiellement affectées par la présence de dépendance spatiale.</p>
<p>Nous pouvons comparer graphiquement la variance observée dans les données et la variance attendue par le modèle. La figure <a href="sect085.html#fig:dispgamma">8.58</a> montre clairement que la variance des données tend à être plus grande qu’attendue quand les temps de trajet sont courts, mais diminue trop vite quand les temps de trajet augmentent. D’autres distributions pourraient être envisagées pour ajuster notre modèle : Lognormal, Weibull, etc.</p>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="sect085.html#cb927-1"></a><span class="co"># Extraction des prédictions du modèle</span></span>
<span id="cb927-2"><a href="sect085.html#cb927-2"></a>mus &lt;-<span class="st"> </span><span class="kw">predict</span>(modele, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)[,<span class="dv">1</span>]</span>
<span id="cb927-3"><a href="sect085.html#cb927-3"></a><span class="co"># Création d&#39;un DataFrame pour contenir la prédiction et les vraies valeurs</span></span>
<span id="cb927-4"><a href="sect085.html#cb927-4"></a>df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb927-5"><a href="sect085.html#cb927-5"></a>  <span class="dt">mus =</span> mus,</span>
<span id="cb927-6"><a href="sect085.html#cb927-6"></a>  <span class="dt">reals =</span> dataset3<span class="op">$</span>Duree</span>
<span id="cb927-7"><a href="sect085.html#cb927-7"></a>)</span>
<span id="cb927-8"><a href="sect085.html#cb927-8"></a><span class="co"># Calcul de l&#39;intervalle de confiance à 95 % selon la distribution Gamma</span></span>
<span id="cb927-9"><a href="sect085.html#cb927-9"></a><span class="co"># et stockage dans un second DataFrame</span></span>
<span id="cb927-10"><a href="sect085.html#cb927-10"></a>seqa &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">120</span>,<span class="dv">10</span>)</span>
<span id="cb927-11"><a href="sect085.html#cb927-11"></a>shape &lt;-<span class="st"> </span><span class="kw">exp</span>(modele<span class="op">@</span>coefficients[[<span class="dv">2</span>]])</span>
<span id="cb927-12"><a href="sect085.html#cb927-12"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb927-13"><a href="sect085.html#cb927-13"></a>  <span class="dt">mus =</span> seqa,</span>
<span id="cb927-14"><a href="sect085.html#cb927-14"></a>  <span class="dt">lower =</span> <span class="kw">qgamma</span>(<span class="dt">p =</span> <span class="fl">0.025</span>, <span class="dt">shape =</span> shape, <span class="dt">scale =</span> seqa<span class="op">/</span>shape),</span>
<span id="cb927-15"><a href="sect085.html#cb927-15"></a>  <span class="dt">upper =</span> <span class="kw">qgamma</span>(<span class="dt">p =</span> <span class="fl">0.975</span>, <span class="dt">shape =</span> shape, <span class="dt">scale =</span> seqa<span class="op">/</span>shape)</span>
<span id="cb927-16"><a href="sect085.html#cb927-16"></a>)</span>
<span id="cb927-17"><a href="sect085.html#cb927-17"></a><span class="co"># Affichage des valeurs réelles et prédites (en rouge)</span></span>
<span id="cb927-18"><a href="sect085.html#cb927-18"></a><span class="co"># et de leur variance selon le modèle (en noir)</span></span>
<span id="cb927-19"><a href="sect085.html#cb927-19"></a><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb927-20"><a href="sect085.html#cb927-20"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> df1, </span>
<span id="cb927-21"><a href="sect085.html#cb927-21"></a>             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mus, <span class="dt">y =</span> reals),</span>
<span id="cb927-22"><a href="sect085.html#cb927-22"></a>             <span class="dt">color =</span><span class="kw">rgb</span>(<span class="fl">0.9</span>,<span class="fl">0.22</span>,<span class="fl">0.27</span>,<span class="fl">0.4</span>), <span class="dt">size =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb927-23"><a href="sect085.html#cb927-23"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> df2,</span>
<span id="cb927-24"><a href="sect085.html#cb927-24"></a>                <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mus, <span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper),</span>
<span id="cb927-25"><a href="sect085.html#cb927-25"></a>                <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb927-26"><a href="sect085.html#cb927-26"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;valeurs prédites&#39;</span>,</span>
<span id="cb927-27"><a href="sect085.html#cb927-27"></a>       <span class="dt">y =</span> <span class="st">&quot;valeurs réelles&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:dispgamma"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/dispgamma-1.png" alt="Comparaison de la variance attendue par le modèle et la variance observée dans les données pour le modèle Gamma" width="50%" />
<p class="caption">
Figure 8.58: Comparaison de la variance attendue par le modèle et la variance observée dans les données pour le modèle Gamma
</p>
</div>
<p>À ce stade, nous disposons de suffisamment d’éléments pour douter des résultats du modèle. Nous poursuivons tout de même notre analyse afin d’illustrer l’estimation de la qualité d’ajustement d’un tel modèle et son interprétation.</p>
<p><strong>Analyse de la qualité d’ajustement</strong></p>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="sect085.html#cb928-1"></a><span class="co"># Ajustement d&#39;un modele nul</span></span>
<span id="cb928-2"><a href="sect085.html#cb928-2"></a>modele.null &lt;-<span class="st"> </span><span class="kw">vglm</span>(Duree <span class="op">~</span><span class="dv">1</span>,</span>
<span id="cb928-3"><a href="sect085.html#cb928-3"></a>               <span class="dt">data =</span> dataset3,</span>
<span id="cb928-4"><a href="sect085.html#cb928-4"></a>               <span class="dt">model =</span> T,</span>
<span id="cb928-5"><a href="sect085.html#cb928-5"></a>               <span class="dt">family=</span>gamma2)</span>
<span id="cb928-6"><a href="sect085.html#cb928-6"></a><span class="co"># Calcul des pseudos R2</span></span>
<span id="cb928-7"><a href="sect085.html#cb928-7"></a><span class="kw">rsqs</span>(<span class="dt">loglike.full =</span> <span class="kw">logLik</span>(modele),</span>
<span id="cb928-8"><a href="sect085.html#cb928-8"></a>     <span class="dt">loglike.null =</span> <span class="kw">logLik</span>(modele.null),</span>
<span id="cb928-9"><a href="sect085.html#cb928-9"></a>     <span class="dt">full.deviance =</span> <span class="kw">logLik</span>(modele) <span class="op">*</span><span class="st"> </span><span class="dv">-2</span>,</span>
<span id="cb928-10"><a href="sect085.html#cb928-10"></a>     <span class="dt">null.deviance =</span> <span class="kw">logLik</span>(modele.null) <span class="op">*</span><span class="st"> </span><span class="dv">-2</span>,</span>
<span id="cb928-11"><a href="sect085.html#cb928-11"></a>     <span class="dt">nb.params =</span> modele2<span class="op">@</span>rank,</span>
<span id="cb928-12"><a href="sect085.html#cb928-12"></a>     <span class="dt">n =</span> <span class="kw">nrow</span>(dataset3)</span>
<span id="cb928-13"><a href="sect085.html#cb928-13"></a>     )</span></code></pre></div>
<pre><code>## $`deviance expliquee`
## [1] 0.05061803
## 
## $`McFadden ajuste`
## [1] 0.05017065
## 
## $`Cox and Snell`
## [1] 0.3326894
## 
## $Nagelkerke
## [1] 0.3328021</code></pre>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="sect085.html#cb930-1"></a><span class="co"># Calcul du RMSE</span></span>
<span id="cb930-2"><a href="sect085.html#cb930-2"></a>preds &lt;-<span class="st"> </span><span class="kw">predict</span>(modele, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)[,<span class="dv">1</span>]</span>
<span id="cb930-3"><a href="sect085.html#cb930-3"></a><span class="kw">sqrt</span>(<span class="kw">mean</span>((preds <span class="op">-</span><span class="st"> </span>dataset3<span class="op">$</span>Duree)<span class="op">**</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 13.39254</code></pre>
<p>Le modèle n’explique que 5 % de la déviance et obtient des valeurs de R<sup>2</sup> ajusté de McFadden, de Cox et Snell et de Nagelkerke de respectivement 0,05, 0,33 et 0,33. La moyenne de l’erreur quadratique est de seulement 13,4 indiquant que le modèle se trompe en moyenne de seulement 13,4 minutes. La capacité de prédiction du modèle est donc limitée sans être catastrophique.</p>
<p><strong>Interprétation des résultats</strong></p>
<p>Pour rappel, la fonction de lien dans notre modèle est la fonction <code>log</code>. Chaque coefficient représente donc l’effet de l’augmentation d’une unité des variables indépendantes sur le logarithme de l’espérance de notre variable dépendante. Si nous transformons nos coefficients avec la fonction exponentielle (<code>exp</code>), nous obtenons, pour chaque augmentation d’une unité des variables indépendantes, la multiplication de l’espérance de notre variable dépendante.</p>
<p>Puisque nos trajets peuvent provenir de nombreux arrondissements, nous proposons de représenter l’exponentiel de leurs coefficients avec un graphique. Nous pouvons d’ailleurs comparer les exponentiels des coefficients et les effets marginaux pour simplifier l’interprétation.</p>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="sect085.html#cb932-1"></a><span class="co"># Extraction des coefficient du modèle</span></span>
<span id="cb932-2"><a href="sect085.html#cb932-2"></a>coeffs &lt;-<span class="st"> </span>modele<span class="op">@</span>coefficients</span>
<span id="cb932-3"><a href="sect085.html#cb932-3"></a><span class="co"># Calcul des interval de confiance des coefficients</span></span>
<span id="cb932-4"><a href="sect085.html#cb932-4"></a>conf &lt;-<span class="st"> </span><span class="kw">confint</span>(modele)</span>
<span id="cb932-5"><a href="sect085.html#cb932-5"></a><span class="co"># Passage en exponentiel</span></span>
<span id="cb932-6"><a href="sect085.html#cb932-6"></a>df &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">cbind</span>(coeffs, conf))</span>
<span id="cb932-7"><a href="sect085.html#cb932-7"></a><span class="co"># Extraction des coefficients pour les arrondissements</span></span>
<span id="cb932-8"><a href="sect085.html#cb932-8"></a>dfArrond &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df[<span class="kw">grepl</span>(<span class="st">&quot;ArrondDep&quot;</span>,<span class="kw">row.names</span>(df), <span class="dt">fixed =</span> T),])</span>
<span id="cb932-9"><a href="sect085.html#cb932-9"></a><span class="kw">names</span>(dfArrond) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;coeff&quot;</span>, <span class="st">&quot;lower&quot;</span>,<span class="st">&quot;upper&quot;</span>)</span>
<span id="cb932-10"><a href="sect085.html#cb932-10"></a>dfArrond<span class="op">$</span>Arrondissement &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;ArrondDep&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="kw">rownames</span>(dfArrond),<span class="dt">fixed =</span> T)</span>
<span id="cb932-11"><a href="sect085.html#cb932-11"></a><span class="co"># Graphique des exponentiels des coefficients</span></span>
<span id="cb932-12"><a href="sect085.html#cb932-12"></a>P1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dfArrond) <span class="op">+</span><span class="st"> </span></span>
<span id="cb932-13"><a href="sect085.html#cb932-13"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb932-14"><a href="sect085.html#cb932-14"></a><span class="st">  </span><span class="kw">geom_errorbarh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">reorder</span>(Arrondissement, coeff), <span class="dt">xmin =</span> upper, <span class="dt">xmax =</span> lower),</span>
<span id="cb932-15"><a href="sect085.html#cb932-15"></a>                 <span class="dt">height =</span> <span class="dv">0</span>)<span class="op">+</span></span>
<span id="cb932-16"><a href="sect085.html#cb932-16"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">reorder</span>(Arrondissement, coeff), <span class="dt">x =</span> coeff)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb932-17"><a href="sect085.html#cb932-17"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> upper, <span class="dt">y =</span> <span class="kw">reorder</span>(Arrondissement, coeff),</span>
<span id="cb932-18"><a href="sect085.html#cb932-18"></a>                <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;coeff. : &quot;</span>,<span class="kw">round</span>(coeff,<span class="dv">2</span>),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb932-19"><a href="sect085.html#cb932-19"></a>                <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">nudge_x =</span> <span class="fl">0.07</span>)<span class="op">+</span></span>
<span id="cb932-20"><a href="sect085.html#cb932-20"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Coefficient multiplicateur (ref : Ahuntsic-Cartierville)&quot;</span>,</span>
<span id="cb932-21"><a href="sect085.html#cb932-21"></a>       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb932-22"><a href="sect085.html#cb932-22"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Exponentiels des coefficients du modèle&quot;</span>)<span class="op">+</span></span>
<span id="cb932-23"><a href="sect085.html#cb932-23"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="fl">0.75</span>,<span class="fl">1.46</span>))</span>
<span id="cb932-24"><a href="sect085.html#cb932-24"></a><span class="co"># Création d&#39;un DataFrame fictif pour les effets marginaux</span></span>
<span id="cb932-25"><a href="sect085.html#cb932-25"></a>dfpred &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb932-26"><a href="sect085.html#cb932-26"></a>  <span class="dt">LogDist =</span> <span class="kw">mean</span>(dataset3<span class="op">$</span>LogDist),</span>
<span id="cb932-27"><a href="sect085.html#cb932-27"></a>  <span class="dt">Motif =</span> <span class="st">&#39;education&#39;</span>,</span>
<span id="cb932-28"><a href="sect085.html#cb932-28"></a>  <span class="dt">HeureDep =</span> <span class="st">&#39;7&#39;</span>,</span>
<span id="cb932-29"><a href="sect085.html#cb932-29"></a>  <span class="dt">MemeArrond =</span> <span class="st">&#39;Different&#39;</span>,</span>
<span id="cb932-30"><a href="sect085.html#cb932-30"></a>  <span class="dt">ArrondDep =</span> <span class="kw">unique</span>(dataset3<span class="op">$</span>ArrondDep),</span>
<span id="cb932-31"><a href="sect085.html#cb932-31"></a>  <span class="dt">Mode =</span> <span class="st">&#39;pieton&#39;</span>,<span class="st">&#39;velo&#39;</span>,<span class="st">&#39;transport collectif&#39;</span>,</span>
<span id="cb932-32"><a href="sect085.html#cb932-32"></a>  <span class="dt">Semaine =</span> <span class="st">&#39;lundi au vendredi&#39;</span></span>
<span id="cb932-33"><a href="sect085.html#cb932-33"></a>)</span>
<span id="cb932-34"><a href="sect085.html#cb932-34"></a><span class="co"># Utiliser le modèle pour effectuer des prédictions (échelle log)</span></span>
<span id="cb932-35"><a href="sect085.html#cb932-35"></a>lin_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(modele,dfpred, <span class="dt">se =</span> T)</span>
<span id="cb932-36"><a href="sect085.html#cb932-36"></a>mu_lin_pred &lt;-<span class="st"> </span>lin_pred<span class="op">$</span>fitted.values[,<span class="dv">1</span>]</span>
<span id="cb932-37"><a href="sect085.html#cb932-37"></a>se_lin_pred &lt;-<span class="st"> </span>lin_pred<span class="op">$</span>se.fit[,<span class="dv">1</span>]</span>
<span id="cb932-38"><a href="sect085.html#cb932-38"></a>dfpred2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb932-39"><a href="sect085.html#cb932-39"></a>  <span class="dt">pred =</span> <span class="kw">exp</span>(mu_lin_pred),</span>
<span id="cb932-40"><a href="sect085.html#cb932-40"></a>  <span class="dt">lower =</span> <span class="kw">exp</span>(mu_lin_pred<span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>se_lin_pred),</span>
<span id="cb932-41"><a href="sect085.html#cb932-41"></a>  <span class="dt">upper =</span> <span class="kw">exp</span>(mu_lin_pred<span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span>se_lin_pred)</span>
<span id="cb932-42"><a href="sect085.html#cb932-42"></a>)</span>
<span id="cb932-43"><a href="sect085.html#cb932-43"></a>dfpred2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(dfpred2, dfpred)</span>
<span id="cb932-44"><a href="sect085.html#cb932-44"></a><span class="co"># Réaliser le graphique des effets marginaux</span></span>
<span id="cb932-45"><a href="sect085.html#cb932-45"></a>P2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dfpred2) <span class="op">+</span><span class="st"> </span></span>
<span id="cb932-46"><a href="sect085.html#cb932-46"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">x =</span> pred, <span class="dt">y =</span> ArrondDep)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb932-47"><a href="sect085.html#cb932-47"></a><span class="st">  </span><span class="kw">geom_errorbarh</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> lower, <span class="dt">xmax =</span> upper, <span class="dt">y =</span> ArrondDep)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb932-48"><a href="sect085.html#cb932-48"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Temps de déplacement prédit&quot;</span>, <span class="dt">y=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb932-49"><a href="sect085.html#cb932-49"></a>       <span class="dt">subtitle =</span> <span class="st">&quot;Prédiction du modèle&quot;</span>)</span>
<span id="cb932-50"><a href="sect085.html#cb932-50"></a><span class="kw">ggarrange</span>(P1,P2, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:arrondgamma"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/arrondgamma-1.png" alt="Effet de l'arrondissement de départ sur les temps de trajet à Montréal" width="100%" />
<p class="caption">
Figure 8.59: Effet de l’arrondissement de départ sur les temps de trajet à Montréal
</p>
</div>
<p>La figure <a href="sect085.html#fig:arrondgamma">8.59</a> permet de constater que les arrondissements Ville-Marie et Plateau-Mont-Royal se distinguent avec des trajets plus courts (environ 20 % plus courts en moyenne que les trajets partant d’Ahuntsic-Cartierville). À l’inverse, Lachine est de loin l’arrondissement avec les trajets les plus longs (25 % plus longs en moyenne que les trajets partant d’Ahuntsic-Cartierville).</p>
<p>Nous appliquons la même méthode de visualisation à la variable <em>Heure de départ</em> des trajets.</p>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="sect085.html#cb933-1"></a><span class="co"># Extraction des valeurs pour les heures de départ</span></span>
<span id="cb933-2"><a href="sect085.html#cb933-2"></a>dfHeures &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df[<span class="kw">grepl</span>(<span class="st">&quot;HeureDep&quot;</span>,<span class="kw">row.names</span>(df), <span class="dt">fixed =</span> T),])</span>
<span id="cb933-3"><a href="sect085.html#cb933-3"></a><span class="kw">names</span>(dfHeures) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;coeff&quot;</span>, <span class="st">&quot;lower&quot;</span>,<span class="st">&quot;upper&quot;</span>)</span>
<span id="cb933-4"><a href="sect085.html#cb933-4"></a>dfHeures<span class="op">$</span>Heure &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;HeureDep&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="kw">rownames</span>(dfHeures),<span class="dt">fixed =</span> T)</span>
<span id="cb933-5"><a href="sect085.html#cb933-5"></a><span class="co"># Rajouter des 0 et des h pour de jolies légendes</span></span>
<span id="cb933-6"><a href="sect085.html#cb933-6"></a>dfHeures<span class="op">$</span>Heure &lt;-<span class="st"> </span><span class="kw">paste</span>(dfHeures<span class="op">$</span>Heure,<span class="st">&quot;h&quot;</span>,<span class="dt">sep=</span><span class="st">&quot; &quot;</span>)</span>
<span id="cb933-7"><a href="sect085.html#cb933-7"></a></span>
<span id="cb933-8"><a href="sect085.html#cb933-8"></a><span class="co"># Afficher le graphique</span></span>
<span id="cb933-9"><a href="sect085.html#cb933-9"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dfHeures) <span class="op">+</span><span class="st"> </span></span>
<span id="cb933-10"><a href="sect085.html#cb933-10"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb933-11"><a href="sect085.html#cb933-11"></a><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Heure, <span class="dt">ymin =</span> upper, <span class="dt">ymax =</span> lower), <span class="dt">width =</span> <span class="dv">0</span>)<span class="op">+</span></span>
<span id="cb933-12"><a href="sect085.html#cb933-12"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Heure, <span class="dt">y =</span> coeff)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb933-13"><a href="sect085.html#cb933-13"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> upper, <span class="dt">x =</span> Heure, <span class="dt">label =</span> <span class="kw">round</span>(coeff,<span class="dv">2</span>)), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">nudge_y =</span> <span class="fl">0.07</span>)<span class="op">+</span></span>
<span id="cb933-14"><a href="sect085.html#cb933-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Coefficient multiplicateur (ref : 7 h)&quot;</span>,</span>
<span id="cb933-15"><a href="sect085.html#cb933-15"></a>       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:heuresgamma"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/heuresgamma-1.png" alt="Effet de l'heure de départ sur les temps de trajet à Montréal" width="85%" />
<p class="caption">
Figure 8.60: Effet de l’heure de départ sur les temps de trajet à Montréal
</p>
</div>
<p>Nous pouvons ainsi observer, à la figure <a href="sect085.html#fig:heuresgamma">8.60</a>, que les trajets effectués à 10 h, 11 h et 12 h sont les plus longs de la journée, entre 30 et 40 % plus longs que ceux effectués à 7 h et 8 h qui constituent les trajets les plus courts.</p>
<p>Le reste des coefficients (ainsi que le paramètre de forme) sont affichés dans le tableau <a href="sect085.html#tab:coeffsgamma">8.35</a>. Comparativement à un trajet effectué à pied, un trajet en transport en commun dure en moyenne 52 % plus longtemps (1,53 fois plus long), alors que les déplacements en véhicule individuel et en vélo sont respectivement 28 % et 23 % moins longs. Aucune différence n’est observable entre les déplacements effectués en semaine ou pendant la fin de semaine.</p>
<table>
<caption>
<span id="tab:coeffsgamma">Tableau 8.35: </span>Résultats pour le modèle GLM Gamma
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coeff.
</th>
<th style="text-align:right;">
Exp(Coeff.)
</th>
<th style="text-align:right;">
Val.p
</th>
<th style="text-align:right;">
IC 2,5 % exp(Coeff.)
</th>
<th style="text-align:right;">
IC 97,5 % exp(Coeff.)
</th>
<th style="text-align:right;">
Sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Constante
</td>
<td style="text-align:right;">
2,927
</td>
<td style="text-align:right;">
18,665
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
14,939
</td>
<td style="text-align:right;">
23,313
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Mode</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : pieton
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
transport collectif
</td>
<td style="text-align:right;">
0,421
</td>
<td style="text-align:right;">
1,523
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,484
</td>
<td style="text-align:right;">
1,562
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
vehicule individuel
</td>
<td style="text-align:right;">
-0,321
</td>
<td style="text-align:right;">
0,725
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,707
</td>
<td style="text-align:right;">
0,744
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
velo
</td>
<td style="text-align:right;">
-0,258
</td>
<td style="text-align:right;">
0,772
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,753
</td>
<td style="text-align:right;">
0,792
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Motif</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : education
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
loisir
</td>
<td style="text-align:right;">
-0,010
</td>
<td style="text-align:right;">
0,990
</td>
<td style="text-align:right;">
0,569
</td>
<td style="text-align:right;">
0,957
</td>
<td style="text-align:right;">
1,024
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
magasinage
</td>
<td style="text-align:right;">
-0,107
</td>
<td style="text-align:right;">
0,899
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,868
</td>
<td style="text-align:right;">
0,931
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
travail
</td>
<td style="text-align:right;">
-0,060
</td>
<td style="text-align:right;">
0,941
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,913
</td>
<td style="text-align:right;">
0,970
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
LogDist
</td>
<td style="text-align:right;">
0,334
</td>
<td style="text-align:right;">
1,397
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,383
</td>
<td style="text-align:right;">
1,412
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>MemeArrond</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : Different
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
Meme
</td>
<td style="text-align:right;">
-0,037
</td>
<td style="text-align:right;">
0,964
</td>
<td style="text-align:right;">
0,001
</td>
<td style="text-align:right;">
0,944
</td>
<td style="text-align:right;">
0,985
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Semaine</em>
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
ref : lundi au vendredi
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
<td style="text-align:right;">
–
</td>
</tr>
<tr>
<td style="text-align:left;">
samedi et dimanche
</td>
<td style="text-align:right;">
0,003
</td>
<td style="text-align:right;">
1,003
</td>
<td style="text-align:right;">
0,755
</td>
<td style="text-align:right;">
0,983
</td>
<td style="text-align:right;">
1,024
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
shape
</td>
<td style="text-align:right;">
1,144
</td>
<td style="text-align:right;">
3,140
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
3,086
</td>
<td style="text-align:right;">
3,196
</td>
<td style="text-align:right;">
***
</td>
</tr>
</tbody>
</table>
<p>Les déplacements ayant comme motif le magasinage et le travail ont tendance à être en moyenne plus courts de 11 % et 6 % respectivement, comparativement aux déplacements effectués pour l’éducation ou le loisir (différence non significative entre loisir et éducation). Sans surprise, la distance entre le point de départ et d’arrivée du trajet (<code>LogDist</code>) affecte sa durée de façon positive. Considérant qu’il est difficile d’interpréter des log de kilomètre (dû à une transformation de la variable originale), nous représentons l’effet de cette variable avec la prédiction du modèle à la figure. Nous utilisons pour cela le cas suivant: déplacement à pied à 7 h en semaine, ayant pour motif éducation, dont le point de départ se situe dans l’arrondissement Ahuntsic et donc le point d’arrivée est dans un autre arrondissement. Seule la distance du trajet varie de 1 à 40 km. À titre de comparaison, nous représentons aussi, pour les mêmes conditions, le cas d’une personne à vélo (en vert) et d’une personne utilisant le transport en commun (en bleu). Les lignes en pointillés représentent les intervalles de confiance à 95 % des prédictions (figure <a href="sect085.html#fig:distancegamma">8.61</a>).</p>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="sect085.html#cb934-1"></a><span class="co"># Création d&#39;un DataFrame fictif pour la prédiction</span></span>
<span id="cb934-2"><a href="sect085.html#cb934-2"></a>dfpred &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb934-3"><a href="sect085.html#cb934-3"></a>  <span class="dt">Dist =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">40</span>, <span class="fl">0.5</span>),</span>
<span id="cb934-4"><a href="sect085.html#cb934-4"></a>  <span class="dt">Motif =</span> <span class="st">&#39;education&#39;</span>,</span>
<span id="cb934-5"><a href="sect085.html#cb934-5"></a>  <span class="dt">HeureDep =</span> <span class="st">&#39;7&#39;</span>,</span>
<span id="cb934-6"><a href="sect085.html#cb934-6"></a>  <span class="dt">MemeArrond =</span> <span class="st">&#39;Different&#39;</span>,</span>
<span id="cb934-7"><a href="sect085.html#cb934-7"></a>  <span class="dt">ArrondDep =</span> <span class="st">&#39;Ahuntsic-Cartierville&#39;</span>,</span>
<span id="cb934-8"><a href="sect085.html#cb934-8"></a>  <span class="dt">Mode =</span> <span class="kw">c</span>(<span class="st">&#39;pieton&#39;</span>,<span class="st">&#39;velo&#39;</span>,<span class="st">&#39;transport collectif&#39;</span>),</span>
<span id="cb934-9"><a href="sect085.html#cb934-9"></a>  <span class="dt">Semaine =</span> <span class="st">&#39;lundi au vendredi&#39;</span></span>
<span id="cb934-10"><a href="sect085.html#cb934-10"></a>)</span>
<span id="cb934-11"><a href="sect085.html#cb934-11"></a><span class="co"># Mise en log de la variable de distance</span></span>
<span id="cb934-12"><a href="sect085.html#cb934-12"></a>dfpred<span class="op">$</span>LogDist &lt;-<span class="st"> </span><span class="kw">log</span>(dfpred<span class="op">$</span>Dist)</span>
<span id="cb934-13"><a href="sect085.html#cb934-13"></a><span class="co"># Calcul des prédictions et de leur erreur standard (échelle log)</span></span>
<span id="cb934-14"><a href="sect085.html#cb934-14"></a>lin_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(modele,dfpred, <span class="dt">se =</span> T)</span>
<span id="cb934-15"><a href="sect085.html#cb934-15"></a><span class="co"># Calcul des intervalles de confiance et mise en exponentielle des prédictions</span></span>
<span id="cb934-16"><a href="sect085.html#cb934-16"></a>dfpred<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">exp</span>(lin_pred<span class="op">$</span>fitted.values[,<span class="dv">1</span>])</span>
<span id="cb934-17"><a href="sect085.html#cb934-17"></a>dfpred<span class="op">$</span>lower &lt;-<span class="st"> </span><span class="kw">exp</span>(lin_pred<span class="op">$</span>fitted.values[,<span class="dv">1</span>] <span class="fl">-1.96</span><span class="op">*</span>lin_pred<span class="op">$</span>se.fit[,<span class="dv">1</span>])</span>
<span id="cb934-18"><a href="sect085.html#cb934-18"></a>dfpred<span class="op">$</span>upper &lt;-<span class="st"> </span><span class="kw">exp</span>(lin_pred<span class="op">$</span>fitted.values[,<span class="dv">1</span>] <span class="fl">+1.96</span><span class="op">*</span>lin_pred<span class="op">$</span>se.fit[,<span class="dv">1</span>])</span>
<span id="cb934-19"><a href="sect085.html#cb934-19"></a><span class="co"># Ajoutons les accents pour le graphiques</span></span>
<span id="cb934-20"><a href="sect085.html#cb934-20"></a>dfpred<span class="op">$</span>Mode &lt;-<span class="st"> </span><span class="kw">as.character</span>(dfpred<span class="op">$</span>Mode)</span>
<span id="cb934-21"><a href="sect085.html#cb934-21"></a>dfpred<span class="op">$</span>Mode2 &lt;-<span class="st"> </span><span class="kw">case_when</span>(dfpred<span class="op">$</span>Mode <span class="op">==</span><span class="st"> &quot;pieton&quot;</span> <span class="op">~</span><span class="st"> &quot;piéton&quot;</span>,</span>
<span id="cb934-22"><a href="sect085.html#cb934-22"></a>                         dfpred<span class="op">$</span>Mode <span class="op">==</span><span class="st"> &quot;velo&quot;</span> <span class="op">~</span><span class="st"> &quot;vélo&quot;</span>,</span>
<span id="cb934-23"><a href="sect085.html#cb934-23"></a>                         <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> </span>dfpred<span class="op">$</span>Mode)</span>
<span id="cb934-24"><a href="sect085.html#cb934-24"></a><span class="co"># Affichage des résultats</span></span>
<span id="cb934-25"><a href="sect085.html#cb934-25"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dfpred) <span class="op">+</span><span class="st"> </span></span>
<span id="cb934-26"><a href="sect085.html#cb934-26"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Dist, <span class="dt">y =</span> lower, <span class="dt">color =</span> Mode2), <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb934-27"><a href="sect085.html#cb934-27"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Dist, <span class="dt">y =</span> upper, <span class="dt">color =</span> Mode2), <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb934-28"><a href="sect085.html#cb934-28"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Dist, <span class="dt">y =</span> pred, <span class="dt">color =</span> Mode2), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb934-29"><a href="sect085.html#cb934-29"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;temps de trajet prédit (minutes)&quot;</span>,</span>
<span id="cb934-30"><a href="sect085.html#cb934-30"></a>       <span class="dt">x =</span> <span class="st">&quot;distance à vol d&#39;oiseau (km)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:distancegamma"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/distancegamma-1.png" alt="Effet de la distance à vol d'oiseau sur les temps de trajet à Montréal" width="85%" />
<p class="caption">
Figure 8.61: Effet de la distance à vol d’oiseau sur les temps de trajet à Montréal
</p>
</div>
</div>
</div>
<div id="sect0854" class="section level3">
<h3><span class="header-section-number">8.4.4</span> Modèle GLM avec une distribution bêta</h3>
<p>Pour rappel, la distribution bêta est une distribution définie sur l’intervalle <span class="math inline">\([0,1]\)</span>, elle est donc particulièrement utile pour décrire des proportions, des pourcentages ou des probabilités. Dans la section <a href="sect024.html#sect024316">2.4.3.16</a> sur les distributions, nous avons présenté la paramétrisation classique de la distribution avec les paramètres <span class="math inline">\(a\)</span> et <span class="math inline">\(b\)</span> étant tous les deux des paramètres de forme. Ces deux paramètres n’ont pas d’interprétation pratique, mais il est possible (comme pour la distribution Gamma) de reparamétrer la distribution bêta avec un paramètre de centralité (espérance) et de dispersion.</p>
<p>Notez également que si la distribution bêta autorise la présence de 0 et de 1, le modèle GLM utilisant cette distribution doit les exclure des valeurs possibles s’il utilise la fonction de lien logistique. En effet, cette fonction à la forme suivante :</p>

<p><span class="math display" id="eq:logitbeta">\[\begin{equation}
logit(x) = log(\frac{x}{1-x})\\
\tag{8.24}
\end{equation}\]</span>
</p>
<p>Nous pouvons constater que si <span class="math inline">\(x = 1\)</span>, alors le dénominateur de la fraction est 0, or il est impossible de diviser par 0. Si <span class="math inline">\(x = 0\)</span>, alors nous obtenons <span class="math inline">\(log(0)\)</span> ce qui est également impossible au plan mathématique.</p>
<p>Dans le cas de figure où des 0 et/ou des 1 sont présents dans les données, quatre options sont possibles pour contourner le problème :</p>
<ol style="list-style-type: decimal">
<li>Si les observations à 0 ou 1 sont très peu nombreuses, il est envisageable de les retirer des données.</li>
<li>Si la variable mesurée le permet, il est possible de remplacer les 0 et les 1 par des valeurs très proches (0,0001 et 0,9999 par exemple) sans dénaturer excessivement les données initiales.</li>
<li>Plutôt que d’utiliser une valeur arbitraire, <span class="citation">Smithson et Verkuilen (<a href="#ref-smithson2006better" role="doc-biblioref">2006</a>)</span> recommande de recalculer la variable <span class="math inline">\(Y \in [0;1]\)</span> avec la formule <a href="sect085.html#eq:correctbeta">(8.25)</a>;</li>
<li>Employer un modèle Hurdle à trois équations, la première prédisant la probabilité d’observer <span class="math inline">\(Y &gt; 0\)</span>, la seconde, la probabilité d’observer <span class="math inline">\(Y = 1\)</span> et la dernière prédisant les valeurs de <em>Y</em> pour <span class="math inline">\(0&gt;Y&gt;1\)</span>.</li>
</ol>

<p><span class="math display" id="eq:correctbeta">\[\begin{equation}
Y&#39; = \frac{Y(N-1)+s}{N}
\tag{8.25}
\end{equation}\]</span>
</p>
<p>Avec <em>N</em> le nombre d’observations, <em>Y’</em> la variable <em>Y</em> transformée et <em>s</em> une constante. Plus cette dernière est élevée, plus la variable <em>Y’</em> a des valeurs éloignée de 0 et 1. la valeur de 0,5 est recommandée par les auteurs.</p>
<div class="bloc_aller_loin">
<p><strong>Reparamétrisation de la distribution bêta</strong></p>
<p>Pour une distribution bêta telle que définie par <span class="math inline">\(Y \sim Beta(a,b)\)</span>, l’espérance de cette distribution et sa variance sont données par :</p>
<p><span class="math display" id="eq:glm20">\[\begin{equation}
\begin{aligned}
&amp;E(Y) = \frac{a}{a+b} \\
&amp;Var(Y) = \frac{a \times b}{(a+b)^2(a+b+1)}\\
\end{aligned}
\tag{8.26}
\end{equation}\]</span>
</p>
<p>Pour reparamétrer cette distribution, nous définissons un nouveau paramètre <span class="math inline">\(\phi\)</span> (phi) tel que:</p>
<p><span class="math display" id="eq:glm21">\[\begin{equation}
\begin{aligned}
&amp;a = \phi * E(Y) \\
&amp;b = \phi - a \\
&amp;Var(Y) = \frac{E(Y) \times (1-E(Y))}{1+\phi}
\end{aligned}
\tag{8.27}
\end{equation}\]</span>
</p>
<p>De cette manière, il est possible d’exprimer la distribution bêta en fonction de son espérance (sa valeur attendue, ce qui s’interprète approximativement comme une moyenne) et d’un paramètre <span class="math inline">\(\phi\)</span> intervenant dans le calcul de sa variance. Vous noterez d’ailleurs que la variance de cette distribution dépend de sa moyenne, impliquant à nouveau une hétéroscédasticité intrinsèque.</p>
</div>
<p>Pour résumer, nous nous retrouvons donc avec un modèle qui prédit l’espérance d’une distribution bêta avec une fonction de lien logistique. La variance de cette distribution est fonction de cette moyenne et d’un second paramètre <span class="math inline">\(\phi\)</span>. Ces informations sont résumées dans la fiche d’identité du modèle (tableau <a href="sect085.html#tab:betaentity">8.36</a>).</p>
<table>
<caption>
<span id="tab:betaentity">Tableau 8.36: </span>Carte d’identité du modèle bêta
</caption>
<tbody>
<tr>
<td>
Type de variable dépendante
</td>
<td>
Variable continue dans l’intervalle <span class="math inline">\(]0,1[\)</span>
</td>
</tr>
<tr>
<td>
Distribution utilisée
</td>
<td>
Student
</td>
</tr>
<tr>
<td>
Formulation
</td>
<td>
<span class="math inline">\(Y \sim Beta(\mu,\phi)\)</span> <br/> <span class="math inline">\(g(\mu) = \beta_0 + \beta X\)</span> <br/> <span class="math inline">\(g(x) = log(\frac{x}{1-x})\)</span>
</td>
</tr>
<tr>
<td>
Fonction de lien
</td>
<td>
log
</td>
</tr>
<tr>
<td>
Paramètre modélisé
</td>
<td>
<span class="math inline">\(\mu\)</span>
</td>
</tr>
<tr>
<td>
Paramètres à estimer
</td>
<td>
<span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta\)</span>, et <span class="math inline">\(\phi\)</span>
</td>
</tr>
<tr>
<td>
Conditions d’application
</td>
<td>
<span class="math inline">\(Variance = \frac{\mu \times (1-\mu)}{1+\phi}\)</span>
</td>
</tr>
</tbody>
</table>
<div id="conditions-dapplication-7" class="section level4">
<h4><span class="header-section-number">8.4.4.1</span> Conditions d’application</h4>
<p>Comme pour un modèle Gamma, la seule condition d’application spécifique à un modèle avec distribution bêta est que la variance des résidus suit la forme attendue par la distribution bêta.</p>
</div>
<div id="interprétation-des-coefficients" class="section level4">
<h4><span class="header-section-number">8.4.4.2</span> Interprétation des coefficients</h4>
<p>Puisque le modèle utilise la fonction de lien logistique, les exponentiels des coefficients <span class="math inline">\(\beta\)</span> du modèle peuvent être interprétés comme des rapports de cotes (voir la section <a href="sect082.html#sect0821">8.2.1</a> sur le modèle GLM binomial). Admettons ainsi que nous avons obtenu pour une variable indépendante <span class="math inline">\(X_1\)</span> le coefficient <span class="math inline">\(\beta_1\)</span> de 0,12. Puisque le coefficient est positif, cela signifie qu’une augmentation de <span class="math inline">\(X_1\)</span> conduit à une augmentation de l’espérance de <em>Y</em>. L’exponentiel de 0,12 est 1,13, ce qui signifie qu’une augmentation d’une unité de <span class="math inline">\(X_1\)</span> multiplie par 1,13 (augmente de 13 %) les chances d’une augmentation de <em>Y</em>. <strong>Pour ce type de modèle, il est particulièrement important de calculer ses prédictions afin d’en faciliter l’interprétation</strong>.</p>
</div>
<div id="exemple-appliqué-dans-r-8" class="section level4">
<h4><span class="header-section-number">8.4.4.3</span> Exemple appliqué dans R</h4>
<p>Afin de présenter le modèle GLM avec une distribution bêta, nous utilisons un jeu de données que nous avons construit pour l’île de Montréal. Nous nous intéressons à la question des îlots de chaleur urbains au niveau des aires de diffusion (AD – entités spatiales du recensement canadien comprenant entre 400 et 700 habitants). Pour cela, nous avons calculé dans chaque AD le pourcentage de sa surface classifiée comme îlot de chaleur dans la carte des îlots de <a href="https://www.donneesquebec.ca/recherche/fr/dataset/ilots-de-chaleur-fraicheur-urbains-et-temperature-de-surface">chaleur/fraicheur</a> réalisée par l’INSPQ et le CERFO.</p>
<p>La question que nous nous posons est la suivante : les populations vulnérables socioéconomiquement et/ou physiologiquement sont-elles systématiquement plus exposées à la nuisance que représentent les îlots de chaleur? Cette question se rattache donc au champ de la recherche sur la justice environnementale et plus spécifiquement sur sa dimension spatiale (à savoir l’équité environnementale, à distinguer des dimensions procédurale et de reconnaissance). Plusieurs études se sont d’ailleurs déjà penchées sur la question des îlots de chaleur abordée sous l’angle de l’équité environnementale <span class="citation">(Harlan et al. <a href="#ref-harlan2007shade" role="doc-biblioref">2007</a>; Sanchez et Reames <a href="#ref-sanchez2019cooling" role="doc-biblioref">2019</a>; Huang, Zhou et Cadenasso <a href="#ref-huang2011everyone" role="doc-biblioref">2011</a>)</span>. Nous modélisons donc pour chaque AD (n = 3 158) de l’île de Montréal la proportion de sa surface couverte par des îlots de chaleur. Nos variables indépendantes sont divisées en deux catégories : variables environnementales et variables socio-économiques. Les premières sont des variables de contrôle, il s’agit de la densité de végétation dans l’AD (ajoutée avec une polynomiale d’ordre deux) et de l’arrondissement dans lequel elle se situe. Ces deux paramètres affectent directement les chances d’observer des îlots de chaleur, mais nous souhaitons isoler leurs effets (toutes choses étant égales par ailleurs) de ceux des variables socio-économiques. Ces dernières ont pour objectif de cibler les populations vulnérables sur le plan physiologique (personnes âgées et enfants de moins de 14 ans) ou socio-économique (minorités visibles et faible revenu). L’ensemble de ces variables sont présentées dans le tableau <a href="sect085.html#tab:variablebeta">8.37</a>. Notez que, puisque le modèle avec distribution bêta ne peut pas prendre en compte des valeurs exactes de 1 ou 0, nous les avons remplacées respectivement par 0,99 et 0,01. Cette légère modification n’altère que marginalement les données, surtout si nous considérons qu’elles sont agrégées au niveau des AD et proviennent originalement d’imagerie satellitaire.</p>
<table>
<caption>
<span id="tab:variablebeta">Tableau 8.37: </span>Variables indépendantes utilisées dans le modèle bêta
</caption>
<thead>
<tr>
<th style="text-align:left;">
Nom de la variable
</th>
<th style="text-align:left;">
Signification
</th>
<th style="text-align:left;">
Type de variable
</th>
<th style="text-align:left;">
Mesure
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A65PlusPct
</td>
<td style="text-align:left;">
Population de 65 ans et plus
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Pourcentage de la population ayant 65 ans et plus
</td>
</tr>
<tr>
<td style="text-align:left;">
A014Pct
</td>
<td style="text-align:left;">
Population de 14 ans et moins
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Pourcentage de la population ayant 14 ans et moins
</td>
</tr>
<tr>
<td style="text-align:left;">
PopFRPct
</td>
<td style="text-align:left;">
Population à faible revenu
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Pourcentage de la population à faible revenu
</td>
</tr>
<tr>
<td style="text-align:left;">
PopMVPct
</td>
<td style="text-align:left;">
Minorités visibles
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Pourcentage de la population faisant partie des minorités visibles
</td>
</tr>
<tr>
<td style="text-align:left;">
VegPct
</td>
<td style="text-align:left;">
Végétation
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Pourcentage de la surface de l’AD couverte par de la végétation
</td>
</tr>
<tr>
<td style="text-align:left;">
Arrond
</td>
<td style="text-align:left;">
Arrondissements
</td>
<td style="text-align:left;">
Variable continue
</td>
<td style="text-align:left;">
Arrondissement de l’Île de Montréal
</td>
</tr>
</tbody>
</table>
<p><strong>Vérification des conditions d’application</strong></p>
<p>Sans surprise, nous commençons par charger nos données et nous nous assurons de l’absence de multicolinéarité excessive entre nos variables indépendantes.</p>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="sect085.html#cb935-1"></a><span class="co">## Chargement des données</span></span>
<span id="cb935-2"><a href="sect085.html#cb935-2"></a>dataset &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/glm/data_chaleur.csv&quot;</span>,<span class="dt">fileEncoding =</span> <span class="st">&quot;utf8&quot;</span>)</span>
<span id="cb935-3"><a href="sect085.html#cb935-3"></a><span class="co">## Calcul des valeurs de vif</span></span>
<span id="cb935-4"><a href="sect085.html#cb935-4"></a><span class="kw">vif</span>(<span class="kw">glm</span>(hot <span class="op">~</span></span>
<span id="cb935-5"><a href="sect085.html#cb935-5"></a><span class="st">          </span>A65Pct <span class="op">+</span><span class="st"> </span>A014Pct <span class="op">+</span><span class="st"> </span>PopFRPct <span class="op">+</span><span class="st"> </span>PopMVPct <span class="op">+</span></span>
<span id="cb935-6"><a href="sect085.html#cb935-6"></a><span class="st">          </span><span class="kw">poly</span>(prt_veg, <span class="dt">degree =</span> <span class="dv">2</span>)  <span class="op">+</span><span class="st"> </span>Arrond,</span>
<span id="cb935-7"><a href="sect085.html#cb935-7"></a>        <span class="dt">data =</span> dataset))</span></code></pre></div>
<pre><code>##                               GVIF Df GVIF^(1/(2*Df))
## A65Pct                    1.609917  1        1.268825
## A014Pct                   2.206072  1        1.485285
## PopFRPct                  2.162036  1        1.470386
## PopMVPct                  2.370269  1        1.539568
## poly(prt_veg, degree = 2) 2.619552  2        1.272204
## Arrond                    7.899208 32        1.032820</code></pre>
<p>La seule variable semblant poser un problème de multicolinéarité est la variable <code>Arrond</code>. Cependant, du fait de sa nature multinomiale, elle regroupe en réalité 32 coefficients (voir la colonne <code>Df</code>). Il faut donc utiliser la règle habituelle de 5 sur le carré de la troisième colonne (<code>GVIF^(1/(2*Df))</code>) du tableau <span class="citation">(Fox et Monette <a href="#ref-fox1992generalized" role="doc-biblioref">1992</a>)</span>, soit <code>1,032820^2 = 1,066717</code>, ce qui est bien inférieur à la limite de 5. Nous n’avons donc pas de problème de multicolinéarité excessive. Nous pouvons passer au calcul des distances de Cook. Pour ajuster notre modèle, nous utilisons le <em>package</em> <code>mgcv</code> et la fonction <code>gam</code> avec le paramètre <code>family = betar(link = "logit")</code>.</p>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="sect085.html#cb937-1"></a><span class="co"># Ajustement d&#39;une première version du modèle</span></span>
<span id="cb937-2"><a href="sect085.html#cb937-2"></a>modele &lt;-<span class="st"> </span><span class="kw">gam</span>(hot <span class="op">~</span></span>
<span id="cb937-3"><a href="sect085.html#cb937-3"></a><span class="st">                </span>A65Pct <span class="op">+</span><span class="st"> </span>A014Pct <span class="op">+</span><span class="st"> </span>PopFRPct <span class="op">+</span><span class="st"> </span>PopMVPct <span class="op">+</span></span>
<span id="cb937-4"><a href="sect085.html#cb937-4"></a><span class="st">                </span><span class="kw">poly</span>(prt_veg, <span class="dt">degree=</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>Arrond,</span>
<span id="cb937-5"><a href="sect085.html#cb937-5"></a>              <span class="dt">data =</span> dataset, <span class="dt">family =</span> <span class="kw">betar</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb937-6"><a href="sect085.html#cb937-6"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb937-7"><a href="sect085.html#cb937-7"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb937-8"><a href="sect085.html#cb937-8"></a>  <span class="dt">cooksd =</span> <span class="kw">cooks.distance</span>(modele),</span>
<span id="cb937-9"><a href="sect085.html#cb937-9"></a>  <span class="dt">oid =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(dataset)</span>
<span id="cb937-10"><a href="sect085.html#cb937-10"></a>)</span>
<span id="cb937-11"><a href="sect085.html#cb937-11"></a><span class="co"># Affichage des distances de Cook</span></span>
<span id="cb937-12"><a href="sect085.html#cb937-12"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df)<span class="op">+</span></span>
<span id="cb937-13"><a href="sect085.html#cb937-13"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> oid, <span class="dt">y =</span> cooksd),</span>
<span id="cb937-14"><a href="sect085.html#cb937-14"></a>             <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>), <span class="dt">size =</span> <span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb937-15"><a href="sect085.html#cb937-15"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Distance de Cook&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cookdistbeta"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookdistbeta-1.png" alt="Distances de Cook pour le modèle GLM bêta" width="65%" />
<p class="caption">
Figure 8.62: Distances de Cook pour le modèle GLM bêta
</p>
</div>
<p>Nous pouvons observer à la figure <a href="sect085.html#fig:cookdistbeta">8.62</a> que seulement deux observations se distinguent très nettement des autres. Nous les isolons donc dans un premier temps.</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="sect085.html#cb938-1"></a>cas_etranges &lt;-<span class="st"> </span><span class="kw">subset</span>(dataset, df<span class="op">$</span>cooksd <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.01</span>)</span>
<span id="cb938-2"><a href="sect085.html#cb938-2"></a><span class="kw">print</span>(cas_etranges[,<span class="dv">23</span><span class="op">:</span><span class="kw">ncol</span>(cas_etranges)])</span></code></pre></div>
<pre><code>##      A014Pct A65Pct PopFRPct PopMVPct      Km2    HabKm2 Shape_Leng Shape_Area
## 1666   11.78  26.77     6.38    11.65 6.458460   72.3083  21153.055  6458456.6
## 2803   15.54  31.07    24.17    52.17 0.134013 5283.0879   1651.471   134012.5
##        prt_hot  prt_veg dist_cntr     Arrond  hot
## 1666  1.824483 90.11691 29.181345 Senneville 0.02
## 2803 40.117994 60.15745  4.178823  Westmount 0.40</code></pre>
<p>Ces deux observations n’ont pas de points communs marqués, et ne semblent pas avoir de valeurs particulièrement fortes sur les différentes variables indépendantes ou la variable dépendante. Nous décidons donc de les supprimer et de recalculer les distances de Cook.</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="sect085.html#cb940-1"></a><span class="co"># Suppression des deux observations très influentes</span></span>
<span id="cb940-2"><a href="sect085.html#cb940-2"></a>dataset2 &lt;-<span class="st"> </span><span class="kw">subset</span>(dataset, df<span class="op">$</span>cooksd <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.01</span>)</span>
<span id="cb940-3"><a href="sect085.html#cb940-3"></a>modele2 &lt;-<span class="st"> </span><span class="kw">gam</span>(hot <span class="op">~</span></span>
<span id="cb940-4"><a href="sect085.html#cb940-4"></a><span class="st">                </span>A65Pct <span class="op">+</span><span class="st"> </span>A014Pct <span class="op">+</span><span class="st"> </span>PopFRPct <span class="op">+</span><span class="st"> </span>PopMVPct <span class="op">+</span></span>
<span id="cb940-5"><a href="sect085.html#cb940-5"></a><span class="st">                </span><span class="kw">I</span>(prt_veg<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>prt_veg <span class="op">+</span><span class="st"> </span>Arrond,</span>
<span id="cb940-6"><a href="sect085.html#cb940-6"></a>              <span class="dt">data =</span> dataset2, <span class="dt">family =</span> <span class="kw">betar</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), <span class="dt">methode =</span> <span class="st">&quot;REML&quot;</span>)</span>
<span id="cb940-7"><a href="sect085.html#cb940-7"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb940-8"><a href="sect085.html#cb940-8"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb940-9"><a href="sect085.html#cb940-9"></a>  <span class="dt">cooksd =</span> <span class="kw">cooks.distance</span>(modele2),</span>
<span id="cb940-10"><a href="sect085.html#cb940-10"></a>  <span class="dt">oid =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(dataset2)</span>
<span id="cb940-11"><a href="sect085.html#cb940-11"></a>)</span>
<span id="cb940-12"><a href="sect085.html#cb940-12"></a><span class="co"># Affichage des distances de Cook</span></span>
<span id="cb940-13"><a href="sect085.html#cb940-13"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df2)<span class="op">+</span></span>
<span id="cb940-14"><a href="sect085.html#cb940-14"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> oid, <span class="dt">y =</span> cooksd),</span>
<span id="cb940-15"><a href="sect085.html#cb940-15"></a>             <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>), <span class="dt">size =</span> <span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb940-16"><a href="sect085.html#cb940-16"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Distance de Cook&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cookdistbeta2"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookdistbeta2-1.png" alt="Distances de Cook pour le modèle GLM bêta (suppression de deux observations influentes)" width="65%" />
<p class="caption">
Figure 8.63: Distances de Cook pour le modèle GLM bêta (suppression de deux observations influentes)
</p>
</div>
<p>Après réajustement (figure <a href="sect085.html#fig:cookdistbeta2">8.63</a>) nous constatons à nouveau qu’une observation est <strong>extrêmement</strong> éloignée des autres. Nous la retirons également, car cette différence est si forte qu’elle risque de polluer le modèle.</p>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="sect085.html#cb941-1"></a><span class="co"># Suppression de l&#39;observation très étonnante</span></span>
<span id="cb941-2"><a href="sect085.html#cb941-2"></a>dataset3 &lt;-<span class="st"> </span><span class="kw">subset</span>(dataset2, df2<span class="op">$</span>cooksd<span class="op">&lt;</span><span class="kw">max</span>(df2<span class="op">$</span>cooksd))</span>
<span id="cb941-3"><a href="sect085.html#cb941-3"></a><span class="co"># Réajustement du modèle</span></span>
<span id="cb941-4"><a href="sect085.html#cb941-4"></a>modele3 &lt;-<span class="st"> </span><span class="kw">gam</span>(hot <span class="op">~</span></span>
<span id="cb941-5"><a href="sect085.html#cb941-5"></a><span class="st">                </span>A65Pct <span class="op">+</span><span class="st"> </span>A014Pct <span class="op">+</span><span class="st"> </span>PopFRPct <span class="op">+</span><span class="st"> </span>PopMVPct <span class="op">+</span></span>
<span id="cb941-6"><a href="sect085.html#cb941-6"></a><span class="st">                </span><span class="kw">I</span>(prt_veg<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>prt_veg <span class="op">+</span><span class="st"> </span>Arrond,</span>
<span id="cb941-7"><a href="sect085.html#cb941-7"></a>              <span class="dt">data =</span> dataset3, <span class="dt">family =</span> <span class="kw">betar</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), <span class="dt">methode =</span> <span class="st">&quot;REML&quot;</span>)</span>
<span id="cb941-8"><a href="sect085.html#cb941-8"></a><span class="co"># Calcul des distances de Cook</span></span>
<span id="cb941-9"><a href="sect085.html#cb941-9"></a>df3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb941-10"><a href="sect085.html#cb941-10"></a>  <span class="dt">cooksd =</span> <span class="kw">cooks.distance</span>(modele3),</span>
<span id="cb941-11"><a href="sect085.html#cb941-11"></a>  <span class="dt">oid =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(dataset3)</span>
<span id="cb941-12"><a href="sect085.html#cb941-12"></a>)</span>
<span id="cb941-13"><a href="sect085.html#cb941-13"></a><span class="co"># Affichage des distances de Cook</span></span>
<span id="cb941-14"><a href="sect085.html#cb941-14"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df3)<span class="op">+</span></span>
<span id="cb941-15"><a href="sect085.html#cb941-15"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> oid, <span class="dt">y =</span> cooksd),</span>
<span id="cb941-16"><a href="sect085.html#cb941-16"></a>             <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.4</span>), <span class="dt">size =</span> <span class="fl">0.5</span>)<span class="op">+</span></span>
<span id="cb941-17"><a href="sect085.html#cb941-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Distance de Cook&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cookdistbeta3"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/cookdistbeta3-1.png" alt="Distances de Cook pour le modèle GLM bêta (suppression de trois observations influentes)" width="65%" />
<p class="caption">
Figure 8.64: Distances de Cook pour le modèle GLM bêta (suppression de trois observations influentes)
</p>
</div>
<p>Tout semble aller pour le mieux après ce second passage (figure <a href="sect085.html#fig:cookdistbeta3">8.64</a>). Si nous avions continué à observer des valeurs aussi influentes, nous aurions dû commencer à sérieusement questionner nos données ou notre modèle. La prochaine étape du diagnostic est donc l’analyse des résidus simulés.</p>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="sect085.html#cb942-1"></a><span class="co"># Extraction de phi</span></span>
<span id="cb942-2"><a href="sect085.html#cb942-2"></a>modele3<span class="op">$</span>family<span class="op">$</span>family</span></code></pre></div>
<pre><code>## [1] &quot;Beta regression(14.612)&quot;</code></pre>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="sect085.html#cb944-1"></a>phi &lt;-<span class="st"> </span><span class="fl">14.612</span></span>
<span id="cb944-2"><a href="sect085.html#cb944-2"></a><span class="co"># Réalisation des simulations</span></span>
<span id="cb944-3"><a href="sect085.html#cb944-3"></a>nsim &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb944-4"><a href="sect085.html#cb944-4"></a>mus &lt;-<span class="st"> </span>modele3<span class="op">$</span>fitted.values</span>
<span id="cb944-5"><a href="sect085.html#cb944-5"></a>cols &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(mus),<span class="cf">function</span>(i){</span>
<span id="cb944-6"><a href="sect085.html#cb944-6"></a>  mu &lt;-<span class="st"> </span>mus[[i]]</span>
<span id="cb944-7"><a href="sect085.html#cb944-7"></a>  p &lt;-<span class="st"> </span>mu <span class="op">*</span><span class="st"> </span>phi</span>
<span id="cb944-8"><a href="sect085.html#cb944-8"></a>  q &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>mu)<span class="op">*</span>phi</span>
<span id="cb944-9"><a href="sect085.html#cb944-9"></a>  sims &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dt">n =</span> nsim,<span class="dt">shape1 =</span> p, <span class="dt">shape2 =</span> q)</span>
<span id="cb944-10"><a href="sect085.html#cb944-10"></a>  <span class="kw">return</span>(sims)</span>
<span id="cb944-11"><a href="sect085.html#cb944-11"></a>})</span>
<span id="cb944-12"><a href="sect085.html#cb944-12"></a>mat_sims &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, cols)</span>
<span id="cb944-13"><a href="sect085.html#cb944-13"></a><span class="co"># Calcul des résidus simulés</span></span>
<span id="cb944-14"><a href="sect085.html#cb944-14"></a>sim_res &lt;-<span class="st"> </span><span class="kw">createDHARMa</span>(<span class="dt">simulatedResponse =</span> mat_sims,</span>
<span id="cb944-15"><a href="sect085.html#cb944-15"></a>                           <span class="dt">observedResponse =</span> dataset3<span class="op">$</span>hot,</span>
<span id="cb944-16"><a href="sect085.html#cb944-16"></a>                           <span class="dt">fittedPredictedResponse =</span> modele3<span class="op">$</span>fitted.values,</span>
<span id="cb944-17"><a href="sect085.html#cb944-17"></a>                           <span class="dt">integerResponse =</span> F)</span>
<span id="cb944-18"><a href="sect085.html#cb944-18"></a><span class="kw">plot</span>(sim_res)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:residsimbeta"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/residsimbeta-1.png" alt="Diagnostic général des résidus simulés du modèle bêta" width="65%" />
<p class="caption">
Figure 8.65: Diagnostic général des résidus simulés du modèle bêta
</p>
</div>
<p>La figure <a href="sect085.html#fig:residsimbeta">8.65</a> indique que les résidus suivent bien une distribution uniforme. Le test des valeurs aberrantes n’est pas significatif au seuil de 0,01 (nous retenons ce seuil considérant le grand nombre de simulations et d’observations de notre jeu de données), nous décidons donc de ne pas supprimer davantage d’observations. Le panneau de droite indique une relation non linéaire instable, mais essentiellement centrée sur la ligne droite attendue. Pour plus de détails, nous calculons ces résidus simulés avec chacune des variables indépendantes.</p>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="sect085.html#cb945-1"></a><span class="co"># Préparons un plot multiple</span></span>
<span id="cb945-2"><a href="sect085.html#cb945-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb945-3"><a href="sect085.html#cb945-3"></a>vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A65Pct&quot;</span>, <span class="st">&quot;A014Pct&quot;</span>, <span class="st">&quot;PopFRPct&quot;</span>, <span class="st">&quot;PopMVPct&quot;</span>, <span class="st">&quot;prt_veg&quot;</span>)</span>
<span id="cb945-4"><a href="sect085.html#cb945-4"></a><span class="cf">for</span>(v <span class="cf">in</span> vars){</span>
<span id="cb945-5"><a href="sect085.html#cb945-5"></a>  <span class="kw">plotResiduals</span>(sim_res, dataset3[[v]], <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> v)</span>
<span id="cb945-6"><a href="sect085.html#cb945-6"></a>}</span>
<span id="cb945-7"><a href="sect085.html#cb945-7"></a><span class="kw">plotResiduals</span>(sim_res, dataset3[[<span class="st">&quot;prt_veg&quot;</span>]]<span class="op">**</span><span class="dv">2</span>, <span class="dt">xlab =</span> <span class="st">&quot;prt_veg^2&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:residsimbeta2"></span>
<img src="images/glm/residsimbeta2.png" alt="Relation entre chaque variable indépendante et les résidus simulés du modèle bêta" width="100%" />
<p class="caption">
Figure 8.66: Relation entre chaque variable indépendante et les résidus simulés du modèle bêta
</p>
</div>
<p>La figure <a href="sect085.html#fig:residsimbeta2">8.66</a> indique des relations marginales et négligeables entre nos variables indépendantes et nos résidus simulés. Concernant la variable <code>Arrond</code> (figure <a href="sect085.html#fig:residsimbeta3">8.67</a>), nous observons une situation plus particulière. Pour quelques arrondissements, les résidus simulés sont nettement plus forts ou plus faibles. Notre hypothèse est que cet effet est provoqué par l’introduction de cette variable dans notre modèle comme un effet fixe alors que sa nature devrait nous inciter à l’introduire comme un effet aléatoire. Nous n’avons pas encore présenté ces concepts ici, mais nous le ferons dans le chapitre <a href="chap09.html#chap09">9</a>. En attendant, nous conservons le modèle tel quel et passons à l’analyse de sa qualité d’ajustement.</p>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="sect085.html#cb946-1"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb946-2"><a href="sect085.html#cb946-2"></a>  <span class="dt">resid =</span> <span class="kw">residuals</span>(sim_res),</span>
<span id="cb946-3"><a href="sect085.html#cb946-3"></a>  <span class="dt">Arrond =</span> dataset3<span class="op">$</span>Arrond</span>
<span id="cb946-4"><a href="sect085.html#cb946-4"></a>)</span>
<span id="cb946-5"><a href="sect085.html#cb946-5"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df) <span class="op">+</span><span class="st"> </span></span>
<span id="cb946-6"><a href="sect085.html#cb946-6"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Arrond, <span class="dt">y =</span> resid))<span class="op">+</span></span>
<span id="cb946-7"><a href="sect085.html#cb946-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb946-8"><a href="sect085.html#cb946-8"></a>        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>()</span>
<span id="cb946-9"><a href="sect085.html#cb946-9"></a>        )<span class="op">+</span></span>
<span id="cb946-10"><a href="sect085.html#cb946-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Arrondissements&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Résidus simulés&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:residsimbeta3"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/residsimbeta3-1.png" alt="Relation entre la variable Arrondissement et les résidus simulés du modèle bêta" width="65%" />
<p class="caption">
Figure 8.67: Relation entre la variable Arrondissement et les résidus simulés du modèle bêta
</p>
</div>
<p><strong>Analyse de la qualité d’ajustement</strong></p>
<p>Dans un premier temps, nous comparons la distribution originale des données à des simulations issues du modèle.</p>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="sect085.html#cb947-1"></a><span class="co"># Extraction de 20 simulations</span></span>
<span id="cb947-2"><a href="sect085.html#cb947-2"></a>df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(mat_sims[,<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>])</span>
<span id="cb947-3"><a href="sect085.html#cb947-3"></a>df3 &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw">melt</span>(df2)</span>
<span id="cb947-4"><a href="sect085.html#cb947-4"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb947-5"><a href="sect085.html#cb947-5"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> hot, <span class="dt">y =</span> ..density..),</span>
<span id="cb947-6"><a href="sect085.html#cb947-6"></a>                 <span class="dt">data =</span> dataset3, <span class="dt">bins =</span> <span class="dv">100</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb947-7"><a href="sect085.html#cb947-7"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y=</span>..density.., <span class="dt">group =</span> variable), <span class="dt">data =</span> df3,</span>
<span id="cb947-8"><a href="sect085.html#cb947-8"></a>               <span class="dt">fill =</span> <span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb947-9"><a href="sect085.html#cb947-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;résidus simulés&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;densité&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:residsimbeta4"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/residsimbeta4-1.png" alt="Comparaison entre la distribution originale et les simulations issues du modèle" width="60%" />
<p class="caption">
Figure 8.68: Comparaison entre la distribution originale et les simulations issues du modèle
</p>
</div>
<p>Nous constatons à la figure <a href="sect085.html#fig:residsimbeta4">8.68</a> que le modèle est parvenu à reproduire la forme générale de la distribution originale : un plus grand nombre de valeurs proches de zéro, suivies d’une répartition presque homogène dans les valeurs comprises entre 0,15 et 0,8, suivies par un plus faible nombre de valeurs quand <em>Y</em> est supérieur à 0,8. Il semble en revanche manquer un certain nombre de valeurs extrêmes proches de 0 (absence d’îlot de chaleur) et proches de 1 (couverture à 100 % par des îlots de chaleur).</p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="sect085.html#cb948-1"></a><span class="co"># Calcul des pseudo R2</span></span>
<span id="cb948-2"><a href="sect085.html#cb948-2"></a><span class="kw">rsqs</span>(<span class="dt">loglike.full =</span> modele3<span class="op">$</span>deviance<span class="op">/-</span><span class="dv">2</span>,</span>
<span id="cb948-3"><a href="sect085.html#cb948-3"></a>     <span class="dt">loglike.null =</span> modele3<span class="op">$</span>null.deviance<span class="op">/-</span><span class="dv">2</span>,</span>
<span id="cb948-4"><a href="sect085.html#cb948-4"></a>     <span class="dt">full.deviance =</span> modele3<span class="op">$</span>deviance,</span>
<span id="cb948-5"><a href="sect085.html#cb948-5"></a>     <span class="dt">null.deviance =</span> modele3<span class="op">$</span>null.deviance,</span>
<span id="cb948-6"><a href="sect085.html#cb948-6"></a>     <span class="dt">nb.params =</span> modele3<span class="op">$</span>rank,</span>
<span id="cb948-7"><a href="sect085.html#cb948-7"></a>     <span class="dt">n =</span> <span class="kw">nrow</span>(dataset3))</span></code></pre></div>
<pre><code>## $`deviance expliquee`
## [1] 0.9017396
## 
## $`McFadden ajuste`
## [1] 0.8992329
## 
## $`Cox and Snell`
## [1] 0.999828
## 
## $Nagelkerke
## [1] 0.9998949</code></pre>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="sect085.html#cb950-1"></a><span class="co"># Calcul du RMSE</span></span>
<span id="cb950-2"><a href="sect085.html#cb950-2"></a><span class="kw">sqrt</span>(<span class="kw">mean</span>((modele3<span class="op">$</span>fitted.values <span class="op">-</span><span class="st"> </span>modele3<span class="op">$</span>y)<span class="op">**</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.1025719</code></pre>
<p>Le modèle parvient à expliquer 90 % de la déviance totale et obtient des pseudo-R<sup>2</sup> très élevés. Il obtient cependant un RMSE de 0,10 soit une erreur quadratique moyenne de 10 % dans la prédiction, ce qui est tout de même important. Le modèle ne semble pas souffrir particulièrement de sur-ajustement comme les pseudo-R<sup>2</sup> auraient pu nous le laisser penser.</p>
<p>L’ensemble des coefficients du modèle sont accessibles via la fonction <code>summary</code>. Pour rappel, il est nécessaire de les convertir avec la fonction exponentielle pour pouvoir les interpréter en termes de rapport de cotes. À nouveau, nous proposons de construire dans un premier temps une figure pour observer l’effet des arrondissements.</p>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="sect085.html#cb952-1"></a><span class="co"># Identifier les coefficients pour les arrondissements</span></span>
<span id="cb952-2"><a href="sect085.html#cb952-2"></a>test &lt;-<span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;Arrond&quot;</span>,<span class="kw">names</span>(modele3<span class="op">$</span>coefficients), <span class="dt">fixed =</span> T)</span>
<span id="cb952-3"><a href="sect085.html#cb952-3"></a><span class="co"># Extraire les coefficients et les erreurs standards</span></span>
<span id="cb952-4"><a href="sect085.html#cb952-4"></a>coeffs &lt;-<span class="st"> </span>modele3<span class="op">$</span>coefficients[test]</span>
<span id="cb952-5"><a href="sect085.html#cb952-5"></a>err.std &lt;-<span class="st"> </span><span class="kw">summary</span>(modele3)<span class="op">$</span>se[test]</span>
<span id="cb952-6"><a href="sect085.html#cb952-6"></a><span class="co"># Créer un DataFrame avec les rapports de cote et les intervalles de confiance</span></span>
<span id="cb952-7"><a href="sect085.html#cb952-7"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb952-8"><a href="sect085.html#cb952-8"></a>  <span class="dt">Arrond =</span> <span class="kw">gsub</span>(<span class="st">&quot;Arrond&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="kw">names</span>(coeffs), <span class="dt">fixed =</span> T),</span>
<span id="cb952-9"><a href="sect085.html#cb952-9"></a>  <span class="dt">coeffs =</span> coeffs,</span>
<span id="cb952-10"><a href="sect085.html#cb952-10"></a>  <span class="dt">err.std =</span> err.std,</span>
<span id="cb952-11"><a href="sect085.html#cb952-11"></a>  <span class="dt">RC =</span> <span class="kw">exp</span>(coeffs),</span>
<span id="cb952-12"><a href="sect085.html#cb952-12"></a>  <span class="dt">lowerRC =</span> <span class="kw">exp</span>(coeffs<span class="fl">-1.96</span><span class="op">*</span>err.std),</span>
<span id="cb952-13"><a href="sect085.html#cb952-13"></a>  <span class="dt">upperRC =</span> <span class="kw">exp</span>(coeffs<span class="fl">+1.96</span><span class="op">*</span>err.std)</span>
<span id="cb952-14"><a href="sect085.html#cb952-14"></a>)</span>
<span id="cb952-15"><a href="sect085.html#cb952-15"></a><span class="co"># Retrouver l&#39;arrondissement de référence</span></span>
<span id="cb952-16"><a href="sect085.html#cb952-16"></a>allArrond &lt;-<span class="st"> </span><span class="kw">unique</span>(dataset3<span class="op">$</span>Arrond)</span>
<span id="cb952-17"><a href="sect085.html#cb952-17"></a>refArrond &lt;-<span class="st"> </span><span class="kw">setdiff</span>(allArrond, df<span class="op">$</span>Arrond)</span>
<span id="cb952-18"><a href="sect085.html#cb952-18"></a><span class="co"># Créer le graphique</span></span>
<span id="cb952-19"><a href="sect085.html#cb952-19"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> df) <span class="op">+</span><span class="st"> </span></span>
<span id="cb952-20"><a href="sect085.html#cb952-20"></a><span class="st">  </span><span class="kw">geom_errorbarh</span>(<span class="kw">aes</span>(<span class="dt">xmin =</span> lowerRC, <span class="dt">xmax =</span> upperRC, <span class="dt">y =</span> <span class="kw">reorder</span>(Arrond,RC)))<span class="op">+</span></span>
<span id="cb952-21"><a href="sect085.html#cb952-21"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> RC, <span class="dt">y =</span> <span class="kw">reorder</span>(Arrond,RC)))<span class="op">+</span></span>
<span id="cb952-22"><a href="sect085.html#cb952-22"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb952-23"><a href="sect085.html#cb952-23"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> upperRC, <span class="dt">y =</span> <span class="kw">reorder</span>(Arrond, RC), </span>
<span id="cb952-24"><a href="sect085.html#cb952-24"></a>                <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;RC : &quot;</span>,<span class="kw">round</span>(RC,<span class="dv">2</span>),<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">nudge_x =</span> <span class="fl">0.3</span>)<span class="op">+</span></span>
<span id="cb952-25"><a href="sect085.html#cb952-25"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">paste</span>(<span class="st">&quot;Rapport de cote (rouge : &quot;</span>,refArrond,<span class="st">&#39;)&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>),</span>
<span id="cb952-26"><a href="sect085.html#cb952-26"></a>       <span class="dt">y =</span> <span class="st">&#39;Arrondissement&#39;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:betaArrond"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/betaArrond-1.png" alt="Rapports de cote pour les arrondissements dans le modèle bêta" width="85%" />
<p class="caption">
Figure 8.69: Rapports de cote pour les arrondissements dans le modèle bêta
</p>
</div>
<p>Nous constatons ainsi que seuls quelques arrondissements ont une différence d’exposition aux îlots de chaleur significative au seuil de 0,05 comparativement à Ahuntsic-Cartierville (figure <a href="sect085.html#fig:betaArrond">8.69</a>). Pour l’essentiel, il s’agit d’arrondissements pour lesquels nous observons des rapports de cotes supérieurs à 1. Verdun, Lasalle et le Plateau-Mont-Royal sont les arrondissements les plus touchés avec des chances d’observer des niveaux supérieurs de densité d’îlots de chaleur multipliés par 3,19, 2,89 et 2,74. Le reste des coefficients sont affichés dans le tableau <a href="sect085.html#tab:coeffsbeta">8.38</a>.</p>
<p>Nous notons ainsi que le seul groupe associé avec une augmentation significative des chances d’observer une augmentation de la densité d’îlot de chaleur est le groupe des personnes à faible revenu (1,4 % de chance supplémentaire à chaque augmentation d’un point de pourcentage de la variable indépendante). Pour mieux cerner la taille de cet effet, nous représentons l’effet marginal de ce coefficient en maintenant toutes les autres variables à leur moyenne. Nous calculons également ces effets marginaux pour trois arrondissements différents : Verdun (RC le plus fort), Ahuntsic-Cartierville (la référence) et Dollard-des-Ormeaux (RC le plus faible). Nous réalisons également un second graphique pour visualiser l’effet non linéaire de la variable <em>pourcentage de végétation</em>. La figure <a href="sect085.html#fig:betaFR">8.70</a> nous indique ainsi que le rôle de l’arrondissement est plus important que celui du pourcentage de personnes à faible revenu. Cependant, nous constatons que passer de 0 % de personnes à faible revenu dans une AD à 75 % est associé avec une multiplication de la surface couverte par des îlots de chaleur par environ 1,5 (toutes choses égales par ailleurs). Le rôle de la végétation dans la réduction de la surface des îlots de chaleur est très net et non linéaire. L’essentiel de la réduction est observé entre 0 et 50 % de végétation dans une AD, au-delà de ce seuil, la réduction des îlots de chaleur par la végétation est moins flagrante. Il semblerait donc exister à Montréal une forme d’iniquité systématique pour les populations à faible revenu, qui seraient davantage exposées aux îlots de chaleur. Cependant, compte tenu de la dépendance spatiale et de l’hétéroscésadicité observées plus haut, des ajustements devraient être apportés au modèle pour confirmer ou infirmer ce résultat.</p>
<table>
<caption>
<span id="tab:coeffsbeta">Tableau 8.38: </span>Résultats pour le modèle GLM bêta
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Coeff.
</th>
<th style="text-align:right;">
RC
</th>
<th style="text-align:right;">
Val.p
</th>
<th style="text-align:right;">
IC 2,5 % RC
</th>
<th style="text-align:right;">
IC 97,5 % RC
</th>
<th style="text-align:right;">
Sign.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Constante
</td>
<td style="text-align:right;">
3,468
</td>
<td style="text-align:right;">
32,059
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
25,636
</td>
<td style="text-align:right;">
40,085
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
A65Pct
</td>
<td style="text-align:right;">
-0,002
</td>
<td style="text-align:right;">
0,998
</td>
<td style="text-align:right;">
0,243
</td>
<td style="text-align:right;">
0,996
</td>
<td style="text-align:right;">
1,001
</td>
<td style="text-align:right;">
</td>
</tr>
<tr>
<td style="text-align:left;">
A014Pct
</td>
<td style="text-align:right;">
-0,006
</td>
<td style="text-align:right;">
0,994
</td>
<td style="text-align:right;">
0,035
</td>
<td style="text-align:right;">
0,988
</td>
<td style="text-align:right;">
1,000
</td>
<td style="text-align:right;">
<ul>
<li></td>
</tr>
<tr>
<td style="text-align:left;">
PopFRPct
</td>
<td style="text-align:right;">
0,013
</td>
<td style="text-align:right;">
1,014
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
1,011
</td>
<td style="text-align:right;">
1,016
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
PopMVPct
</td>
<td style="text-align:right;">
-0,003
</td>
<td style="text-align:right;">
0,997
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,995
</td>
<td style="text-align:right;">
0,998
</td>
<td style="text-align:right;">
***
</td>
</tr>
<tr>
<td style="text-align:left;">
prt_veg
</td>
<td style="text-align:right;">
-0,137
</td>
<td style="text-align:right;">
0,872
</td>
<td style="text-align:right;">
0,000
</td>
<td style="text-align:right;">
0,865
</td>
<td style="text-align:right;">
0,879
</td>
<td style="text-align:right;">
***
</td>
</tr>
</tbody>
</table></li>
</ul>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="sect085.html#cb953-1"></a><span class="co"># Créer un DataFrame pour la prédiction</span></span>
<span id="cb953-2"><a href="sect085.html#cb953-2"></a>df &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb953-3"><a href="sect085.html#cb953-3"></a>  <span class="dt">A65Pct =</span> <span class="kw">mean</span>(dataset3<span class="op">$</span>A65Pct),</span>
<span id="cb953-4"><a href="sect085.html#cb953-4"></a>  <span class="dt">A014Pct =</span> <span class="kw">mean</span>(dataset3<span class="op">$</span>A014Pct),</span>
<span id="cb953-5"><a href="sect085.html#cb953-5"></a>  <span class="dt">PopFRPct =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">75</span>, <span class="dv">1</span>),</span>
<span id="cb953-6"><a href="sect085.html#cb953-6"></a>  <span class="dt">PopMVPct =</span> <span class="kw">mean</span>(dataset3<span class="op">$</span>PopMVPct),</span>
<span id="cb953-7"><a href="sect085.html#cb953-7"></a>  <span class="dt">prt_veg =</span> <span class="kw">mean</span>(dataset3<span class="op">$</span>prt_veg),</span>
<span id="cb953-8"><a href="sect085.html#cb953-8"></a>  <span class="dt">Arrond =</span> <span class="kw">c</span>(<span class="st">&quot;Verdun&quot;</span>,<span class="st">&#39;Ahuntsic-Cartierville&#39;</span>,<span class="st">&#39;Dollard-des-Ormeaux&#39;</span>)</span>
<span id="cb953-9"><a href="sect085.html#cb953-9"></a>)</span>
<span id="cb953-10"><a href="sect085.html#cb953-10"></a><span class="co"># Effectuer les prédiction sur l&#39;échelle log</span></span>
<span id="cb953-11"><a href="sect085.html#cb953-11"></a>pred &lt;-<span class="st"> </span><span class="kw">predict</span>(modele3, df, <span class="dt">se=</span>T, <span class="dt">type =</span> <span class="st">&quot;link&quot;</span>)</span>
<span id="cb953-12"><a href="sect085.html#cb953-12"></a><span class="co"># Calculer les prédictions et leurs intervalles de confiance</span></span>
<span id="cb953-13"><a href="sect085.html#cb953-13"></a>ilink &lt;-<span class="st"> </span>modele3<span class="op">$</span>family<span class="op">$</span>linkinv</span>
<span id="cb953-14"><a href="sect085.html#cb953-14"></a>df<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">ilink</span>(pred<span class="op">$</span>fit)</span>
<span id="cb953-15"><a href="sect085.html#cb953-15"></a>df<span class="op">$</span>lower &lt;-<span class="st"> </span><span class="kw">ilink</span>(pred<span class="op">$</span>fit <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="st"> </span>pred<span class="op">$</span>se.fit)</span>
<span id="cb953-16"><a href="sect085.html#cb953-16"></a>df<span class="op">$</span>upper &lt;-<span class="st"> </span><span class="kw">ilink</span>(pred<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="st"> </span>pred<span class="op">$</span>se.fit)</span>
<span id="cb953-17"><a href="sect085.html#cb953-17"></a><span class="co"># Afficher le résultat</span></span>
<span id="cb953-18"><a href="sect085.html#cb953-18"></a>P1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df)<span class="op">+</span></span>
<span id="cb953-19"><a href="sect085.html#cb953-19"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PopFRPct, <span class="dt">y =</span> pred, <span class="dt">color =</span> Arrond), <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb953-20"><a href="sect085.html#cb953-20"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PopFRPct, <span class="dt">y =</span> lower, <span class="dt">color =</span> Arrond), <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb953-21"><a href="sect085.html#cb953-21"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> PopFRPct, <span class="dt">y =</span> upper, <span class="dt">color =</span> Arrond), <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb953-22"><a href="sect085.html#cb953-22"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Personnes à faible revenu (%)&quot;</span>, </span>
<span id="cb953-23"><a href="sect085.html#cb953-23"></a>       <span class="dt">y =</span> <span class="st">&quot;Surface de l&#39;AD couverte par des îlots de chaleur (%)&quot;</span>,</span>
<span id="cb953-24"><a href="sect085.html#cb953-24"></a>       <span class="dt">color =</span> <span class="st">&#39;Arrondissement&#39;</span>)<span class="op">+</span></span>
<span id="cb953-25"><a href="sect085.html#cb953-25"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb953-26"><a href="sect085.html#cb953-26"></a><span class="co"># Pour la végétation</span></span>
<span id="cb953-27"><a href="sect085.html#cb953-27"></a>df2 &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(</span>
<span id="cb953-28"><a href="sect085.html#cb953-28"></a>  <span class="dt">A65Pct =</span> <span class="kw">mean</span>(dataset3<span class="op">$</span>A65Pct),</span>
<span id="cb953-29"><a href="sect085.html#cb953-29"></a>  <span class="dt">A014Pct =</span> <span class="kw">mean</span>(dataset3<span class="op">$</span>A014Pct),</span>
<span id="cb953-30"><a href="sect085.html#cb953-30"></a>  <span class="dt">PopFRPct =</span> <span class="kw">mean</span>(dataset3<span class="op">$</span>PopFRPct),</span>
<span id="cb953-31"><a href="sect085.html#cb953-31"></a>  <span class="dt">PopMVPct =</span> <span class="kw">mean</span>(dataset3<span class="op">$</span>PopMVPct),</span>
<span id="cb953-32"><a href="sect085.html#cb953-32"></a>  <span class="dt">prt_veg =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">95</span>,<span class="dv">1</span>),</span>
<span id="cb953-33"><a href="sect085.html#cb953-33"></a>  <span class="dt">Arrond =</span> <span class="kw">c</span>(<span class="st">&quot;Verdun&quot;</span>,<span class="st">&#39;Ahuntsic-Cartierville&#39;</span>,<span class="st">&#39;Dollard-des-Ormeaux&#39;</span>)</span>
<span id="cb953-34"><a href="sect085.html#cb953-34"></a>)</span>
<span id="cb953-35"><a href="sect085.html#cb953-35"></a><span class="co"># Effectuer les prédiction sur l&#39;échelle log</span></span>
<span id="cb953-36"><a href="sect085.html#cb953-36"></a>pred2 &lt;-<span class="st"> </span><span class="kw">predict</span>(modele3, df2, <span class="dt">se=</span>T, <span class="dt">type =</span> <span class="st">&quot;link&quot;</span>)</span>
<span id="cb953-37"><a href="sect085.html#cb953-37"></a><span class="co"># Calculer les prédictions et leurs intervalles de confiance</span></span>
<span id="cb953-38"><a href="sect085.html#cb953-38"></a>df2<span class="op">$</span>pred &lt;-<span class="st"> </span><span class="kw">ilink</span>(pred2<span class="op">$</span>fit)</span>
<span id="cb953-39"><a href="sect085.html#cb953-39"></a>df2<span class="op">$</span>lower &lt;-<span class="st"> </span><span class="kw">ilink</span>(pred2<span class="op">$</span>fit <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="st"> </span>pred2<span class="op">$</span>se.fit)</span>
<span id="cb953-40"><a href="sect085.html#cb953-40"></a>df2<span class="op">$</span>upper &lt;-<span class="st"> </span><span class="kw">ilink</span>(pred2<span class="op">$</span>fit <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span><span class="op">*</span><span class="st"> </span>pred2<span class="op">$</span>se.fit)</span>
<span id="cb953-41"><a href="sect085.html#cb953-41"></a><span class="co"># Afficher le résultat</span></span>
<span id="cb953-42"><a href="sect085.html#cb953-42"></a>P2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df2)<span class="op">+</span></span>
<span id="cb953-43"><a href="sect085.html#cb953-43"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> prt_veg, <span class="dt">y =</span> pred, <span class="dt">color =</span> Arrond), <span class="dt">size =</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb953-44"><a href="sect085.html#cb953-44"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> prt_veg, <span class="dt">y =</span> lower, <span class="dt">color =</span> Arrond), <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb953-45"><a href="sect085.html#cb953-45"></a><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">x =</span> prt_veg, <span class="dt">y =</span> upper, <span class="dt">color =</span> Arrond), <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb953-46"><a href="sect085.html#cb953-46"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Couverture végétale (%)&quot;</span>, <span class="dt">y =</span> <span class="st">&#39;&#39;</span>, <span class="dt">color =</span> <span class="st">&#39;Arrondissement&#39;</span>)<span class="op">+</span></span>
<span id="cb953-47"><a href="sect085.html#cb953-47"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb953-48"><a href="sect085.html#cb953-48"></a><span class="kw">ggarrange</span>(P1,P2, <span class="dt">common.legend =</span> T)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:betaFR"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/betaFR-1.png" alt="Effets marginaux des variables pourcentage de personnes à faible revenu et densité de végétation" width="60%" />
<p class="caption">
Figure 8.70: Effets marginaux des variables pourcentage de personnes à faible revenu et densité de végétation
</p>
</div>
</div>
</div>
</div>
<h3>R&eacute;f&eacute;rences</h3>
<div id="refs" class="references">
<div id="ref-anastasopoulos2012analysis">
<p>Anastasopoulos, Panagiotis C, John E Haddock, Matthew G Karlaftis et Fred L Mannering. 2012. « Analysis of urban travel times: Hazard-based approach to random parameters ». <em>Transportation research record</em> 2302 (1): 121‑129. <a href="https://doi.org/10.3141%2F2302-13">https://doi.org/10.3141%2F2302-13</a>.</p>
</div>
<div id="ref-fox1992generalized">
<p>Fox, John et Georges Monette. 1992. « Generalized collinearity diagnostics ». <em>Journal of the American Statistical Association</em> 87 (417): 178‑183. <a href="https://doi.org/10.2307/2290467">https://doi.org/10.2307/2290467</a>.</p>
</div>
<div id="ref-frank2008urban">
<p>Frank, Lawrence, Mark Bradley, Sarah Kavage, James Chapman et T Keith Lawton. 2008. « Urban form, travel time, and cost relationships with tour complexity and mode choice ». <em>Transportation</em> 35 (1): 37‑54. <a href="https://doi.org/10.1007/s11116-007-9136-6">https://doi.org/10.1007/s11116-007-9136-6</a>.</p>
</div>
<div id="ref-harlan2007shade">
<p>Harlan, Sharon L, Anthony J Brazel, G Darrel Jenerette, Nancy S Jones, Larissa Larsen, Lela Prashad et William L Stefanov. 2007. « In the shade of affluence: the inequitable distribution of the urban heat island ». <em>Research in Social Problems and Public Policy</em> 15: 173‑202. <a href="http://dx.doi.org/10.1016/S0196-1152(07)15005-5">http://dx.doi.org/10.1016/S0196-1152(07)15005-5</a>.</p>
</div>
<div id="ref-huang2011everyone">
<p>Huang, Ganlin, Weiqi Zhou et ML Cadenasso. 2011. « Is everyone hot in the city? Spatial pattern of land surface temperatures, land cover and neighborhood socioeconomic characteristics in Baltimore, MD ». <em>Journal of environmental management</em> 92 (7): 1753‑1759. <a href="https://doi.org/10.1016/j.jenvman.2011.02.006">https://doi.org/10.1016/j.jenvman.2011.02.006</a>.</p>
</div>
<div id="ref-sanchez2019cooling">
<p>Sanchez, Lino et Tony G Reames. 2019. « Cooling Detroit: A socio-spatial analysis of equity in green roofs as an urban heat island mitigation strategy ». <em>Urban Forestry &amp; Urban Greening</em> 44: 126331. <a href="https://doi.org/10.1016/j.ufug.2019.04.014">https://doi.org/10.1016/j.ufug.2019.04.014</a>.</p>
</div>
<div id="ref-smithson2006better">
<p>Smithson, Michael et Jay Verkuilen. 2006. « A better lemon squeezer? Maximum-likelihood regression with beta-distributed dependent variables ». <em>Psychological methods</em> 11 (1): 54. <a href="https://doi.org/10.1037/1082-989x.11.1.54">https://doi.org/10.1037/1082-989x.11.1.54</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect084.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect086.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MethodesQuantitScSocialesBolR.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
