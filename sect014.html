<!DOCTYPE html>
<html lang="fr" xml:lang="fr">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.4 Manipulation de données | Méthodes quantitatives en sciences sociales : un grand bol d’R</title>
  <meta name="description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="1.4 Manipulation de données | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />
  <meta property="og:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="github-repo" content="LAEQ/livre_statistique_Phil_Jere" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.4 Manipulation de données | Méthodes quantitatives en sciences sociales : un grand bol d’R" />
  
  <meta name="twitter:description" content="Ce livre vise à décrire une panoplie de méthodes quantitatives utilisées en sciences sociales avec le logiciel ouvert R. Il a d’ailleurs été écrit intégralement dans R avec rmarkdown. Le contenu est pensé pour être accessible à tous et toutes, même à ceux et celles n’ayant presque aucune base en statistique ou en programmation. Les personnes plus expérimentées y découvriront des sections sur des méthodes plus avancées comme les modèles à effets mixtes, les modèles multiniveaux, les modèles généralisés additifs ainsi que les méthodes factorielles et de classification. Ceux et celles souhaitant migrer progressivement d’un autre logiciel statistique vers R trouveront dans cet ouvrage les éléments pour une transition en douceur. La philosophie de ce livre est de donner toutes les clefs de compréhension et de mise en œuvre des méthodes abordées dans R. La présentation des méthodes est basée sur une approche compréhensive et intuitive plutôt que mathématique, sans pour autant que la rigueur statistique ne soit négligée." />
  <meta name="twitter:image" content="https://laeq.github.io/LivreStatistique_website/images/introduction/ImageCouverture.png" />

<meta name="author" content="Philippe Apparicio et Jérémy Gelb" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sect013.html"/>
<link rel="next" href="sect016.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="libs/d3-4.13.0/d3.min.js"></script>
<script src="libs/d3-tip-0.8.1/index.js"></script>
<link href="libs/chorddiag-0.1.2.9000/chorddiag.css" rel="stylesheet" />
<script src="libs/chorddiag-0.1.2.9000/chorddiag.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/quizlib.min.css" type="text/css" />
<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d'R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenue</a></li>
<li class="chapter" data-level="" data-path="préface.html"><a href="préface.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="" data-path="sect001.html"><a href="sect001.html"><i class="fa fa-check"></i>Un manuel sous la forme d’une ressource éducative libre</a></li>
<li class="chapter" data-level="" data-path="sect002.html"><a href="sect002.html"><i class="fa fa-check"></i>Un manuel conçu comme un projet collaboratif</a></li>
<li class="chapter" data-level="" data-path="sect003.html"><a href="sect003.html"><i class="fa fa-check"></i>Comment lire ce livre?</a></li>
<li class="chapter" data-level="" data-path="sect003B.html"><a href="sect003B.html"><i class="fa fa-check"></i>Comment utiliser les données du livre pour reproduire les exemples?</a></li>
<li class="chapter" data-level="" data-path="sect004.html"><a href="sect004.html"><i class="fa fa-check"></i>Structure du livre</a></li>
<li class="chapter" data-level="" data-path="sect005.html"><a href="sect005.html"><i class="fa fa-check"></i>Pourquoi faut-il programmer en sciences sociales?</a></li>
<li class="chapter" data-level="" data-path="sect006.html"><a href="sect006.html"><i class="fa fa-check"></i>Remerciements</a></li>
<li class="chapter" data-level="" data-path="sect007.html"><a href="sect007.html"><i class="fa fa-check"></i>Dédicace toute spéciale à Cargo et Ambrée</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="auteurs.html"><a href="auteurs.html"><i class="fa fa-check"></i>À propos des auteurs</a></li>
<li class="part"><span><b>I Découverte de R</b></span></li>
<li class="chapter" data-level="1" data-path="chap01.html"><a href="chap01.html"><i class="fa fa-check"></i><b>1</b> Prise en main de R</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sect011.html"><a href="sect011.html"><i class="fa fa-check"></i><b>1.1</b> Histoire et philosophie de R</a></li>
<li class="chapter" data-level="1.2" data-path="sect012.html"><a href="sect012.html"><i class="fa fa-check"></i><b>1.2</b> Environnement de travail</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="sect012.html"><a href="sect012.html#sect0121"><i class="fa fa-check"></i><b>1.2.1</b> Installation de R</a></li>
<li class="chapter" data-level="1.2.2" data-path="sect012.html"><a href="sect012.html#sect0122"><i class="fa fa-check"></i><b>1.2.2</b> Environnement RStudio</a></li>
<li class="chapter" data-level="1.2.3" data-path="sect012.html"><a href="sect012.html#sect0123"><i class="fa fa-check"></i><b>1.2.3</b> Installation et chargement un <em>package</em></a></li>
<li class="chapter" data-level="1.2.4" data-path="sect012.html"><a href="sect012.html#aide-disponible"><i class="fa fa-check"></i><b>1.2.4</b> Aide disponible</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="sect013.html"><a href="sect013.html"><i class="fa fa-check"></i><b>1.3</b> Bases du langage R</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="sect013.html"><a href="sect013.html#sect0131"><i class="fa fa-check"></i><b>1.3.1</b> <em>Hello World</em>!</a></li>
<li class="chapter" data-level="1.3.2" data-path="sect013.html"><a href="sect013.html#sect0132"><i class="fa fa-check"></i><b>1.3.2</b> Objets et expressions</a></li>
<li class="chapter" data-level="1.3.3" data-path="sect013.html"><a href="sect013.html#sect0_133"><i class="fa fa-check"></i><b>1.3.3</b> Fonctions et arguments</a></li>
<li class="chapter" data-level="1.3.4" data-path="sect013.html"><a href="sect013.html#sect0134"><i class="fa fa-check"></i><b>1.3.4</b> Principaux types de données</a></li>
<li class="chapter" data-level="1.3.5" data-path="sect013.html"><a href="sect013.html#sect0135"><i class="fa fa-check"></i><b>1.3.5</b> Opérateurs</a></li>
<li class="chapter" data-level="1.3.6" data-path="sect013.html"><a href="sect013.html#sect0136"><i class="fa fa-check"></i><b>1.3.6</b> Structures de données</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="sect014.html"><a href="sect014.html"><i class="fa fa-check"></i><b>1.4</b> Manipulation de données</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="sect014.html"><a href="sect014.html#sect0141"><i class="fa fa-check"></i><b>1.4.1</b> Chargement d’un <em>DataFrame</em> depuis un fichier</a></li>
<li class="chapter" data-level="1.4.2" data-path="sect014.html"><a href="sect014.html#sect0142"><i class="fa fa-check"></i><b>1.4.2</b> Manipulation d’un <em>DataFrame</em></a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="sect016.html"><a href="sect016.html"><i class="fa fa-check"></i><b>1.5</b> Code R bien structuré</a></li>
<li class="chapter" data-level="1.6" data-path="sect017.html"><a href="sect017.html"><i class="fa fa-check"></i><b>1.6</b> Enregistrement des résultats</a></li>
<li class="chapter" data-level="1.7" data-path="sect018.html"><a href="sect018.html"><i class="fa fa-check"></i><b>1.7</b> Session de travail</a></li>
<li class="chapter" data-level="1.8" data-path="sect019.html"><a href="sect019.html"><i class="fa fa-check"></i><b>1.8</b> Conclusion et ressources pertinentes</a></li>
<li class="chapter" data-level="1.9" data-path="sect0110.html"><a href="sect0110.html"><i class="fa fa-check"></i><b>1.9</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>II Analyses univariées et graphiques dans R</b></span></li>
<li class="chapter" data-level="2" data-path="chap02.html"><a href="chap02.html"><i class="fa fa-check"></i><b>2</b> Statistiques descriptives univariées</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sect021.html"><a href="sect021.html"><i class="fa fa-check"></i><b>2.1</b> Notion et types de variable</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="sect021.html"><a href="sect021.html#sect0211"><i class="fa fa-check"></i><b>2.1.1</b> Notion de variable</a></li>
<li class="chapter" data-level="2.1.2" data-path="sect021.html"><a href="sect021.html#sect0212"><i class="fa fa-check"></i><b>2.1.2</b> Types de variables</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sect022.html"><a href="sect022.html"><i class="fa fa-check"></i><b>2.2</b> Types de données</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sect022.html"><a href="sect022.html#sect0221"><i class="fa fa-check"></i><b>2.2.1</b> Données secondaires <em>versus</em> données primaires</a></li>
<li class="chapter" data-level="2.2.2" data-path="sect022.html"><a href="sect022.html#sect0222"><i class="fa fa-check"></i><b>2.2.2</b> Données transversales <em>versus</em> données longitudinales</a></li>
<li class="chapter" data-level="2.2.3" data-path="sect022.html"><a href="sect022.html#sect0223"><i class="fa fa-check"></i><b>2.2.3</b> Données spatiales versus données aspatiales</a></li>
<li class="chapter" data-level="2.2.4" data-path="sect022.html"><a href="sect022.html#sect0224"><i class="fa fa-check"></i><b>2.2.4</b> Données individuelles <em>versus</em> données agrégées</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sect023.html"><a href="sect023.html"><i class="fa fa-check"></i><b>2.3</b> Statistique descriptive et statistique inférentielle</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="sect023.html"><a href="sect023.html#sect0231"><i class="fa fa-check"></i><b>2.3.1</b> Population, échantillon et inférence</a></li>
<li class="chapter" data-level="2.3.2" data-path="sect023.html"><a href="sect023.html#sect0232"><i class="fa fa-check"></i><b>2.3.2</b> Deux grandes familles de méthodes statistiques</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="sect024.html"><a href="sect024.html"><i class="fa fa-check"></i><b>2.4</b> Notion de distribution</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sect024.html"><a href="sect024.html#définition-générale"><i class="fa fa-check"></i><b>2.4.1</b> Définition générale</a></li>
<li class="chapter" data-level="2.4.2" data-path="sect024.html"><a href="sect024.html#anatomie-dune-distribution"><i class="fa fa-check"></i><b>2.4.2</b> Anatomie d’une distribution</a></li>
<li class="chapter" data-level="2.4.3" data-path="sect024.html"><a href="sect024.html#principales-distributions"><i class="fa fa-check"></i><b>2.4.3</b> Principales distributions</a></li>
<li class="chapter" data-level="2.4.4" data-path="sect024.html"><a href="sect024.html#conclusion-sur-les-distributions"><i class="fa fa-check"></i><b>2.4.4</b> Conclusion sur les distributions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sect025.html"><a href="sect025.html"><i class="fa fa-check"></i><b>2.5</b> Statistiques descriptives sur des variables quantitatives</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="sect025.html"><a href="sect025.html#sect0251"><i class="fa fa-check"></i><b>2.5.1</b> Paramètres de tendance centrale</a></li>
<li class="chapter" data-level="2.5.2" data-path="sect025.html"><a href="sect025.html#sect0252"><i class="fa fa-check"></i><b>2.5.2</b> Paramètres de position</a></li>
<li class="chapter" data-level="2.5.3" data-path="sect025.html"><a href="sect025.html#sect0253"><i class="fa fa-check"></i><b>2.5.3</b> Paramètres de dispersion</a></li>
<li class="chapter" data-level="2.5.4" data-path="sect025.html"><a href="sect025.html#sect0254"><i class="fa fa-check"></i><b>2.5.4</b> Paramètres de forme</a></li>
<li class="chapter" data-level="2.5.5" data-path="sect025.html"><a href="sect025.html#sect0255"><i class="fa fa-check"></i><b>2.5.5</b> Transformation des variables</a></li>
<li class="chapter" data-level="2.5.6" data-path="sect025.html"><a href="sect025.html#sect0256"><i class="fa fa-check"></i><b>2.5.6</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sect026.html"><a href="sect026.html"><i class="fa fa-check"></i><b>2.6</b> Statistiques descriptives sur des variables qualitatives et semi-qualitatives</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="sect026.html"><a href="sect026.html#sect0261"><i class="fa fa-check"></i><b>2.6.1</b> Fréquences</a></li>
<li class="chapter" data-level="2.6.2" data-path="sect026.html"><a href="sect026.html#sect0262"><i class="fa fa-check"></i><b>2.6.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="sect027.html"><a href="sect027.html"><i class="fa fa-check"></i><b>2.7</b> Statistiques descriptives pondérées : pour aller plus loin</a></li>
<li class="chapter" data-level="2.8" data-path="sect028.html"><a href="sect028.html"><i class="fa fa-check"></i><b>2.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap03.html"><a href="chap03.html"><i class="fa fa-check"></i><b>3</b> Magie des graphiques</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sect031.html"><a href="sect031.html"><i class="fa fa-check"></i><b>3.1</b> Philosophie du ggplot2</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="sect031.html"><a href="sect031.html#sect0311"><i class="fa fa-check"></i><b>3.1.1</b> Grammaire</a></li>
<li class="chapter" data-level="3.1.2" data-path="sect031.html"><a href="sect031.html#sect0312"><i class="fa fa-check"></i><b>3.1.2</b> Types de géométries</a></li>
<li class="chapter" data-level="3.1.3" data-path="sect031.html"><a href="sect031.html#sect0313"><i class="fa fa-check"></i><b>3.1.3</b> Habillage</a></li>
<li class="chapter" data-level="3.1.4" data-path="sect031.html"><a href="sect031.html#utilisation-des-thèmes"><i class="fa fa-check"></i><b>3.1.4</b> Utilisation des thèmes</a></li>
<li class="chapter" data-level="3.1.5" data-path="sect031.html"><a href="sect031.html#sect0314"><i class="fa fa-check"></i><b>3.1.5</b> Composition d’une figure avec plusieurs graphiques</a></li>
<li class="chapter" data-level="3.1.6" data-path="sect031.html"><a href="sect031.html#sect0315"><i class="fa fa-check"></i><b>3.1.6</b> Couleur</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sect032.html"><a href="sect032.html"><i class="fa fa-check"></i><b>3.2</b> Principaux graphiques</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sect032.html"><a href="sect032.html#sect0321"><i class="fa fa-check"></i><b>3.2.1</b> Histogramme</a></li>
<li class="chapter" data-level="3.2.2" data-path="sect032.html"><a href="sect032.html#sect0322"><i class="fa fa-check"></i><b>3.2.2</b> Graphique de densité</a></li>
<li class="chapter" data-level="3.2.3" data-path="sect032.html"><a href="sect032.html#sect0323"><i class="fa fa-check"></i><b>3.2.3</b> Nuage de points</a></li>
<li class="chapter" data-level="3.2.4" data-path="sect032.html"><a href="sect032.html#sect0324"><i class="fa fa-check"></i><b>3.2.4</b> Graphique en ligne</a></li>
<li class="chapter" data-level="3.2.5" data-path="sect032.html"><a href="sect032.html#sect0325"><i class="fa fa-check"></i><b>3.2.5</b> Boîte à moustaches</a></li>
<li class="chapter" data-level="3.2.6" data-path="sect032.html"><a href="sect032.html#sect0326"><i class="fa fa-check"></i><b>3.2.6</b> Graphique en violon</a></li>
<li class="chapter" data-level="3.2.7" data-path="sect032.html"><a href="sect032.html#sect0327"><i class="fa fa-check"></i><b>3.2.7</b> Graphique en barre</a></li>
<li class="chapter" data-level="3.2.8" data-path="sect032.html"><a href="sect032.html#sect0328"><i class="fa fa-check"></i><b>3.2.8</b> Graphique circulaire</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sect033.html"><a href="sect033.html"><i class="fa fa-check"></i><b>3.3</b> Graphiques spéciaux</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sect033.html"><a href="sect033.html#sect0331"><i class="fa fa-check"></i><b>3.3.1</b> Graphique en radar</a></li>
<li class="chapter" data-level="3.3.2" data-path="sect033.html"><a href="sect033.html#sect0332"><i class="fa fa-check"></i><b>3.3.2</b> Diagramme d’accord</a></li>
<li class="chapter" data-level="3.3.3" data-path="sect033.html"><a href="sect033.html#sect0333"><i class="fa fa-check"></i><b>3.3.3</b> Nuage de mots</a></li>
<li class="chapter" data-level="3.3.4" data-path="sect033.html"><a href="sect033.html#sect0334"><i class="fa fa-check"></i><b>3.3.4</b> Carte proportionnelle</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sect034.html"><a href="sect034.html"><i class="fa fa-check"></i><b>3.4</b> Cartes</a></li>
<li class="chapter" data-level="3.5" data-path="sect035.html"><a href="sect035.html"><i class="fa fa-check"></i><b>3.5</b> Exportation des graphiques</a></li>
<li class="chapter" data-level="3.6" data-path="sect036.html"><a href="sect036.html"><i class="fa fa-check"></i><b>3.6</b> Conclusion sur les graphiques</a></li>
</ul></li>
<li class="part"><span><b>III Analyses bivariées</b></span></li>
<li class="chapter" data-level="4" data-path="chap04.html"><a href="chap04.html"><i class="fa fa-check"></i><b>4</b> Relation linéaire entre deux variables quantitatives</a>
<ul>
<li class="chapter" data-level="4.1" data-path="sect041.html"><a href="sect041.html"><i class="fa fa-check"></i><b>4.1</b> Bref retour sur le postulat de la relation linéaire</a></li>
<li class="chapter" data-level="4.2" data-path="sect042.html"><a href="sect042.html"><i class="fa fa-check"></i><b>4.2</b> Covariance</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="sect042.html"><a href="sect042.html#sect0421"><i class="fa fa-check"></i><b>4.2.1</b> Formulation</a></li>
<li class="chapter" data-level="4.2.2" data-path="sect042.html"><a href="sect042.html#sect0422"><i class="fa fa-check"></i><b>4.2.2</b> Interprétation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sect043.html"><a href="sect043.html"><i class="fa fa-check"></i><b>4.3</b> Corrélation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="sect043.html"><a href="sect043.html#sect0431"><i class="fa fa-check"></i><b>4.3.1</b> Formulation</a></li>
<li class="chapter" data-level="4.3.2" data-path="sect043.html"><a href="sect043.html#sect0432"><i class="fa fa-check"></i><b>4.3.2</b> Interprétation</a></li>
<li class="chapter" data-level="4.3.3" data-path="sect043.html"><a href="sect043.html#sect0433"><i class="fa fa-check"></i><b>4.3.3</b> Corrélations pour des variables anormalement distribuées (coefficient de Spearman, tau de Kendall)</a></li>
<li class="chapter" data-level="4.3.4" data-path="sect043.html"><a href="sect043.html#sect0434"><i class="fa fa-check"></i><b>4.3.4</b> Corrélations robustes (<em>Biweight midcorrelation</em>, <em>Percentage bend correlation</em> et la corrélation <em>pi</em> de Shepherd)</a></li>
<li class="chapter" data-level="4.3.5" data-path="sect043.html"><a href="sect043.html#sect0435"><i class="fa fa-check"></i><b>4.3.5</b> Significativité des coefficients de corrélation</a></li>
<li class="chapter" data-level="4.3.6" data-path="sect043.html"><a href="sect043.html#sect0436"><i class="fa fa-check"></i><b>4.3.6</b> Corrélation partielle</a></li>
<li class="chapter" data-level="4.3.7" data-path="sect043.html"><a href="sect043.html#sect0437"><i class="fa fa-check"></i><b>4.3.7</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.3.8" data-path="sect043.html"><a href="sect043.html#sect0438"><i class="fa fa-check"></i><b>4.3.8</b> Comment rapporter des valeurs de corrélations?</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="sect044.html"><a href="sect044.html"><i class="fa fa-check"></i><b>4.4</b> Régression linéaire simple</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="sect044.html"><a href="sect044.html#sect0441"><i class="fa fa-check"></i><b>4.4.1</b> Principe de base de la régression linéaire simple</a></li>
<li class="chapter" data-level="4.4.2" data-path="sect044.html"><a href="sect044.html#sect0442"><i class="fa fa-check"></i><b>4.4.2</b> Formulation de la droite de régression des moindres carrés ordinaires</a></li>
<li class="chapter" data-level="4.4.3" data-path="sect044.html"><a href="sect044.html#sect0443"><i class="fa fa-check"></i><b>4.4.3</b> Mesure de la qualité d’ajustement du modèle</a></li>
<li class="chapter" data-level="4.4.4" data-path="sect044.html"><a href="sect044.html#sect0444"><i class="fa fa-check"></i><b>4.4.4</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="4.4.5" data-path="sect044.html"><a href="sect044.html#sect0445"><i class="fa fa-check"></i><b>4.4.5</b> Comment rapporter une régression linéaire simple</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sect045.html"><a href="sect045.html"><i class="fa fa-check"></i><b>4.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap05.html"><a href="chap05.html"><i class="fa fa-check"></i><b>5</b> Relation entre deux variables qualitatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sect051.html"><a href="sect051.html"><i class="fa fa-check"></i><b>5.1</b> Construction de tableau de contingence</a></li>
<li class="chapter" data-level="5.2" data-path="sect052.html"><a href="sect052.html"><i class="fa fa-check"></i><b>5.2</b> Test du khi-deux</a></li>
<li class="chapter" data-level="5.3" data-path="sect053.html"><a href="sect053.html"><i class="fa fa-check"></i><b>5.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="5.4" data-path="sect054.html"><a href="sect054.html"><i class="fa fa-check"></i><b>5.4</b> Interprétation d’un tableau de contingence</a></li>
<li class="chapter" data-level="5.5" data-path="sect055.html"><a href="sect055.html"><i class="fa fa-check"></i><b>5.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap06.html"><a href="chap06.html"><i class="fa fa-check"></i><b>6</b> Relation entre une variable qualitative et une variable quantitative</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sect061.html"><a href="sect061.html"><i class="fa fa-check"></i><b>6.1</b> Relation entre une variable quantitative et une variable qualitative à deux modalités</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="sect061.html"><a href="sect061.html#sect0611"><i class="fa fa-check"></i><b>6.1.1</b> Test <em>t</em> et ses différentes variantes</a></li>
<li class="chapter" data-level="6.1.2" data-path="sect061.html"><a href="sect061.html#sect0612"><i class="fa fa-check"></i><b>6.1.2</b> Test non paramétrique de Wilcoxon</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="sect062.html"><a href="sect062.html"><i class="fa fa-check"></i><b>6.2</b> Relation entre une variable quantitative et une variable qualitative à plus de deux modalités</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="sect062.html"><a href="sect062.html#sect0621"><i class="fa fa-check"></i><b>6.2.1</b> Analyse de variance</a></li>
<li class="chapter" data-level="6.2.2" data-path="sect062.html"><a href="sect062.html#sect0622"><i class="fa fa-check"></i><b>6.2.2</b> Test non paramétrique de Kruskal-Wallis</a></li>
<li class="chapter" data-level="6.2.3" data-path="sect062.html"><a href="sect062.html#sect0623"><i class="fa fa-check"></i><b>6.2.3</b> Mise en œuvre dans R</a></li>
<li class="chapter" data-level="6.2.4" data-path="sect062.html"><a href="sect062.html#sect0624"><i class="fa fa-check"></i><b>6.2.4</b> Comment rapporter les résultats d’une ANOVA et du test de Kruskal-Wallis</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="sect063.html"><a href="sect063.html"><i class="fa fa-check"></i><b>6.3</b> Conclusion sur la troisième partie</a></li>
<li class="chapter" data-level="6.4" data-path="sect064.html"><a href="sect064.html"><i class="fa fa-check"></i><b>6.4</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>IV Modèles de régression</b></span></li>
<li class="chapter" data-level="7" data-path="chap07.html"><a href="chap07.html"><i class="fa fa-check"></i><b>7</b> Régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sect071.html"><a href="sect071.html"><i class="fa fa-check"></i><b>7.1</b> Objectifs de la régression linéaire multiple et construction d’un modèle de régression</a></li>
<li class="chapter" data-level="7.2" data-path="sect072.html"><a href="sect072.html"><i class="fa fa-check"></i><b>7.2</b> Principes de base de la régression linéaire multiple</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="sect072.html"><a href="sect072.html#sect0721"><i class="fa fa-check"></i><b>7.2.1</b> Un peu d’équations…</a></li>
<li class="chapter" data-level="7.2.2" data-path="sect072.html"><a href="sect072.html#sect0722"><i class="fa fa-check"></i><b>7.2.2</b> Hypothèses de la régression linéaire multiple</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="sect073.html"><a href="sect073.html"><i class="fa fa-check"></i><b>7.3</b> Évaluation de la qualité d’ajustement du modèle</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sect073.html"><a href="sect073.html#sect0731"><i class="fa fa-check"></i><b>7.3.1</b> Mesures de la qualité d’un modèle</a></li>
<li class="chapter" data-level="7.3.2" data-path="sect073.html"><a href="sect073.html#sect0732"><i class="fa fa-check"></i><b>7.3.2</b> Comparaison des modèles incrémentiels</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sect074.html"><a href="sect074.html"><i class="fa fa-check"></i><b>7.4</b> Différentes mesures pour les coefficients de régression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="sect074.html"><a href="sect074.html#sect0741"><i class="fa fa-check"></i><b>7.4.1</b> Coefficients de régression : évaluer l’effet des variables indépendantes</a></li>
<li class="chapter" data-level="7.4.2" data-path="sect074.html"><a href="sect074.html#sect0742"><i class="fa fa-check"></i><b>7.4.2</b> Coefficients de régression standardisés : repérer les variables les plus importantes du modèle</a></li>
<li class="chapter" data-level="7.4.3" data-path="sect074.html"><a href="sect074.html#sect0743"><i class="fa fa-check"></i><b>7.4.3</b> Significativité des coefficients de régression : valeurs de <em>t</em> et de <em>p</em></a></li>
<li class="chapter" data-level="7.4.4" data-path="sect074.html"><a href="sect074.html#sect0744"><i class="fa fa-check"></i><b>7.4.4</b> Intervalle de confiance des coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="sect075.html"><a href="sect075.html"><i class="fa fa-check"></i><b>7.5</b> Introduction de variables explicatives particulières</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sect075.html"><a href="sect075.html#sect0751"><i class="fa fa-check"></i><b>7.5.1</b> Exploration des relations non linéaires</a></li>
<li class="chapter" data-level="7.5.2" data-path="sect075.html"><a href="sect075.html#sect0752"><i class="fa fa-check"></i><b>7.5.2</b> Variable indépendante qualitative dichotomique</a></li>
<li class="chapter" data-level="7.5.3" data-path="sect075.html"><a href="sect075.html#sect0753"><i class="fa fa-check"></i><b>7.5.3</b> Variable indépendante qualitative polytomique</a></li>
<li class="chapter" data-level="7.5.4" data-path="sect075.html"><a href="sect075.html#sect0754"><i class="fa fa-check"></i><b>7.5.4</b> Variables d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sect076.html"><a href="sect076.html"><i class="fa fa-check"></i><b>7.6</b> Diagnostics de la régression</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="sect076.html"><a href="sect076.html#sect0761"><i class="fa fa-check"></i><b>7.6.1</b> Nombre d’observations</a></li>
<li class="chapter" data-level="7.6.2" data-path="sect076.html"><a href="sect076.html#sect0762"><i class="fa fa-check"></i><b>7.6.2</b> Normalité des résidus</a></li>
<li class="chapter" data-level="7.6.3" data-path="sect076.html"><a href="sect076.html#sect0763"><i class="fa fa-check"></i><b>7.6.3</b> Linéarité et homoscédasticité des résidus</a></li>
<li class="chapter" data-level="7.6.4" data-path="sect076.html"><a href="sect076.html#sect0764"><i class="fa fa-check"></i><b>7.6.4</b> Absence de multicolinéarité excessive</a></li>
<li class="chapter" data-level="7.6.5" data-path="sect076.html"><a href="sect076.html#sect0766"><i class="fa fa-check"></i><b>7.6.5</b> Absence d’observations aberrantes</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="sect077.html"><a href="sect077.html"><i class="fa fa-check"></i><b>7.7</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sect077.html"><a href="sect077.html#sect0771"><i class="fa fa-check"></i><b>7.7.1</b> Fonctions <code>lm</code>, <code>summary()</code> et <code>confint()</code></a></li>
<li class="chapter" data-level="7.7.2" data-path="sect077.html"><a href="sect077.html#sect0772"><i class="fa fa-check"></i><b>7.7.2</b> Comparaison des modèles</a></li>
<li class="chapter" data-level="7.7.3" data-path="sect077.html"><a href="sect077.html#sect0773"><i class="fa fa-check"></i><b>7.7.3</b> Diagnostic sur un modèle</a></li>
<li class="chapter" data-level="7.7.4" data-path="sect077.html"><a href="sect077.html#sect0774"><i class="fa fa-check"></i><b>7.7.4</b> Graphiques pour les effets marginaux</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sect078.html"><a href="sect078.html"><i class="fa fa-check"></i><b>7.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap08.html"><a href="chap08.html"><i class="fa fa-check"></i><b>8</b> Régressions linéaires généralisées (GLM)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="sect081.html"><a href="sect081.html"><i class="fa fa-check"></i><b>8.1</b> Qu’est qu’un modèle GLM?</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="sect081.html"><a href="sect081.html#sect0811"><i class="fa fa-check"></i><b>8.1.1</b> Formulation d’un GLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="sect081.html"><a href="sect081.html#sect0812"><i class="fa fa-check"></i><b>8.1.2</b> Autres distributions et rôle de la fonction de lien</a></li>
<li class="chapter" data-level="8.1.3" data-path="sect081.html"><a href="sect081.html#sect0813"><i class="fa fa-check"></i><b>8.1.3</b> Conditions d’application</a></li>
<li class="chapter" data-level="8.1.4" data-path="sect081.html"><a href="sect081.html#sect0814"><i class="fa fa-check"></i><b>8.1.4</b> Résidus et déviance</a></li>
<li class="chapter" data-level="8.1.5" data-path="sect081.html"><a href="sect081.html#sect0815"><i class="fa fa-check"></i><b>8.1.5</b> Vérification l’ajustement</a></li>
<li class="chapter" data-level="8.1.6" data-path="sect081.html"><a href="sect081.html#sect0816"><i class="fa fa-check"></i><b>8.1.6</b> Comparaison de deux modèles GLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="sect082.html"><a href="sect082.html"><i class="fa fa-check"></i><b>8.2</b> Modèles GLM pour des variables qualitatives</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="sect082.html"><a href="sect082.html#sect0821"><i class="fa fa-check"></i><b>8.2.1</b> Modèle logistique binomial</a></li>
<li class="chapter" data-level="8.2.2" data-path="sect082.html"><a href="sect082.html#sect0822"><i class="fa fa-check"></i><b>8.2.2</b> Modèle probit binomial</a></li>
<li class="chapter" data-level="8.2.3" data-path="sect082.html"><a href="sect082.html#sect0823"><i class="fa fa-check"></i><b>8.2.3</b> Modèle logistique des cotes proportionnelles</a></li>
<li class="chapter" data-level="8.2.4" data-path="sect082.html"><a href="sect082.html#sect0824"><i class="fa fa-check"></i><b>8.2.4</b> Modèle logistique multinomial</a></li>
<li class="chapter" data-level="8.2.5" data-path="sect082.html"><a href="sect082.html#conclusion-sur-les-modèles-pour-des-variables-qualitatives"><i class="fa fa-check"></i><b>8.2.5</b> Conclusion sur les modèles pour des variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="sect084.html"><a href="sect084.html"><i class="fa fa-check"></i><b>8.3</b> Modèles GLM pour des variables de comptage</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="sect084.html"><a href="sect084.html#sect0841"><i class="fa fa-check"></i><b>8.3.1</b> Modèle de Poisson</a></li>
<li class="chapter" data-level="8.3.2" data-path="sect084.html"><a href="sect084.html#sect0842"><i class="fa fa-check"></i><b>8.3.2</b> Modèle binomial négatif</a></li>
<li class="chapter" data-level="8.3.3" data-path="sect084.html"><a href="sect084.html#sect0843"><i class="fa fa-check"></i><b>8.3.3</b> Modèle de Poisson avec excès fixe de zéros</a></li>
<li class="chapter" data-level="8.3.4" data-path="sect084.html"><a href="sect084.html#sect0844"><i class="fa fa-check"></i><b>8.3.4</b> Modèle de Poisson avec excès ajusté de zéros</a></li>
<li class="chapter" data-level="8.3.5" data-path="sect084.html"><a href="sect084.html#sect0845"><i class="fa fa-check"></i><b>8.3.5</b> Conclusion sur les modèles destinés à des variables de comptage</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sect085.html"><a href="sect085.html"><i class="fa fa-check"></i><b>8.4</b> Modèles GLM pour des variables continues</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sect085.html"><a href="sect085.html#sect0851"><i class="fa fa-check"></i><b>8.4.1</b> Modèle GLM gaussien</a></li>
<li class="chapter" data-level="8.4.2" data-path="sect085.html"><a href="sect085.html#sect0852"><i class="fa fa-check"></i><b>8.4.2</b> Modèle GLM avec une distribution de Student</a></li>
<li class="chapter" data-level="8.4.3" data-path="sect085.html"><a href="sect085.html#sect0853"><i class="fa fa-check"></i><b>8.4.3</b> Modèle GLM avec distribution Gamma</a></li>
<li class="chapter" data-level="8.4.4" data-path="sect085.html"><a href="sect085.html#sect0854"><i class="fa fa-check"></i><b>8.4.4</b> Modèle GLM avec une distribution bêta</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="sect086.html"><a href="sect086.html"><i class="fa fa-check"></i><b>8.5</b> Conclusion sur les modèles linéaires généralisés</a></li>
<li class="chapter" data-level="8.6" data-path="sect087.html"><a href="sect087.html"><i class="fa fa-check"></i><b>8.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap09.html"><a href="chap09.html"><i class="fa fa-check"></i><b>9</b> Régressions à effets mixtes (GLMM)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="sect091.html"><a href="sect091.html"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="sect091.html"><a href="sect091.html#sect0911"><i class="fa fa-check"></i><b>9.1.1</b> Indépendance des observations et effets de groupes</a></li>
<li class="chapter" data-level="9.1.2" data-path="sect091.html"><a href="sect091.html#sect0912"><i class="fa fa-check"></i><b>9.1.2</b> Terminologie: effets fixes et effets aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="sect092.html"><a href="sect092.html"><i class="fa fa-check"></i><b>9.2</b> Principes de base des GLMM</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="sect092.html"><a href="sect092.html#sect0921"><i class="fa fa-check"></i><b>9.2.1</b> GLMM avec constantes aléatoires</a></li>
<li class="chapter" data-level="9.2.2" data-path="sect092.html"><a href="sect092.html#sect0923"><i class="fa fa-check"></i><b>9.2.2</b> GLMM avec pentes aléatoires</a></li>
<li class="chapter" data-level="9.2.3" data-path="sect092.html"><a href="sect092.html#sect0924"><i class="fa fa-check"></i><b>9.2.3</b> GLMM avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="sect093.html"><a href="sect093.html"><i class="fa fa-check"></i><b>9.3</b> Conditions d’application des GLMM</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="sect093.html"><a href="sect093.html#sect0931"><i class="fa fa-check"></i><b>9.3.1</b> Vérification de la distribution des effets aléatoires</a></li>
<li class="chapter" data-level="9.3.2" data-path="sect093.html"><a href="sect093.html#sect0932"><i class="fa fa-check"></i><b>9.3.2</b> Homogénéité des variances au sein des groupes</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sect094.html"><a href="sect094.html"><i class="fa fa-check"></i><b>9.4</b> Inférence dans les modèles GLMM</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sect094.html"><a href="sect094.html#sect0941"><i class="fa fa-check"></i><b>9.4.1</b> Inférence pour les effets fixes</a></li>
<li class="chapter" data-level="9.4.2" data-path="sect094.html"><a href="sect094.html#sect0942"><i class="fa fa-check"></i><b>9.4.2</b> Inférence pour les effets aléatoires, effet global</a></li>
<li class="chapter" data-level="9.4.3" data-path="sect094.html"><a href="sect094.html#sect0943"><i class="fa fa-check"></i><b>9.4.3</b> Inférence pour les effets aléatoires, des constantes et des pentes</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="sect095.html"><a href="sect095.html"><i class="fa fa-check"></i><b>9.5</b> Conclusion sur les GLMM</a></li>
<li class="chapter" data-level="9.6" data-path="sect096.html"><a href="sect096.html"><i class="fa fa-check"></i><b>9.6</b> Mise en œuvre des GLMM dans R</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="sect096.html"><a href="sect096.html#sect0961"><i class="fa fa-check"></i><b>9.6.1</b> Ajustement du modèle avec uniquement une constante aléatoire</a></li>
<li class="chapter" data-level="9.6.2" data-path="sect096.html"><a href="sect096.html#sect0962"><i class="fa fa-check"></i><b>9.6.2</b> Ajustement du modèle avec constantes et pentes aléatoires</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="sect097.html"><a href="sect097.html"><i class="fa fa-check"></i><b>9.7</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Régressions multiniveaux</a>
<ul>
<li class="chapter" data-level="10.1" data-path="sect101.html"><a href="sect101.html"><i class="fa fa-check"></i><b>10.1</b> Modèles multiniveaux : deux intérêts majeurs</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="sect101.html"><a href="sect101.html#sect1011"><i class="fa fa-check"></i><b>10.1.1</b> Répartition de la variance entre les différents niveaux</a></li>
<li class="chapter" data-level="10.1.2" data-path="sect101.html"><a href="sect101.html#sect1012"><i class="fa fa-check"></i><b>10.1.2</b> Estimation des coefficients aux différents niveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="sect102.html"><a href="sect102.html"><i class="fa fa-check"></i><b>10.2</b> Différents types de modèles multiniveaux</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="sect102.html"><a href="sect102.html#sect1021"><i class="fa fa-check"></i><b>10.2.1</b> Description du jeu de données utilisé</a></li>
<li class="chapter" data-level="10.2.2" data-path="sect102.html"><a href="sect102.html#sect1022"><i class="fa fa-check"></i><b>10.2.2</b> Démarche classique pour les modèles multiniveaux</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="sect103.html"><a href="sect103.html"><i class="fa fa-check"></i><b>10.3</b> Conditions d’application des régressions multiniveaux</a></li>
<li class="chapter" data-level="10.4" data-path="sect104.html"><a href="sect104.html"><i class="fa fa-check"></i><b>10.4</b> Mise en œuvre dans R</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="sect104.html"><a href="sect104.html#sect1041"><i class="fa fa-check"></i><b>10.4.1</b> Le modèle vide</a></li>
<li class="chapter" data-level="10.4.2" data-path="sect104.html"><a href="sect104.html#sect1042"><i class="fa fa-check"></i><b>10.4.2</b> Modèle avec les variables indépendantes du niveau 1</a></li>
<li class="chapter" data-level="10.4.3" data-path="sect104.html"><a href="sect104.html#sect1043"><i class="fa fa-check"></i><b>10.4.3</b> Modèle avec les variables indépendantes aux niveaux 1 et 2</a></li>
<li class="chapter" data-level="10.4.4" data-path="sect104.html"><a href="sect104.html#sect10414"><i class="fa fa-check"></i><b>10.4.4</b> Modèle complet avec une interaction</a></li>
<li class="chapter" data-level="10.4.5" data-path="sect104.html"><a href="sect104.html#sect1045"><i class="fa fa-check"></i><b>10.4.5</b> Comparaison des quatre modèles</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="sect105.html"><a href="sect105.html"><i class="fa fa-check"></i><b>10.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chap11.html"><a href="chap11.html"><i class="fa fa-check"></i><b>11</b> Modèles généralisés additifs</a>
<ul>
<li class="chapter" data-level="11.1" data-path="sect111.html"><a href="sect111.html"><i class="fa fa-check"></i><b>11.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="sect111.html"><a href="sect111.html#sect1111"><i class="fa fa-check"></i><b>11.1.1</b> Non linéarité fonctionnelle</a></li>
<li class="chapter" data-level="11.1.2" data-path="sect111.html"><a href="sect111.html#sect1112"><i class="fa fa-check"></i><b>11.1.2</b> Non linéarité avec des polynomiales</a></li>
<li class="chapter" data-level="11.1.3" data-path="sect111.html"><a href="sect111.html#sect1113"><i class="fa fa-check"></i><b>11.1.3</b> Non linéarité par segments</a></li>
<li class="chapter" data-level="11.1.4" data-path="sect111.html"><a href="sect111.html#sect1114"><i class="fa fa-check"></i><b>11.1.4</b> Non linéarité avec des <em>splines</em></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="sect112.html"><a href="sect112.html"><i class="fa fa-check"></i><b>11.2</b> <em>Spline</em> de régression et <em>spline</em> de lissage</a></li>
<li class="chapter" data-level="11.3" data-path="sect113.html"><a href="sect113.html"><i class="fa fa-check"></i><b>11.3</b> Interprétation d’une <em>spline</em></a></li>
<li class="chapter" data-level="11.4" data-path="sect114.html"><a href="sect114.html"><i class="fa fa-check"></i><b>11.4</b> Multicolinéarité non linéaire</a></li>
<li class="chapter" data-level="11.5" data-path="sect115.html"><a href="sect115.html"><i class="fa fa-check"></i><b>11.5</b> <em>Splines</em> avancées</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="sect115.html"><a href="sect115.html#sect1151"><i class="fa fa-check"></i><b>11.5.1</b> <em>Splines</em> cycliques</a></li>
<li class="chapter" data-level="11.5.2" data-path="sect115.html"><a href="sect115.html#sect1152"><i class="fa fa-check"></i><b>11.5.2</b> Splines par groupe</a></li>
<li class="chapter" data-level="11.5.3" data-path="sect115.html"><a href="sect115.html#sect1153"><i class="fa fa-check"></i><b>11.5.3</b> <em>Splines</em> multivariées et <em>splines</em> d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="sect116.html"><a href="sect116.html"><i class="fa fa-check"></i><b>11.6</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="11.7" data-path="sect117.html"><a href="sect117.html"><i class="fa fa-check"></i><b>11.7</b> GAMM</a></li>
<li class="chapter" data-level="11.8" data-path="sect118.html"><a href="sect118.html"><i class="fa fa-check"></i><b>11.8</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>V Analyses exploratoires multivariées</b></span></li>
<li class="chapter" data-level="12" data-path="chap12.html"><a href="chap12.html"><i class="fa fa-check"></i><b>12</b> Méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1" data-path="sect121.html"><a href="sect121.html"><i class="fa fa-check"></i><b>12.1</b> Aperçu des méthodes factorielles</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="sect121.html"><a href="sect121.html#sect1211"><i class="fa fa-check"></i><b>12.1.1</b> Méthodes factorielles et types de données</a></li>
<li class="chapter" data-level="12.1.2" data-path="sect121.html"><a href="sect121.html#sect1212"><i class="fa fa-check"></i><b>12.1.2</b> Bref historique des méthodes factorielles</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="sect122.html"><a href="sect122.html"><i class="fa fa-check"></i><b>12.2</b> Analyses en composantes principales (ACP)</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="sect122.html"><a href="sect122.html#sect1221"><i class="fa fa-check"></i><b>12.2.1</b> Recherche d’une simplification</a></li>
<li class="chapter" data-level="12.2.2" data-path="sect122.html"><a href="sect122.html#sect1222"><i class="fa fa-check"></i><b>12.2.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.2.3" data-path="sect122.html"><a href="sect122.html#sect1223"><i class="fa fa-check"></i><b>12.2.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="sect123.html"><a href="sect123.html"><i class="fa fa-check"></i><b>12.3</b> Analyse factorielle des correspondances (AFC)</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="sect123.html"><a href="sect123.html#sect1231"><i class="fa fa-check"></i><b>12.3.1</b> Recherche d’une simplification basée sur la distance du khi-deux</a></li>
<li class="chapter" data-level="12.3.2" data-path="sect123.html"><a href="sect123.html#sect1232"><i class="fa fa-check"></i><b>12.3.2</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.3.3" data-path="sect123.html"><a href="sect123.html#sect1233"><i class="fa fa-check"></i><b>12.3.3</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="sect124.html"><a href="sect124.html"><i class="fa fa-check"></i><b>12.4</b> Analyse de correspondances multiples (ACM)</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="sect124.html"><a href="sect124.html#sect1241"><i class="fa fa-check"></i><b>12.4.1</b> Aides à l’interprétation</a></li>
<li class="chapter" data-level="12.4.2" data-path="sect124.html"><a href="sect124.html#sect1242"><i class="fa fa-check"></i><b>12.4.2</b> Mise en œuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="sect125.html"><a href="sect125.html"><i class="fa fa-check"></i><b>12.5</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chap13.html"><a href="chap13.html"><i class="fa fa-check"></i><b>13</b> Méthodes de classification non supervisée</a>
<ul>
<li class="chapter" data-level="13.1" data-path="sect131.html"><a href="sect131.html"><i class="fa fa-check"></i><b>13.1</b> Méthodes de classification : un aperçu</a></li>
<li class="chapter" data-level="13.2" data-path="sect132.html"><a href="sect132.html"><i class="fa fa-check"></i><b>13.2</b> Notions essentielles en classification</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="sect132.html"><a href="sect132.html#sect1321"><i class="fa fa-check"></i><b>13.2.1</b> Distance</a></li>
<li class="chapter" data-level="13.2.2" data-path="sect132.html"><a href="sect132.html#sect1322"><i class="fa fa-check"></i><b>13.2.2</b> Inertie</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="sect133.html"><a href="sect133.html"><i class="fa fa-check"></i><b>13.3</b> Classification ascendante hiérarchique</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="sect133.html"><a href="sect133.html#sect1331"><i class="fa fa-check"></i><b>13.3.1</b> Fonctionnement de l’algorithme</a></li>
<li class="chapter" data-level="13.3.2" data-path="sect133.html"><a href="sect133.html#sect1332"><i class="fa fa-check"></i><b>13.3.2</b> Choisir le bon nombre de groupes</a></li>
<li class="chapter" data-level="13.3.3" data-path="sect133.html"><a href="sect133.html#sect1333"><i class="fa fa-check"></i><b>13.3.3</b> Limites de la classification ascendante hiérarchique</a></li>
<li class="chapter" data-level="13.3.4" data-path="sect133.html"><a href="sect133.html#sect1334"><i class="fa fa-check"></i><b>13.3.4</b> Mise en oeuvre dans R</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="sect134.html"><a href="sect134.html"><i class="fa fa-check"></i><b>13.4</b> Nuées dynamiques</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="sect134.html"><a href="sect134.html#sect1341"><i class="fa fa-check"></i><b>13.4.1</b> <em>K-means</em></a></li>
<li class="chapter" data-level="13.4.2" data-path="sect134.html"><a href="sect134.html#sect1342"><i class="fa fa-check"></i><b>13.4.2</b> K-médianes</a></li>
<li class="chapter" data-level="13.4.3" data-path="sect134.html"><a href="sect134.html#sect1343"><i class="fa fa-check"></i><b>13.4.3</b> K-médoïds</a></li>
<li class="chapter" data-level="13.4.4" data-path="sect134.html"><a href="sect134.html#sect1344"><i class="fa fa-check"></i><b>13.4.4</b> Mise en oeuvre dans R</a></li>
<li class="chapter" data-level="13.4.5" data-path="sect134.html"><a href="sect134.html#sect1346"><i class="fa fa-check"></i><b>13.4.5</b> Extensions en logique floue : <em>c-means</em>, <em>c-medoids</em></a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sect135.html"><a href="sect135.html"><i class="fa fa-check"></i><b>13.5</b> Conclusion sur la cinquième partie</a></li>
<li class="chapter" data-level="13.6" data-path="sect136.html"><a href="sect136.html"><i class="fa fa-check"></i><b>13.6</b> Quiz de révision du chapitre</a></li>
</ul></li>
<li class="part"><span><b>VI Annexes</b></span></li>
<li class="chapter" data-level="14" data-path="annexe1.html"><a href="annexe1.html"><i class="fa fa-check"></i><b>14</b> Table des valeurs critiques de khi-deux</a></li>
<li class="chapter" data-level="15" data-path="annexe2.html"><a href="annexe2.html"><i class="fa fa-check"></i><b>15</b> Table des valeurs critiques de Fisher</a></li>
<li class="chapter" data-level="16" data-path="annexe3.html"><a href="annexe3.html"><i class="fa fa-check"></i><b>16</b> Table des valeurs critiques de <em>t</em></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Méthodes quantitatives en sciences sociales : un grand bol d’R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sect014" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Manipulation de données<a href="sect014.html#sect014" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dans cette section, vous apprendrez à charger et à manipuler des <em>DataFrames</em> en vue d’effectuer des opérations classiques de gestion de données.</p>
<div id="sect0141" class="section level3 hasAnchor" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Chargement d’un <em>DataFrame</em> depuis un fichier<a href="sect014.html#sect0141" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il est rarement nécessaire de créer vos <em>DataFrames</em> manuellement. Le plus souvent, vous disposerez de fichiers contenant vos données et utiliserez des fonctions pour les importer dans R sous forme d’un <em>DataFrame</em>. Les formats à importer les plus répandus sont :</p>
<ul>
<li><em>.csv</em>, soit un fichier texte dont chaque ligne représente une ligne du tableau de données et dont les colonnes sont séparées par un délimiteur (généralement une virgule ou un point-virgule);</li>
<li><em>.dbf</em>, ou fichier <em>dBase</em>, souvent associés à des fichiers d’information géographique au format <em>ShapeFile</em>;</li>
<li><em>.xls</em> et <em>.xlsx</em>, soit des fichiers générés par Excel;</li>
<li><em>.json</em>, soit un fichier texte utilisant la norme d’écriture propre au langage JavaScript.</li>
</ul>
<p>Plus rarement, il se peut que vous ayez à charger des fichiers provenant de logiciels propriétaires :</p>
<ul>
<li><em>.sas7bdat</em> (SAS);</li>
<li><em>.sav</em> (SPSS);</li>
<li><em>.dta</em> (STATA).</li>
</ul>
<p>Pour lire la plupart de ces fichiers, nous utilisons le <em>package</em> <code>foreign</code> dédié à l’importation d’une multitude de formats. Nous commençons donc par l’installer (<code>install.packages("foreign")</code>). Ensuite, nous chargeons cinq fois le même jeu de données enregistré dans des formats différents (<em>csv</em>, <em>dbf</em>, <em>dta</em>, <em>sas7bdat</em> et <em>xlsx</em>) et nous mesurons le temps nécessaire pour importer chacun de ces fichiers avec la fonction <code>Sys.time</code>.</p>
<div id="sect01411" class="section level4 hasAnchor" number="1.4.1.1">
<h4><span class="header-section-number">1.4.1.1</span> Lecture d’un fichier <em>csv</em><a href="sect014.html#sect01411" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour le format <em>csv</em>, il n’est pas nécessaire d’utiliser un <em>package</em> puisque R dispose d’une fonction de base pour lire ce format.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="sect014.html#cb106-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb106-2"><a href="sect014.html#cb106-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/priseenmain/SR_MTL_2016.csv&quot;</span>, </span>
<span id="cb106-3"><a href="sect014.html#cb106-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb106-4"><a href="sect014.html#cb106-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb106-5"><a href="sect014.html#cb106-5" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb106-6"><a href="sect014.html#cb106-6" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>))</span>
<span id="cb106-7"><a href="sect014.html#cb106-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-8"><a href="sect014.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;le DataFrame df1 a &quot;</span>,<span class="fu">nrow</span>(df1),<span class="st">&#39; observations&#39;</span>,</span>
<span id="cb106-9"><a href="sect014.html#cb106-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;et &#39;</span>,<span class="fu">ncol</span>(df1),<span class="st">&quot;colonnes</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## le DataFrame df1 a  951  observations et  48 colonnes</code></pre>
<p>Rien de bien compliqué! Notez tout de même que :</p>
<ul>
<li>Lorsque vous chargez un fichier <em>csv</em>, vous devez connaître le <strong>délimiteur</strong> (ou <strong>séparateur</strong>), soit le caractère utilisé pour délimiter les colonnes. Dans le cas présent, il s’agit d’une virgule (spécifiez avec l’argument <code>sep = ","</code>), mais il pourrait tout aussi bien être un point virgule (<code>sep = ";"</code>), une tabulation (<code>sep = "    "</code>), etc.</li>
<li>Vous devez également spécifier le caractère utilisé comme séparateur de décimales. Le plus souvent, ce sera le point (<code>dec = "."</code>), mais certains logiciels avec des paramètres régionaux de langue française (notamment Excel) exportent des fichiers <em>csv</em> avec des virgules comme séparateur de décimales (utilisez alors <code>dec = ","</code>).</li>
<li>L’argument <code>header</code> indique si la première ligne (l’entête) du fichier comprend ou non les noms des colonnes du jeu de données (avec les valeurs <code>TRUE</code> ou <code>FALSE</code>). Il arrive que certains fichiers <em>csv</em> soient fournis sans entête et que le nom et la description des colonnes soient fournis dans un autre fichier.</li>
<li>L’argument <code>stringsAsFactors</code> permet d’indiquer à R que les colonnes comportant du texte doivent être chargées comme des vecteurs de type texte et non de type facteur.</li>
</ul>
</div>
<div id="sect01412" class="section level4 hasAnchor" number="1.4.1.2">
<h4><span class="header-section-number">1.4.1.2</span> Lecture d’un fichier <em>dbase</em><a href="sect014.html#sect01412" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour lire un fichier <em>dbase</em> (.dbf), nous utilisons la fonction <code>read.dbf</code> du <em>package</em> <code>foreign</code> installé précédemment :</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="sect014.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb108-2"><a href="sect014.html#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="sect014.html#cb108-3" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb108-4"><a href="sect014.html#cb108-4" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">read.dbf</span>(<span class="st">&quot;data/priseenmain/SR_MTL_2016.dbf&quot;</span>)</span>
<span id="cb108-5"><a href="sect014.html#cb108-5" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb108-6"><a href="sect014.html#cb108-6" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>))</span>
<span id="cb108-7"><a href="sect014.html#cb108-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-8"><a href="sect014.html#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;le DataFrame df2 a &quot;</span>,<span class="fu">nrow</span>(df2),<span class="st">&quot; observations&quot;</span>,</span>
<span id="cb108-9"><a href="sect014.html#cb108-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;et &quot;</span>,<span class="fu">ncol</span>(df2),<span class="st">&quot; colonnes</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## le DataFrame df2 a  951  observations et  48  colonnes</code></pre>
<p>Comme vous pouvez le constater, nous obtenons les mêmes résultats qu’avec le fichier <em>csv</em>.</p>
</div>
<div id="sect01413" class="section level4 hasAnchor" number="1.4.1.3">
<h4><span class="header-section-number">1.4.1.3</span> Lecture d’un fichier <em>dta</em> (Stata)<a href="sect014.html#sect01413" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Si vous travaillez avec des collègues utilisant le logiciel Stata, il se peut que ces derniers vous partagent des fichiers <em>dta</em>. Toujours en utilisant le <em>package</em> <code>foreign</code>, vous serez en mesure de les charger directement dans R.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="sect014.html#cb110-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb110-2"><a href="sect014.html#cb110-2" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">read.dta</span>(<span class="st">&quot;data/priseenmain/SR_MTL_2016.dta&quot;</span>)</span>
<span id="cb110-3"><a href="sect014.html#cb110-3" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb110-4"><a href="sect014.html#cb110-4" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>))</span>
<span id="cb110-5"><a href="sect014.html#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="sect014.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;le DataFrame df3 a &quot;</span>,<span class="fu">nrow</span>(df3),<span class="st">&quot; observations &quot;</span>,</span>
<span id="cb110-7"><a href="sect014.html#cb110-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;et &quot;</span>,<span class="fu">ncol</span>(df3),<span class="st">&quot;colonnes</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## le DataFrame df3 a 951 observations et 48colonnes</code></pre>
</div>
<div id="sect01414" class="section level4 hasAnchor" number="1.4.1.4">
<h4><span class="header-section-number">1.4.1.4</span> Lecture d’un fichier <em>sav</em> (SPSS)<a href="sect014.html#sect01414" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour importer un fichier <em>sav</em> provenant du logiciel statistique SPSS, utilisez la fonction <code>read.spss</code> du <em>package</em> <code>foreign</code>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="sect014.html#cb112-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb112-2"><a href="sect014.html#cb112-2" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read.spss</span>(<span class="st">&quot;data/priseenmain/SR_MTL_2016.sav&quot;</span>))</span>
<span id="cb112-3"><a href="sect014.html#cb112-3" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb112-4"><a href="sect014.html#cb112-4" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>))</span>
<span id="cb112-5"><a href="sect014.html#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="sect014.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;le DataFrame df4 a &quot;</span>,<span class="fu">nrow</span>(df4),<span class="st">&quot; observations &quot;</span>,</span>
<span id="cb112-7"><a href="sect014.html#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;et &quot;</span>,<span class="fu">ncol</span>(df4),<span class="st">&quot;colonnes</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## le DataFrame df4 a 951 observations et 48colonnes</code></pre>
</div>
<div id="sect01415" class="section level4 hasAnchor" number="1.4.1.5">
<h4><span class="header-section-number">1.4.1.5</span> Lecture d’un fichier <em>sas7bdat</em> (SAS)<a href="sect014.html#sect01415" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Pour importer un fichier <em>sas7bdat</em> provenant du logiciel statistique SAS, utilisez la fonction <code>read.sas7bdat</code> du <em>package</em> <code>sas7bdat</code>. Installez préalablement le <em>package</em> (<code>install.packages("sas7bdat")</code>) et chargez-le (<code>library(sas7bdat)</code>).</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="sect014.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sas7bdat)</span>
<span id="cb114-2"><a href="sect014.html#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="sect014.html#cb114-3" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb114-4"><a href="sect014.html#cb114-4" aria-hidden="true" tabindex="-1"></a>df5 <span class="ot">&lt;-</span> <span class="fu">read.sas7bdat</span>(<span class="st">&quot;data/priseenmain/SR_MTL_2016.sas7bdat&quot;</span>)</span>
<span id="cb114-5"><a href="sect014.html#cb114-5" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb114-6"><a href="sect014.html#cb114-6" aria-hidden="true" tabindex="-1"></a>d5 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>))</span>
<span id="cb114-7"><a href="sect014.html#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="sect014.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;le DataFrame df5 a &quot;</span>,<span class="fu">nrow</span>(df5),<span class="st">&quot; observations &quot;</span>,</span>
<span id="cb114-9"><a href="sect014.html#cb114-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;et &quot;</span>,<span class="fu">ncol</span>(df5),<span class="st">&quot; colonnes</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## le DataFrame df5 a 951 observations et 48 colonnes</code></pre>
</div>
<div id="sect01416" class="section level4 hasAnchor" number="1.4.1.6">
<h4><span class="header-section-number">1.4.1.6</span> Lecture d’un fichier <em>xlsx</em> (Excel)<a href="sect014.html#sect01416" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Lire un fichier Excel dans R n’est pas toujours une tâche facile. Généralement, nous recommandons d’exporter le fichier en question au format <em>csv</em> dans un premier temps, puis de le lire avec la fonction <code>read.csv</code> dans un second temps (section <a href="sect014.html#sect01411">1.4.1.1</a>).</p>
<p>Il est néanmoins possible de lire directement un fichier <em>xlsx</em> avec le <em>package</em> <code>xlsx</code>. Ce dernier requiert que le logiciel JAVA soit installé sur votre ordinateur (Windows, Mac ou Linux). Si vous utilisez la version 64 bit de R, vous devrez télécharger et installer la version 64 bit de JAVA. Une fois que ce logiciel tiers est installé, il ne vous restera plus qu’à installer (<code>install.packages("xlsx")</code>) et charger (<code>library(xlsx)</code>) le <em>package</em> <code>xlsx</code>. Sous windows, il est possible que vous deviez également installer manuellement le <em>package</em> <code>rJava</code> et indiquer à R où se trouve JAVA sur votre ordinateur. La procédure est détaillée <a href="https://cimentadaj.github.io/blog/2018-05-25-installing-rjava-on-windows-10/installing-rjava-on-windows-10/">ici</a>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="sect014.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx)</span>
<span id="cb116-2"><a href="sect014.html#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="sect014.html#cb116-3" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb116-4"><a href="sect014.html#cb116-4" aria-hidden="true" tabindex="-1"></a>df6 <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="at">file=</span><span class="st">&quot;data/priseenmain/SR_MTL_2016.xlsx&quot;</span>,</span>
<span id="cb116-5"><a href="sect014.html#cb116-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">sheetIndex =</span> <span class="dv">1</span>,</span>
<span id="cb116-6"><a href="sect014.html#cb116-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">as.data.frame =</span> <span class="cn">TRUE</span>)</span>
<span id="cb116-7"><a href="sect014.html#cb116-7" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb116-8"><a href="sect014.html#cb116-8" aria-hidden="true" tabindex="-1"></a>d6 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>))</span>
<span id="cb116-9"><a href="sect014.html#cb116-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-10"><a href="sect014.html#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;le DataFrame df6 a &quot;</span>,<span class="fu">nrow</span>(df6),<span class="st">&quot; observations &quot;</span>,</span>
<span id="cb116-11"><a href="sect014.html#cb116-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;et &quot;</span>,<span class="fu">ncol</span>(df6),<span class="st">&quot; colonnes</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## le DataFrame df6 a 951 observations et 48 colonnes</code></pre>
<p>Il est possible d’accélérer significativement la vitesse de lecture d’un fichier <em>xlsx</em> en utilisant la fonction <code>read.xlsx2</code>. Il faut cependant indiquer à cette dernière le type de données de chaque colonne. Dans le cas présent, les cinq premières colonnes contiennent des données de type texte (<code>character</code>), alors que les 43 autres sont des données numériques (<code>numeric</code>). Nous utilisons la fonction <code>rep</code> afin de ne pas avoir à écrire plusieurs fois <em>character</em> et <em>numeric</em>.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="sect014.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx)</span>
<span id="cb118-2"><a href="sect014.html#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="sect014.html#cb118-3" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb118-4"><a href="sect014.html#cb118-4" aria-hidden="true" tabindex="-1"></a>df7 <span class="ot">&lt;-</span> <span class="fu">read.xlsx2</span>(<span class="at">file=</span><span class="st">&quot;data/priseenmain/SR_MTL_2016.xlsx&quot;</span>,</span>
<span id="cb118-5"><a href="sect014.html#cb118-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sheetIndex =</span> <span class="dv">1</span>, </span>
<span id="cb118-6"><a href="sect014.html#cb118-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">as.data.frame =</span> <span class="cn">TRUE</span>,</span>
<span id="cb118-7"><a href="sect014.html#cb118-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colClasses =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;character&quot;</span>,<span class="dv">5</span>),<span class="fu">rep</span>(<span class="st">&quot;numeric&quot;</span>,<span class="dv">43</span>))</span>
<span id="cb118-8"><a href="sect014.html#cb118-8" aria-hidden="true" tabindex="-1"></a>                  )</span>
<span id="cb118-9"><a href="sect014.html#cb118-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb118-10"><a href="sect014.html#cb118-10" aria-hidden="true" tabindex="-1"></a>d7 <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(t2,t1,<span class="at">units=</span><span class="st">&quot;secs&quot;</span>))</span>
<span id="cb118-11"><a href="sect014.html#cb118-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-12"><a href="sect014.html#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;le DataFrame df6 a &quot;</span>,<span class="fu">nrow</span>(df7),<span class="st">&quot; observations &quot;</span>,</span>
<span id="cb118-13"><a href="sect014.html#cb118-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;et &quot;</span>,<span class="fu">ncol</span>(df7),<span class="st">&quot;colonnes</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## le DataFrame df6 a 951 observations et 48colonnes</code></pre>
<p>Si nous comparons les temps d’exécution (tableau <a href="sect014.html#tab:tableduration">1.5</a>), nous constatons que la lecture des fichiers <em>xlsx</em> peut être extrêmement longue si nous ne spécifions pas le type des colonnes, ce qui peut devenir problématique pour des fichiers volumineux. Notez également que la lecture d’un fichier <em>csv</em> devient de plus en plus laborieuse à mesure que sa taille augmente. Si vous devez un jour charger des fichiers <em>csv</em> de plusieurs gigaoctets, nous vous recommandons vivement d’utiliser la fonction <code>fread</code> du <em>package</em> <code>data.table</code> qui est beaucoup plus rapide.</p>
<table>
<caption>
<span id="tab:tableduration">Tableau 1.5: </span>Temps nécessaire pour lire les données en fonction du type de fichiers
</caption>
<thead>
<tr>
<th style="text-align:right;">
Durée (secondes)
</th>
<th style="text-align:left;">
Fonction
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0,03
</td>
<td style="text-align:left;">
read.csv
</td>
</tr>
<tr>
<td style="text-align:right;">
0,02
</td>
<td style="text-align:left;">
read.dbf
</td>
</tr>
<tr>
<td style="text-align:right;">
0,01
</td>
<td style="text-align:left;">
read.spss
</td>
</tr>
<tr>
<td style="text-align:right;">
0,01
</td>
<td style="text-align:left;">
read.dta
</td>
</tr>
<tr>
<td style="text-align:right;">
0,46
</td>
<td style="text-align:left;">
read.sas7bdat
</td>
</tr>
<tr>
<td style="text-align:right;">
8,72
</td>
<td style="text-align:left;">
read.xlsx
</td>
</tr>
<tr>
<td style="text-align:right;">
0,32
</td>
<td style="text-align:left;">
read.xlsx2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sect0142" class="section level3 hasAnchor" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Manipulation d’un <em>DataFrame</em><a href="sect014.html#sect0142" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Une fois le <em>DataFrame</em> chargé, voyons comment il est possible de le manipuler.</p>
<div id="sect01421" class="section level4 hasAnchor" number="1.4.2.1">
<h4><span class="header-section-number">1.4.2.1</span> Petit mot sur le <code>tidyverse</code><a href="sect014.html#sect01421" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>tidyverse</code> est un ensemble de <em>packages</em> conçus pour faciliter la structuration et la manipulation des données dans R. Avant d’aller plus loin, il est important d’aborder brièvement un débat actuel dans la Communauté R. Entre 2010 et 2020, l’utilisation du <code>tidyverse</code> s’est peu à peu répandue. Développé et maintenu par Hadley Wickham, <code>tidyverse</code> introduit une philosophie et une grammaire spécifiques qui diffèrent du langage R traditionnel. Une partie de la communauté a pour ainsi dire complètement embrassé le <code>tidyverse</code> et de nombreux <em>packages</em>, en dehors du <code>tidyverse</code>, ont adopté sa grammaire et sa philosophie. À l’inverse, une autre partie de la communauté est contre cette évolution (<a href="https://blog.ephorie.de/why-i-dont-use-the-tidyverse" target="_blank">voir l’article du blogue suivant</a>). Les arguments pour et contre <code>tidyverse</code> sont résumés dans le tableau suivant.</p>
<table>
<caption>
<span id="tab:tableTidyverse">Tableau 1.6: </span>Avantages et inconvénients du tidyverse
</caption>
<thead>
<tr>
<th style="text-align:left;">
Avantage du tidyverse
</th>
<th style="text-align:left;">
Problème posé par le tidyverse
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Simplicité d’écriture et d’apprentissage
</td>
<td style="text-align:left;">
Nouvelle syntaxe à apprendre
</td>
</tr>
<tr>
<td style="text-align:left;">
Ajout de l’opérateur <code>%&gt;%</code> permettant d’enchaîner les traitements
</td>
<td style="text-align:left;">
Perte de lisibilité avec l’opérateur <code>-&gt;</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
La meilleure librairie pour réaliser des graphiques : <code>ggplot2</code>
</td>
<td style="text-align:left;">
Remplacement de certaines fonctions de base par d’autres provenant du <code>tidyverse</code> lors de son chargement, pouvant créer des erreurs.
</td>
</tr>
<tr>
<td style="text-align:left;">
Crée un écosystème cohérent
</td>
<td style="text-align:left;">
Ajout d’une dépendance dans le code
</td>
</tr>
<tr>
<td style="text-align:left;">
<em>Package</em> en développement et de plus en plus utilisé
</td>
<td style="text-align:left;">
Philosophie d’évolution agressive, aucune assurance de rétrocompatibilité
</td>
</tr>
</tbody>
</table>
<p>Le dernier point est probablement le plus problématique. Dans sa volonté d’évoluer au mieux et sans restriction, le <em>package</em> <code>tidyverse</code> n’offre aucune garantie de rétrocompatibilité. En d’autre termes, des changements importants peuvent être introduits d’une version à l’autre rendant potentiellement obsolète votre ancien code. Nous n’avons pas d’opinion tranchée sur le sujet : <code>tidyverse</code> est un outil très intéressant dans de nombreux cas; nous évitons simplement de l’utiliser systématiquement et préférons charger directement des sous-<em>packages</em> (comme <code>dplyr</code> ou <code>ggplot2</code>) du <code>tidyverse</code>. Notez que le <em>package</em> <code>data.table</code> offre une alternative au <code>tidyverse</code> dans la manipulation de données. Au prix d’une syntaxe généralement un peu plus complexe, le package <code>data.table</code> offre une vitesse de calcul bien supérieure au <code>tidyverse</code> et assure une bonne rétrocompatibilité.</p>
</div>
<div id="sect01422" class="section level4 hasAnchor" number="1.4.2.2">
<h4><span class="header-section-number">1.4.2.2</span> Gestion des colonnes d’un <em>DataFrame</em><a href="sect014.html#sect01422" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Repartons du <em>DataFrame</em> que nous avions chargé précédemment en important un fichier <em>csv</em>.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="sect014.html#cb120-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;data/priseenmain/SR_MTL_2016.csv&quot;</span>, </span>
<span id="cb120-2"><a href="sect014.html#cb120-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb120-3"><a href="sect014.html#cb120-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div id="sect014221" class="section level5 hasAnchor" number="1.4.2.2.1">
<h5><span class="header-section-number">1.4.2.2.1</span> Sélection d’une colonne<a href="sect014.html#sect014221" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Rappelons qu’il est possible d’accéder aux colonnes dans ce <em>DataFrame</em> en utilisant le symbole dollar <code>$ma_colonne</code> ou les doubles crochets <code>[["ma_colonne"]]</code>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="sect014.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la superficie totale de l&#39;Île de Montréal</span></span>
<span id="cb121-2"><a href="sect014.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(df<span class="sc">$</span>KM2)</span></code></pre></div>
<pre><code>## [1] 4680.543</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="sect014.html#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(df[[<span class="st">&quot;KM2&quot;</span>]])</span></code></pre></div>
<pre><code>## [1] 4680.543</code></pre>
</div>
<div id="sect014222" class="section level5 hasAnchor" number="1.4.2.2.2">
<h5><span class="header-section-number">1.4.2.2.2</span> Sélection de plusieurs colonnes<a href="sect014.html#sect014222" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Il est possible de sélectionner plusieurs colonnes d’un <em>DataFrame</em> et de filtrer ainsi les colonnes inutiles. Pour cela, nous pouvons utiliser un vecteur contenant soit les positions des colonnes (1 pour la première colonne, 2 pour la seconde et ainsi de suite), soit les noms des colonnes.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="sect014.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conserver les 5 premières colonnes</span></span>
<span id="cb125-2"><a href="sect014.html#cb125-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb125-3"><a href="sect014.html#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="sect014.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Conserver les colonnes 1, 5, 10 et 15</span></span>
<span id="cb125-5"><a href="sect014.html#cb125-5" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>)]</span>
<span id="cb125-6"><a href="sect014.html#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="sect014.html#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Cela peut aussi être utilisé pour changer l&#39;ordre des champs</span></span>
<span id="cb125-8"><a href="sect014.html#cb125-8" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df[<span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">1</span>,<span class="dv">5</span>)]</span>
<span id="cb125-9"><a href="sect014.html#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="sect014.html#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Conserver les colonnes 1 à 5, 7 à 12, 17 et 22</span></span>
<span id="cb125-11"><a href="sect014.html#cb125-11" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> df[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>,<span class="dv">17</span>,<span class="dv">22</span>)]</span>
<span id="cb125-12"><a href="sect014.html#cb125-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-13"><a href="sect014.html#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Conserver les colonnes avec leurs noms</span></span>
<span id="cb125-14"><a href="sect014.html#cb125-14" aria-hidden="true" tabindex="-1"></a>df5 <span class="ot">&lt;-</span> df[<span class="fu">c</span>(<span class="st">&quot;SRIDU&quot;</span>,<span class="st">&quot;KM2&quot;</span>,<span class="st">&quot;Pop2016&quot;</span>,<span class="st">&quot;MaisonIndi&quot;</span>,<span class="st">&quot;LoyerMed&quot;</span>)]</span></code></pre></div>
</div>
<div id="sect014223" class="section level5 hasAnchor" number="1.4.2.2.3">
<h5><span class="header-section-number">1.4.2.2.3</span> Suppression de colonnes<a href="sect014.html#sect014223" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Il est parfois plus intéressant et rapide de supprimer directement des colonnes plutôt que de recréer un nouveau <em>DataFrame</em>. Pour ce faire, nous attribuons la valeur <code>NULL</code> à ces colonnes.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="sect014.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer le colonnes 2, 3 et 5</span></span>
<span id="cb126-2"><a href="sect014.html#cb126-2" aria-hidden="true" tabindex="-1"></a>df3[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb126-3"><a href="sect014.html#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="sect014.html#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer une colonne avec son nom</span></span>
<span id="cb126-5"><a href="sect014.html#cb126-5" aria-hidden="true" tabindex="-1"></a>df4<span class="sc">$</span>OID <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb126-6"><a href="sect014.html#cb126-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-7"><a href="sect014.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer plusieurs colonnes par leur nom</span></span>
<span id="cb126-8"><a href="sect014.html#cb126-8" aria-hidden="true" tabindex="-1"></a>df5[<span class="fu">c</span>(<span class="st">&quot;SRIDU&quot;</span>,<span class="st">&quot;LoyerMed&quot;</span>)] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>)</span></code></pre></div>
<p>Notez que si vous supprimez une colonne, vous ne pouvez pas revenir en arrière. Il faudra recharger votre jeu de données ou éventuellement relancer les calculs qui avaient produit cette colonne.</p>
</div>
<div id="sect014224" class="section level5 hasAnchor" number="1.4.2.2.4">
<h5><span class="header-section-number">1.4.2.2.4</span> Modification du nom des colonnes<a href="sect014.html#sect014224" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Il est possible de changer le nom d’une colonne. Cette opération est importante pour faciliter la lecture du <em>DataFrame</em> ou encore s’assurer que l’exportation du <em>DataFrame</em> dans un format particulier (tel que <em>.dbf</em> qui ne supporte que les noms de colonnes avec moins de 10 caractères) ne posera pas de problème.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="sect014.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Voici les noms des colonnes</span></span>
<span id="cb127-2"><a href="sect014.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df5)</span></code></pre></div>
<pre><code>## [1] &quot;KM2&quot;        &quot;Pop2016&quot;    &quot;MaisonIndi&quot;</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="sect014.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Renommer toutes les colonnes</span></span>
<span id="cb129-2"><a href="sect014.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df5) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;superficie_km2&#39;</span>,<span class="st">&#39;population_2016&#39;</span>, <span class="st">&#39;maison_individuelle_prt&#39;</span>)</span>
<span id="cb129-3"><a href="sect014.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df5)</span></code></pre></div>
<pre><code>## [1] &quot;superficie_km2&quot;          &quot;population_2016&quot;         &quot;maison_individuelle_prt&quot;</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="sect014.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Renommer avec dplyr</span></span>
<span id="cb131-2"><a href="sect014.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb131-3"><a href="sect014.html#cb131-3" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">rename</span>(df4, <span class="st">&quot;population_2016&quot;</span> <span class="ot">=</span> <span class="st">&quot;Pop2016&quot;</span>,</span>
<span id="cb131-4"><a href="sect014.html#cb131-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;prs_moins_14ans_prt&quot;</span> <span class="ot">=</span> <span class="st">&quot;A014&quot;</span>,</span>
<span id="cb131-5"><a href="sect014.html#cb131-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;prs_15_64_ans_prt&quot;</span> <span class="ot">=</span> <span class="st">&quot;A1564&quot;</span>,</span>
<span id="cb131-6"><a href="sect014.html#cb131-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;prs_65plus_ans_prt&quot;</span> <span class="ot">=</span> <span class="st">&quot;A65plus&quot;</span></span>
<span id="cb131-7"><a href="sect014.html#cb131-7" aria-hidden="true" tabindex="-1"></a>              )</span></code></pre></div>
</div>
</div>
<div id="sect01423" class="section level4 hasAnchor" number="1.4.2.3">
<h4><span class="header-section-number">1.4.2.3</span> Calcul de nouvelles variables<a href="sect014.html#sect01423" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Il est possible d’utiliser les colonnes de type numérique pour calculer de nouvelles colonnes en utilisant les opérateurs mathématiques vus dans la section <a href="sect013.html#sect0135">1.3.5</a>. Prenons un exemple concret : calculons la densité de population par secteur de recensement dans notre <em>DataFrame</em>, puis affichons un résumé de cette nouvelle variable.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="sect014.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul de la densité</span></span>
<span id="cb132-2"><a href="sect014.html#cb132-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>pop_density_2016 <span class="ot">&lt;-</span> df<span class="sc">$</span>Pop2016 <span class="sc">/</span> df<span class="sc">$</span>KM2</span>
<span id="cb132-3"><a href="sect014.html#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="sect014.html#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Statistiques descriptives</span></span>
<span id="cb132-5"><a href="sect014.html#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(df<span class="sc">$</span>pop_density_2016)</span></code></pre></div>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
##    17.45  1946.96  3700.50  5465.03  7918.39 48811.79</code></pre>
<p>Nous pouvons aussi calculer le ratio entre le nombre de maisons et le nombre d’appartements.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="sect014.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcul du ratio</span></span>
<span id="cb134-2"><a href="sect014.html#cb134-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>total_maison <span class="ot">&lt;-</span> (df<span class="sc">$</span>MaisonIndi <span class="sc">+</span> df<span class="sc">$</span>MaisJumule <span class="sc">+</span> df<span class="sc">$</span>MaisRangee <span class="sc">+</span> df<span class="sc">$</span>AutreMais)</span>
<span id="cb134-3"><a href="sect014.html#cb134-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>total_apt <span class="ot">&lt;-</span> (df<span class="sc">$</span>AppDuplex <span class="sc">+</span> df<span class="sc">$</span>App5Moins <span class="sc">+</span> df<span class="sc">$</span>App5Plus)</span>
<span id="cb134-4"><a href="sect014.html#cb134-4" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ratio_maison_apt <span class="ot">&lt;-</span> df<span class="sc">$</span>total_maison <span class="sc">/</span> df<span class="sc">$</span>total_apt</span></code></pre></div>
<p>Retenez ici que R applique le calcul à chaque ligne de votre jeu de données et stocke le résultat dans une nouvelle colonne. Cette opération est du calcul vectoriel : toute la colonne est calculée en une seule fois. R est d’ailleurs optimisé pour le calcul vectoriel.</p>
</div>
<div id="sect01424" class="section level4 hasAnchor" number="1.4.2.4">
<h4><span class="header-section-number">1.4.2.4</span> Fonctions mathématiques<a href="sect014.html#sect01424" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>R propose un ensemble de fonctions de base pour effectuer du calcul. Voici une liste non exhaustive des principales fonctions :</p>
<ul>
<li><code>abs</code> calcule la valeur absolue de chaque valeur d’un vecteur;</li>
<li><code>sqrt</code> calcule la racine carrée de chaque valeur d’un vecteur;</li>
<li><code>log</code> calcule le logarithme de chaque valeur d’un vecteur;</li>
<li><code>exp</code> calcule l’exponentielle de chaque valeur d’un vecteur;</li>
<li><code>factorial</code> calcule la factorielle de chaque valeur d’un vecteur;</li>
<li><code>round</code> arrondit la valeur d’un vecteur;</li>
<li><code>ceiling</code>, <code>floor</code> arrondit à l’unité supérieure ou inférieure de chaque valeur d’un vecteur;</li>
<li><code>sin</code>, <code>asin</code>, <code>cos</code>, <code>acos</code>, <code>tan</code>, <code>atan</code> sont des fonctions de trigonométrie;</li>
<li><code>cumsum</code> calcule la somme cumulative des valeurs d’un vecteur.</li>
</ul>
<p>Ces fonctions sont des fonctions vectorielles puisqu’elles s’appliquent à tous les éléments d’un vecteur. Si votre vecteur en entrée comprend cinq valeurs, le vecteur en sortie comprendra aussi cinq valeurs.</p>
<p>À l’inverse, les fonctions suivantes s’appliquent directement à l’ensemble d’un vecteur et ne vont renvoyer qu’une seule valeur :</p>
<ul>
<li><code>sum</code> calcule la somme des valeurs d’un vecteur;</li>
<li><code>prod</code> calcule le produit des valeurs d’un vecteur;</li>
<li><code>min</code>, <code>max</code> renvoient les valeurs maximale et minimale d’un vecteur;</li>
<li><code>mean</code>, <code>median</code> renvoient la moyenne et la médiane d’un vecteur;</li>
<li><code>quantile</code> renvoie les percentiles d’un vecteur.</li>
</ul>
</div>
<div id="sect01425" class="section level4 hasAnchor" number="1.4.2.5">
<h4><span class="header-section-number">1.4.2.5</span> Fonctions pour manipuler des chaînes de caractères<a href="sect014.html#sect01425" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Outre les données numériques, vous aurez à travailler avec des données de type texte (<code>string</code>). Le <code>tidyverse</code> avec le <em>package</em> <code>stringr</code> offre des fonctions très intéressantes pour manipuler ce type de données. Pour un aperçu de toutes les fonctions offertes par <code>stringr</code>, référez-vous à sa <a href="https://github.com/rstudio/cheatsheets/blob/master/strings.pdf" target="_blank"><em>Cheat Sheet</em></a>. Commençons avec un <em>DataFrame</em> assez simple comprenant des adresses et des noms de personnes.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="sect014.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb135-2"><a href="sect014.html#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="sect014.html#cb135-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb135-4"><a href="sect014.html#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">noms =</span> <span class="fu">c</span>(<span class="st">&quot;Jérémy Toutanplace&quot;</span>,<span class="st">&quot;constant Tinople&quot;</span>,<span class="st">&quot;dino Resto&quot;</span>,<span class="st">&quot;Luce tancil&quot;</span>),</span>
<span id="cb135-5"><a href="sect014.html#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">adresses =</span> <span class="fu">c</span>(<span class="st">&#39;15 rue Levy&#39;</span>, <span class="st">&#39;413 Blvd Saint-Laurent&#39;</span>, <span class="st">&#39;3606 rue Duké&#39;</span>, <span class="st">&#39;2457 route St Marys&#39;</span>)</span>
<span id="cb135-6"><a href="sect014.html#cb135-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div id="sect014251" class="section level5 hasAnchor" number="1.4.2.5.1">
<h5><span class="header-section-number">1.4.2.5.1</span> Majuscules et minuscules<a href="sect014.html#sect014251" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Pour harmoniser ce <em>DataFrame</em>, nous mettons, dans un premier temps, des majuscules à la première lettre des prénoms et des noms des individus avec la fonction <code>str_to_title</code>.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="sect014.html#cb136-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>noms_corr <span class="ot">&lt;-</span> <span class="fu">str_to_title</span>(df<span class="sc">$</span>noms)</span>
<span id="cb136-2"><a href="sect014.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df<span class="sc">$</span>noms_corr)</span></code></pre></div>
<pre><code>## [1] &quot;Jérémy Toutanplace&quot; &quot;Constant Tinople&quot;   &quot;Dino Resto&quot;         &quot;Luce Tancil&quot;</code></pre>
<p>Nous pourrions également tout mettre en minuscules ou tout en majuscules.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="sect014.html#cb138-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>noms_min <span class="ot">&lt;-</span> <span class="fu">tolower</span>(df<span class="sc">$</span>noms)</span>
<span id="cb138-2"><a href="sect014.html#cb138-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>noms_maj <span class="ot">&lt;-</span> <span class="fu">toupper</span>(df<span class="sc">$</span>noms)</span>
<span id="cb138-3"><a href="sect014.html#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df<span class="sc">$</span>noms_min)</span></code></pre></div>
<pre><code>## [1] &quot;jérémy toutanplace&quot; &quot;constant tinople&quot;   &quot;dino resto&quot;         &quot;luce tancil&quot;</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="sect014.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df<span class="sc">$</span>noms_maj)</span></code></pre></div>
<pre><code>## [1] &quot;JÉRÉMY TOUTANPLACE&quot; &quot;CONSTANT TINOPLE&quot;   &quot;DINO RESTO&quot;         &quot;LUCE TANCIL&quot;</code></pre>
</div>
<div id="sect014252" class="section level5 hasAnchor" number="1.4.2.5.2">
<h5><span class="header-section-number">1.4.2.5.2</span> Remplacement du texte<a href="sect014.html#sect014252" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Les adresses comprennent des caractères accentués. Ce type de caractères cause régulièrement des problèmes d’encodage. Nous pourrions alors décider de les remplacer par des caractères simples avec la fonction <code>str_replace_all</code>.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="sect014.html#cb142-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>adresses_1 <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(df<span class="sc">$</span>adresses,<span class="st">&#39;é&#39;</span>,<span class="st">&#39;e&#39;</span>)</span>
<span id="cb142-2"><a href="sect014.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df<span class="sc">$</span>adresses_1)</span></code></pre></div>
<pre><code>## [1] &quot;15 rue Levy&quot;            &quot;413 Blvd Saint-Laurent&quot; &quot;3606 rue Duke&quot;         
## [4] &quot;2457 route St Marys&quot;</code></pre>
<p>La même fonction peut être utilisée pour remplacer les <em>St</em> par <em>Saint</em> et les <em>Blvd</em> par <em>Boulevard</em>.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="sect014.html#cb144-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>adresses_2 <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(df<span class="sc">$</span>adresses_1,<span class="st">&#39; St &#39;</span>,<span class="st">&#39; Saint &#39;</span>)</span>
<span id="cb144-2"><a href="sect014.html#cb144-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>adresses_3 <span class="ot">&lt;-</span> <span class="fu">str_replace_all</span>(df<span class="sc">$</span>adresses_2,<span class="st">&#39; Blvd &#39;</span>,<span class="st">&#39; Boulevard &#39;</span>)</span>
<span id="cb144-3"><a href="sect014.html#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df<span class="sc">$</span>adresses_3)</span></code></pre></div>
<pre><code>## [1] &quot;15 rue Levy&quot;                 &quot;413 Boulevard Saint-Laurent&quot; &quot;3606 rue Duke&quot;              
## [4] &quot;2457 route Saint Marys&quot;</code></pre>
</div>
<div id="sect014253" class="section level5 hasAnchor" number="1.4.2.5.3">
<h5><span class="header-section-number">1.4.2.5.3</span> Découpage du texte<a href="sect014.html#sect014253" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Il est parfois nécessaire de découper du texte pour en extraire des éléments. Nous devons alors choisir un caractère de découpage. Dans notre exemple, nous pourrions vouloir extraire les numéros civiques des adresses en sélectionnant le premier espace comme caractère de découpage, et en utilisant la fonction <code>str_split_fixed</code>.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="sect014.html#cb146-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>num_civique <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(df<span class="sc">$</span>adresses_3, <span class="st">&#39; &#39;</span>,<span class="at">n=</span><span class="dv">2</span>)[,<span class="dv">1</span>]</span>
<span id="cb146-2"><a href="sect014.html#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df<span class="sc">$</span>num_civique)</span></code></pre></div>
<pre><code>## [1] &quot;15&quot;   &quot;413&quot;  &quot;3606&quot; &quot;2457&quot;</code></pre>
<p>Pour être exact, sachez que pour notre exemple, la fonction <code>str_split_fixed</code> renvoie deux colonnes de texte : une avec le texte avant le premier espace, soit le numéro civique, et une avec le reste du texte. Le nombre de colonnes est contrôlé par l’argument <code>n</code>. Si <code>n = 1</code>, la fonction ne fait aucun découpage; avec <code>n = 2</code> la fonction découpe en deux parties le texte avec la première occurrence du délimiteur et ainsi de suite. En ajoutant <code>[,1]</code> à la fin, nous indiquons que nous souhaitons garder seulement la première des deux colonnes.</p>
<p>Il est également possible d’extraire des parties de texte et de ne garder par exemple que les <em>N</em> premiers caractères ou les <em>N</em> derniers caractères :</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="sect014.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne garder que les 5 premiers caractères</span></span>
<span id="cb148-2"><a href="sect014.html#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(df<span class="sc">$</span>adresses_3,<span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;15 ru&quot; &quot;413 B&quot; &quot;3606 &quot; &quot;2457 &quot;</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="sect014.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ne garder que les 5 derniers caractères</span></span>
<span id="cb150-2"><a href="sect014.html#cb150-2" aria-hidden="true" tabindex="-1"></a>n_caract <span class="ot">&lt;-</span> <span class="fu">nchar</span>(df<span class="sc">$</span>adresses_3)</span>
<span id="cb150-3"><a href="sect014.html#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(df<span class="sc">$</span>adresses_3, <span class="at">start =</span> n_caract<span class="dv">-4</span>, <span class="at">stop =</span> n_caract)</span></code></pre></div>
<pre><code>## [1] &quot; Levy&quot; &quot;urent&quot; &quot; Duke&quot; &quot;Marys&quot;</code></pre>
<p>Notez que les paramètres <code>start</code> et <code>stop</code> de la fonction <code>substr</code> peuvent accepter un vecteur de valeurs. Il est ainsi possible d’appliquer une sélection de texte différente à chaque chaîne de caractères dans notre vecteur en entrée. Nous pourrions par exemple vouloir récupérer tout le texte avant le second espace pour garder uniquement le numéro civique et le type de rue.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="sect014.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 1 : récupérer les positions des espaces pour chaque adresses</span></span>
<span id="cb152-2"><a href="sect014.html#cb152-2" aria-hidden="true" tabindex="-1"></a>positions <span class="ot">&lt;-</span> <span class="fu">str_locate_all</span>(df<span class="sc">$</span>adresses_3, <span class="st">&quot; &quot;</span>)</span>
<span id="cb152-3"><a href="sect014.html#cb152-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-4"><a href="sect014.html#cb152-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 2 : récupérer les positions des seconds espaces</span></span>
<span id="cb152-5"><a href="sect014.html#cb152-5" aria-hidden="true" tabindex="-1"></a>sec_positions <span class="ot">&lt;-</span> <span class="fu">sapply</span>(positions, <span class="cf">function</span>(i){</span>
<span id="cb152-6"><a href="sect014.html#cb152-6" aria-hidden="true" tabindex="-1"></a>  i[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb152-7"><a href="sect014.html#cb152-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb152-8"><a href="sect014.html#cb152-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-9"><a href="sect014.html#cb152-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 3 : appliquer le découpage</span></span>
<span id="cb152-10"><a href="sect014.html#cb152-10" aria-hidden="true" tabindex="-1"></a><span class="fu">substr</span>(df<span class="sc">$</span>adresses_3, <span class="at">start =</span> <span class="dv">1</span>, <span class="at">stop =</span> sec_positions<span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;15 rue&quot;        &quot;413 Boulevard&quot; &quot;3606 rue&quot;      &quot;2457 route&quot;</code></pre>
</div>
<div id="sect014254" class="section level5 hasAnchor" number="1.4.2.5.4">
<h5><span class="header-section-number">1.4.2.5.4</span> Concaténation du texte<a href="sect014.html#sect014254" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>À l’inverse du découpage, il est parfois nécessaire de concaténer des éléments de texte, ce qu’il est possible de réaliser avec la fonction <code>paste</code>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="sect014.html#cb154-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>texte_complet <span class="ot">&lt;-</span> <span class="fu">paste</span>(df<span class="sc">$</span>noms_corr, df<span class="sc">$</span>adresses_3, <span class="at">sep =</span> <span class="st">&quot; : &quot;</span>)</span>
<span id="cb154-2"><a href="sect014.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df<span class="sc">$</span>texte_complet)</span></code></pre></div>
<pre><code>## [1] &quot;Jérémy Toutanplace : 15 rue Levy&quot;              
## [2] &quot;Constant Tinople : 413 Boulevard Saint-Laurent&quot;
## [3] &quot;Dino Resto : 3606 rue Duke&quot;                    
## [4] &quot;Luce Tancil : 2457 route Saint Marys&quot;</code></pre>
<p>Le paramètre <code>sep</code> permet d’indiquer le ou les caractères à intercaler entre les éléments à concaténer. Notez qu’il est possible de concaténer plus que deux éléments.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="sect014.html#cb156-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>ville <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Montreal&#39;</span>,<span class="st">&#39;Montreal&#39;</span>,<span class="st">&#39;Montreal&#39;</span>,<span class="st">&#39;Montreal&#39;</span>)</span>
<span id="cb156-2"><a href="sect014.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(df<span class="sc">$</span>noms_corr, df<span class="sc">$</span>adresses_3, df<span class="sc">$</span>ville, <span class="at">sep =</span> <span class="st">&quot;, &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Jérémy Toutanplace, 15 rue Levy, Montreal&quot;              
## [2] &quot;Constant Tinople, 413 Boulevard Saint-Laurent, Montreal&quot;
## [3] &quot;Dino Resto, 3606 rue Duke, Montreal&quot;                    
## [4] &quot;Luce Tancil, 2457 route Saint Marys, Montreal&quot;</code></pre>
<p>Si vous souhaitez concaténer des éléments de texte sans séparateur, la fonction <code>paste0</code> peut être plus simple à utiliser.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="sect014.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;Please conca&quot;</span>, <span class="st">&quot;tenate me!&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Please concatenate me!&quot;</code></pre>
</div>
</div>
<div id="sect01426" class="section level4 hasAnchor" number="1.4.2.6">
<h4><span class="header-section-number">1.4.2.6</span> Manipulation des colonnes de type date<a href="sect014.html#sect01426" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Nous avons vu que les principaux types de données dans R sont le numérique, le texte, le booléen et le facteur. Il existe d’autres types introduits par différents <em>packages</em>. Nous abordons ici les types date et heure (<em>date</em> and <em>time</em>). Pour les manipuler, nous privilégions l’utilisation du <em>package</em> <code>lubridate</code> du <code>tidyverse</code>. Pour illustrer le tout, nous l’utilisons avec un jeu de données ouvertes de la Ville de Montréal représentant les collisions routières impliquant au moins un cycliste survenues après le 1<sup>er</sup> janvier 2017.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="sect014.html#cb160-1" aria-hidden="true" tabindex="-1"></a>accidents_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file=</span><span class="st">&quot;data/priseenmain/accidents.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb160-2"><a href="sect014.html#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(accidents_df)</span></code></pre></div>
<pre><code>## [1] &quot;HEURE_ACCDN&quot;       &quot;DT_ACCDN&quot;          &quot;NB_VICTIMES_TOTAL&quot;</code></pre>
<p>Nous disposons de trois colonnes représentant respectivement l’heure, la date et le nombre de victimes impliquées dans la collision.</p>
<div id="sect014261" class="section level5 hasAnchor" number="1.4.2.6.1">
<h5><span class="header-section-number">1.4.2.6.1</span> Du texte à la date<a href="sect014.html#sect014261" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Actuellement, les colonnes <code>HEURE_ACCDN</code> et <code>DT_ACCDN</code> sont au format texte. Nous pouvons afficher quelques lignes du jeu de données avec la fonction <code>head</code> pour visualiser comment elles ont été saisies.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="sect014.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(accidents_df, <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##         HEURE_ACCDN   DT_ACCDN NB_VICTIMES_TOTAL
## 1 16:00:00-16:59:00 2017/11/02                 0
## 2 06:00:00-06:59:00 2017/01/16                 1
## 3 18:00:00-18:59:00 2017/04/18                 0
## 4 11:00:00-11:59:00 2017/05/28                 1
## 5 15:00:00-15:59:00 2017/05/28                 1</code></pre>
<p>Un peu de ménage s’impose : les heures sont indiquées comme des périodes d’une heure. Nous utilisons la fonction <code>str_split_fixed</code> du <em>package</em> <code>stringr</code> pour ne garder que la première partie de l’heure (avant le tiret). Ensuite, Nous concaténons l’heure et la date avec la fonction <code>paste</code>, puis nous convertissons ce résultat en un objet <em>date-time</em>.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="sect014.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb164-2"><a href="sect014.html#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="sect014.html#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 1 : découper la colonne Heure_ACCDN</span></span>
<span id="cb164-4"><a href="sect014.html#cb164-4" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>heure <span class="ot">&lt;-</span> <span class="fu">str_split_fixed</span>(accidents_df<span class="sc">$</span>HEURE_ACCDN, <span class="st">&quot;-&quot;</span>, <span class="at">n=</span><span class="dv">2</span>)[,<span class="dv">1</span>]</span>
<span id="cb164-5"><a href="sect014.html#cb164-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-6"><a href="sect014.html#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 2 : concaténer l&#39;heure et la date</span></span>
<span id="cb164-7"><a href="sect014.html#cb164-7" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>date_heure <span class="ot">&lt;-</span> <span class="fu">paste</span>(accidents_df<span class="sc">$</span>DT_ACCDN, </span>
<span id="cb164-8"><a href="sect014.html#cb164-8" aria-hidden="true" tabindex="-1"></a>                                 accidents_df<span class="sc">$</span>heure,</span>
<span id="cb164-9"><a href="sect014.html#cb164-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sep =</span> <span class="st">&#39; &#39;</span>)</span>
<span id="cb164-10"><a href="sect014.html#cb164-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-11"><a href="sect014.html#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Étape 3 : convertir au format datetime</span></span>
<span id="cb164-12"><a href="sect014.html#cb164-12" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>datetime <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(accidents_df<span class="sc">$</span>date_heure,</span>
<span id="cb164-13"><a href="sect014.html#cb164-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">format =</span> <span class="st">&quot;%Y/%m/%d %H:%M:%S&quot;</span>)</span></code></pre></div>
<p>Pour effectuer la conversion, nous avons utilisé la fonction <code>as_datetime</code> du <em>package</em> <code>lubridate</code>. Elle prend comme paramètre un vecteur de texte et une indication du format de ce vecteur de texte. Il existe de nombreuses façons de spécifier une date et une heure et l’argument <em>format</em> permet d’indiquer celle à utiliser. Dans cet exemple, la date est structurée comme suit :
<code>année/mois/jour heure:minute:seconde</code>, ce qui se traduit par le format <code>%Y/%m/%d %H:%M:%S</code>.</p>
<ul>
<li>%Y signifie une année indiquée avec quatre caractères : 2017;</li>
<li>%m signifie un mois, indiqué avec deux caractères : 01, 02, 03, … 12;</li>
<li>%d signifie un jour, indiqué avec deux caractères : 01, 02, 03, … 31;</li>
<li>%H signifie une heure, au format 24 heures avec deux caractères : 00, 02, … 23;</li>
<li>%M signifie des minutes indiquées avec deux caractères : 00, 02, … 59;</li>
<li>%S signifie des secondes, indiquées avec deux caractères : 00, 02, … 59.</li>
</ul>
<p>Notez que les caractères séparant les années, jours, heures, etc. sont aussi à indiquer dans le format. Dans notre exemple, nous utilisons la barre oblique (<code>/</code>) pour séparer les éléments de la date et le deux points (<code>:</code>) pour l’heure, et une espace pour séparer la date et l’heure.</p>
<p>Il existe d’autres nomenclatures pour spécifier un format <em>datetime</em> : par exemple, des mois renseignés par leur nom, l’indication AM-PM, etc. Vous pouvez vous référer à la documentation de la fonction <code>strptime</code> (<code>help(strptime)</code>) pour explorer les différentes nomenclatures et choisir celle qui vous convient. Bien évidemment, il est nécessaire que toutes les dates de votre colonne soient renseignées dans le même format, pour éviter que la fonction ne retourne la valeur <code>NA</code> lorsqu’elle ne peut lire le format. Après toutes ces opérations, rejetons un oeil à notre <em>DataFrame</em>.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="sect014.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(accidents_df, <span class="at">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##         HEURE_ACCDN   DT_ACCDN NB_VICTIMES_TOTAL    heure          date_heure            datetime
## 1 16:00:00-16:59:00 2017/11/02                 0 16:00:00 2017/11/02 16:00:00 2017-11-02 16:00:00
## 2 06:00:00-06:59:00 2017/01/16                 1 06:00:00 2017/01/16 06:00:00 2017-01-16 06:00:00
## 3 18:00:00-18:59:00 2017/04/18                 0 18:00:00 2017/04/18 18:00:00 2017-04-18 18:00:00
## 4 11:00:00-11:59:00 2017/05/28                 1 11:00:00 2017/05/28 11:00:00 2017-05-28 11:00:00
## 5 15:00:00-15:59:00 2017/05/28                 1 15:00:00 2017/05/28 15:00:00 2017-05-28 15:00:00</code></pre>
</div>
<div id="sect014262" class="section level5 hasAnchor" number="1.4.2.6.2">
<h5><span class="header-section-number">1.4.2.6.2</span> Extraction des informations d’une date<a href="sect014.html#sect014262" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>À partir de la nouvelle colonne <code>datetime</code>, nous sommes en mesure d’extraire des informations intéressantes comme :</p>
<ul>
<li>le nom du jour de la semaine avec la fonction <code>weekdays</code></li>
</ul>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="sect014.html#cb167-1" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>jour <span class="ot">&lt;-</span> <span class="fu">weekdays</span>(accidents_df<span class="sc">$</span>datetime)</span></code></pre></div>
<ul>
<li>la période de la journée avec les fonctions <code>am</code> et <code>pm</code></li>
</ul>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="sect014.html#cb168-1" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>AM <span class="ot">&lt;-</span> <span class="fu">am</span>(accidents_df<span class="sc">$</span>datetime)</span>
<span id="cb168-2"><a href="sect014.html#cb168-2" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>PM <span class="ot">&lt;-</span> <span class="fu">pm</span>(accidents_df<span class="sc">$</span>datetime)</span>
<span id="cb168-3"><a href="sect014.html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(accidents_df[<span class="fu">c</span>(<span class="st">&quot;jour&quot;</span>, <span class="st">&quot;AM&quot;</span>, <span class="st">&quot;PM&quot;</span>)], <span class="at">n=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>##       jour    AM    PM
## 1    jeudi FALSE  TRUE
## 2    lundi  TRUE FALSE
## 3    mardi FALSE  TRUE
## 4 dimanche  TRUE FALSE
## 5 dimanche FALSE  TRUE</code></pre>
<p>Il est aussi possible d’accéder aux sous-éléments d’un <em>datetime</em> comme l’année, le mois, le jour, l’heure, la minute et la seconde avec les fonctions <code>year()</code>, <code>month()</code>,<code>day()</code>, <code>hour()</code>, <code>minute()</code> et <code>second()</code>.</p>
</div>
<div id="sect014263" class="section level5 hasAnchor" number="1.4.2.6.3">
<h5><span class="header-section-number">1.4.2.6.3</span> Calcul d’une durée entre deux <em>datetime</em><a href="sect014.html#sect014263" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Une autre utilisation intéressante du format <em>datetime</em> est de calculer des différences de temps. Par exemple, nous pourrions utiliser le nombre de minutes écoulées depuis 7 h comme une variable dans une analyse visant à déterminer le moment critique des collisions routières durant l’heure de pointe du matin.
Pour cela, nous devons créer un <em>datetime</em> de référence en concaténant la date de chaque observation, et le temps <code>07:00:00</code>, qui est notre point de départ.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="sect014.html#cb170-1" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>date_heure_07 <span class="ot">&lt;-</span> <span class="fu">paste</span>(accidents_df<span class="sc">$</span>DT_ACCDN, </span>
<span id="cb170-2"><a href="sect014.html#cb170-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&#39;07:00:00&#39;</span>,</span>
<span id="cb170-3"><a href="sect014.html#cb170-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sep =</span> <span class="st">&#39; &#39;</span>)</span>
<span id="cb170-4"><a href="sect014.html#cb170-4" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>ref_datetime <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(accidents_df<span class="sc">$</span>date_heure_07,</span>
<span id="cb170-5"><a href="sect014.html#cb170-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">format =</span> <span class="st">&quot;%Y/%m/%d %H:%M:%S&quot;</span>)</span></code></pre></div>
<p>Il ne nous reste plus qu’à calculer la différence de temps entre la colonne <em>datetime</em> et notre temps de référence <em>ref_datetime</em>.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="sect014.html#cb171-1" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>diff_time <span class="ot">&lt;-</span> <span class="fu">difftime</span>(accidents_df<span class="sc">$</span>datetime,</span>
<span id="cb171-2"><a href="sect014.html#cb171-2" aria-hidden="true" tabindex="-1"></a>                                   accidents_df<span class="sc">$</span>ref_datetime,</span>
<span id="cb171-3"><a href="sect014.html#cb171-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">units =</span> <span class="st">&#39;min&#39;</span>)</span></code></pre></div>
<p>Notez qu’ici la colonne <em>diff_time</em> est d’un type spécial : une différence temporelle (<em>difftime</em>). Il faut encore la convertir au format numérique pour l’utiliser avec la fonction <code>as.numeric</code>. Par curiosité, réalisons rapidement un histogramme avec la fonction <code>hist</code> pour analyser rapidement cette variable d’écart de temps!</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="sect014.html#cb172-1" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>diff_time_num <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(accidents_df<span class="sc">$</span>diff_time)</span>
<span id="cb172-2"><a href="sect014.html#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(accidents_df<span class="sc">$</span>diff_time_num, <span class="at">breaks =</span> <span class="dv">50</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig015"></span>
<img src="MethodesQuantitScSocialesBolR_files/figure-html/fig015-1.png" alt="Répartition temporelle des accidents à vélo" width="65%" />
<p class="caption">
Figure 1.15: Répartition temporelle des accidents à vélo
</p>
</div>
<p>Nous observons clairement deux pics, un premier entre 0 et 100 (entre 7 h et 8 h 30 environ) et un second plus important entre 550 et 650 (entre 16 h et 17 h 30 environ), ce qui correspond sans surprise aux heures de pointe (figure <a href="sect014.html#fig:fig015">1.15</a>). Il est intéressant de noter que plus d’accidents se produisent à l’heure de pointe du soir qu’à celle du matin.</p>
</div>
<div id="sect014264" class="section level5 hasAnchor" number="1.4.2.6.4">
<h5><span class="header-section-number">1.4.2.6.4</span> Fuseau horaire<a href="sect014.html#sect014264" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Lorsque nous travaillons avec des données provenant de différents endroits dans le monde ou que nous devons tenir compte des heures d’été et d’hiver, il convient de tenir compte du fuseau horaire. Pour créer une date avec un fuseau horaire, il est possible d’utiliser le paramètre <code>tz</code> dans la fonction <code>as_datetime</code> et d’utiliser l’identifiant du fuseau approprié. Dans notre cas, les données d’accident ont été collectées à Montréal, qui a un décalage de -5 heures par rapport au temps de référence UTC (+1 heure en été). Le code spécifique de ce fuseau horaire est <em>EDT</em>; il est facile de trouver ces codes avec le site web <a href="https://www.timeanddate.com/time/map/">timeanddate.com</a>.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="sect014.html#cb173-1" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>datetime <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(accidents_df<span class="sc">$</span>date_heure,</span>
<span id="cb173-2"><a href="sect014.html#cb173-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">format =</span> <span class="st">&quot;%Y/%m/%d %H:%M:%S&quot;</span>,</span>
<span id="cb173-3"><a href="sect014.html#cb173-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">tz =</span> <span class="st">&quot;EDT&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="sect01427" class="section level4 hasAnchor" number="1.4.2.7">
<h4><span class="header-section-number">1.4.2.7</span> Recodage des variables<a href="sect014.html#sect01427" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Recoder une variable signifie changer ses valeurs selon une condition afin d’obtenir une nouvelle variable. Si nous reprenons le jeu de données précédent sur les accidents à vélo, nous pourrions vouloir créer une nouvelle colonne nous indiquant si la collision a eu lieu en heures de pointe ou non. Nous obtiendrions ainsi une nouvelle variable avec seulement deux catégories plutôt que la variable numérique originale. Nous pourrions aussi définir quatre catégories avec l’heure de pointe du matin, l’heure de pointe du soir, le reste de la journée et la nuit.</p>
<div id="sect014271" class="section level5 hasAnchor" number="1.4.2.7.1">
<h5><span class="header-section-number">1.4.2.7.1</span> Cas binaire avec <code>ifelse</code><a href="sect014.html#sect014271" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Si nous ne souhaitons créer que deux catégories, le plus simple est d’utiliser la fonction <code>ifelse</code>. Cette fonction évalue une condition (section <a href="sect013.html#sect0135">1.3.5</a>) pour chaque ligne d’un <em>DataFrame</em> et produit un nouveau vecteur. Créons donc une variable binaire indiquant si une collision a eu lieu durant les heures de pointe ou hors heures de pointe. Nous devons alors évaluer les conditions suivantes :</p>
<p>Est-ce que l’accident a eu lieu entre 7 h (0) <strong>ET</strong> 9 h (120), <strong>OU</strong> entre 16 h 30 (570) <strong>ET</strong> 18 h 30 (690)?</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="sect014.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(accidents_df<span class="sc">$</span>diff_time_num))</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##  2414    40</code></pre>
<p>Notons dans un premier temps que nous avons 40 observations sans valeur pour la colonne <code>diff_time_num</code>. Il s’agit d’observations pour lesquelles nous ne disposions pas de dates au départ.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="sect014.html#cb176-1" aria-hidden="true" tabindex="-1"></a>Cond1 <span class="ot">&lt;-</span> accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&lt;=</span> <span class="dv">120</span></span>
<span id="cb176-2"><a href="sect014.html#cb176-2" aria-hidden="true" tabindex="-1"></a>Cond2 <span class="ot">&lt;-</span> accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&gt;=</span> <span class="dv">570</span> <span class="sc">&amp;</span> accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&lt;=</span> <span class="dv">690</span></span>
<span id="cb176-3"><a href="sect014.html#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="sect014.html#cb176-4" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>moment_bin <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Cond1 <span class="sc">|</span> Cond2,</span>
<span id="cb176-5"><a href="sect014.html#cb176-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;en heures de pointe&quot;</span>,</span>
<span id="cb176-6"><a href="sect014.html#cb176-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;hors heures de pointe&quot;</span>)</span></code></pre></div>
<p>Comme vous pouvez le constater, la fonction <code>ifelse</code> nécessite trois arguments :</p>
<ul>
<li>une condition, pouvant être <code>TRUE</code> ou <code>FALSE</code>;</li>
<li>la valeur à renvoyer si la condition est <code>FALSE</code>;</li>
<li>la valeur à renvoyer si la condition est <code>TRUE</code>.</li>
</ul>
<p>Avec la fonction <code>table</code>, nous pouvons rapidement visualiser les effectifs des deux catégories ainsi créées :</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="sect014.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(accidents_df<span class="sc">$</span>moment_bin)</span></code></pre></div>
<pre><code>## 
##   en heures de pointe hors heures de pointe 
##                   841                  1573</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="sect014.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifier si nous avons toujours seulement 40 NA</span></span>
<span id="cb179-2"><a href="sect014.html#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(accidents_df<span class="sc">$</span>moment_bin))</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##  2414    40</code></pre>
<p>Les heures de pointe représentent quatre heures de la journée, ce qui nous laisse neuf heures hors heures de pointe entre 7 h et 20 h.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="sect014.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ratio de collisions routières en heures de pointe</span></span>
<span id="cb181-2"><a href="sect014.html#cb181-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">841</span> <span class="sc">/</span> <span class="dv">2414</span>) <span class="sc">/</span> (<span class="dv">4</span> <span class="sc">/</span> <span class="dv">13</span>)</span></code></pre></div>
<pre><code>## [1] 1.132249</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="sect014.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ratio de collisions routières hors heure de pointe</span></span>
<span id="cb183-2"><a href="sect014.html#cb183-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1573</span> <span class="sc">/</span> <span class="dv">2414</span>) <span class="sc">/</span> (<span class="dv">9</span> <span class="sc">/</span> <span class="dv">13</span>)</span></code></pre></div>
<pre><code>## [1] 0.9412225</code></pre>
<p>En rapportant les collisions aux durées des deux périodes, nous observons une nette surreprésentation des collisions impliquant un vélo pendant les heures de pointe d’environ 13 % comparativement à la période hors des heures de pointe.</p>
</div>
<div id="sect014272" class="section level5 hasAnchor" number="1.4.2.7.2">
<h5><span class="header-section-number">1.4.2.7.2</span> Cas multiple avec la <code>case_when</code><a href="sect014.html#sect014272" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Lorsque nous souhaitons créer plus que deux catégories, il est possible soit d’enchaîner plusieurs fonctions <code>ifelse</code> (ce qui produit un code plus long et moins lisible), soit d’utiliser la fonction <code>case_when</code> du <em>package</em> <code>dplyr</code> du <code>tidyverse</code>. Reprenons notre exemple et créons quatre catégories :</p>
<ul>
<li>en heures de pointe du matin;</li>
<li>en heures de pointe du soir;</li>
<li>le reste de la journée (entre 7 h et 20 h);</li>
<li>la nuit (entre 21 h et 7 h).</li>
</ul>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="sect014.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb185-2"><a href="sect014.html#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="sect014.html#cb185-3" aria-hidden="true" tabindex="-1"></a>accidents_df<span class="sc">$</span>moment_multi <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb185-4"><a href="sect014.html#cb185-4" aria-hidden="true" tabindex="-1"></a>  accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&gt;=</span> <span class="dv">0</span> <span class="sc">&amp;</span> accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&lt;=</span> <span class="dv">120</span> <span class="sc">~</span> <span class="st">&quot;pointe matin&quot;</span>,</span>
<span id="cb185-5"><a href="sect014.html#cb185-5" aria-hidden="true" tabindex="-1"></a>  accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&gt;=</span> <span class="dv">570</span> <span class="sc">&amp;</span> accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&lt;=</span> <span class="dv">690</span> <span class="sc">~</span> <span class="st">&quot;pointe soir&quot;</span>,</span>
<span id="cb185-6"><a href="sect014.html#cb185-6" aria-hidden="true" tabindex="-1"></a>  accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&gt;</span> <span class="dv">690</span> <span class="sc">&amp;</span> accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&lt;</span> <span class="dv">780</span> <span class="sc">~</span> <span class="st">&quot;journee&quot;</span>,</span>
<span id="cb185-7"><a href="sect014.html#cb185-7" aria-hidden="true" tabindex="-1"></a>  accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&gt;</span> <span class="dv">120</span> <span class="sc">&amp;</span> accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&lt;</span> <span class="dv">570</span> <span class="sc">~</span> <span class="st">&quot;journee&quot;</span>,</span>
<span id="cb185-8"><a href="sect014.html#cb185-8" aria-hidden="true" tabindex="-1"></a>  accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">|</span> accidents_df<span class="sc">$</span>diff_time_num <span class="sc">&gt;=</span> <span class="dv">780</span> <span class="sc">~</span> <span class="st">&quot;nuit&quot;</span></span>
<span id="cb185-9"><a href="sect014.html#cb185-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb185-10"><a href="sect014.html#cb185-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-11"><a href="sect014.html#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(accidents_df<span class="sc">$</span>moment_multi)</span></code></pre></div>
<pre><code>## 
##      journee         nuit pointe matin  pointe soir 
##         1155          418          404          437</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="sect014.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifions encore les NA</span></span>
<span id="cb187-2"><a href="sect014.html#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(accidents_df<span class="sc">$</span>moment_multi))</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##  2414    40</code></pre>
<p>La syntaxe de cette fonction est un peu particulière. Elle accepte un nombre illimité (ou presque) d’arguments. Chaque argument est composé d’une condition et d’une valeur à renvoyer si la condition est vraie; ces deux éléments étant reliés par le symbole <code>~</code>. Notez que toutes les évaluations sont effectuées dans l’ordre des arguments. En d’autres termes, la fonction teste d’abord la première condition et assigne ses valeurs, puis recommence pour les prochaines conditions. Ainsi, si une observation (ligne du tableau de données) obtient <code>TRUE</code> à plusieurs conditions, elle obtient au final la valeur de la dernière condition validée. Dans l’exemple précédent, si la première condition est <code>accidents_df$diff_time_num &gt;= 0 | accidents_df$diff_time_num &lt;= 120</code>, alors nous obtenons pour seule valeur en résultat <code>"pointe matin"</code> puisque chaque observation a une valeur supérieure à 0 et que nous avons remplacé l’opérateur <code>&amp;</code> (ET) par l’opérateur <code>|</code> (OU).</p>
</div>
</div>
<div id="sect01428" class="section level4 hasAnchor" number="1.4.2.8">
<h4><span class="header-section-number">1.4.2.8</span> Sous-sélection d’un <em>DataFrame</em><a href="sect014.html#sect01428" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dans cette section, nous voyons comment extraire des sous-parties d’un <em>DataFrame</em>. Il est possible de sous-sélectionner des lignes et des colonnes en se basant sur des conditions ou leur index. Pour cela, nous utilisons un jeu de données fourni avec R : le jeu de données <strong>iris</strong> décrivant des fleurs du même nom.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="sect014.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;iris&quot;</span>)</span>
<span id="cb189-2"><a href="sect014.html#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="sect014.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombre de lignes et de colonnes</span></span>
<span id="cb189-4"><a href="sect014.html#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(iris)</span></code></pre></div>
<pre><code>## [1] 150   5</code></pre>
<div id="sect014281" class="section level5 hasAnchor" number="1.4.2.8.1">
<h5><span class="header-section-number">1.4.2.8.1</span> Sous-sélection des lignes<a href="sect014.html#sect014281" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Sous-sélectionner des lignes par index est relativement simple. Admettons que nous souhaitons sélectionner les lignes 1 à 5, 10 à 25, 37 et 58.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="sect014.html#cb191-1" aria-hidden="true" tabindex="-1"></a>sub_iris <span class="ot">&lt;-</span> iris[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">10</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">37</span>, <span class="dv">58</span>),]</span>
<span id="cb191-2"><a href="sect014.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(sub_iris)</span></code></pre></div>
<pre><code>## [1] 23</code></pre>
<p>Sous-sélectionner des lignes avec une condition peut être effectué soit avec une syntaxe similaire, soit en utilisant la fonction <code>subset</code>. Sélectionnons toutes les fleurs de l’espèce Virginica.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="sect014.html#cb193-1" aria-hidden="true" tabindex="-1"></a>iris_virginica1 <span class="ot">&lt;-</span> iris[iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;virginica&quot;</span>,]</span>
<span id="cb193-2"><a href="sect014.html#cb193-2" aria-hidden="true" tabindex="-1"></a>iris_virginica2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;virginica&quot;</span>)</span>
<span id="cb193-3"><a href="sect014.html#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="sect014.html#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérifions que les deux DataFrames ont le même nombre de lignes</span></span>
<span id="cb193-5"><a href="sect014.html#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(iris_virginica1) <span class="sc">==</span> <span class="fu">nrow</span>(iris_virginica2)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Vous pouvez utiliser, dans les deux cas, tous les opérateurs vus dans les sections <a href="sect013.html#sect01352">1.3.5.2</a> et <a href="sect013.html#sect01353">1.3.5.3</a>. L’enjeu est d’arriver à créer un vecteur booléen final permettant d’identifier les observations à conserver.</p>
</div>
<div id="sect014282" class="section level5 hasAnchor" number="1.4.2.8.2">
<h5><span class="header-section-number">1.4.2.8.2</span> Sous-sélection des colonnes<a href="sect014.html#sect014282" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Nous avons déjà vu comment sélectionner des colonnes en utilisant leur nom ou leur index dans la section <a href="sect014.html#sect014221">1.4.2.2.1</a>. Ajoutons ici un cas particulier où nous souhaitons sélectionner des colonnes selon une condition. Par exemple, nous pourrions vouloir conserver que les colonnes comprenant le mot <em>Length</em>. Pour cela, nous utilisons la fonction <code>grepl</code>, permettant de déterminer si des caractères sont présents dans une chaîne de caractères.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="sect014.html#cb195-1" aria-hidden="true" tabindex="-1"></a>nom_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(iris)</span>
<span id="cb195-2"><a href="sect014.html#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(nom_cols)</span></code></pre></div>
<pre><code>## [1] &quot;Sepal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Length&quot; &quot;Petal.Width&quot;  &quot;Species&quot;</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="sect014.html#cb197-1" aria-hidden="true" tabindex="-1"></a>test_nom <span class="ot">&lt;-</span> <span class="fu">grepl</span>(<span class="st">&quot;Length&quot;</span>,nom_cols, <span class="at">fixed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb197-2"><a href="sect014.html#cb197-2" aria-hidden="true" tabindex="-1"></a>ok_nom <span class="ot">&lt;-</span> nom_cols[test_nom]</span>
<span id="cb197-3"><a href="sect014.html#cb197-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-4"><a href="sect014.html#cb197-4" aria-hidden="true" tabindex="-1"></a>iris_2 <span class="ot">&lt;-</span> iris[ok_nom]</span>
<span id="cb197-5"><a href="sect014.html#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">names</span>(iris_2))</span></code></pre></div>
<pre><code>## [1] &quot;Sepal.Length&quot; &quot;Petal.Length&quot;</code></pre>
<p>Il est possible d’obtenir ce résultat en une seule ligne de code, mais elle est un peu moins lisible.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="sect014.html#cb199-1" aria-hidden="true" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> iris[<span class="fu">names</span>(iris)[<span class="fu">grepl</span>(<span class="st">&quot;Length&quot;</span>,<span class="fu">names</span>(iris), <span class="at">fixed =</span> <span class="cn">TRUE</span>)]]</span></code></pre></div>
</div>
<div id="sect014283" class="section level5 hasAnchor" number="1.4.2.8.3">
<h5><span class="header-section-number">1.4.2.8.3</span> Sélection des colonnes et des lignes<a href="sect014.html#sect014283" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Nous avons vu qu’avec les crochets <code>[]</code>, nous pouvons extraire les colonnes et les lignes d’un <em>DataFrame</em>. Il est possible de combiner les deux opérations simultanément. Pour ce faire, il faut indiquer en premier les index ou la condition permettant de sélectionner une ligne, puis les index ou la condition pour sélectionner les colonnes : <code>[index_lignes , index_colonnes]</code>. Sélectionnons cinq premières lignes et les trois premières colonnes du jeu de données iris :</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="sect014.html#cb200-1" aria-hidden="true" tabindex="-1"></a>iris_5x3 <span class="ot">&lt;-</span> iris[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)]</span>
<span id="cb200-2"><a href="sect014.html#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(iris_5x3)</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length
## 1          5.1         3.5          1.4
## 2          4.9         3.0          1.4
## 3          4.7         3.2          1.3
## 4          4.6         3.1          1.5
## 5          5.0         3.6          1.4</code></pre>
<p>Combinons nos deux exemples précédents pour sélectionner uniquement les lignes avec des fleurs de l’espèce <em>virginica</em>, et les colonnes avec le mot <em>Length</em>.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="sect014.html#cb202-1" aria-hidden="true" tabindex="-1"></a>iris_virginica3 <span class="ot">&lt;-</span> iris[iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;virginica&quot;</span>,</span>
<span id="cb202-2"><a href="sect014.html#cb202-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">names</span>(iris)[<span class="fu">grepl</span>(<span class="st">&quot;Length&quot;</span>,<span class="fu">names</span>(iris), <span class="at">fixed =</span> <span class="cn">TRUE</span>)]]</span>
<span id="cb202-3"><a href="sect014.html#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris_virginica3, <span class="at">n=</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>##     Sepal.Length Petal.Length
## 101          6.3          6.0
## 102          5.8          5.1
## 103          7.1          5.9
## 104          6.3          5.6
## 105          6.5          5.8</code></pre>
</div>
</div>
<div id="sect01429" class="section level4 hasAnchor" number="1.4.2.9">
<h4><span class="header-section-number">1.4.2.9</span> Fusion de <em>DataFrames</em><a href="sect014.html#sect01429" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Terminons cette section avec la fusion de <em>DataFrames</em>. Nous distinguons deux méthodes répondant à des besoins différents : par ajout ou par jointure.</p>
<div id="sect014291" class="section level5 hasAnchor" number="1.4.2.9.1">
<h5><span class="header-section-number">1.4.2.9.1</span> Fusion de <em>DataFrames</em> par ajout<a href="sect014.html#sect014291" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Ajouter deux <em>DataFrames</em> peut se faire en fonction de leurs colonnes ou en fonction de leurs lignes. Dans ces deux cas, nous utilisons respectivement les fonctions <code>cbind</code> et <code>rbind</code>. La figure <a href="sect014.html#fig:fig016">1.16</a> résume graphiquement le fonctionnement des deux fonctions.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig016"></span>
<img src="images/introduction/rbind_cbind.png" alt="Fusion de DataFrames" width="30%" />
<p class="caption">
Figure 1.16: Fusion de DataFrames
</p>
</div>
<p>Pour que <code>cbind</code> fonctionne, il faut que les deux <em>DataFrames</em> aient le même nombre de lignes. Pour <code>rbind</code>, les deux <em>DataFrames</em> doivent avoir le même nombre de colonnes. Prenons à nouveau comme exemple le jeu de données iris. Nous commençons par le séparer en trois sous-jeux de données comprenant chacun une espèce d’iris. Puis, nous fusionnons deux d’entre eux avec la fonction <code>rbind</code>.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="sect014.html#cb204-1" aria-hidden="true" tabindex="-1"></a>iris1 <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;virginica&quot;</span>)</span>
<span id="cb204-2"><a href="sect014.html#cb204-2" aria-hidden="true" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;versicolor&quot;</span>)</span>
<span id="cb204-3"><a href="sect014.html#cb204-3" aria-hidden="true" tabindex="-1"></a>iris3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;setosa&quot;</span>)</span>
<span id="cb204-4"><a href="sect014.html#cb204-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-5"><a href="sect014.html#cb204-5" aria-hidden="true" tabindex="-1"></a>iris_comb <span class="ot">&lt;-</span> <span class="fu">rbind</span>(iris2,iris3)</span></code></pre></div>
<p>Nous pourrions aussi extraire dans les deux <em>DataFrames</em> les colonnes comprenant le mot <em>Length</em> et le mot <em>Width</em>, puis les fusionner.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="sect014.html#cb205-1" aria-hidden="true" tabindex="-1"></a>iris_l <span class="ot">&lt;-</span> iris[<span class="fu">names</span>(iris)[<span class="fu">grepl</span>(<span class="st">&quot;Length&quot;</span>,<span class="fu">names</span>(iris), <span class="at">fixed =</span> <span class="cn">TRUE</span>)]]</span>
<span id="cb205-2"><a href="sect014.html#cb205-2" aria-hidden="true" tabindex="-1"></a>iris_w <span class="ot">&lt;-</span> iris[<span class="fu">names</span>(iris)[<span class="fu">grepl</span>(<span class="st">&quot;Width&quot;</span>,<span class="fu">names</span>(iris), <span class="at">fixed =</span> <span class="cn">TRUE</span>)]]</span>
<span id="cb205-3"><a href="sect014.html#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="sect014.html#cb205-4" aria-hidden="true" tabindex="-1"></a>iris_comb <span class="ot">&lt;-</span> <span class="fu">cbind</span>(iris_l,iris_w)</span>
<span id="cb205-5"><a href="sect014.html#cb205-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(iris_comb)</span></code></pre></div>
<pre><code>## [1] &quot;Sepal.Length&quot; &quot;Petal.Length&quot; &quot;Sepal.Width&quot;  &quot;Petal.Width&quot;</code></pre>
</div>
<div id="sect014292" class="section level5 hasAnchor" number="1.4.2.9.2">
<h5><span class="header-section-number">1.4.2.9.2</span> Jointure de <em>DataFrames</em><a href="sect014.html#sect014292" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Une jointure est une opération un peu plus complexe qu’un simple ajout. L’idée est d’associer des informations de plusieurs <em>DataFrames</em> en utilisant une colonne (appelée une clef) présente dans les deux jeux de données. Nous distinguons plusieurs types de jointure :</p>
<ul>
<li>les jointures internes permettant de combiner les éléments communs entre deux <em>DataFrames</em> A <strong>et</strong> B;</li>
<li>la jointure complète permettant de combiner les éléments présents dans A <strong>ou</strong> B;</li>
<li>la jointure à gauche, permettant de ne conserver que les éléments présents dans A même s’ils n’ont pas de correspondance dans B.</li>
</ul>
<p>Ces trois jointures sont présentées à la figure <a href="sect014.html#fig:fig017">1.17</a>; pour ces trois cas, la colonne commune se nomme <em>id</em>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig017"></span>
<img src="images/introduction/merging.png" alt="Jointure de DataFrames" width="30%" />
<p class="caption">
Figure 1.17: Jointure de DataFrames
</p>
</div>
<p>Vous retiendrez que les deux dernières jointures peuvent produire des valeurs manquantes. Pour réaliser ces opérations, nous utilisons la fonction <code>merge</code>. Prenons un exemple simple à partir d’un petit jeu de données.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="sect014.html#cb207-1" aria-hidden="true" tabindex="-1"></a>auteurs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb207-2"><a href="sect014.html#cb207-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Tukey&quot;</span>, <span class="st">&quot;Venables&quot;</span>, <span class="st">&quot;Tierney&quot;</span>, <span class="st">&quot;Ripley&quot;</span>, <span class="st">&quot;McNeil&quot;</span>, <span class="st">&quot;Apparicio&quot;</span>),</span>
<span id="cb207-3"><a href="sect014.html#cb207-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">nationality =</span> <span class="fu">c</span>(<span class="st">&quot;US&quot;</span>, <span class="st">&quot;Australia&quot;</span>, <span class="st">&quot;US&quot;</span>, <span class="st">&quot;UK&quot;</span>, <span class="st">&quot;Australia&quot;</span>, <span class="st">&quot;Canada&quot;</span>),</span>
<span id="cb207-4"><a href="sect014.html#cb207-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">retired =</span> <span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="fu">rep</span>(<span class="st">&quot;no&quot;</span>, <span class="dv">5</span>)))</span>
<span id="cb207-5"><a href="sect014.html#cb207-5" aria-hidden="true" tabindex="-1"></a>livres <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb207-6"><a href="sect014.html#cb207-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">aut =</span> <span class="fu">c</span>(<span class="st">&quot;Tukey&quot;</span>, <span class="st">&quot;Venables&quot;</span>, <span class="st">&quot;Tierney&quot;</span>, <span class="st">&quot;Ripley&quot;</span>, <span class="st">&quot;Ripley&quot;</span>, <span class="st">&quot;McNeil&quot;</span>,<span class="st">&quot;Wickham&quot;</span>),</span>
<span id="cb207-7"><a href="sect014.html#cb207-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">c</span>(<span class="st">&quot;Exploratory Data Analysis&quot;</span>,</span>
<span id="cb207-8"><a href="sect014.html#cb207-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;Modern Applied Statistics ...&quot;</span>,</span>
<span id="cb207-9"><a href="sect014.html#cb207-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;LISP-STAT&quot;</span>,</span>
<span id="cb207-10"><a href="sect014.html#cb207-10" aria-hidden="true" tabindex="-1"></a>              <span class="st">&quot;Spatial Statistics&quot;</span>, <span class="st">&quot;Stochastic Simulation&quot;</span>,</span>
<span id="cb207-11"><a href="sect014.html#cb207-11" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;Interactive Data Analysis&quot;</span>, <span class="st">&quot;R for Data Science&quot;</span>))</span></code></pre></div>
<p>Nous avons donc deux <em>DataFrames</em>, le premier décrivant des auteurs et le second des livres. Effectuons une première jointure interne afin de savoir pour chaque livre la nationnalité de son auteur et si ce dernier est à la retraite.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="sect014.html#cb208-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">merge</span>(livres, auteurs, <span class="co">#les deux DataFrames </span></span>
<span id="cb208-2"><a href="sect014.html#cb208-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">by.x =</span> <span class="st">&quot;aut&quot;</span>, <span class="at">by.y =</span> <span class="st">&#39;name&#39;</span>, <span class="co">#les noms des colonnes de jointures</span></span>
<span id="cb208-3"><a href="sect014.html#cb208-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">all.x =</span> <span class="cn">FALSE</span>, <span class="at">all.y =</span> <span class="cn">FALSE</span>)</span>
<span id="cb208-4"><a href="sect014.html#cb208-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-5"><a href="sect014.html#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df1)</span></code></pre></div>
<pre><code>##        aut                         title nationality retired
## 1   McNeil     Interactive Data Analysis   Australia      no
## 2   Ripley            Spatial Statistics          UK      no
## 3   Ripley         Stochastic Simulation          UK      no
## 4  Tierney                     LISP-STAT          US      no
## 5    Tukey     Exploratory Data Analysis          US     yes
## 6 Venables Modern Applied Statistics ...   Australia      no</code></pre>
<p>Cette jointure est interne, car les deux paramètres <em>all.x</em> et <em>all.y</em> ont pour valeur <code>FALSE</code>. Ainsi, nous indiquons à la fonction que nous ne souhaitons ni garder tous les éléments du premier <em>DataFrame</em> ni tous les éléments du second, mais uniquement les éléments présents dans les deux. Vous noterez ainsi que le livre “R for Data Science” n’est pas présent dans le jeu de données final, car son auteur “Wickham” ne fait pas partie du <em>DataFrame</em> auteurs. De même, l’auteur “Apparicio” n’apparaît pas dans la jointure, car aucun livre dans le <em>DataFrame</em> books n’a été écrit par cet auteur.</p>
<p>Pour conserver tous les livres, nous pouvons effectuer une jointure à gauche en renseignant <code>all.x = TRUE</code>. Nous forçons ainsi la fonction à garder tous les livres et à mettre des valeurs vides aux informations manquantes des auteurs.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="sect014.html#cb210-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(livres, auteurs, <span class="co">#les deux DataFrames </span></span>
<span id="cb210-2"><a href="sect014.html#cb210-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">by.x =</span> <span class="st">&quot;aut&quot;</span>, <span class="at">by.y =</span> <span class="st">&#39;name&#39;</span>, <span class="co">#les noms des colonnes de jointures</span></span>
<span id="cb210-3"><a href="sect014.html#cb210-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">all.y =</span> <span class="cn">FALSE</span>)</span>
<span id="cb210-4"><a href="sect014.html#cb210-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-5"><a href="sect014.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df2)</span></code></pre></div>
<pre><code>##        aut                         title nationality retired
## 1   McNeil     Interactive Data Analysis   Australia      no
## 2   Ripley            Spatial Statistics          UK      no
## 3   Ripley         Stochastic Simulation          UK      no
## 4  Tierney                     LISP-STAT          US      no
## 5    Tukey     Exploratory Data Analysis          US     yes
## 6 Venables Modern Applied Statistics ...   Australia      no
## 7  Wickham            R for Data Science        &lt;NA&gt;    &lt;NA&gt;</code></pre>
<p>Pour garder tous les livres et tous les auteurs, nous pouvons faire une jointure complète en indiquant <code>all.x = TRUE</code> et <code>all.y = TRUE</code>.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="sect014.html#cb212-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">merge</span>(livres, auteurs, <span class="co">#les deux DataFrames </span></span>
<span id="cb212-2"><a href="sect014.html#cb212-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">by.x =</span> <span class="st">&quot;aut&quot;</span>, <span class="at">by.y =</span> <span class="st">&#39;name&#39;</span>, <span class="co">#les noms des colonnes de jointures</span></span>
<span id="cb212-3"><a href="sect014.html#cb212-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb212-4"><a href="sect014.html#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="sect014.html#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df3)</span></code></pre></div>
<pre><code>##         aut                         title nationality retired
## 1 Apparicio                          &lt;NA&gt;      Canada      no
## 2    McNeil     Interactive Data Analysis   Australia      no
## 3    Ripley            Spatial Statistics          UK      no
## 4    Ripley         Stochastic Simulation          UK      no
## 5   Tierney                     LISP-STAT          US      no
## 6     Tukey     Exploratory Data Analysis          US     yes
## 7  Venables Modern Applied Statistics ...   Australia      no
## 8   Wickham            R for Data Science        &lt;NA&gt;    &lt;NA&gt;</code></pre>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sect013.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sect016.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MethodesQuantitScSocialesBolR.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
